!function(){"use strict";function t(t,n){function e(){}e.prototype=t;var i=new e;for(var r in n)i[r]=n[r];return n.toString!==Object.prototype.toString&&(i.toString=n.toString),i}function n(t,n){if(null==n)return null;null==n.__id__&&(n.__id__=h++);var e;return null==t.hx__closures__?t.hx__closures__={}:e=t.hx__closures__[n.__id__],null==e&&(e=function(){return e.method.apply(e.scope,arguments)},e.scope=t,e.method=n,t.hx__closures__[n.__id__]=e),e}var e=function(){this.space=new p.space.Space(new p.geom.Vec2(0,400)),this.init()};e.__name__=!0,e.main=function(){new e},e.prototype={init:function(){var t=this;this.space.get_gravity().set_y(10),this.space.set_worldAngularDrag(0),this.space.set_worldLinearDrag(0);p.geom.MarchingSquares.run(null,null,null,null);p.Config.sleepDelay=1e6;var n=(p.geom.Vec2List.fromArray([]),new p.dynamics.InteractionFilter(2,-3),new p.geom.Vec2);if(n.add(new p.geom.Vec2),n.sub(new p.geom.Vec2),n.mul(1),n.rotate(1),null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(n.zpp_inner.immutable(),10!=function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.x}()&&(n.zpp_inner.x=10,n.zpp_inner.invalidate()),null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(n.zpp_inner.validate(),n.zpp_inner.x,null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(n.zpp_inner.immutable(),20!=function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.y}()&&(n.zpp_inner.y=20,n.zpp_inner.invalidate()),null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";n.zpp_inner.validate(),n.zpp_inner.y;if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";n.zpp_inner.validate(),n.zpp_inner.x;if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(n.zpp_inner.validate(),n.zpp_inner.y,null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";p.geom.Vec2.get(function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.x}(),function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.y}(),!1),n.dot(new p.geom.Vec2),n.unit(),p.geom.Vec2.distance(n,n),p.geom.Vec2.dsq(n,n);if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";Math.sqrt(function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.x}()*function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.x}()+function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.y}()*function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.y}());var e=(p.geom.Ray.fromSegment(n,n),new p.geom.GeomPoly(n));if(e.top(),e.bottom(),e.bounds(),e.right(),e.left(),null!=e&&e.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(null==e.zpp_inner.vertices||null==e.zpp_inner.vertices.next||e.zpp_inner.vertices.prev==e.zpp_inner.vertices.next||o.geom.ZPP_Simple.isSimple(e.zpp_inner.vertices),e.isConvex(),null!=e&&e.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";null==e.zpp_inner.vertices||null==e.zpp_inner.vertices.next||e.zpp_inner.vertices.prev==e.zpp_inner.vertices.next||o.geom.ZPP_Monotone.isMonotone(e.zpp_inner.vertices),e.winding(),function(t){null==o.util.ZPP_Flags.Winding_CLOCKWISE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Winding_CLOCKWISE=new p.geom.Winding,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Winding_CLOCKWISE}(),e.size(),e.inflate(.5),e.cut(n,n,!0,!0),function(t){if(null!=e&&e.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";null==e.zpp_inner.vertices||null==e.zpp_inner.vertices.next||e.zpp_inner.vertices.prev==e.zpp_inner.vertices.next||(e.area(),p.Config.epsilon)}(),e.simpleDecomposition();var i=e.convexDecomposition(),r=new p.geom.GeomPolyList;i.merge(r),i.foreach(function(t){}),r.zpp_inner.reverse_flag?r.push(e):r.unshift(e);var s=this.space.bodiesUnderPoint(new p.geom.Vec2);s.has(new p.phys.Body),s.remove(new p.phys.Body),s.filter(function(t){return!0});var a=new p.geom.AABB;if(a.zpp_inner._immutable)throw"Error: AABB is immutable";if(10!=function(t){return a.zpp_inner.validate(),a.zpp_inner.width()}()&&(a.zpp_inner.maxx=function(t){return a.zpp_inner.validate(),a.zpp_inner.minx}()+10,a.zpp_inner.invalidate()),a.zpp_inner.validate(),a.zpp_inner.width(),a.zpp_inner._immutable)throw"Error: AABB is immutable";10!=function(t){return a.zpp_inner.validate(),a.zpp_inner.height()}()&&(a.zpp_inner.maxy=function(t){return a.zpp_inner.validate(),a.zpp_inner.miny}()+10,a.zpp_inner.invalidate()),a.zpp_inner.validate(),a.zpp_inner.height(),s=this.space.bodiesInAABB(a,!0);var _=new p.geom.RayResultList;_.filter(function(t){return!0}),_.merge(_);var h,u=(s.get_length(),new p.shape.Polygon(p.shape.Polygon.rect(.5,0,1,400)));null==u.zpp_inner_zn.wrap_edges&&u.zpp_inner_zn.getedges(),h=u.zpp_inner_zn.wrap_edges;var d=h.at(0);if(null==d.zpp_inner.polygon)throw"Error: Edge not current in use";d.zpp_inner.polygon.validate_laxi(),d.zpp_inner.length;if(null==d.zpp_inner.polygon)throw"Error: Edge not current in use";d.zpp_inner.polygon.validate_gaxi(),d.zpp_inner.gp0.wrapper();if(null==d.zpp_inner.polygon)throw"Error: Edge not current in use";d.zpp_inner.polygon.validate_gaxi(),d.zpp_inner.gp1.wrapper();if(null==d.zpp_inner.polygon)throw"Error: Edge not current in use";null==d.zpp_inner.wrap_gnorm&&d.zpp_inner.getgnorm(),d.zpp_inner.wrap_gnorm;if(null==d.zpp_inner.polygon)throw"Error: Edge not current in use";d.zpp_inner.polygon.validate_laxi(),d.zpp_inner.lp0.wrapper();if(null==d.zpp_inner.polygon)throw"Error: Edge not current in use";d.zpp_inner.polygon.validate_laxi(),d.zpp_inner.lp1.wrapper();if(null==d.zpp_inner.polygon)throw"Error: Edge not current in use";null==d.zpp_inner.wrap_lnorm&&d.zpp_inner.getlnorm(),d.zpp_inner.wrap_lnorm,p.geom.Geom.contains(u,u),p.geom.Geom.distance(u,u,n,n),p.geom.Geom.distanceBody(new p.phys.Body,new p.phys.Body,n,n),p.geom.Geom.intersects(u,u),p.geom.Geom.intersectsBody(new p.phys.Body,new p.phys.Body);var c=(function(t){return null==u.zpp_inner.wrap_localCOM&&(u.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?u.zpp_inner.circle.setupLocalCOM():u.zpp_inner.polygon.setupLocalCOM()),u.zpp_inner.wrap_localCOM}().get_x(),u.zpp_inner.material.wrapper());1!=1e3*c.zpp_inner.density&&(c.zpp_inner.density=.001,c.zpp_inner.invalidate(o.phys.ZPP_Material.WAKE|o.phys.ZPP_Material.PROPS)),c.zpp_inner.density,(u.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_POLYGON?u.zpp_inner.polygon.outer_zn:null).get_worldVerts().foreach(function(t){}),u.scale(1,1),u.rotate(1),u.zpp_inner.immutable_midstep("Shape::fluidEnabled"),u.zpp_inner.fluidEnabled=!0,null==u.zpp_inner.fluidProperties&&u.set_fluidProperties(new p.phys.FluidProperties),u.zpp_inner.wake(),u.zpp_inner.fluidEnabled,u.zpp_inner.immutable_midstep("Shape::fluidEnabled"),u.zpp_inner.fluidEnabled=!1,u.zpp_inner.wake(),u.zpp_inner.fluidEnabled,function(t){return u.zpp_inner.immutable_midstep("Shape::fluidProperties"),null==u.zpp_inner.fluidProperties&&u.zpp_inner.setFluid((new p.phys.FluidProperties).zpp_inner),u.zpp_inner.fluidProperties.wrapper()}().set_density(1),function(t){return u.zpp_inner.immutable_midstep("Shape::fluidProperties"),null==u.zpp_inner.fluidProperties&&u.zpp_inner.setFluid((new p.phys.FluidProperties).zpp_inner),u.zpp_inner.fluidProperties.wrapper()}().set_viscosity(10);(function(t){return u.zpp_inner.immutable_midstep("Shape::fluidProperties"),null==u.zpp_inner.fluidProperties&&u.zpp_inner.setFluid((new p.phys.FluidProperties).zpp_inner),u.zpp_inner.fluidProperties.wrapper()})().get_density();(function(t){return u.zpp_inner.immutable_midstep("Shape::fluidProperties"),null==u.zpp_inner.fluidProperties&&u.zpp_inner.setFluid((new p.phys.FluidProperties).zpp_inner),u.zpp_inner.fluidProperties.wrapper()})().get_viscosity(),u.zpp_inner.filter.wrapper().set_collisionGroup(1),u.zpp_inner.filter.wrapper().set_collisionMask(-3),null==u.zpp_inner_zn.wrap_lverts&&u.zpp_inner_zn.getlverts(),u.zpp_inner_zn.wrap_lverts;var P=new p.phys.Material(.3,.5,.6,2.7,.001);if(u.zpp_inner.immutable_midstep("Shape::material"),null==P)throw"Error: Cannot assign null as Shape material";u.zpp_inner.setMaterial(P.zpp_inner),u.zpp_inner.material.wrapper();P.zpp_inner.elasticity;1!=1e3*P.zpp_inner.density&&(P.zpp_inner.density=.001,P.zpp_inner.invalidate(o.phys.ZPP_Material.WAKE|o.phys.ZPP_Material.PROPS)),P.zpp_inner.density,.5!=P.zpp_inner.dynamicFriction&&(P.zpp_inner.dynamicFriction=.5,P.zpp_inner.invalidate(o.phys.ZPP_Material.WAKE|o.phys.ZPP_Material.ANGDRAG|o.phys.ZPP_Material.ARBITERS)),P.zpp_inner.dynamicFriction,.5!=P.zpp_inner.elasticity&&(P.zpp_inner.elasticity=.5,P.zpp_inner.invalidate(o.phys.ZPP_Material.WAKE|o.phys.ZPP_Material.ARBITERS)),P.zpp_inner.elasticity,.5!=P.zpp_inner.rollingFriction&&(P.zpp_inner.rollingFriction=.5,P.zpp_inner.invalidate(o.phys.ZPP_Material.WAKE|o.phys.ZPP_Material.ARBITERS)),P.zpp_inner.rollingFriction,1!=P.zpp_inner.staticFriction&&(P.zpp_inner.staticFriction=1,P.zpp_inner.invalidate(o.phys.ZPP_Material.WAKE|o.phys.ZPP_Material.ARBITERS)),P.zpp_inner.staticFriction;u.validity();!function(t){null==o.util.ZPP_Flags.ValidationResult_VALID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_VALID=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ValidationResult_VALID}();u.set_localCOM(new p.geom.Vec2(10,-100)),function(t){return null==u.zpp_inner.wrap_localCOM&&(u.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?u.zpp_inner.circle.setupLocalCOM():u.zpp_inner.polygon.setupLocalCOM()),u.zpp_inner.wrap_localCOM}().set_x(100),function(t){return null==u.zpp_inner.wrap_localCOM&&(u.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?u.zpp_inner.circle.setupLocalCOM():u.zpp_inner.polygon.setupLocalCOM()),u.zpp_inner.wrap_localCOM}().set_y(100);var f=new p.dynamics.InteractionGroup(!0),z=new p.dynamics.InteractionGroup(!1);if(z==f)throw"Error: Cannot assign InteractionGroup to itself";f.zpp_inner.setGroup(null==z?null:z.zpp_inner),null==f.zpp_inner.group||f.zpp_inner.group.outer;var v=new p.phys.Body(function(t){return null==o.util.ZPP_Flags.BodyType_KINEMATIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_KINEMATIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_KINEMATIC}());v.zpp_inner.disableCCD=!0,v.zpp_inner.disableCCD;v.zpp_inner.angvel,v.connectedBodies();!function(t){if(null==v.zpp_inner.space)throw"Error: isSleeping makes no sense if the object is not contained within a Space";v.zpp_inner.component.sleeping}();var m=new p.geom.Vec3;if(null!=m&&m.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";Math.sqrt(function(t){if(null!=m&&m.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return m.zpp_inner.validate(),m.zpp_inner.x}()*function(t){if(null!=m&&m.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return m.zpp_inner.validate(),m.zpp_inner.x}()+function(t){if(null!=m&&m.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return m.zpp_inner.validate(),m.zpp_inner.y}()*function(t){if(null!=m&&m.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return m.zpp_inner.validate(),m.zpp_inner.y}()+function(t){if(null!=m&&m.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return m.zpp_inner.validate(),m.zpp_inner.z}()*function(t){if(null!=m&&m.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return m.zpp_inner.validate(),m.zpp_inner.z}());if(null!=m&&m.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";m.zpp_inner.validate(),m.zpp_inner.x;if(null!=m&&m.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";m.zpp_inner.validate(),m.zpp_inner.y;if(null!=m&&m.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";m.zpp_inner.validate(),m.zpp_inner.z,v.zpp_inner.wrap_shapes.remove(v.zpp_inner.wrap_shapes.at(0));v.zpp_inner.wrap_shapes;if(v.zpp_inner.world)throw"Error: Space::world has no bounds";v.zpp_inner.aabb.wrapper(),v.zpp_inner.immutable_midstep("Body::true"),1!=!v.zpp_inner.nomove&&(v.zpp_inner.nomove=!1,v.zpp_inner.invalidate_mass()),v.zpp_inner.nomove;v.zpp_inner.nomove;if(v.zpp_inner_i.immutable_midstep("Interactor::group"),v.zpp_inner_i.setGroup(null==f?null:f.zpp_inner),null==v.zpp_inner_i.group||v.zpp_inner_i.group.outer,function(t){return null==v.zpp_inner_i.wrap_cbTypes&&v.zpp_inner_i.setupcbTypes(),v.zpp_inner_i.wrap_cbTypes}().remove(new p.callbacks.CbType),v.zpp_inner.immutable_midstep("Body::mass"),v.zpp_inner.world)throw"Error: Space::world is immutable";if(10>=Math.POSITIVE_INFINITY)throw"Error: Mass cannot be infinite, use allowMovement = false instead";if(v.zpp_inner.massMode=o.util.ZPP_Flags.id_MassMode_FIXED,v.zpp_inner.cmass=10,v.zpp_inner.invalidate_mass(),v.zpp_inner.world)throw"Error: Space::world has no mass";if(v.zpp_inner.validate_mass(),v.zpp_inner.massMode==o.util.ZPP_Flags.id_MassMode_DEFAULT&&null==v.zpp_inner.shapes.head)throw"Error: Given current mass mode, Body::mass only makes sense if it contains shapes";v.zpp_inner.cmass,v.set_position(new p.geom.Vec2),v.zpp_inner.immutable_midstep("Body::false"),0!=!v.zpp_inner.norotate&&(v.zpp_inner.norotate=!0,v.zpp_inner.invalidate_inertia()),v.zpp_inner.norotate,v.zpp_inner.immutable_midstep("Body::true"),1!=!v.zpp_inner.norotate&&(v.zpp_inner.norotate=!1,v.zpp_inner.invalidate_inertia()),v.zpp_inner.norotate,v.zpp_inner.bulletEnabled=!1,v.zpp_inner.bulletEnabled,v.contains(new p.geom.Vec2),v.applyImpulse(n),v.applyAngularImpulse(100),v.buoyancyImpulse(),v.constraintsImpulse(),v.dragImpulse(),v.normalImpulse(),v.rollingImpulse(),v.tangentImpulse(),v.totalContactsImpulse(),v.totalFluidImpulse(),v.totalImpulse(),v.zpp_inner.wrap_shapes.foreach(function(t){});var b;null==v.zpp_inner.wrap_constraints&&(v.zpp_inner.wrap_constraints=o.util.ZPP_ConstraintList.get(v.zpp_inner.constraints,!0)),b=v.zpp_inner.wrap_constraints,b.foreach(function(t){});var y=new p.phys.BodyList;y.zpp_inner.reverse_flag?y.push(v):y.unshift(v);y.at(0);y.clear(),y.filter(function(t){return!1}),y.foreach(function(t){}),y.has(v);var g=new p.phys.BodyList;y.merge(g);var x;y.get_length();null==v.zpp_inner.wrap_arbiters&&(v.zpp_inner.wrap_arbiters=o.util.ZPP_ArbiterList.get(v.zpp_inner.arbiters,!0)),x=v.zpp_inner.wrap_arbiters;x.zpp_gl();if(x.filter(function(t){if(t.zpp_inner.type==o.dynamics.ZPP_Arbiter.COL){t.zpp_inner.type==o.dynamics.ZPP_Arbiter.COL?t.zpp_inner.colarb.outer_zn:null}return t.zpp_inner.type,o.dynamics.ZPP_Arbiter.FLUID,!1}),x.foreach(function(t){}),x.has(null),x.at(0),x.zpp_gl(),v.zpp_inner_i.immutable_midstep("Interactor::group"),v.zpp_inner_i.setGroup(null==z?null:z.zpp_inner),null==v.zpp_inner_i.group||v.zpp_inner_i.group.outer,v.align(),v.zpp_inner.wrap_shapes.clear(),v.zpp_inner.immutable_midstep("Body::rotation"),v.zpp_inner.world)throw"Error: Space::world is immutable";if(v.zpp_inner.type==o.util.ZPP_Flags.id_BodyType_STATIC&&null!=v.zpp_inner.space)throw"Error: Static objects cannot be rotated once inside a Space";1!=v.zpp_inner.rot&&(v.zpp_inner.rot=1,v.zpp_inner.invalidate_rot(),v.zpp_inner.wake()),v.zpp_inner.rot,v.localPointToWorld(new p.geom.Vec2(100,100),!1);for(var Z=1;Z<3;){var w=Z++;v.zpp_inner.wrap_shapes.add(new p.shape.Polygon(p.shape.Polygon.rect(266.6666666666667*w-.5,0,1,400)))}for(var C=1;C<3;){var E=C++;v.zpp_inner.wrap_shapes.add(new p.shape.Polygon(p.shape.Polygon.rect(0,200*E-.5,800,1)))}v.set_space(this.space),(null==v.zpp_inner.space?null:v.zpp_inner.space.outer).zpp_inner.wrap_bodies.remove(v);var S=new p.constraint.WeldJoint(v,v,n,n);0!=S.zpp_inner.active&&(null!=S.zpp_inner.component&&(S.zpp_inner.component.woken=!1),S.zpp_inner.clearcache(),null!=S.zpp_inner.space&&(S.zpp_inner.wake(),S.zpp_inner.space.live_constraints.remove(S.zpp_inner)),S.zpp_inner.active=!1,S.zpp_inner.deactivate()),S.zpp_inner.active,1!=S.zpp_inner.active&&(null!=S.zpp_inner.component&&(S.zpp_inner.component.woken=!1),S.zpp_inner.clearcache(),S.zpp_inner.active=!0,S.zpp_inner.activate(),null!=S.zpp_inner.space&&(null!=S.zpp_inner.component&&(S.zpp_inner.component.sleeping=!0),S.zpp_inner.space.wake_constraint(S.zpp_inner,!0))),S.zpp_inner.active,S.impulse();null==S.zpp_inner_zn.b1||S.zpp_inner_zn.b1.outer,S.set_body1(new p.phys.Body),S.set_body2(new p.phys.Body);var N=new p.constraint.DistanceJoint(v,v,n,n,0,100);if(N.zpp_inner.validate(),1!=N.zpp_inner.ignore&&(N.zpp_inner.ignore=!0,N.zpp_inner.wake()),N.zpp_inner.ignore,0!=N.zpp_inner.stiff&&(N.zpp_inner.stiff=!1,N.zpp_inner.wake()),N.zpp_inner.stiff,0!=N.zpp_inner.damping&&(N.zpp_inner.damping=0,N.zpp_inner.stiff||N.zpp_inner.wake()),N.zpp_inner.damping,1e3!=N.zpp_inner.frequency&&(N.zpp_inner.frequency=1e3,N.zpp_inner.stiff||N.zpp_inner.wake()),N.zpp_inner.frequency,N.impulse(),null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==n)throw"Error: Constraint::anchor1 cannot be null";if(function(t){return null==N.zpp_inner_zn.wrap_a1&&N.zpp_inner_zn.setup_a1(),N.zpp_inner_zn.wrap_a1}().set(n),null==N.zpp_inner_zn.wrap_a1&&N.zpp_inner_zn.setup_a1(),N.zpp_inner_zn.wrap_a1,null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==n)throw"Error: Constraint::anchor2 cannot be null";(function(t){return null==N.zpp_inner_zn.wrap_a2&&N.zpp_inner_zn.setup_a2(),N.zpp_inner_zn.wrap_a2})().set(n),null==N.zpp_inner_zn.wrap_a2&&N.zpp_inner_zn.setup_a2(),N.zpp_inner_zn.wrap_a2;var k=new p.constraint.PivotJoint(v,v,n,n);if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==n)throw"Error: Constraint::anchor1 cannot be null";if(function(t){return null==k.zpp_inner_zn.wrap_a1&&k.zpp_inner_zn.setup_a1(),k.zpp_inner_zn.wrap_a1}().set(n),null==k.zpp_inner_zn.wrap_a1&&k.zpp_inner_zn.setup_a1(),k.zpp_inner_zn.wrap_a1,null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==n)throw"Error: Constraint::anchor2 cannot be null";(function(t){return null==k.zpp_inner_zn.wrap_a2&&k.zpp_inner_zn.setup_a2(),k.zpp_inner_zn.wrap_a2})().set(n),null==k.zpp_inner_zn.wrap_a2&&k.zpp_inner_zn.setup_a2(),k.zpp_inner_zn.wrap_a2;var M=function(n){0!=n.zpp_inner.stiff&&(n.zpp_inner.stiff=!1,n.zpp_inner.wake()),n.zpp_inner.stiff,20!=n.zpp_inner.frequency&&(n.zpp_inner.frequency=20,n.zpp_inner.stiff||n.zpp_inner.wake()),n.zpp_inner.frequency,1!=n.zpp_inner.damping&&(n.zpp_inner.damping=1,n.zpp_inner.stiff||n.zpp_inner.wake()),n.zpp_inner.damping,n.set_space(t.space)};this.withCell(1,0,"PivotJoint",function(n,e){var i=t.box(n(88.8888888888889),e(100),22);i.zpp_inner.wrap_shapes.at(0).set_sensorEnabled(!0),i.zpp_inner.wrap_shapes.at(0).set_filter(new p.dynamics.InteractionFilter(2,-3));var r=t.box(n(177.7777777777778),e(100),22);null==i.zpp_inner.wrap_pos&&i.zpp_inner.setupPosition(),i.zpp_inner.wrap_pos;var s=p.geom.Vec2.get(n(133.33333333333334),e(100),null);M(new p.constraint.PivotJoint(i,r,i.worldPointToLocal(s,!0),r.worldPointToLocal(s,!0))),s.dispose()}),this.withCell(2,0,"WeldJoint",function(n,e){var i=t.box(n(88.8888888888889),e(100),22),r=t.box(n(177.7777777777778),e(100),22),s=p.geom.Vec2.get(n(133.33333333333334),e(100),null);M(new p.constraint.WeldJoint(i,r,i.worldPointToLocal(s,!0),r.worldPointToLocal(s,!0),Math.PI/4)),s.dispose()}),this.withCell(0,1,"DistanceJoint",function(n,e){var i=t.box(n(111.11111111111113),e(100),22),r=t.box(n(155.55555555555557),e(100),22);M(new p.constraint.DistanceJoint(i,r,p.geom.Vec2.get(0,-22,!0),p.geom.Vec2.get(0,-22,!0),66.66666666666667,111.11111111111113))}),this.withCell(1,1,"LineJoint",function(n,e){var i=t.box(n(88.8888888888889),e(100),22),r=t.box(n(177.7777777777778),e(100),22),s=p.geom.Vec2.get(n(133.33333333333334),e(100),null);M(new p.constraint.LineJoint(i,r,i.worldPointToLocal(s,!0),r.worldPointToLocal(s,!0),p.geom.Vec2.get(0,1,!0),-22,22)),s.dispose()}),this.withCell(2,1,"PulleyJoint",function(n,e){var i=t.box(n(133.33333333333334),e(22),11,!0);i.scaleShapes(4,1);var r=t.box(n(88.8888888888889),e(100),11),s=t.box(n(177.7777777777778),e(100),22);M(new p.constraint.PulleyJoint(i,r,i,s,p.geom.Vec2.get(-44,0,!0),p.geom.Vec2.get(0,-11,!0),p.geom.Vec2.get(44,0,!0),p.geom.Vec2.get(0,-22,!0),150,150,2.5))}),this.withCell(0,2,"AngleJoint",function(n,e){var i=t.box(n(88.8888888888889),e(100),22,!0),r=t.box(n(177.7777777777778),e(100),22,!0);M(new p.constraint.AngleJoint(i,r,1.5*-Math.PI,1.5*Math.PI,2))}),this.withCell(1,2,"MotorJoint",function(n,e){var i=t.box(n(88.8888888888889),e(100),22,!0),r=t.box(n(177.7777777777778),e(100),22,!0);M(new p.constraint.MotorJoint(i,r,10,3))}),this.SpatialQueries(),this.OneWayPlatforms(),new l.Timer(200).run=function(){t.space.step(.016666666666666666,10,10)}},withCell:function(t,n,e,i){i(function(n){return n+266.6666666666667*t},function(t){return t+200*n})},box:function(t,n,e,i){null==i&&(i=!1);var r=new p.phys.Body;if(function(t){return null==r.zpp_inner.wrap_pos&&r.zpp_inner.setupPosition(),r.zpp_inner.wrap_pos}().setxy(t,n),r.zpp_inner.wrap_shapes.add(new p.shape.Polygon(p.shape.Polygon.box(2*e,2*e))),r.set_space(this.space),i){var s=new p.constraint.PivotJoint(this.space.zpp_inner.__static,r,function(t){return null==r.zpp_inner.wrap_pos&&r.zpp_inner.setupPosition(),r.zpp_inner.wrap_pos}(),p.geom.Vec2.get(0,0,!0));s.set_space(this.space),this.space.zpp_inner.wrap_constraints.remove(s)}return r},SpatialQueries:function(){var t,n,e,i,r,s,l,a;this.space.set_worldLinearDrag(4),this.space.set_worldAngularDrag(4),e=new p.phys.Body,function(t){return null==e.zpp_inner.wrap_pos&&e.zpp_inner.setupPosition(),e.zpp_inner.wrap_pos}().setxy(800/3,340),e.zpp_inner.wrap_shapes.add(new p.shape.Polygon(p.shape.Polygon.box(10,40))),e.zpp_inner.wrap_shapes.add(new p.shape.Polygon(p.shape.Polygon.rect(-10,-20,20,10))),e.set_space(this.space),r=new p.phys.Body,function(t){return null==r.zpp_inner.wrap_pos&&r.zpp_inner.setupPosition(),r.zpp_inner.wrap_pos}().setxy(1600/3,340),r.zpp_inner.wrap_shapes.add(new p.shape.Polygon(p.shape.Polygon.box(10,40))),r.zpp_inner.wrap_shapes.add(new p.shape.Polygon(p.shape.Polygon.rect(-10,-20,20,10))),r.set_space(this.space),i=new p.dynamics.InteractionFilter(2,-3),e.setShapeFilters(i),r.setShapeFilters(i),t=new p.phys.Body,n=new p.shape.Polygon(p.shape.Polygon.box(20,10)),n.zpp_inner.immutable_midstep("Shape::body"),(null!=n.zpp_inner.body?n.zpp_inner.body.outer:null)!=t&&(null!=n.zpp_inner.body&&(null!=n.zpp_inner.body?n.zpp_inner.body.outer:null).zpp_inner.wrap_shapes.remove(n),null!=t&&t.zpp_inner.wrap_shapes.add(n)),null!=n.zpp_inner.body&&n.zpp_inner.body.outer,s=new p.geom.Ray(p.geom.Vec2.get(0,0,!0),p.geom.Vec2.get(0,0,!0)),s.set_origin(new p.geom.Vec2),s.set_direction(p.geom.Vec2.get(0,0,null).sub(new p.geom.Vec2));var o=this.space.rayCast(s,!1),_=this.space.rayMultiCast(s,!1,null);_.foreach(function(t){}),_.filter(function(t){return!0});if(null!=o.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";o.zpp_inner.toiDistance;s.at(10);new p.phys.BodyList,new p.geom.AABB,l=new p.phys.Body,a=new p.shape.Polygon(p.shape.Polygon.regular(110,110,5)),a.zpp_inner.immutable_midstep("Shape::body"),(null!=a.zpp_inner.body?a.zpp_inner.body.outer:null)!=l&&(null!=a.zpp_inner.body&&(null!=a.zpp_inner.body?a.zpp_inner.body.outer:null).zpp_inner.wrap_shapes.remove(a),null!=l&&l.zpp_inner.wrap_shapes.add(a)),null!=a.zpp_inner.body&&a.zpp_inner.body.outer;for(var h=0;h<50;){var u=(h++,new p.phys.Body);Math.random()<.33?u.zpp_inner.wrap_shapes.add(new p.shape.Circle(20)):Math.random()<.5?u.zpp_inner.wrap_shapes.add(new p.shape.Polygon(p.shape.Polygon.box(40,40))):u.zpp_inner.wrap_shapes.add(new p.shape.Polygon(p.shape.Polygon.regular(20,20,5))),function(t){return null==u.zpp_inner.wrap_pos&&u.zpp_inner.setupPosition(),u.zpp_inner.wrap_pos}().setxy(800*Math.random(),400*Math.random()*.5),u.set_space(this.space)}},OneWayPlatforms:function(){var t,e,i=900,r=800;t=new p.callbacks.CbType,this.space.zpp_inner.wrap_listeners.add(new p.callbacks.PreListener(function(t){return null==o.util.ZPP_Flags.InteractionType_COLLISION&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_COLLISION=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_COLLISION}(),t,o.callbacks.ZPP_CbType.ANY_BODY,n(this,this.oneWayHandler),0,!0)),this.conveyor(160,200),this.conveyor(320,100),this.conveyor(480,-100),this.conveyor(640,200),e=new p.callbacks.CbType,this.space.zpp_inner.wrap_listeners.add(new p.callbacks.InteractionListener(function(t){return null==o.util.ZPP_Flags.CbEvent_BEGIN&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_BEGIN=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_BEGIN}(),function(t){return null==o.util.ZPP_Flags.InteractionType_SENSOR&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_SENSOR=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_SENSOR}(),o.callbacks.ZPP_CbType.ANY_BODY,e,n(this,this.teleporterHandler))),this.space.zpp_inner.wrap_listeners.add(new p.callbacks.InteractionListener(function(t){return null==o.util.ZPP_Flags.CbEvent_ONGOING&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_ONGOING=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_ONGOING}(),function(t){return null==o.util.ZPP_Flags.InteractionType_FLUID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_FLUID=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_FLUID}(),o.callbacks.ZPP_CbType.ANY_COMPOUND,e,n(this,this.teleporterHandler)));var s=new p.phys.Body(function(t){return null==o.util.ZPP_Flags.BodyType_STATIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_STATIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_STATIC}());s.zpp_inner.wrap_shapes.add(new p.shape.Polygon(p.shape.Polygon.rect(-20,0,940,-1))),s.zpp_inner.wrap_shapes.add(new p.shape.Polygon(p.shape.Polygon.rect(-20,680,940,-1)));var l=new p.shape.Polygon(p.shape.Polygon.rect(-20,0,-1,680));l.zpp_inner.immutable_midstep("Shape::sensorEnabled"),l.zpp_inner.sensorEnabled=!0,l.zpp_inner.wake(),l.zpp_inner.sensorEnabled,function(t){return null==l.zpp_inner_i.wrap_cbTypes&&l.zpp_inner_i.setupcbTypes(),l.zpp_inner_i.wrap_cbTypes}().add(e),l.zpp_inner.immutable_midstep("Shape::body"),(null!=l.zpp_inner.body?l.zpp_inner.body.outer:null)!=s&&(null!=l.zpp_inner.body&&(null!=l.zpp_inner.body?l.zpp_inner.body.outer:null).zpp_inner.wrap_shapes.remove(l),null!=s&&s.zpp_inner.wrap_shapes.add(l)),null!=l.zpp_inner.body&&l.zpp_inner.body.outer;var a=new p.shape.Polygon(p.shape.Polygon.rect(920,0,1,680));a.zpp_inner.immutable_midstep("Shape::sensorEnabled"),a.zpp_inner.sensorEnabled=!0,a.zpp_inner.wake(),a.zpp_inner.sensorEnabled,function(t){return null==a.zpp_inner_i.wrap_cbTypes&&a.zpp_inner_i.setupcbTypes(),a.zpp_inner_i.wrap_cbTypes}().add(e),a.zpp_inner.immutable_midstep("Shape::body"),(null!=a.zpp_inner.body?a.zpp_inner.body.outer:null)!=s&&(null!=a.zpp_inner.body&&(null!=a.zpp_inner.body?a.zpp_inner.body.outer:null).zpp_inner.wrap_shapes.remove(a),null!=s&&s.zpp_inner.wrap_shapes.add(a)),null!=a.zpp_inner.body&&a.zpp_inner.body.outer,s.set_space(this.space);this.kinematic(-20,235,60,480),this.kinematic(215,235,120,360),this.kinematic(450,235,240,120),this.kinematic(685,235,180,240);for(var _=0;_<100;){var h=(_++,new p.phys.Body);Math.random()<.33?h.zpp_inner.wrap_shapes.add(new p.shape.Circle(20)):Math.random()<.5?h.zpp_inner.wrap_shapes.add(new p.shape.Polygon(p.shape.Polygon.box(40,40))):h.zpp_inner.wrap_shapes.add(new p.shape.Polygon(p.shape.Polygon.regular(20,20,5))),function(t){return null==h.zpp_inner.wrap_pos&&h.zpp_inner.setupPosition(),h.zpp_inner.wrap_pos}().setxy(Math.random()*i,Math.random()*r),h.set_space(this.space)}},postUpdate:function(t){},kinematic:function(t,n,e,i){var r=new p.phys.Body(function(t){return null==o.util.ZPP_Flags.BodyType_KINEMATIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_KINEMATIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_KINEMATIC}());(function(t){return null==r.zpp_inner.wrap_pos&&r.zpp_inner.setupPosition(),r.zpp_inner.wrap_pos})().setxy(t,680),r.zpp_inner.wrap_shapes.add(new p.shape.Polygon(p.shape.Polygon.rect(0,0,n,1))),function(t){return null==r.zpp_inner.wrap_vel&&r.zpp_inner.setupVelocity(),r.zpp_inner.wrap_vel}().set_y(-e),r.set_space(this.space),(function(t){return null==r.zpp_inner_i.userData&&(r.zpp_inner_i.userData={}),r.zpp_inner_i.userData}()).targetHeight=i},conveyor:function(t,n){var e=new p.phys.Body(function(t){return null==o.util.ZPP_Flags.BodyType_STATIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_STATIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_STATIC}());e.zpp_inner.wrap_shapes.add(new p.shape.Polygon(p.shape.Polygon.rect(-20,t,840,10))),function(t){return null==e.zpp_inner.wrap_svel&&e.zpp_inner.setupsvel(),e.zpp_inner.wrap_svel}().set_x(n),function(t){return null==e.zpp_inner_i.wrap_cbTypes&&e.zpp_inner_i.setupcbTypes(),e.zpp_inner_i.wrap_cbTypes}().add(new p.callbacks.CbType),e.setShapeMaterials(p.phys.Material.rubber()),e.set_space(this.space)},teleporterHandler:function(t){var n=t.zpp_inner.int1.outer_i.get_castBody();if(o.phys.ZPP_Body.types[n.zpp_inner.type]!=function(t){return null==o.util.ZPP_Flags.BodyType_KINEMATIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_KINEMATIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_KINEMATIC}()){if(function(t){return null==n.zpp_inner.wrap_pos&&n.zpp_inner.setupPosition(),n.zpp_inner.wrap_pos}().set_x(800*Math.random()),function(t){return null==n.zpp_inner.wrap_pos&&n.zpp_inner.setupPosition(),n.zpp_inner.wrap_pos}().set_y(660),function(t){return null==n.zpp_inner.wrap_vel&&n.zpp_inner.setupVelocity(),n.zpp_inner.wrap_vel}().setxy(0,0),n.zpp_inner.world)throw"Error: Space::world is immutable";if(0!=n.zpp_inner.angvel){if(n.zpp_inner.type==o.util.ZPP_Flags.id_BodyType_STATIC)throw"Error: A static object cannot be given a velocity";n.zpp_inner.angvel=0,n.zpp_inner.wake()}n.zpp_inner.angvel}},oneWayHandler:function(t){var n=t.zpp_inner.pre_arbiter.wrapper().get_collisionArbiter();return function(t){if(!n.zpp_inner.active)throw"Error: Arbiter not currently in use";return null==n.zpp_inner.colarb.wrap_normal&&n.zpp_inner.colarb.getnormal(),n.zpp_inner.colarb.wrap_normal}().get_y()>0!=t.zpp_inner.pre_swapped?(null==o.util.ZPP_Flags.PreFlag_IGNORE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_IGNORE=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_IGNORE):(null==o.util.ZPP_Flags.PreFlag_ACCEPT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_ACCEPT=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_ACCEPT)},__class__:e},Math.__name__=!0;var i=function(){};i.__name__=!0,i.field=function(t,n){try{return t[n]}catch(t){return null}},i.setField=function(t,n,e){t[n]=e},i.fields=function(t){var n=[];if(null!=t){var e=Object.prototype.hasOwnProperty;for(var i in t)"__id__"!=i&&"hx__closures__"!=i&&e.call(t,i)&&n.push(i)}return n},i.copy=function(t){for(var n={},e=0,r=i.fields(t);e<r.length;){var s=r[e];++e,i.setField(n,s,i.field(t,s))}return n};var r=function(){};r.__name__=!0,r.string=function(t){return a.Boot.__string_rec(t,"")};var s=function(){};s.__name__=!0,s.hex=function(t,n){var e="";do{
e="0123456789ABCDEF".charAt(15&t)+e,t>>>=4}while(t>0);if(null!=n)for(;e.length<n;)e="0"+e;return e};var l={};l.Timer=function(t){var n=this;this.id=setInterval(function(){n.run()},t)},l.Timer.__name__=!0,l.Timer.prototype={run:function(){},__class__:l.Timer};var a={};a.Boot=function(){},a.Boot.__name__=!0,a.Boot.getClass=function(t){return t instanceof Array&&null==t.__enum__?Array:t.__class__},a.Boot.__string_rec=function(t,n){if(null==t)return"null";if(n.length>=5)return"<...>";var e=typeof t;switch("function"==e&&(t.__name__||t.__ename__)&&(e="object"),e){case"object":if(t instanceof Array){if(t.__enum__){if(2==t.length)return t[0];var i=t[0]+"(";n+="\t";for(var r=2,s=t.length;r<s;){var l=r++;i+=2!=l?","+a.Boot.__string_rec(t[l],n):a.Boot.__string_rec(t[l],n)}return i+")"}var p=t.length,o="[";n+="\t";for(var _=0;_<p;){var h=_++;o+=(h>0?",":"")+a.Boot.__string_rec(t[h],n)}return o+="]"}var u;try{u=t.toString}catch(t){return"???"}if(null!=u&&u!=Object.toString){var d=t.toString();if("[object Object]"!=d)return d}var c=null,P="{\n";n+="\t";var f=null!=t.hasOwnProperty;for(var c in t)f&&!t.hasOwnProperty(c)||"prototype"!=c&&"__class__"!=c&&"__super__"!=c&&"__interfaces__"!=c&&"__properties__"!=c&&(2!=P.length&&(P+=", \n"),P+=n+c+" : "+a.Boot.__string_rec(t[c],n));return n=n.substring(1),P+="\n"+n+"}";case"function":return"<function>";case"string":return t;default:return String(t)}},a.Boot.__interfLoop=function(t,n){if(null==t)return!1;if(t==n)return!0;var e=t.__interfaces__;if(null!=e)for(var i=0,r=e.length;i<r;){var s=i++,l=e[s];if(l==n||a.Boot.__interfLoop(l,n))return!0}return a.Boot.__interfLoop(t.__super__,n)},a.Boot.__instanceof=function(t,n){if(null==n)return!1;switch(n){case u:return(0|t)===t;case c:return"number"==typeof t;case P:return"boolean"==typeof t;case String:return"string"==typeof t;case Array:return t instanceof Array&&null==t.__enum__;case d:return!0;default:if(null==t)return!1;if("function"==typeof n){if(t instanceof n)return!0;if(a.Boot.__interfLoop(a.Boot.getClass(t),n))return!0}return n==f&&null!=t.__name__||(n==z&&null!=t.__ename__||t.__enum__==n)}};var p={};p.Config=function(){},p.Config.__name__=!0,p.Config.prototype={__class__:p.Config},p.callbacks={},p.callbacks.Callback=function(){if(this.zpp_inner=null,!o.callbacks.ZPP_Callback.internal)throw"Error: Callback cannot be instantiated derp!"},p.callbacks.Callback.__name__=!0,p.callbacks.Callback.prototype={get_event:function(){return o.callbacks.ZPP_Listener.events[this.zpp_inner.event]},get_listener:function(){return this.zpp_inner.listener.outer},toString:function(){return""},__class__:p.callbacks.Callback},p.callbacks.BodyCallback=function(){p.callbacks.Callback.call(this)},p.callbacks.BodyCallback.__name__=!0,p.callbacks.BodyCallback.__super__=p.callbacks.Callback,p.callbacks.BodyCallback.prototype=t(p.callbacks.Callback.prototype,{get_body:function(){return this.zpp_inner.body.outer},toString:function(){var t="Cb:";return t+=["WAKE","SLEEP"][this.zpp_inner.event-o.util.ZPP_Flags.id_CbEvent_WAKE],t+=":"+this.zpp_inner.body.outer.toString(),t+=" : listener: "+r.string(this.zpp_inner.listener.outer)},__class__:p.callbacks.BodyCallback}),p.callbacks.Listener=function(){if(this.zpp_inner=null,!o.callbacks.ZPP_Listener.internal)throw"Error: Cannot instantiate Listener derp!"},p.callbacks.Listener.__name__=!0,p.callbacks.Listener.prototype={get_type:function(){return o.callbacks.ZPP_Listener.types[this.zpp_inner.type]},get_event:function(){return o.callbacks.ZPP_Listener.events[this.zpp_inner.event]},set_event:function(t){if(null==t)throw"Error: Cannot set listener event type to null";if(o.callbacks.ZPP_Listener.events[this.zpp_inner.event]!=t){var n;n=t==function(t){return null==o.util.ZPP_Flags.CbEvent_BEGIN&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_BEGIN=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_BEGIN}()?o.util.ZPP_Flags.id_CbEvent_BEGIN:t==function(t){return null==o.util.ZPP_Flags.CbEvent_ONGOING&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_ONGOING=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_ONGOING}()?o.util.ZPP_Flags.id_CbEvent_ONGOING:t==function(t){return null==o.util.ZPP_Flags.CbEvent_END&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_END=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_END}()?o.util.ZPP_Flags.id_CbEvent_END:t==function(t){return null==o.util.ZPP_Flags.CbEvent_SLEEP&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_SLEEP=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_SLEEP}()?o.util.ZPP_Flags.id_CbEvent_SLEEP:t==function(t){return null==o.util.ZPP_Flags.CbEvent_WAKE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_WAKE=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_WAKE}()?o.util.ZPP_Flags.id_CbEvent_WAKE:t==function(t){return null==o.util.ZPP_Flags.CbEvent_PRE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_PRE=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_PRE}()?o.util.ZPP_Flags.id_CbEvent_PRE:o.util.ZPP_Flags.id_CbEvent_BREAK,this.zpp_inner.swapEvent(n)}return o.callbacks.ZPP_Listener.events[this.zpp_inner.event]},get_precedence:function(){return this.zpp_inner.precedence},set_precedence:function(t){return this.zpp_inner.precedence!=t&&(this.zpp_inner.precedence=t,this.zpp_inner.invalidate_precedence()),this.zpp_inner.precedence},get_space:function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},set_space:function(t){return(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=t&&(null!=this.zpp_inner.space&&this.zpp_inner.space.outer.zpp_inner.wrap_listeners.remove(this),null!=t?t.zpp_inner.wrap_listeners.add(this):this.zpp_inner.space=null),null==this.zpp_inner.space?null:this.zpp_inner.space.outer},toString:function(){var t=["BEGIN","END","WAKE","SLEEP","BREAK","PRE","ONGOING"][this.zpp_inner.event];if(this.zpp_inner.type==o.util.ZPP_Flags.id_ListenerType_BODY){var n=this.zpp_inner.body;return"BodyListener{"+t+"::"+r.string(n.outer_zn.zpp_inner_zn.options.outer)+"}"}if(this.zpp_inner.type==o.util.ZPP_Flags.id_ListenerType_CONSTRAINT){var e=this.zpp_inner.constraint;return"ConstraintListener{"+t+"::"+r.string(e.outer_zn.zpp_inner_zn.options.outer)+"}"}var i,s=this.zpp_inner.interaction;switch(s.itype){case o.util.ZPP_Flags.id_InteractionType_COLLISION:i="COLLISION";break;case o.util.ZPP_Flags.id_InteractionType_SENSOR:i="SENSOR";break;case o.util.ZPP_Flags.id_InteractionType_FLUID:i="FLUID";break;default:i="ALL"}return(this.zpp_inner.type==o.util.ZPP_Flags.id_ListenerType_INTERACTION?"InteractionListener{"+t+"#"+i+"::"+r.string(s.outer_zni.zpp_inner_zn.options1.outer)+":"+r.string(s.outer_zni.zpp_inner_zn.options2.outer)+"}":"PreListener{"+i+"::"+r.string(s.outer_znp.zpp_inner_zn.options1.outer)+":"+r.string(s.outer_znp.zpp_inner_zn.options2.outer)+"}")+" precedence="+this.zpp_inner.precedence},__class__:p.callbacks.Listener},p.callbacks.BodyListener=function(t,n,e,i){if(null==i&&(i=0),this.zpp_inner_zn=null,o.callbacks.ZPP_Listener.internal=!0,p.callbacks.Listener.call(this),o.callbacks.ZPP_Listener.internal=!1,null==e)throw"Error: BodyListener::handler cannot be null";var r=-1;if(t==function(t){return null==o.util.ZPP_Flags.CbEvent_WAKE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_WAKE=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_WAKE}())r=o.util.ZPP_Flags.id_CbEvent_WAKE;else{if(t!=function(t){return null==o.util.ZPP_Flags.CbEvent_SLEEP&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_SLEEP=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_SLEEP}())throw"Error: cbEvent '"+t.toString()+"' is not a valid event type for a BodyListener";r=o.util.ZPP_Flags.id_CbEvent_SLEEP}this.zpp_inner_zn=new o.callbacks.ZPP_BodyListener(o.callbacks.ZPP_OptionType.argument(n),r,e),this.zpp_inner=this.zpp_inner_zn,this.zpp_inner.outer=this,this.zpp_inner_zn.outer_zn=this,this.zpp_inner.precedence=i},p.callbacks.BodyListener.__name__=!0,p.callbacks.BodyListener.__super__=p.callbacks.Listener,p.callbacks.BodyListener.prototype=t(p.callbacks.Listener.prototype,{get_options:function(){return this.zpp_inner_zn.options.outer},set_options:function(t){return this.zpp_inner_zn.options.set(t.zpp_inner),this.zpp_inner_zn.options.outer},get_handler:function(){return this.zpp_inner_zn.handler},set_handler:function(t){if(null==t)throw"Error: BodyListener::handler cannot be null";return this.zpp_inner_zn.handler=t,this.zpp_inner_zn.handler},__class__:p.callbacks.BodyListener}),p.callbacks.CbEvent=function(){if(!o.util.ZPP_Flags.internal)throw"Error: Cannot instantiate CbEvent derp!"},p.callbacks.CbEvent.__name__=!0,p.callbacks.CbEvent.get_BEGIN=function(){return null==o.util.ZPP_Flags.CbEvent_BEGIN&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_BEGIN=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_BEGIN},p.callbacks.CbEvent.get_ONGOING=function(){return null==o.util.ZPP_Flags.CbEvent_ONGOING&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_ONGOING=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_ONGOING},p.callbacks.CbEvent.get_END=function(){return null==o.util.ZPP_Flags.CbEvent_END&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_END=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_END},p.callbacks.CbEvent.get_WAKE=function(){return null==o.util.ZPP_Flags.CbEvent_WAKE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_WAKE=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_WAKE},p.callbacks.CbEvent.get_SLEEP=function(){return null==o.util.ZPP_Flags.CbEvent_SLEEP&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_SLEEP=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_SLEEP},p.callbacks.CbEvent.get_BREAK=function(){return null==o.util.ZPP_Flags.CbEvent_BREAK&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_BREAK=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_BREAK},p.callbacks.CbEvent.get_PRE=function(){return null==o.util.ZPP_Flags.CbEvent_PRE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_PRE=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_PRE},p.callbacks.CbEvent.prototype={toString:function(){return this==function(t){return null==o.util.ZPP_Flags.CbEvent_PRE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_PRE=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_PRE}()?"PRE":this==function(t){return null==o.util.ZPP_Flags.CbEvent_BEGIN&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_BEGIN=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_BEGIN}()?"BEGIN":this==function(t){return null==o.util.ZPP_Flags.CbEvent_ONGOING&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_ONGOING=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_ONGOING}()?"ONGOING":this==function(t){return null==o.util.ZPP_Flags.CbEvent_END&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_END=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_END}()?"END":this==function(t){return null==o.util.ZPP_Flags.CbEvent_WAKE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_WAKE=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_WAKE}()?"WAKE":this==function(t){return null==o.util.ZPP_Flags.CbEvent_SLEEP&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_SLEEP=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_SLEEP}()?"SLEEP":this==function(t){return null==o.util.ZPP_Flags.CbEvent_BREAK&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_BREAK=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_BREAK}()?"BREAK":""},__class__:p.callbacks.CbEvent},p.callbacks.CbType=function(){this.zpp_inner=null,this.zpp_inner=new o.callbacks.ZPP_CbType,this.zpp_inner.outer=this},p.callbacks.CbType.__name__=!0,p.callbacks.CbType.get_ANY_BODY=function(){return o.callbacks.ZPP_CbType.ANY_BODY},p.callbacks.CbType.get_ANY_CONSTRAINT=function(){return o.callbacks.ZPP_CbType.ANY_CONSTRAINT},p.callbacks.CbType.get_ANY_SHAPE=function(){return o.callbacks.ZPP_CbType.ANY_SHAPE},p.callbacks.CbType.get_ANY_COMPOUND=function(){return o.callbacks.ZPP_CbType.ANY_COMPOUND},p.callbacks.CbType.prototype={get_id:function(){return this.zpp_inner.id},including:function(t){return new p.callbacks.OptionType(this).including(t)},excluding:function(t){return new p.callbacks.OptionType(this).excluding(t)},get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_interactors:function(){return null==this.zpp_inner.wrap_interactors&&(this.zpp_inner.wrap_interactors=o.util.ZPP_InteractorList.get(this.zpp_inner.interactors,!0)),this.zpp_inner.wrap_interactors},get_constraints:function(){return null==this.zpp_inner.wrap_constraints&&(this.zpp_inner.wrap_constraints=o.util.ZPP_ConstraintList.get(this.zpp_inner.constraints,!0)),this.zpp_inner.wrap_constraints},toString:function(){return this==o.callbacks.ZPP_CbType.ANY_BODY?"ANY_BODY":this==o.callbacks.ZPP_CbType.ANY_SHAPE?"ANY_SHAPE":this==o.callbacks.ZPP_CbType.ANY_COMPOUND?"ANY_COMPOUND":this==o.callbacks.ZPP_CbType.ANY_CONSTRAINT?"ANY_CONSTRAINT":"CbType#"+this.zpp_inner.id},__class__:p.callbacks.CbType},p.callbacks.CbTypeIterator=function(){if(this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null,!o.util.ZPP_CbTypeList.internal)throw"Error: Cannot instantiate CbTypeIterator derp!"},p.callbacks.CbTypeIterator.__name__=!0,p.callbacks.CbTypeIterator.get=function(t){var n;if(null==p.callbacks.CbTypeIterator.zpp_pool){o.util.ZPP_CbTypeList.internal=!0;var e=new p.callbacks.CbTypeIterator;o.util.ZPP_CbTypeList.internal=!1,n=e}else{var i=p.callbacks.CbTypeIterator.zpp_pool;p.callbacks.CbTypeIterator.zpp_pool=i.zpp_next,n=i}return n.zpp_i=0,n.zpp_inner=t,n.zpp_critical=!1,n},p.callbacks.CbTypeIterator.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=p.callbacks.CbTypeIterator.zpp_pool,p.callbacks.CbTypeIterator.zpp_pool=this,this.zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:p.callbacks.CbTypeIterator},p.callbacks.CbTypeList=function(){this.zpp_inner=null,this.zpp_inner=new o.util.ZPP_CbTypeList,this.zpp_inner.outer=this},p.callbacks.CbTypeList.__name__=!0,p.callbacks.CbTypeList.fromArray=function(t){if(null==t)throw"Error: Cannot convert null Array to Nape list";for(var n=new p.callbacks.CbTypeList,e=0;e<t.length;){var i=t[e];++e,n.push(i)}return n},p.callbacks.CbTypeList.prototype={get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},at:function(t){if(this.zpp_inner.valmod(),t<0||t>=this.get_length())throw"Error: Index out of bounds 1";if(this.zpp_inner.reverse_flag&&(t=this.get_length()-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(t){if(this.zpp_inner.immutable)throw"Error: CbTypeList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},unshift:function(t){if(this.zpp_inner.immutable)throw"Error: CbTypeList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},pop:function(){if(this.zpp_inner.immutable)throw"Error: CbTypeList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){t=this.zpp_inner.inner.head.elt;var n=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var e;e=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==e?this.zpp_inner.inner.head.elt:e.next.elt;var i=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)}return this.zpp_inner.invalidate(),t.outer},shift:function(){if(this.zpp_inner.immutable)throw"Error: CbTypeList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n;n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==n?this.zpp_inner.inner.head.elt:n.next.elt;var e=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}else{t=this.zpp_inner.inner.head.elt;var i=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),t.outer},add:function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},remove:function(t){if(this.zpp_inner.immutable)throw"Error: CbTypeList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;n=!1;for(var e=this.zpp_inner.inner.head;null!=e;){if(e.elt==t.zpp_inner){n=!0;break}e=e.next}return n&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),n},clear:function(){if(this.zpp_inner.immutable)throw"Error: CbTypeList is immutable";if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){return this.zpp_inner.valmod(),p.callbacks.CbTypeIterator.get(this)},copy:function(t){null==t&&(t=!1);var n,e=new p.callbacks.CbTypeList;for(this.zpp_inner.valmod(),n=p.callbacks.CbTypeIterator.get(this);n.hasNext();){var i;n.zpp_critical=!1,i=n.zpp_inner.at(n.zpp_i++),e.push(t?function(t){throw"Error: CbType is not a copyable type"}():i)}return e},merge:function(t){if(null==t)throw"Error: Cannot merge with null list";var n;for(t.zpp_inner.valmod(),n=p.callbacks.CbTypeIterator.get(t);n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),this.has(e)||(this.zpp_inner.reverse_flag?this.push(e):this.unshift(e))}},toString:function(){var t,n="[",e=!0;for(this.zpp_inner.valmod(),t=p.callbacks.CbTypeIterator.get(this);t.hasNext();){var i;t.zpp_critical=!1,i=t.zpp_inner.at(t.zpp_i++),e||(n+=","),n+=null==i?"NULL":i.toString(),e=!1}return n+"]"},foreach:function(t){if(null==t)throw"Error: Cannot execute null on list elements";var n;for(this.zpp_inner.valmod(),n=p.callbacks.CbTypeIterator.get(this);n.hasNext();)try{t(function(t){return n.zpp_critical=!1,n.zpp_inner.at(n.zpp_i++)}())}catch(t){n.zpp_next=p.callbacks.CbTypeIterator.zpp_pool,p.callbacks.CbTypeIterator.zpp_pool=n,n.zpp_inner=null;break}return this},filter:function(t){if(null==t)throw"Error: Cannot select elements of list with null";for(var n=0;n<this.get_length();){var e=this.at(n);try{t(e)?n++:this.remove(e)}catch(t){break}}return this},__class__:p.callbacks.CbTypeList},p.callbacks.ConstraintCallback=function(){p.callbacks.Callback.call(this)},p.callbacks.ConstraintCallback.__name__=!0,p.callbacks.ConstraintCallback.__super__=p.callbacks.Callback,p.callbacks.ConstraintCallback.prototype=t(p.callbacks.Callback.prototype,{get_constraint:function(){return this.zpp_inner.constraint.outer},toString:function(){var t="Cb:";return t+=["WAKE","SLEEP","BREAK"][this.zpp_inner.event-o.util.ZPP_Flags.id_CbEvent_WAKE],t+=":"+this.zpp_inner.constraint.outer.toString(),t+=" : listener: "+r.string(this.zpp_inner.listener.outer)},__class__:p.callbacks.ConstraintCallback}),p.callbacks.ConstraintListener=function(t,n,e,i){if(null==i&&(i=0),this.zpp_inner_zn=null,o.callbacks.ZPP_Listener.internal=!0,p.callbacks.Listener.call(this),o.callbacks.ZPP_Listener.internal=!1,null==e)throw"Error: ConstraintListener::handler cannot be null";var r=-1;if(t==function(t){return null==o.util.ZPP_Flags.CbEvent_WAKE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_WAKE=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_WAKE}())r=o.util.ZPP_Flags.id_CbEvent_WAKE;else if(t==function(t){return null==o.util.ZPP_Flags.CbEvent_SLEEP&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_SLEEP=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_SLEEP}())r=o.util.ZPP_Flags.id_CbEvent_SLEEP;else{if(t!=function(t){return null==o.util.ZPP_Flags.CbEvent_BREAK&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_BREAK=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_BREAK}())throw"Error: cbEvent '"+t.toString()+"' is not a valid event type for a ConstraintListener";r=o.util.ZPP_Flags.id_CbEvent_BREAK}this.zpp_inner_zn=new o.callbacks.ZPP_ConstraintListener(o.callbacks.ZPP_OptionType.argument(n),r,e),this.zpp_inner=this.zpp_inner_zn,this.zpp_inner.outer=this,this.zpp_inner_zn.outer_zn=this,this.zpp_inner.precedence=i},p.callbacks.ConstraintListener.__name__=!0,p.callbacks.ConstraintListener.__super__=p.callbacks.Listener,p.callbacks.ConstraintListener.prototype=t(p.callbacks.Listener.prototype,{get_options:function(){return this.zpp_inner_zn.options.outer},set_options:function(t){return this.zpp_inner_zn.options.set(t.zpp_inner),this.zpp_inner_zn.options.outer},get_handler:function(){return this.zpp_inner_zn.handler},set_handler:function(t){if(null==t)throw"Error: ConstraintListener::handler cannot be null";return this.zpp_inner_zn.handler=t,this.zpp_inner_zn.handler},__class__:p.callbacks.ConstraintListener}),p.callbacks.InteractionCallback=function(){p.callbacks.Callback.call(this)},p.callbacks.InteractionCallback.__name__=!0,p.callbacks.InteractionCallback.__super__=p.callbacks.Callback,p.callbacks.InteractionCallback.prototype=t(p.callbacks.Callback.prototype,{get_int1:function(){return this.zpp_inner.int1.outer_i},get_int2:function(){return this.zpp_inner.int2.outer_i},get_arbiters:function(){return this.zpp_inner.wrap_arbiters},toString:function(){var t="Cb:";return t+=["BEGIN","END","","","","","ONGOING"][this.zpp_inner.event],t+=":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString(),t+=" : "+this.zpp_inner.wrap_arbiters.toString(),t+=" : listener: "+r.string(this.zpp_inner.listener.outer)},__class__:p.callbacks.InteractionCallback}),p.callbacks.InteractionListener=function(t,n,e,i,r,s){if(null==s&&(s=0),this.zpp_inner_zn=null,o.callbacks.ZPP_Listener.internal=!0,p.callbacks.Listener.call(this),o.callbacks.ZPP_Listener.internal=!1,null==r)throw"Error: InteractionListener::handler cannot be null";if(null==t)throw"Error: CbEvent cannot be null for InteractionListener";var l=-1;if(t==function(t){return null==o.util.ZPP_Flags.CbEvent_BEGIN&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_BEGIN=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_BEGIN}())l=o.util.ZPP_Flags.id_CbEvent_BEGIN;else if(t==function(t){return null==o.util.ZPP_Flags.CbEvent_END&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_END=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_END}())l=o.util.ZPP_Flags.id_CbEvent_END;else{if(t!=function(t){return null==o.util.ZPP_Flags.CbEvent_ONGOING&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_ONGOING=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_ONGOING}())throw"Error: CbEvent '"+t.toString()+"' is not a valid event type for InteractionListener";l=o.util.ZPP_Flags.id_CbEvent_ONGOING}this.zpp_inner_zn=new o.callbacks.ZPP_InteractionListener(o.callbacks.ZPP_OptionType.argument(e),o.callbacks.ZPP_OptionType.argument(i),l,o.util.ZPP_Flags.id_ListenerType_INTERACTION),this.zpp_inner=this.zpp_inner_zn,this.zpp_inner.outer=this,this.zpp_inner_zn.outer_zni=this,this.zpp_inner.precedence=s,this.zpp_inner_zn.handleri=r,this.set_interactionType(n)},p.callbacks.InteractionListener.__name__=!0,p.callbacks.InteractionListener.__super__=p.callbacks.Listener,p.callbacks.InteractionListener.prototype=t(p.callbacks.Listener.prototype,{get_options1:function(){return this.zpp_inner_zn.options1.outer},set_options1:function(t){return this.zpp_inner_zn.options1.set(t.zpp_inner),this.zpp_inner_zn.options1.outer},get_options2:function(){return this.zpp_inner_zn.options2.outer},set_options2:function(t){return this.zpp_inner_zn.options2.set(t.zpp_inner),this.zpp_inner_zn.options2.outer},get_interactionType:function(){var t=this.zpp_inner_zn.itype;return t==o.util.ZPP_Flags.id_InteractionType_COLLISION?(null==o.util.ZPP_Flags.InteractionType_COLLISION&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_COLLISION=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_COLLISION):t==o.util.ZPP_Flags.id_InteractionType_SENSOR?(null==o.util.ZPP_Flags.InteractionType_SENSOR&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_SENSOR=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_SENSOR):t==o.util.ZPP_Flags.id_InteractionType_FLUID?(null==o.util.ZPP_Flags.InteractionType_FLUID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_FLUID=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_FLUID):t==o.util.ZPP_Flags.id_InteractionType_ANY?(null==o.util.ZPP_Flags.InteractionType_ANY&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_ANY=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_ANY):null},set_interactionType:function(t){if(null==t)throw"Error: Cannot set listener interaction type to null";if(this.get_interactionType()!=t){var n;n=t==function(t){return null==o.util.ZPP_Flags.InteractionType_COLLISION&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_COLLISION=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_COLLISION}()?o.util.ZPP_Flags.id_InteractionType_COLLISION:t==function(t){return null==o.util.ZPP_Flags.InteractionType_SENSOR&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_SENSOR=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_SENSOR}()?o.util.ZPP_Flags.id_InteractionType_SENSOR:t==function(t){return null==o.util.ZPP_Flags.InteractionType_FLUID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_FLUID=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_FLUID}()?o.util.ZPP_Flags.id_InteractionType_FLUID:o.util.ZPP_Flags.id_InteractionType_ANY,this.zpp_inner_zn.itype=n}return this.get_interactionType()},get_handler:function(){return this.zpp_inner_zn.handleri},set_handler:function(t){if(null==t)throw"Error: InteractionListener::handler cannot be null";return this.zpp_inner_zn.handleri=t,this.zpp_inner_zn.handleri},get_allowSleepingCallbacks:function(){return this.zpp_inner_zn.allowSleepingCallbacks},set_allowSleepingCallbacks:function(t){return this.zpp_inner_zn.allowSleepingCallbacks=t,this.zpp_inner_zn.allowSleepingCallbacks},__class__:p.callbacks.InteractionListener}),p.callbacks.InteractionType=function(){if(!o.util.ZPP_Flags.internal)throw"Error: Cannot instantiate InteractionType derp!"},p.callbacks.InteractionType.__name__=!0,p.callbacks.InteractionType.get_COLLISION=function(){return null==o.util.ZPP_Flags.InteractionType_COLLISION&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_COLLISION=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_COLLISION},p.callbacks.InteractionType.get_SENSOR=function(){return null==o.util.ZPP_Flags.InteractionType_SENSOR&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_SENSOR=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_SENSOR},p.callbacks.InteractionType.get_FLUID=function(){return null==o.util.ZPP_Flags.InteractionType_FLUID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_FLUID=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_FLUID},p.callbacks.InteractionType.get_ANY=function(){return null==o.util.ZPP_Flags.InteractionType_ANY&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_ANY=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_ANY},p.callbacks.InteractionType.prototype={toString:function(){return this==function(t){return null==o.util.ZPP_Flags.InteractionType_COLLISION&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_COLLISION=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_COLLISION}()?"COLLISION":this==function(t){return null==o.util.ZPP_Flags.InteractionType_SENSOR&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_SENSOR=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_SENSOR}()?"SENSOR":this==function(t){return null==o.util.ZPP_Flags.InteractionType_FLUID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_FLUID=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_FLUID}()?"FLUID":this==function(t){return null==o.util.ZPP_Flags.InteractionType_ANY&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_ANY=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_ANY}()?"ANY":""},__class__:p.callbacks.InteractionType},p.callbacks.ListenerIterator=function(){if(this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null,!o.util.ZPP_ListenerList.internal)throw"Error: Cannot instantiate ListenerIterator derp!"},p.callbacks.ListenerIterator.__name__=!0,p.callbacks.ListenerIterator.get=function(t){var n;if(null==p.callbacks.ListenerIterator.zpp_pool){o.util.ZPP_ListenerList.internal=!0;var e=new p.callbacks.ListenerIterator;o.util.ZPP_ListenerList.internal=!1,n=e}else{var i=p.callbacks.ListenerIterator.zpp_pool;p.callbacks.ListenerIterator.zpp_pool=i.zpp_next,n=i}return n.zpp_i=0,n.zpp_inner=t,n.zpp_critical=!1,n},
p.callbacks.ListenerIterator.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=p.callbacks.ListenerIterator.zpp_pool,p.callbacks.ListenerIterator.zpp_pool=this,this.zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:p.callbacks.ListenerIterator},p.callbacks.ListenerList=function(){this.zpp_inner=null,this.zpp_inner=new o.util.ZPP_ListenerList,this.zpp_inner.outer=this},p.callbacks.ListenerList.__name__=!0,p.callbacks.ListenerList.fromArray=function(t){if(null==t)throw"Error: Cannot convert null Array to Nape list";for(var n=new p.callbacks.ListenerList,e=0;e<t.length;){var i=t[e];++e,n.push(i)}return n},p.callbacks.ListenerList.prototype={get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},at:function(t){if(this.zpp_inner.valmod(),t<0||t>=this.get_length())throw"Error: Index out of bounds 2";if(this.zpp_inner.reverse_flag&&(t=this.get_length()-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(t){if(this.zpp_inner.immutable)throw"Error: ListenerList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},unshift:function(t){if(this.zpp_inner.immutable)throw"Error: ListenerList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},pop:function(){if(this.zpp_inner.immutable)throw"Error: ListenerList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){t=this.zpp_inner.inner.head.elt;var n=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var e;e=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==e?this.zpp_inner.inner.head.elt:e.next.elt;var i=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)}return this.zpp_inner.invalidate(),t.outer},shift:function(){if(this.zpp_inner.immutable)throw"Error: ListenerList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n;n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==n?this.zpp_inner.inner.head.elt:n.next.elt;var e=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}else{t=this.zpp_inner.inner.head.elt;var i=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),t.outer},add:function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},remove:function(t){if(this.zpp_inner.immutable)throw"Error: ListenerList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;n=!1;for(var e=this.zpp_inner.inner.head;null!=e;){if(e.elt==t.zpp_inner){n=!0;break}e=e.next}return n&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),n},clear:function(){if(this.zpp_inner.immutable)throw"Error: ListenerList is immutable";if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){return this.zpp_inner.valmod(),p.callbacks.ListenerIterator.get(this)},copy:function(t){null==t&&(t=!1);var n,e=new p.callbacks.ListenerList;for(this.zpp_inner.valmod(),n=p.callbacks.ListenerIterator.get(this);n.hasNext();){var i;n.zpp_critical=!1,i=n.zpp_inner.at(n.zpp_i++),e.push(t?function(t){throw"Error: Listener is not a copyable type"}():i)}return e},merge:function(t){if(null==t)throw"Error: Cannot merge with null list";var n;for(t.zpp_inner.valmod(),n=p.callbacks.ListenerIterator.get(t);n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),this.has(e)||(this.zpp_inner.reverse_flag?this.push(e):this.unshift(e))}},toString:function(){var t,n="[",e=!0;for(this.zpp_inner.valmod(),t=p.callbacks.ListenerIterator.get(this);t.hasNext();){var i;t.zpp_critical=!1,i=t.zpp_inner.at(t.zpp_i++),e||(n+=","),n+=null==i?"NULL":i.toString(),e=!1}return n+"]"},foreach:function(t){if(null==t)throw"Error: Cannot execute null on list elements";var n;for(this.zpp_inner.valmod(),n=p.callbacks.ListenerIterator.get(this);n.hasNext();)try{t(function(t){return n.zpp_critical=!1,n.zpp_inner.at(n.zpp_i++)}())}catch(t){n.zpp_next=p.callbacks.ListenerIterator.zpp_pool,p.callbacks.ListenerIterator.zpp_pool=n,n.zpp_inner=null;break}return this},filter:function(t){if(null==t)throw"Error: Cannot select elements of list with null";for(var n=0;n<this.get_length();){var e=this.at(n);try{t(e)?n++:this.remove(e)}catch(t){break}}return this},__class__:p.callbacks.ListenerList},p.callbacks.ListenerType=function(){if(!o.util.ZPP_Flags.internal)throw"Error: Cannot instantiate ListenerType derp!"},p.callbacks.ListenerType.__name__=!0,p.callbacks.ListenerType.get_BODY=function(){return null==o.util.ZPP_Flags.ListenerType_BODY&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ListenerType_BODY=new p.callbacks.ListenerType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ListenerType_BODY},p.callbacks.ListenerType.get_CONSTRAINT=function(){return null==o.util.ZPP_Flags.ListenerType_CONSTRAINT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ListenerType_CONSTRAINT=new p.callbacks.ListenerType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ListenerType_CONSTRAINT},p.callbacks.ListenerType.get_INTERACTION=function(){return null==o.util.ZPP_Flags.ListenerType_INTERACTION&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ListenerType_INTERACTION=new p.callbacks.ListenerType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ListenerType_INTERACTION},p.callbacks.ListenerType.get_PRE=function(){return null==o.util.ZPP_Flags.ListenerType_PRE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ListenerType_PRE=new p.callbacks.ListenerType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ListenerType_PRE},p.callbacks.ListenerType.prototype={toString:function(){return this==function(t){return null==o.util.ZPP_Flags.ListenerType_BODY&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ListenerType_BODY=new p.callbacks.ListenerType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ListenerType_BODY}()?"BODY":this==function(t){return null==o.util.ZPP_Flags.ListenerType_CONSTRAINT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ListenerType_CONSTRAINT=new p.callbacks.ListenerType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ListenerType_CONSTRAINT}()?"CONSTRAINT":this==function(t){return null==o.util.ZPP_Flags.ListenerType_INTERACTION&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ListenerType_INTERACTION=new p.callbacks.ListenerType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ListenerType_INTERACTION}()?"INTERACTION":this==function(t){return null==o.util.ZPP_Flags.ListenerType_PRE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ListenerType_PRE=new p.callbacks.ListenerType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ListenerType_PRE}()?"PRE":""},__class__:p.callbacks.ListenerType},p.callbacks.OptionType=function(t,n){this.zpp_inner=null,this.zpp_inner=new o.callbacks.ZPP_OptionType,this.zpp_inner.outer=this,null!=t&&this.including(t),null!=n&&this.excluding(n)},p.callbacks.OptionType.__name__=!0,p.callbacks.OptionType.prototype={get_includes:function(){return null==this.zpp_inner.wrap_includes&&this.zpp_inner.setup_includes(),this.zpp_inner.wrap_includes},get_excludes:function(){return null==this.zpp_inner.wrap_excludes&&this.zpp_inner.setup_excludes(),this.zpp_inner.wrap_excludes},including:function(t){return this.zpp_inner.append(this.zpp_inner.includes,t),this},excluding:function(t){return this.zpp_inner.append(this.zpp_inner.excludes,t),this},toString:function(){return"@{"+function(t){return null==t.zpp_inner.wrap_includes&&t.zpp_inner.setup_includes(),t.zpp_inner.wrap_includes}(this).toString()+" excluding "+function(t){return null==t.zpp_inner.wrap_excludes&&t.zpp_inner.setup_excludes(),t.zpp_inner.wrap_excludes}(this).toString()+"}"},__class__:p.callbacks.OptionType},p.callbacks.PreCallback=function(){p.callbacks.Callback.call(this)},p.callbacks.PreCallback.__name__=!0,p.callbacks.PreCallback.__super__=p.callbacks.Callback,p.callbacks.PreCallback.prototype=t(p.callbacks.Callback.prototype,{get_arbiter:function(){return this.zpp_inner.pre_arbiter.wrapper()},get_int1:function(){return this.zpp_inner.int1.outer_i},get_int2:function(){return this.zpp_inner.int2.outer_i},get_swapped:function(){return this.zpp_inner.pre_swapped},toString:function(){var t="Cb:PRE:";return t+=":"+this.zpp_inner.int1.outer_i.toString()+"/"+this.zpp_inner.int2.outer_i.toString(),t+=" : "+this.zpp_inner.pre_arbiter.wrapper().toString(),t+=" : listnener: "+r.string(this.zpp_inner.listener.outer)},__class__:p.callbacks.PreCallback}),p.callbacks.PreFlag=function(){if(!o.util.ZPP_Flags.internal)throw"Error: Cannot instantiate PreFlag derp!"},p.callbacks.PreFlag.__name__=!0,p.callbacks.PreFlag.get_ACCEPT=function(){return null==o.util.ZPP_Flags.PreFlag_ACCEPT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_ACCEPT=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_ACCEPT},p.callbacks.PreFlag.get_IGNORE=function(){return null==o.util.ZPP_Flags.PreFlag_IGNORE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_IGNORE=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_IGNORE},p.callbacks.PreFlag.get_ACCEPT_ONCE=function(){return null==o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE},p.callbacks.PreFlag.get_IGNORE_ONCE=function(){return null==o.util.ZPP_Flags.PreFlag_IGNORE_ONCE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_IGNORE_ONCE=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_IGNORE_ONCE},p.callbacks.PreFlag.prototype={toString:function(){return this==function(t){return null==o.util.ZPP_Flags.PreFlag_ACCEPT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_ACCEPT=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_ACCEPT}()?"ACCEPT":this==function(t){return null==o.util.ZPP_Flags.PreFlag_IGNORE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_IGNORE=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_IGNORE}()?"IGNORE":this==function(t){return null==o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE}()?"ACCEPT_ONCE":this==function(t){return null==o.util.ZPP_Flags.PreFlag_IGNORE_ONCE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_IGNORE_ONCE=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_IGNORE_ONCE}()?"IGNORE_ONCE":""},__class__:p.callbacks.PreFlag},p.callbacks.PreListener=function(t,n,e,i,r,s){if(null==s&&(s=!1),null==r&&(r=0),this.zpp_inner_zn=null,o.callbacks.ZPP_Listener.internal=!0,p.callbacks.Listener.call(this),o.callbacks.ZPP_Listener.internal=!1,null==i)throw"Error: PreListener must take a handler!";this.zpp_inner_zn=new o.callbacks.ZPP_InteractionListener(o.callbacks.ZPP_OptionType.argument(n),o.callbacks.ZPP_OptionType.argument(e),o.util.ZPP_Flags.id_CbEvent_PRE,o.util.ZPP_Flags.id_ListenerType_PRE),this.zpp_inner=this.zpp_inner_zn,this.zpp_inner.outer=this,this.zpp_inner_zn.outer_znp=this,this.zpp_inner.precedence=r,this.zpp_inner_zn.pure=s,this.zpp_inner_zn.handlerp=i,this.set_interactionType(t)},p.callbacks.PreListener.__name__=!0,p.callbacks.PreListener.__super__=p.callbacks.Listener,p.callbacks.PreListener.prototype=t(p.callbacks.Listener.prototype,{get_options1:function(){return this.zpp_inner_zn.options1.outer},set_options1:function(t){return this.zpp_inner_zn.options1.set(t.zpp_inner),this.zpp_inner_zn.options1.outer},get_options2:function(){return this.zpp_inner_zn.options2.outer},set_options2:function(t){return this.zpp_inner_zn.options2.set(t.zpp_inner),this.zpp_inner_zn.options2.outer},get_handler:function(){return this.zpp_inner_zn.handlerp},set_handler:function(t){if(null==t)throw"Error: PreListener must take a non-null handler!";return this.zpp_inner_zn.handlerp=t,this.zpp_inner_zn.wake(),this.zpp_inner_zn.handlerp},get_pure:function(){return this.zpp_inner_zn.pure},set_pure:function(t){return t||this.zpp_inner_zn.wake(),this.zpp_inner_zn.pure=t,this.zpp_inner_zn.pure},get_interactionType:function(){var t=this.zpp_inner_zn.itype;return t==o.util.ZPP_Flags.id_InteractionType_COLLISION?(null==o.util.ZPP_Flags.InteractionType_COLLISION&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_COLLISION=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_COLLISION):t==o.util.ZPP_Flags.id_InteractionType_SENSOR?(null==o.util.ZPP_Flags.InteractionType_SENSOR&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_SENSOR=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_SENSOR):t==o.util.ZPP_Flags.id_InteractionType_FLUID?(null==o.util.ZPP_Flags.InteractionType_FLUID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_FLUID=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_FLUID):t==o.util.ZPP_Flags.id_InteractionType_ANY?(null==o.util.ZPP_Flags.InteractionType_ANY&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_ANY=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_ANY):null},set_interactionType:function(t){if(null==t)throw"Error: Cannot set listener interaction type to null";if(this.get_interactionType()!=t){var n;n=t==function(t){return null==o.util.ZPP_Flags.InteractionType_COLLISION&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_COLLISION=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_COLLISION}()?o.util.ZPP_Flags.id_InteractionType_COLLISION:t==function(t){return null==o.util.ZPP_Flags.InteractionType_SENSOR&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_SENSOR=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_SENSOR}()?o.util.ZPP_Flags.id_InteractionType_SENSOR:t==function(t){return null==o.util.ZPP_Flags.InteractionType_FLUID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_FLUID=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_FLUID}()?o.util.ZPP_Flags.id_InteractionType_FLUID:o.util.ZPP_Flags.id_InteractionType_ANY,this.zpp_inner_zn.itype=n}return this.get_interactionType()},__class__:p.callbacks.PreListener}),p.constraint={},p.constraint.Constraint=function(){if(this.debugDraw=!0,this.zpp_inner.insert_cbtype(o.callbacks.ZPP_CbType.ANY_CONSTRAINT.zpp_inner),!p.constraint.Constraint.zpp_internalAlloc)throw"Error: Constraint cannot be instantiated derp!"},p.constraint.Constraint.__name__=!0,p.constraint.Constraint.prototype={get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_compound:function(){return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},set_compound:function(t){return(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)!=t&&(null!=(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)&&(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer).zpp_inner.wrap_constraints.remove(this),null!=t&&t.zpp_inner.wrap_constraints.add(this)),null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},get_space:function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},set_space:function(t){if(null!=this.zpp_inner.compound)throw"Error: Cannot set the space of a Constraint belonging to a Compound, only the root Compound space can be set";return(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=t&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.woken=!1),this.zpp_inner.clearcache(),null!=this.zpp_inner.space&&this.zpp_inner.space.outer.zpp_inner.wrap_constraints.remove(this),null!=t?t.zpp_inner.wrap_constraints.add(this):this.zpp_inner.space=null),null==this.zpp_inner.space?null:this.zpp_inner.space.outer},get_isSleeping:function(){if(null==this.zpp_inner.space||!this.zpp_inner.active)throw"Error: isSleeping only makes sense if constraint is active and inside a space";return this.zpp_inner.component.sleeping},get_active:function(){return this.zpp_inner.active},set_active:function(t){return this.zpp_inner.active!=t&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.woken=!1),this.zpp_inner.clearcache(),t?(this.zpp_inner.active=t,this.zpp_inner.activate(),null!=this.zpp_inner.space&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.sleeping=!0),this.zpp_inner.space.wake_constraint(this.zpp_inner,!0))):(null!=this.zpp_inner.space&&(this.zpp_inner.wake(),this.zpp_inner.space.live_constraints.remove(this.zpp_inner)),this.zpp_inner.active=t,this.zpp_inner.deactivate())),this.zpp_inner.active},get_ignore:function(){return this.zpp_inner.ignore},set_ignore:function(t){return this.zpp_inner.ignore!=t&&(this.zpp_inner.ignore=t,this.zpp_inner.wake()),this.zpp_inner.ignore},get_stiff:function(){return this.zpp_inner.stiff},set_stiff:function(t){return this.zpp_inner.stiff!=t&&(this.zpp_inner.stiff=t,this.zpp_inner.wake()),this.zpp_inner.stiff},get_frequency:function(){return this.zpp_inner.frequency},set_frequency:function(t){if(t!=t)throw"Error: Constraint::Frequency cannot be NaN";if(t<=0)throw"Error: Constraint::Frequency must be >0";return this.zpp_inner.frequency!=t&&(this.zpp_inner.frequency=t,this.zpp_inner.stiff||this.zpp_inner.wake()),this.zpp_inner.frequency},get_damping:function(){return this.zpp_inner.damping},set_damping:function(t){if(t!=t)throw"Error: Constraint::Damping cannot be Nan";if(t<0)throw"Error: Constraint::Damping must be >=0";return this.zpp_inner.damping!=t&&(this.zpp_inner.damping=t,this.zpp_inner.stiff||this.zpp_inner.wake()),this.zpp_inner.damping},get_maxForce:function(){return this.zpp_inner.maxForce},set_maxForce:function(t){if(t!=t)throw"Error: Constraint::maxForce cannot be NaN";if(t<0)throw"Error: Constraint::maxForce must be >=0";return this.zpp_inner.maxForce!=t&&(this.zpp_inner.maxForce=t,this.zpp_inner.wake()),this.zpp_inner.maxForce},get_maxError:function(){return this.zpp_inner.maxError},set_maxError:function(t){if(t!=t)throw"Error: Constraint::maxError cannot be NaN";if(t<0)throw"Error: Constraint::maxError must be >=0";return this.zpp_inner.maxError!=t&&(this.zpp_inner.maxError=t,this.zpp_inner.wake()),this.zpp_inner.maxError},get_breakUnderForce:function(){return this.zpp_inner.breakUnderForce},set_breakUnderForce:function(t){return this.zpp_inner.breakUnderForce!=t&&(this.zpp_inner.breakUnderForce=t,this.zpp_inner.wake()),this.zpp_inner.breakUnderForce},get_breakUnderError:function(){return this.zpp_inner.breakUnderError},set_breakUnderError:function(t){return this.zpp_inner.breakUnderError!=t&&(this.zpp_inner.breakUnderError=t,this.zpp_inner.wake()),this.zpp_inner.breakUnderError},get_removeOnBreak:function(){return this.zpp_inner.removeOnBreak},set_removeOnBreak:function(t){return this.zpp_inner.removeOnBreak=t,this.zpp_inner.removeOnBreak},impulse:function(){return null},bodyImpulse:function(t){return null},visitBodies:function(t){},get_cbTypes:function(){return null==this.zpp_inner.wrap_cbTypes&&this.zpp_inner.setupcbTypes(),this.zpp_inner.wrap_cbTypes},toString:function(){return"{Constraint}"},copy:function(){return this.zpp_inner.copy()},__class__:p.constraint.Constraint},p.constraint.AngleJoint=function(t,n,e,i,r){if(null==r&&(r=1),this.zpp_inner_zn=null,this.zpp_inner_zn=new o.constraint.ZPP_AngleJoint,this.zpp_inner=this.zpp_inner_zn,this.zpp_inner.outer=this,this.zpp_inner_zn.outer_zn=this,p.constraint.Constraint.zpp_internalAlloc=!0,p.constraint.Constraint.call(this),p.constraint.Constraint.zpp_internalAlloc=!1,this.set_body1(t),this.set_body2(n),this.zpp_inner.immutable_midstep("AngleJoint::jointMin"),e!=e)throw"Error: AngleJoint::jointMin cannot be NaN";if(this.zpp_inner_zn.jointMin!=e&&(this.zpp_inner_zn.jointMin=e,this.zpp_inner.wake()),this.zpp_inner_zn.jointMin,this.zpp_inner.immutable_midstep("AngleJoint::jointMax"),i!=i)throw"Error: AngleJoint::jointMax cannot be NaN";if(this.zpp_inner_zn.jointMax!=i&&(this.zpp_inner_zn.jointMax=i,this.zpp_inner.wake()),this.zpp_inner_zn.jointMax,this.zpp_inner.immutable_midstep("AngleJoint::ratio"),r!=r)throw"Error: AngleJoint::ratio cannot be NaN";this.zpp_inner_zn.ratio!=r&&(this.zpp_inner_zn.ratio=r,this.zpp_inner.wake()),this.zpp_inner_zn.ratio},p.constraint.AngleJoint.__name__=!0,p.constraint.AngleJoint.__super__=p.constraint.Constraint,p.constraint.AngleJoint.prototype=t(p.constraint.Constraint.prototype,{get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(t){this.zpp_inner.immutable_midstep("Constraint::body1");var n;return n=null==t?null:t.zpp_inner,n!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=n,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=n&&this.zpp_inner_zn.b2!=n&&null!=n&&n.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=n&&n.wake())),null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(t){this.zpp_inner.immutable_midstep("Constraint::body2");var n;return n=null==t?null:t.zpp_inner,n!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=n,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=n&&this.zpp_inner_zn.b1!=n&&null!=n&&n.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=n&&n.wake())),null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_jointMin:function(){return this.zpp_inner_zn.jointMin},set_jointMin:function(t){if(this.zpp_inner.immutable_midstep("AngleJoint::jointMin"),t!=t)throw"Error: AngleJoint::jointMin cannot be NaN";return this.zpp_inner_zn.jointMin!=t&&(this.zpp_inner_zn.jointMin=t,this.zpp_inner.wake()),this.zpp_inner_zn.jointMin},get_jointMax:function(){return this.zpp_inner_zn.jointMax},set_jointMax:function(t){if(this.zpp_inner.immutable_midstep("AngleJoint::jointMax"),t!=t)throw"Error: AngleJoint::jointMax cannot be NaN";return this.zpp_inner_zn.jointMax!=t&&(this.zpp_inner_zn.jointMax=t,this.zpp_inner.wake()),this.zpp_inner_zn.jointMax},get_ratio:function(){return this.zpp_inner_zn.ratio},set_ratio:function(t){if(this.zpp_inner.immutable_midstep("AngleJoint::ratio"),t!=t)throw"Error: AngleJoint::ratio cannot be NaN";return this.zpp_inner_zn.ratio!=t&&(this.zpp_inner_zn.ratio=t,this.zpp_inner.wake()),this.zpp_inner_zn.ratio},isSlack:function(){if(null==(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)||null==(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer))throw"Error: Cannot compute slack for AngleJoint if either body is null.";return this.zpp_inner_zn.is_slack()},impulse:function(){var t=new p.geom.MatMN(1,1);if(0>=t.zpp_inner.m||0>=t.zpp_inner.n)throw"Error: MatMN indices out of range";return t.zpp_inner.x[0*t.zpp_inner.n]=this.zpp_inner_zn.jAcc,t},bodyImpulse:function(t){if(null==t)throw"Error: Cannot evaluate impulse on null body";if(t!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer))throw"Error: Body is not linked to this constraint";return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(t.zpp_inner):p.geom.Vec3.get(0,0,0)},visitBodies:function(t){if(null==t)throw"Error: Cannot apply null lambda to bodies";null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer),null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},__class__:p.constraint.AngleJoint}),p.constraint.ConstraintIterator=function(){if(this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null,!o.util.ZPP_ConstraintList.internal)throw"Error: Cannot instantiate ConstraintIterator derp!"},p.constraint.ConstraintIterator.__name__=!0,p.constraint.ConstraintIterator.get=function(t){var n;if(null==p.constraint.ConstraintIterator.zpp_pool){o.util.ZPP_ConstraintList.internal=!0;var e=new p.constraint.ConstraintIterator;o.util.ZPP_ConstraintList.internal=!1,n=e}else{var i=p.constraint.ConstraintIterator.zpp_pool;p.constraint.ConstraintIterator.zpp_pool=i.zpp_next,n=i}return n.zpp_i=0,n.zpp_inner=t,n.zpp_critical=!1,n},p.constraint.ConstraintIterator.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=p.constraint.ConstraintIterator.zpp_pool,p.constraint.ConstraintIterator.zpp_pool=this,this.zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:p.constraint.ConstraintIterator},p.constraint.ConstraintList=function(){this.zpp_inner=null,this.zpp_inner=new o.util.ZPP_ConstraintList,this.zpp_inner.outer=this},p.constraint.ConstraintList.__name__=!0,p.constraint.ConstraintList.fromArray=function(t){if(null==t)throw"Error: Cannot convert null Array to Nape list";for(var n=new p.constraint.ConstraintList,e=0;e<t.length;){var i=t[e];++e,n.push(i)}return n},p.constraint.ConstraintList.prototype={get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},at:function(t){if(this.zpp_inner.valmod(),t<0||t>=this.get_length())throw"Error: Index out of bounds 3";if(this.zpp_inner.reverse_flag&&(t=this.get_length()-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(t){if(this.zpp_inner.immutable)throw"Error: ConstraintList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},unshift:function(t){if(this.zpp_inner.immutable)throw"Error: ConstraintList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},pop:function(){if(this.zpp_inner.immutable)throw"Error: ConstraintList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){t=this.zpp_inner.inner.head.elt;var n=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var e;e=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==e?this.zpp_inner.inner.head.elt:e.next.elt;var i=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)}return this.zpp_inner.invalidate(),t.outer},shift:function(){if(this.zpp_inner.immutable)throw"Error: ConstraintList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n;n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==n?this.zpp_inner.inner.head.elt:n.next.elt;var e=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),
this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}else{t=this.zpp_inner.inner.head.elt;var i=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),t.outer},add:function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},remove:function(t){if(this.zpp_inner.immutable)throw"Error: ConstraintList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;n=!1;for(var e=this.zpp_inner.inner.head;null!=e;){if(e.elt==t.zpp_inner){n=!0;break}e=e.next}return n&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),n},clear:function(){if(this.zpp_inner.immutable)throw"Error: ConstraintList is immutable";if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){return this.zpp_inner.valmod(),p.constraint.ConstraintIterator.get(this)},copy:function(t){null==t&&(t=!1);var n,e=new p.constraint.ConstraintList;for(this.zpp_inner.valmod(),n=p.constraint.ConstraintIterator.get(this);n.hasNext();){var i;n.zpp_critical=!1,i=n.zpp_inner.at(n.zpp_i++),e.push(t?function(t){throw"Error: Constraint is not a copyable type"}():i)}return e},merge:function(t){if(null==t)throw"Error: Cannot merge with null list";var n;for(t.zpp_inner.valmod(),n=p.constraint.ConstraintIterator.get(t);n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),this.has(e)||(this.zpp_inner.reverse_flag?this.push(e):this.unshift(e))}},toString:function(){var t,n="[",e=!0;for(this.zpp_inner.valmod(),t=p.constraint.ConstraintIterator.get(this);t.hasNext();){var i;t.zpp_critical=!1,i=t.zpp_inner.at(t.zpp_i++),e||(n+=","),n+=null==i?"NULL":i.toString(),e=!1}return n+"]"},foreach:function(t){if(null==t)throw"Error: Cannot execute null on list elements";var n;for(this.zpp_inner.valmod(),n=p.constraint.ConstraintIterator.get(this);n.hasNext();)try{t(function(t){return n.zpp_critical=!1,n.zpp_inner.at(n.zpp_i++)}())}catch(t){n.zpp_next=p.constraint.ConstraintIterator.zpp_pool,p.constraint.ConstraintIterator.zpp_pool=n,n.zpp_inner=null;break}return this},filter:function(t){if(null==t)throw"Error: Cannot select elements of list with null";for(var n=0;n<this.get_length();){var e=this.at(n);try{t(e)?n++:this.remove(e)}catch(t){break}}return this},__class__:p.constraint.ConstraintList},p.constraint.DistanceJoint=function(t,n,e,i,r,s){if(this.zpp_inner_zn=null,this.zpp_inner_zn=new o.constraint.ZPP_DistanceJoint,this.zpp_inner=this.zpp_inner_zn,this.zpp_inner.outer=this,this.zpp_inner_zn.outer_zn=this,p.constraint.Constraint.zpp_internalAlloc=!0,p.constraint.Constraint.call(this),p.constraint.Constraint.zpp_internalAlloc=!1,this.set_body1(t),this.set_body2(n),null!=e&&e.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==e)throw"Error: Constraint::anchor1 cannot be null";if(function(t){return null==t.zpp_inner_zn.wrap_a1&&t.zpp_inner_zn.setup_a1(),t.zpp_inner_zn.wrap_a1}(this).set(e),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1,null!=i&&i.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==i)throw"Error: Constraint::anchor2 cannot be null";if(function(t){return null==t.zpp_inner_zn.wrap_a2&&t.zpp_inner_zn.setup_a2(),t.zpp_inner_zn.wrap_a2}(this).set(i),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2,this.zpp_inner.immutable_midstep("DistanceJoint::jointMin"),r!=r)throw"Error: DistanceJoint::jointMin cannot be NaN";if(r<0)throw"Error: DistanceJoint::jointMin must be >= 0";if(this.zpp_inner_zn.jointMin!=r&&(this.zpp_inner_zn.jointMin=r,this.zpp_inner.wake()),this.zpp_inner_zn.jointMin,this.zpp_inner.immutable_midstep("DistanceJoint::jointMax"),s!=s)throw"Error: DistanceJoint::jointMax cannot be NaN";if(s<0)throw"Error: DistanceJoint::jointMax must be >= 0";this.zpp_inner_zn.jointMax!=s&&(this.zpp_inner_zn.jointMax=s,this.zpp_inner.wake()),this.zpp_inner_zn.jointMax},p.constraint.DistanceJoint.__name__=!0,p.constraint.DistanceJoint.__super__=p.constraint.Constraint,p.constraint.DistanceJoint.prototype=t(p.constraint.Constraint.prototype,{get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(t){this.zpp_inner.immutable_midstep("Constraint::body1");var n;return n=null==t?null:t.zpp_inner,n!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=n,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=n&&this.zpp_inner_zn.b2!=n&&null!=n&&n.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=n&&n.wake())),null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(t){this.zpp_inner.immutable_midstep("Constraint::body2");var n;return n=null==t?null:t.zpp_inner,n!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=n,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=n&&this.zpp_inner_zn.b1!=n&&null!=n&&n.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=n&&n.wake())),null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_anchor1:function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},set_anchor1:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Constraint::anchor1 cannot be null";return function(t){return null==t.zpp_inner_zn.wrap_a1&&t.zpp_inner_zn.setup_a1(),t.zpp_inner_zn.wrap_a1}(this).set(t),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},get_anchor2:function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},set_anchor2:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Constraint::anchor2 cannot be null";return function(t){return null==t.zpp_inner_zn.wrap_a2&&t.zpp_inner_zn.setup_a2(),t.zpp_inner_zn.wrap_a2}(this).set(t),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},get_jointMin:function(){return this.zpp_inner_zn.jointMin},set_jointMin:function(t){if(this.zpp_inner.immutable_midstep("DistanceJoint::jointMin"),t!=t)throw"Error: DistanceJoint::jointMin cannot be NaN";if(t<0)throw"Error: DistanceJoint::jointMin must be >= 0";return this.zpp_inner_zn.jointMin!=t&&(this.zpp_inner_zn.jointMin=t,this.zpp_inner.wake()),this.zpp_inner_zn.jointMin},get_jointMax:function(){return this.zpp_inner_zn.jointMax},set_jointMax:function(t){if(this.zpp_inner.immutable_midstep("DistanceJoint::jointMax"),t!=t)throw"Error: DistanceJoint::jointMax cannot be NaN";if(t<0)throw"Error: DistanceJoint::jointMax must be >= 0";return this.zpp_inner_zn.jointMax!=t&&(this.zpp_inner_zn.jointMax=t,this.zpp_inner.wake()),this.zpp_inner_zn.jointMax},isSlack:function(){if(null==(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)||null==(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer))throw"Error: Cannot compute slack for DistanceJoint if either body is null.";return this.zpp_inner_zn.slack},impulse:function(){var t=new p.geom.MatMN(1,1);if(0>=t.zpp_inner.m||0>=t.zpp_inner.n)throw"Error: MatMN indices out of range";return t.zpp_inner.x[0*t.zpp_inner.n]=this.zpp_inner_zn.jAcc,t},bodyImpulse:function(t){if(null==t)throw"Error: Cannot evaluate impulse on null body";if(t!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer))throw"Error: Body is not linked to this constraint";return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(t.zpp_inner):p.geom.Vec3.get()},visitBodies:function(t){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer),null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},__class__:p.constraint.DistanceJoint}),p.constraint.LineJoint=function(t,n,e,i,r,s,l){if(this.zpp_inner_zn=null,this.zpp_inner_zn=new o.constraint.ZPP_LineJoint,this.zpp_inner=this.zpp_inner_zn,this.zpp_inner.outer=this,this.zpp_inner_zn.outer_zn=this,p.constraint.Constraint.zpp_internalAlloc=!0,p.constraint.Constraint.call(this),p.constraint.Constraint.zpp_internalAlloc=!1,this.set_body1(t),this.set_body2(n),null!=e&&e.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==e)throw"Error: Constraint::anchor1 cannot be null";if(function(t){return null==t.zpp_inner_zn.wrap_a1&&t.zpp_inner_zn.setup_a1(),t.zpp_inner_zn.wrap_a1}(this).set(e),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1,null!=i&&i.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==i)throw"Error: Constraint::anchor2 cannot be null";if(function(t){return null==t.zpp_inner_zn.wrap_a2&&t.zpp_inner_zn.setup_a2(),t.zpp_inner_zn.wrap_a2}(this).set(i),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2,null!=r&&r.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==r)throw"Error: Constraint::direction cannot be null";if(function(t){return null==t.zpp_inner_zn.wrap_n&&t.zpp_inner_zn.setup_n(),t.zpp_inner_zn.wrap_n}(this).set(r),null==this.zpp_inner_zn.wrap_n&&this.zpp_inner_zn.setup_n(),this.zpp_inner_zn.wrap_n,this.zpp_inner.immutable_midstep("LineJoint::jointMin"),s!=s)throw"Error: AngleJoint::jointMin cannot be NaN";if(this.zpp_inner_zn.jointMin!=s&&(this.zpp_inner_zn.jointMin=s,this.zpp_inner.wake()),this.zpp_inner_zn.jointMin,this.zpp_inner.immutable_midstep("LineJoint::jointMax"),l!=l)throw"Error: AngleJoint::jointMax cannot be NaN";this.zpp_inner_zn.jointMax!=l&&(this.zpp_inner_zn.jointMax=l,this.zpp_inner.wake()),this.zpp_inner_zn.jointMax},p.constraint.LineJoint.__name__=!0,p.constraint.LineJoint.__super__=p.constraint.Constraint,p.constraint.LineJoint.prototype=t(p.constraint.Constraint.prototype,{get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(t){this.zpp_inner.immutable_midstep("Constraint::body1");var n;return n=null==t?null:t.zpp_inner,n!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=n,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=n&&this.zpp_inner_zn.b2!=n&&null!=n&&n.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=n&&n.wake())),null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(t){this.zpp_inner.immutable_midstep("Constraint::body2");var n;return n=null==t?null:t.zpp_inner,n!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=n,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=n&&this.zpp_inner_zn.b1!=n&&null!=n&&n.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=n&&n.wake())),null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_anchor1:function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},set_anchor1:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Constraint::anchor1 cannot be null";return function(t){return null==t.zpp_inner_zn.wrap_a1&&t.zpp_inner_zn.setup_a1(),t.zpp_inner_zn.wrap_a1}(this).set(t),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},get_anchor2:function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},set_anchor2:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Constraint::anchor2 cannot be null";return function(t){return null==t.zpp_inner_zn.wrap_a2&&t.zpp_inner_zn.setup_a2(),t.zpp_inner_zn.wrap_a2}(this).set(t),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},get_direction:function(){return null==this.zpp_inner_zn.wrap_n&&this.zpp_inner_zn.setup_n(),this.zpp_inner_zn.wrap_n},set_direction:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Constraint::direction cannot be null";return function(t){return null==t.zpp_inner_zn.wrap_n&&t.zpp_inner_zn.setup_n(),t.zpp_inner_zn.wrap_n}(this).set(t),null==this.zpp_inner_zn.wrap_n&&this.zpp_inner_zn.setup_n(),this.zpp_inner_zn.wrap_n},get_jointMin:function(){return this.zpp_inner_zn.jointMin},set_jointMin:function(t){if(this.zpp_inner.immutable_midstep("LineJoint::jointMin"),t!=t)throw"Error: AngleJoint::jointMin cannot be NaN";return this.zpp_inner_zn.jointMin!=t&&(this.zpp_inner_zn.jointMin=t,this.zpp_inner.wake()),this.zpp_inner_zn.jointMin},get_jointMax:function(){return this.zpp_inner_zn.jointMax},set_jointMax:function(t){if(this.zpp_inner.immutable_midstep("LineJoint::jointMax"),t!=t)throw"Error: AngleJoint::jointMax cannot be NaN";return this.zpp_inner_zn.jointMax!=t&&(this.zpp_inner_zn.jointMax=t,this.zpp_inner.wake()),this.zpp_inner_zn.jointMax},impulse:function(){var t=new p.geom.MatMN(2,1);if(0>=t.zpp_inner.m||0>=t.zpp_inner.n)throw"Error: MatMN indices out of range";if(t.zpp_inner.x[0*t.zpp_inner.n]=this.zpp_inner_zn.jAccx,1>=t.zpp_inner.m||0>=t.zpp_inner.n)throw"Error: MatMN indices out of range";return t.zpp_inner.x[t.zpp_inner.n]=this.zpp_inner_zn.jAccy,t},bodyImpulse:function(t){if(null==t)throw"Error: Cannot evaluate impulse on null body";if(t!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer))throw"Error: Body is not linked to this constraint";return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(t.zpp_inner):p.geom.Vec3.get()},visitBodies:function(t){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer),null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},__class__:p.constraint.LineJoint}),p.constraint.MotorJoint=function(t,n,e,i){if(null==i&&(i=1),null==e&&(e=0),this.zpp_inner_zn=null,this.zpp_inner_zn=new o.constraint.ZPP_MotorJoint,this.zpp_inner=this.zpp_inner_zn,this.zpp_inner.outer=this,this.zpp_inner_zn.outer_zn=this,p.constraint.Constraint.zpp_internalAlloc=!0,p.constraint.Constraint.call(this),p.constraint.Constraint.zpp_internalAlloc=!1,this.set_body1(t),this.set_body2(n),this.zpp_inner.immutable_midstep("MotorJoint::rate"),e!=e)throw"Error: MotorJoint::rate cannot be NaN";if(this.zpp_inner_zn.rate!=e&&(this.zpp_inner_zn.rate=e,this.zpp_inner.wake()),this.zpp_inner_zn.rate,this.zpp_inner.immutable_midstep("MotorJoint::ratio"),i!=i)throw"Error: MotorJoint::ratio cannot be NaN";this.zpp_inner_zn.ratio!=i&&(this.zpp_inner_zn.ratio=i,this.zpp_inner.wake()),this.zpp_inner_zn.ratio},p.constraint.MotorJoint.__name__=!0,p.constraint.MotorJoint.__super__=p.constraint.Constraint,p.constraint.MotorJoint.prototype=t(p.constraint.Constraint.prototype,{get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(t){this.zpp_inner.immutable_midstep("Constraint::body1");var n;return n=null==t?null:t.zpp_inner,n!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=n,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=n&&this.zpp_inner_zn.b2!=n&&null!=n&&n.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=n&&n.wake())),null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(t){this.zpp_inner.immutable_midstep("Constraint::body2");var n;return n=null==t?null:t.zpp_inner,n!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=n,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=n&&this.zpp_inner_zn.b1!=n&&null!=n&&n.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=n&&n.wake())),null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_ratio:function(){return this.zpp_inner_zn.ratio},set_ratio:function(t){if(this.zpp_inner.immutable_midstep("MotorJoint::ratio"),t!=t)throw"Error: MotorJoint::ratio cannot be NaN";return this.zpp_inner_zn.ratio!=t&&(this.zpp_inner_zn.ratio=t,this.zpp_inner.wake()),this.zpp_inner_zn.ratio},get_rate:function(){return this.zpp_inner_zn.rate},set_rate:function(t){if(this.zpp_inner.immutable_midstep("MotorJoint::rate"),t!=t)throw"Error: MotorJoint::rate cannot be NaN";return this.zpp_inner_zn.rate!=t&&(this.zpp_inner_zn.rate=t,this.zpp_inner.wake()),this.zpp_inner_zn.rate},impulse:function(){var t=new p.geom.MatMN(1,1);if(0>=t.zpp_inner.m||0>=t.zpp_inner.n)throw"Error: MatMN indices out of range";return t.zpp_inner.x[0*t.zpp_inner.n]=this.zpp_inner_zn.jAcc,t},bodyImpulse:function(t){if(null==t)throw"Error: Cannot evaluate impulse on null body";if(t!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer))throw"Error: Body is not linked to this constraint";return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(t.zpp_inner):p.geom.Vec3.get()},visitBodies:function(t){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer),null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},__class__:p.constraint.MotorJoint}),p.constraint.PivotJoint=function(t,n,e,i){if(this.zpp_inner_zn=null,this.zpp_inner_zn=new o.constraint.ZPP_PivotJoint,this.zpp_inner=this.zpp_inner_zn,this.zpp_inner.outer=this,this.zpp_inner_zn.outer_zn=this,p.constraint.Constraint.zpp_internalAlloc=!0,p.constraint.Constraint.call(this),p.constraint.Constraint.zpp_internalAlloc=!1,this.set_body1(t),this.set_body2(n),null!=e&&e.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==e)throw"Error: Constraint::anchor1 cannot be null";if(function(t){return null==t.zpp_inner_zn.wrap_a1&&t.zpp_inner_zn.setup_a1(),t.zpp_inner_zn.wrap_a1}(this).set(e),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1,null!=i&&i.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==i)throw"Error: Constraint::anchor2 cannot be null";(function(t){return null==t.zpp_inner_zn.wrap_a2&&t.zpp_inner_zn.setup_a2(),t.zpp_inner_zn.wrap_a2})(this).set(i),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},p.constraint.PivotJoint.__name__=!0,p.constraint.PivotJoint.__super__=p.constraint.Constraint,p.constraint.PivotJoint.prototype=t(p.constraint.Constraint.prototype,{get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(t){this.zpp_inner.immutable_midstep("Constraint::body1");var n;return n=null==t?null:t.zpp_inner,n!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=n,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=n&&this.zpp_inner_zn.b2!=n&&null!=n&&n.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=n&&n.wake())),null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(t){this.zpp_inner.immutable_midstep("Constraint::body2");var n;return n=null==t?null:t.zpp_inner,n!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=n,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=n&&this.zpp_inner_zn.b1!=n&&null!=n&&n.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=n&&n.wake())),null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_anchor1:function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},set_anchor1:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Constraint::anchor1 cannot be null";return function(t){return null==t.zpp_inner_zn.wrap_a1&&t.zpp_inner_zn.setup_a1(),t.zpp_inner_zn.wrap_a1}(this).set(t),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},get_anchor2:function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},set_anchor2:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Constraint::anchor2 cannot be null";return function(t){return null==t.zpp_inner_zn.wrap_a2&&t.zpp_inner_zn.setup_a2(),t.zpp_inner_zn.wrap_a2}(this).set(t),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},impulse:function(){var t=new p.geom.MatMN(2,1);if(0>=t.zpp_inner.m||0>=t.zpp_inner.n)throw"Error: MatMN indices out of range";if(t.zpp_inner.x[0*t.zpp_inner.n]=this.zpp_inner_zn.jAccx,1>=t.zpp_inner.m||0>=t.zpp_inner.n)throw"Error: MatMN indices out of range";return t.zpp_inner.x[t.zpp_inner.n]=this.zpp_inner_zn.jAccy,t},bodyImpulse:function(t){if(null==t)throw"Error: Cannot evaluate impulse on null body";if(t!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer))throw"Error: Body is not linked to this constraint";return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(t.zpp_inner):p.geom.Vec3.get()},visitBodies:function(t){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer),null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},__class__:p.constraint.PivotJoint}),p.constraint.PulleyJoint=function(t,n,e,i,r,s,l,a,_,h,u){if(null==u&&(u=1),this.zpp_inner_zn=null,this.zpp_inner_zn=new o.constraint.ZPP_PulleyJoint,this.zpp_inner=this.zpp_inner_zn,this.zpp_inner.outer=this,this.zpp_inner_zn.outer_zn=this,p.constraint.Constraint.zpp_internalAlloc=!0,p.constraint.Constraint.call(this),p.constraint.Constraint.zpp_internalAlloc=!1,this.set_body1(t),this.set_body2(n),this.set_body3(e),this.set_body4(i),null!=r&&r.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==r)throw"Error: Constraint::anchor1 cannot be null";if(function(t){return null==t.zpp_inner_zn.wrap_a1&&t.zpp_inner_zn.setup_a1(),t.zpp_inner_zn.wrap_a1}(this).set(r),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1,null!=s&&s.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==s)throw"Error: Constraint::anchor2 cannot be null";if(function(t){return null==t.zpp_inner_zn.wrap_a2&&t.zpp_inner_zn.setup_a2(),t.zpp_inner_zn.wrap_a2}(this).set(s),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2,null!=l&&l.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==l)throw"Error: Constraint::anchor3 cannot be null";if(function(t){return null==t.zpp_inner_zn.wrap_a3&&t.zpp_inner_zn.setup_a3(),t.zpp_inner_zn.wrap_a3}(this).set(l),null==this.zpp_inner_zn.wrap_a3&&this.zpp_inner_zn.setup_a3(),this.zpp_inner_zn.wrap_a3,null!=a&&a.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==a)throw"Error: Constraint::anchor4 cannot be null";if(function(t){return null==t.zpp_inner_zn.wrap_a4&&t.zpp_inner_zn.setup_a4(),t.zpp_inner_zn.wrap_a4}(this).set(a),null==this.zpp_inner_zn.wrap_a4&&this.zpp_inner_zn.setup_a4(),this.zpp_inner_zn.wrap_a4,this.zpp_inner.immutable_midstep("PulleyJoint::ratio"),u!=u)throw"Error: PulleyJoint::ratio cannot be NaN";if(this.zpp_inner_zn.ratio!=u&&(this.zpp_inner_zn.ratio=u,this.zpp_inner.wake()),this.zpp_inner_zn.ratio,this.zpp_inner.immutable_midstep("PulleyJoint::jointMin"),_!=_)throw"Error: PulleyJoint::jointMin cannot be NaN";if(_<0)throw"Error: PulleyJoint::jointMin must be >= 0";if(this.zpp_inner_zn.jointMin!=_&&(this.zpp_inner_zn.jointMin=_,this.zpp_inner.wake()),this.zpp_inner_zn.jointMin,this.zpp_inner.immutable_midstep("PulleyJoint::jointMax"),h!=h)throw"Error: PulleyJoint::jointMax cannot be NaN";if(h<0)throw"Error: PulleyJoint::jointMax must be >= 0";this.zpp_inner_zn.jointMax!=h&&(this.zpp_inner_zn.jointMax=h,this.zpp_inner.wake()),this.zpp_inner_zn.jointMax},p.constraint.PulleyJoint.__name__=!0,p.constraint.PulleyJoint.__super__=p.constraint.Constraint,p.constraint.PulleyJoint.prototype=t(p.constraint.Constraint.prototype,{get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(t){this.zpp_inner.immutable_midstep("Constraint::body1");var n;return n=null==t?null:t.zpp_inner,n!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=n,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=n&&this.zpp_inner_zn.b2!=n&&this.zpp_inner_zn.b3!=n&&this.zpp_inner_zn.b4!=n&&null!=n&&n.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=n&&n.wake())),null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(t){this.zpp_inner.immutable_midstep("Constraint::body2");var n;return n=null==t?null:t.zpp_inner,n!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=n,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=n&&this.zpp_inner_zn.b1!=n&&this.zpp_inner_zn.b3!=n&&this.zpp_inner_zn.b4!=n&&null!=n&&n.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=n&&n.wake())),null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_body3:function(){return null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer},set_body3:function(t){this.zpp_inner.immutable_midstep("Constraint::body3");var n;return n=null==t?null:t.zpp_inner,n!=this.zpp_inner_zn.b3&&(null!=this.zpp_inner_zn.b3&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b3&&null!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b3.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b3.wake()),this.zpp_inner_zn.b3=n,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=n&&this.zpp_inner_zn.b1!=n&&this.zpp_inner_zn.b2!=n&&this.zpp_inner_zn.b4!=n&&null!=n&&n.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=n&&n.wake())),null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer},get_body4:function(){
return null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer},set_body4:function(t){this.zpp_inner.immutable_midstep("Constraint::body4");var n;return n=null==t?null:t.zpp_inner,n!=this.zpp_inner_zn.b4&&(null!=this.zpp_inner_zn.b4&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b4&&null!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b4.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b4.wake()),this.zpp_inner_zn.b4=n,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=n&&this.zpp_inner_zn.b1!=n&&this.zpp_inner_zn.b2!=n&&this.zpp_inner_zn.b3!=n&&null!=n&&n.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=n&&n.wake())),null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer},get_anchor1:function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},set_anchor1:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Constraint::anchor1 cannot be null";return function(t){return null==t.zpp_inner_zn.wrap_a1&&t.zpp_inner_zn.setup_a1(),t.zpp_inner_zn.wrap_a1}(this).set(t),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},get_anchor2:function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},set_anchor2:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Constraint::anchor2 cannot be null";return function(t){return null==t.zpp_inner_zn.wrap_a2&&t.zpp_inner_zn.setup_a2(),t.zpp_inner_zn.wrap_a2}(this).set(t),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},get_anchor3:function(){return null==this.zpp_inner_zn.wrap_a3&&this.zpp_inner_zn.setup_a3(),this.zpp_inner_zn.wrap_a3},set_anchor3:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Constraint::anchor3 cannot be null";return function(t){return null==t.zpp_inner_zn.wrap_a3&&t.zpp_inner_zn.setup_a3(),t.zpp_inner_zn.wrap_a3}(this).set(t),null==this.zpp_inner_zn.wrap_a3&&this.zpp_inner_zn.setup_a3(),this.zpp_inner_zn.wrap_a3},get_anchor4:function(){return null==this.zpp_inner_zn.wrap_a4&&this.zpp_inner_zn.setup_a4(),this.zpp_inner_zn.wrap_a4},set_anchor4:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Constraint::anchor4 cannot be null";return function(t){return null==t.zpp_inner_zn.wrap_a4&&t.zpp_inner_zn.setup_a4(),t.zpp_inner_zn.wrap_a4}(this).set(t),null==this.zpp_inner_zn.wrap_a4&&this.zpp_inner_zn.setup_a4(),this.zpp_inner_zn.wrap_a4},get_jointMin:function(){return this.zpp_inner_zn.jointMin},set_jointMin:function(t){if(this.zpp_inner.immutable_midstep("PulleyJoint::jointMin"),t!=t)throw"Error: PulleyJoint::jointMin cannot be NaN";if(t<0)throw"Error: PulleyJoint::jointMin must be >= 0";return this.zpp_inner_zn.jointMin!=t&&(this.zpp_inner_zn.jointMin=t,this.zpp_inner.wake()),this.zpp_inner_zn.jointMin},get_jointMax:function(){return this.zpp_inner_zn.jointMax},set_jointMax:function(t){if(this.zpp_inner.immutable_midstep("PulleyJoint::jointMax"),t!=t)throw"Error: PulleyJoint::jointMax cannot be NaN";if(t<0)throw"Error: PulleyJoint::jointMax must be >= 0";return this.zpp_inner_zn.jointMax!=t&&(this.zpp_inner_zn.jointMax=t,this.zpp_inner.wake()),this.zpp_inner_zn.jointMax},get_ratio:function(){return this.zpp_inner_zn.ratio},set_ratio:function(t){if(this.zpp_inner.immutable_midstep("PulleyJoint::ratio"),t!=t)throw"Error: PulleyJoint::ratio cannot be NaN";return this.zpp_inner_zn.ratio!=t&&(this.zpp_inner_zn.ratio=t,this.zpp_inner.wake()),this.zpp_inner_zn.ratio},isSlack:function(){if(null==(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)||null==(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)||null==(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer)||null==(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer))throw"Error: Cannot compute slack for PulleyJoint if either body is null.";return this.zpp_inner_zn.slack},impulse:function(){var t=new p.geom.MatMN(1,1);if(0>=t.zpp_inner.m||0>=t.zpp_inner.n)throw"Error: MatMN indices out of range";return t.zpp_inner.x[0*t.zpp_inner.n]=this.zpp_inner_zn.jAcc,t},bodyImpulse:function(t){if(null==t)throw"Error: Cannot evaluate impulse on null body";if(t!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&t!=(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer)&&t!=(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer))throw"Error: Body is not linked to this constraint";return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(t.zpp_inner):p.geom.Vec3.get()},visitBodies:function(t){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer),null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer),null!=(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer)&&(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer)!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&t(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer),null!=(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer)&&(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer)!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer)!=(null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer)&&t(null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer)},__class__:p.constraint.PulleyJoint}),p.constraint.UserConstraint=function(t,n){if(null==n&&(n=!1),this.zpp_inner_zn=null,t<1)throw"Error: Constraint dimension must be at least 1";this.zpp_inner_zn=new o.constraint.ZPP_UserConstraint(t,n),this.zpp_inner=this.zpp_inner_zn,this.zpp_inner.outer=this,this.zpp_inner_zn.outer_zn=this,p.constraint.Constraint.zpp_internalAlloc=!0,p.constraint.Constraint.call(this),p.constraint.Constraint.zpp_internalAlloc=!1},p.constraint.UserConstraint.__name__=!0,p.constraint.UserConstraint.__super__=p.constraint.Constraint,p.constraint.UserConstraint.prototype=t(p.constraint.Constraint.prototype,{__bindVec2:function(){var t=new p.geom.Vec2;return t.zpp_inner._inuse=!0,t.zpp_inner._invalidate=(_=this.zpp_inner_zn,n(_,_.bindVec2_invalidate)),t},__copy:function(){throw"Error: UserConstraint::__copy must be overriden"},__broken:function(){},__validate:function(){},__draw:function(t){},__prepare:function(){},__position:function(t){throw"Error: UserConstraint::__position must be overriden"},__velocity:function(t){throw"Error: Userconstraint::__velocity must be overriden"},__eff_mass:function(t){throw"Error: UserConstraint::__eff_mass must be overriden"},__clamp:function(t){},__impulse:function(t,n,e){throw"Error: UserConstraint::__impulse must be overriden"},impulse:function(){for(var t=new p.geom.MatMN(this.zpp_inner_zn.dim,1),n=0,e=this.zpp_inner_zn.dim;n<e;){var i=n++;if(i<0||i>=t.zpp_inner.m||0>=t.zpp_inner.n)throw"Error: MatMN indices out of range";t.zpp_inner.x[i*t.zpp_inner.n]=this.zpp_inner_zn.jAcc[i]}return t},bodyImpulse:function(t){if(null==t)throw"Error: Cannot evaluate impulse on null body";for(var n=!1,e=0,i=this.zpp_inner_zn.bodies;e<i.length;){var r=i[e];if(++e,r.body==t.zpp_inner){n=!0;break}}if(!n)throw"Error: Body is not linked to this constraint";return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(t.zpp_inner):p.geom.Vec3.get()},visitBodies:function(t){for(var n=0,e=this.zpp_inner_zn.bodies.length;n<e;){var i=this.zpp_inner_zn.bodies[n];if(null!=i.body){for(var r=!1,s=n+1;s<e;){var l=s++;if(this.zpp_inner_zn.bodies[l].body==i.body){r=!0;break}}r||t(i.body.outer)}n++}},__invalidate:function(){this.zpp_inner.immutable_midstep("UserConstraint::invalidate()"),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner.wake()},__registerBody:function(t,n){if(this.zpp_inner.immutable_midstep("UserConstraint::registerBody(..)"),t!=n){if(null!=t){if(!this.zpp_inner_zn.remBody(t.zpp_inner))throw"Error: oldBody is not registered to the cosntraint";this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&t.zpp_inner.wake()}null!=n&&this.zpp_inner_zn.addBody(n.zpp_inner),this.zpp_inner.wake(),null!=n&&n.zpp_inner.wake()}return n},__class__:p.constraint.UserConstraint}),p.constraint.WeldJoint=function(t,n,e,i,r){if(null==r&&(r=0),this.zpp_inner_zn=null,this.zpp_inner_zn=new o.constraint.ZPP_WeldJoint,this.zpp_inner=this.zpp_inner_zn,this.zpp_inner.outer=this,this.zpp_inner_zn.outer_zn=this,p.constraint.Constraint.zpp_internalAlloc=!0,p.constraint.Constraint.call(this),p.constraint.Constraint.zpp_internalAlloc=!1,this.set_body1(t),this.set_body2(n),null!=e&&e.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==e)throw"Error: Constraint::anchor1 cannot be null";if(function(t){return null==t.zpp_inner_zn.wrap_a1&&t.zpp_inner_zn.setup_a1(),t.zpp_inner_zn.wrap_a1}(this).set(e),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1,null!=i&&i.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==i)throw"Error: Constraint::anchor2 cannot be null";if(function(t){return null==t.zpp_inner_zn.wrap_a2&&t.zpp_inner_zn.setup_a2(),t.zpp_inner_zn.wrap_a2}(this).set(i),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2,this.zpp_inner.immutable_midstep("WeldJoint::phase"),r!=r)throw"Error: WeldJoint::phase cannot be NaN";this.zpp_inner_zn.phase!=r&&(this.zpp_inner_zn.phase=r,this.zpp_inner.wake()),this.zpp_inner_zn.phase},p.constraint.WeldJoint.__name__=!0,p.constraint.WeldJoint.__super__=p.constraint.Constraint,p.constraint.WeldJoint.prototype=t(p.constraint.Constraint.prototype,{get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(t){this.zpp_inner.immutable_midstep("Constraint::body1");var n;return n=null==t?null:t.zpp_inner,n!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=n,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=n&&this.zpp_inner_zn.b2!=n&&null!=n&&n.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=n&&n.wake())),null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(t){this.zpp_inner.immutable_midstep("Constraint::body2");var n;return n=null==t?null:t.zpp_inner,n!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=n,null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&null!=n&&this.zpp_inner_zn.b1!=n&&null!=n&&n.constraints.add(this.zpp_inner),this.zpp_inner.active&&null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.wake(),null!=n&&n.wake())),null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},get_anchor1:function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},set_anchor1:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Constraint::anchor1 cannot be null";return function(t){return null==t.zpp_inner_zn.wrap_a1&&t.zpp_inner_zn.setup_a1(),t.zpp_inner_zn.wrap_a1}(this).set(t),null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},get_anchor2:function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},set_anchor2:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Constraint::anchor2 cannot be null";return function(t){return null==t.zpp_inner_zn.wrap_a2&&t.zpp_inner_zn.setup_a2(),t.zpp_inner_zn.wrap_a2}(this).set(t),null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},get_phase:function(){return this.zpp_inner_zn.phase},set_phase:function(t){if(this.zpp_inner.immutable_midstep("WeldJoint::phase"),t!=t)throw"Error: WeldJoint::phase cannot be NaN";return this.zpp_inner_zn.phase!=t&&(this.zpp_inner_zn.phase=t,this.zpp_inner.wake()),this.zpp_inner_zn.phase},impulse:function(){var t=new p.geom.MatMN(3,1);if(0>=t.zpp_inner.m||0>=t.zpp_inner.n)throw"Error: MatMN indices out of range";if(t.zpp_inner.x[0*t.zpp_inner.n]=this.zpp_inner_zn.jAccx,1>=t.zpp_inner.m||0>=t.zpp_inner.n)throw"Error: MatMN indices out of range";if(t.zpp_inner.x[t.zpp_inner.n]=this.zpp_inner_zn.jAccy,1>=t.zpp_inner.m||0>=t.zpp_inner.n)throw"Error: MatMN indices out of range";return t.zpp_inner.x[t.zpp_inner.n]=this.zpp_inner_zn.jAccz,t},bodyImpulse:function(t){if(null==t)throw"Error: Cannot evaluate impulse on null body";if(t!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer))throw"Error: Body is not linked to this constraint";return this.zpp_inner.active?this.zpp_inner_zn.bodyImpulse(t.zpp_inner):p.geom.Vec3.get()},visitBodies:function(t){null!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer),null!=(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)&&(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)!=(null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer)&&t(null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer)},__class__:p.constraint.WeldJoint}),p.dynamics={},p.dynamics.Arbiter=function(){if(this.zpp_inner=null,!o.dynamics.ZPP_Arbiter.internal)throw"Error: Cannot instantiate Arbiter derp!"},p.dynamics.Arbiter.__name__=!0,p.dynamics.Arbiter.prototype={get_isSleeping:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";return this.zpp_inner.sleeping},get_type:function(){return o.dynamics.ZPP_Arbiter.types[this.zpp_inner.type]},isCollisionArbiter:function(){return this.zpp_inner.type==o.dynamics.ZPP_Arbiter.COL},isFluidArbiter:function(){return this.zpp_inner.type==o.dynamics.ZPP_Arbiter.FLUID},isSensorArbiter:function(){return this.zpp_inner.type==o.dynamics.ZPP_Arbiter.SENSOR},get_collisionArbiter:function(){return this.zpp_inner.type==o.dynamics.ZPP_Arbiter.COL?this.zpp_inner.colarb.outer_zn:null},get_fluidArbiter:function(){return this.zpp_inner.type==o.dynamics.ZPP_Arbiter.FLUID?this.zpp_inner.fluidarb.outer_zn:null},get_shape1:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";return this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer},get_shape2:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";return this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer},get_body1:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";return this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b2.outer:this.zpp_inner.b1.outer},get_body2:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";return this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b1.outer:this.zpp_inner.b2.outer},get_state:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";var t=this.zpp_inner.immState;if(t==(o.util.ZPP_Flags.id_ImmState_ACCEPT|o.util.ZPP_Flags.id_ImmState_ALWAYS))return null==o.util.ZPP_Flags.PreFlag_ACCEPT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_ACCEPT=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_ACCEPT;var n=t;switch(t){case o.util.ZPP_Flags.id_ImmState_ACCEPT:return null==o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE;default:return n==(o.util.ZPP_Flags.id_ImmState_IGNORE|o.util.ZPP_Flags.id_ImmState_ALWAYS)?(null==o.util.ZPP_Flags.PreFlag_IGNORE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_IGNORE=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_IGNORE):(null==o.util.ZPP_Flags.PreFlag_IGNORE_ONCE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_IGNORE_ONCE=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_IGNORE_ONCE)}},totalImpulse:function(t,n){if(null==n&&(n=!1),!this.zpp_inner.active)throw"Error: Arbiter not currently in use";if(null!=t&&t!=function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.b2.outer:t.zpp_inner.b1.outer}(this)&&t!=function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.b1.outer:t.zpp_inner.b2.outer}(this))throw"Error: Arbiter does not relate to body";return p.geom.Vec3.get(0,0,0)},toString:function(){var t;return t=this.zpp_inner.type==o.dynamics.ZPP_Arbiter.COL?"CollisionArbiter":this.zpp_inner.type==o.dynamics.ZPP_Arbiter.FLUID?"FluidArbiter":"SensorArbiter",this.zpp_inner.cleared?t+"(object-pooled)":t+"("+function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.ws2.outer:t.zpp_inner.ws1.outer}(this).toString()+"|"+function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.ws1.outer:t.zpp_inner.ws2.outer}(this).toString()+")"+(this.zpp_inner.type==o.dynamics.ZPP_Arbiter.COL?"["+["SD","DD"][this.zpp_inner.colarb.stat?0:1]+"]":"")+"<-"+this.get_state().toString()},__class__:p.dynamics.Arbiter},p.dynamics.ArbiterIterator=function(){if(this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null,!o.util.ZPP_ArbiterList.internal)throw"Error: Cannot instantiate ArbiterIterator derp!"},p.dynamics.ArbiterIterator.__name__=!0,p.dynamics.ArbiterIterator.get=function(t){var n;if(null==p.dynamics.ArbiterIterator.zpp_pool){o.util.ZPP_ArbiterList.internal=!0;var e=new p.dynamics.ArbiterIterator;o.util.ZPP_ArbiterList.internal=!1,n=e}else{var i=p.dynamics.ArbiterIterator.zpp_pool;p.dynamics.ArbiterIterator.zpp_pool=i.zpp_next,n=i}return n.zpp_i=0,n.zpp_inner=t,n.zpp_critical=!1,n},p.dynamics.ArbiterIterator.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.zpp_gl();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=p.dynamics.ArbiterIterator.zpp_pool,p.dynamics.ArbiterIterator.zpp_pool=this,this.zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:p.dynamics.ArbiterIterator},p.dynamics.ArbiterList=function(){this.zpp_inner=null,this.zpp_inner=new o.util.ZPP_ArbiterList,this.zpp_inner.outer=this},p.dynamics.ArbiterList.__name__=!0,p.dynamics.ArbiterList.fromArray=function(t){if(null==t)throw"Error: Cannot convert null Array to Nape list";for(var n=new p.dynamics.ArbiterList,e=0;e<t.length;){var i=t[e];++e,n.push(i)}return n},p.dynamics.ArbiterList.prototype={get_length:function(){return this.zpp_gl()},zpp_gl:function(){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var t=this.zpp_inner.inner.head;null!=t;){t.elt.active&&this.zpp_inner.user_length++,t=t.next}}return this.zpp_inner.user_length},zpp_vm:function(){this.zpp_inner.valmod()},has:function(t){return this.zpp_vm(),this.zpp_inner.inner.has(t.zpp_inner)},at:function(t){if(this.zpp_vm(),t<0||t>=this.zpp_gl())throw"Error: Index out of bounds 4";if(this.zpp_inner.reverse_flag&&(t=this.zpp_gl()-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)for(this.zpp_inner.at_index=0,this.zpp_inner.at_ite=this.zpp_inner.inner.head;;){var n=this.zpp_inner.at_ite.elt;if(n.active)break;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}for(;this.zpp_inner.at_index!=t;)for(this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;;){var e=this.zpp_inner.at_ite.elt;if(e.active)break;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}return this.zpp_inner.at_ite.elt.wrapper()},push:function(t){if(this.zpp_inner.immutable)throw"Error: ArbiterList is immutable";this.zpp_inner.modify_test(),this.zpp_vm();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(this.empty()?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},unshift:function(t){if(this.zpp_inner.immutable)throw"Error: ArbiterList is immutable";this.zpp_inner.modify_test(),this.zpp_vm();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.empty()?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},pop:function(){if(this.zpp_inner.immutable)throw"Error: ArbiterList is immutable";if(this.zpp_inner.modify_test(),this.empty())throw"Error: Cannot remove from empty list";this.zpp_vm();var t=null;if(this.zpp_inner.reverse_flag){t=this.zpp_inner.inner.head.elt;var n=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var e;e=1==this.zpp_gl()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2),t=null==e?this.zpp_inner.inner.head.elt:e.next.elt;var i=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)}return this.zpp_inner.invalidate(),t.wrapper()},shift:function(){if(this.zpp_inner.immutable)throw"Error: ArbiterList is immutable";if(this.zpp_inner.modify_test(),this.empty())throw"Error: Cannot remove from empty list";this.zpp_vm();var t=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n;n=1==this.zpp_gl()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2),t=null==n?this.zpp_inner.inner.head.elt:n.next.elt;var e=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}else{t=this.zpp_inner.inner.head.elt;var i=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),t.wrapper()},add:function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},remove:function(t){if(this.zpp_inner.immutable)throw"Error: ArbiterList is immutable";this.zpp_inner.modify_test(),this.zpp_vm();var n;n=!1;for(var e=this.zpp_inner.inner.head;null!=e;){if(e.elt==t.zpp_inner){n=!0;break}e=e.next}return n&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),n},clear:function(){if(this.zpp_inner.immutable)throw"Error: ArbiterList is immutable";if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return 0==this.zpp_gl()},iterator:function(){return this.zpp_vm(),p.dynamics.ArbiterIterator.get(this)},copy:function(t){null==t&&(t=!1);for(var n=new p.dynamics.ArbiterList,e=this.iterator();e.hasNext();){var i;e.zpp_critical=!1,i=e.zpp_inner.at(e.zpp_i++),n.push(t?function(t){throw"Error: Arbiter is not a copyable type"}():i)}return n},merge:function(t){if(null==t)throw"Error: Cannot merge with null list";for(var n=t.iterator();n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),this.has(e)||this.add(e)}},toString:function(){for(var t="[",n=!0,e=this.iterator();e.hasNext();){var i;e.zpp_critical=!1,i=e.zpp_inner.at(e.zpp_i++),n||(t+=","),t+=null==i?"NULL":i.toString(),n=!1}return t+"]"},foreach:function(t){if(null==t)throw"Error: Cannot execute null on list elements";for(var n=this.iterator();n.hasNext();)try{t(function(t){return n.zpp_critical=!1,n.zpp_inner.at(n.zpp_i++)}())}catch(t){n.zpp_next=p.dynamics.ArbiterIterator.zpp_pool,p.dynamics.ArbiterIterator.zpp_pool=n,n.zpp_inner=null;break}return this},filter:function(t){if(null==t)throw"Error: Cannot select elements of list with null";for(var n=0;n<this.zpp_gl();){var e=this.at(n);try{t(e)?n++:this.remove(e)}catch(t){break}}return this},__class__:p.dynamics.ArbiterList},p.dynamics.ArbiterType=function(){if(!o.util.ZPP_Flags.internal)throw"Error: Cannot instantiate ArbiterType derp!"},p.dynamics.ArbiterType.__name__=!0,p.dynamics.ArbiterType.get_COLLISION=function(){return null==o.util.ZPP_Flags.ArbiterType_COLLISION&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ArbiterType_COLLISION=new p.dynamics.ArbiterType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ArbiterType_COLLISION},p.dynamics.ArbiterType.get_SENSOR=function(){return null==o.util.ZPP_Flags.ArbiterType_SENSOR&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ArbiterType_SENSOR=new p.dynamics.ArbiterType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ArbiterType_SENSOR},p.dynamics.ArbiterType.get_FLUID=function(){return null==o.util.ZPP_Flags.ArbiterType_FLUID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ArbiterType_FLUID=new p.dynamics.ArbiterType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ArbiterType_FLUID},p.dynamics.ArbiterType.prototype={toString:function(){return this==function(t){return null==o.util.ZPP_Flags.ArbiterType_COLLISION&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ArbiterType_COLLISION=new p.dynamics.ArbiterType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ArbiterType_COLLISION}()?"COLLISION":this==function(t){return null==o.util.ZPP_Flags.ArbiterType_SENSOR&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ArbiterType_SENSOR=new p.dynamics.ArbiterType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ArbiterType_SENSOR}()?"SENSOR":this==function(t){return null==o.util.ZPP_Flags.ArbiterType_FLUID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ArbiterType_FLUID=new p.dynamics.ArbiterType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ArbiterType_FLUID}()?"FLUID":""},__class__:p.dynamics.ArbiterType},p.dynamics.CollisionArbiter=function(){if(!o.dynamics.ZPP_Arbiter.internal)throw"Error: Cannot instantiate CollisionArbiter derp!";p.dynamics.Arbiter.call(this)},p.dynamics.CollisionArbiter.__name__=!0,p.dynamics.CollisionArbiter.__super__=p.dynamics.Arbiter,p.dynamics.CollisionArbiter.prototype=t(p.dynamics.Arbiter.prototype,{get_contacts:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";return null==this.zpp_inner.colarb.wrap_contacts&&this.zpp_inner.colarb.setupcontacts(),this.zpp_inner.colarb.wrap_contacts},get_normal:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";return null==this.zpp_inner.colarb.wrap_normal&&this.zpp_inner.colarb.getnormal(),this.zpp_inner.colarb.wrap_normal},get_radius:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";return this.zpp_inner.colarb.radius},get_referenceEdge1:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";var t=this.zpp_inner.colarb.__ref_edge1;return null==t||function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.ws2.outer:t.zpp_inner.ws1.outer}(this).isPolygon()&&function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.ws2.outer:t.zpp_inner.ws1.outer}(this).zpp_inner==t.polygon||(t=this.zpp_inner.colarb.__ref_edge2),null==t?null:t.wrapper()},get_referenceEdge2:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";var t=this.zpp_inner.colarb.__ref_edge1;return null==t||function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.ws1.outer:t.zpp_inner.ws2.outer}(this).isPolygon()&&function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.ws1.outer:t.zpp_inner.ws2.outer}(this).zpp_inner==t.polygon||(t=this.zpp_inner.colarb.__ref_edge2),null==t?null:t.wrapper()},firstVertex:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";return!(null!=this.zpp_inner.colarb.__ref_edge1==(null!=this.zpp_inner.colarb.__ref_edge2))&&-1==this.zpp_inner.colarb.__ref_vertex},secondVertex:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";return!(null!=this.zpp_inner.colarb.__ref_edge1==(null!=this.zpp_inner.colarb.__ref_edge2))&&1==this.zpp_inner.colarb.__ref_vertex},normalImpulse:function(t,n){if(null==n&&(n=!1),!this.zpp_inner.active)throw"Error: Arbiter not currently in use";if(null!=t&&t!=function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.b2.outer:t.zpp_inner.b1.outer}(this)&&t!=function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.b1.outer:t.zpp_inner.b2.outer}(this))throw"Error: Arbiter does not relate to body";var e=0,i=0,r=0,s=this.zpp_inner.colarb;if(!n||s.oc1.fresh){var l=s.oc1.wrapper().normalImpulse(t);e+=1*function(t){if(null!=l&&l.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return l.zpp_inner.validate(),l.zpp_inner.x}(),i+=1*function(t){if(null!=l&&l.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return l.zpp_inner.validate(),l.zpp_inner.y}(),r+=1*function(t){if(null!=l&&l.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return l.zpp_inner.validate(),l.zpp_inner.z}(),l.dispose()}if(s.hc2&&(!n||s.oc2.fresh)){var a=s.oc2.wrapper().normalImpulse(t);e+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.x}(),
i+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.y}(),r+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.z}(),a.dispose()}return p.geom.Vec3.get(e,i,r)},tangentImpulse:function(t,n){if(null==n&&(n=!1),!this.zpp_inner.active)throw"Error: Arbiter not currently in use";if(null!=t&&t!=function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.b2.outer:t.zpp_inner.b1.outer}(this)&&t!=function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.b1.outer:t.zpp_inner.b2.outer}(this))throw"Error: Arbiter does not relate to body";var e=0,i=0,r=0,s=this.zpp_inner.colarb;if(!n||s.oc1.fresh){var l=s.oc1.wrapper().tangentImpulse(t);e+=1*function(t){if(null!=l&&l.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return l.zpp_inner.validate(),l.zpp_inner.x}(),i+=1*function(t){if(null!=l&&l.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return l.zpp_inner.validate(),l.zpp_inner.y}(),r+=1*function(t){if(null!=l&&l.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return l.zpp_inner.validate(),l.zpp_inner.z}(),l.dispose()}if(s.hc2&&(!n||s.oc2.fresh)){var a=s.oc2.wrapper().tangentImpulse(t);e+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.x}(),i+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.y}(),r+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.z}(),a.dispose()}return p.geom.Vec3.get(e,i,r)},totalImpulse:function(t,n){if(null==n&&(n=!1),!this.zpp_inner.active)throw"Error: Arbiter not currently in use";if(null!=t&&t!=function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.b2.outer:t.zpp_inner.b1.outer}(this)&&t!=function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.b1.outer:t.zpp_inner.b2.outer}(this))throw"Error: Arbiter does not relate to body";var e=0,i=0,r=0,s=this.zpp_inner.colarb;if(!n||s.oc1.fresh){var l=s.oc1.wrapper().totalImpulse(t);e+=1*function(t){if(null!=l&&l.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return l.zpp_inner.validate(),l.zpp_inner.x}(),i+=1*function(t){if(null!=l&&l.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return l.zpp_inner.validate(),l.zpp_inner.y}(),r+=1*function(t){if(null!=l&&l.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return l.zpp_inner.validate(),l.zpp_inner.z}(),l.dispose()}if(s.hc2&&(!n||s.oc2.fresh)){var a=s.oc2.wrapper().totalImpulse(t);e+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.x}(),i+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.y}(),r+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.z}(),a.dispose()}return p.geom.Vec3.get(e,i,r)},rollingImpulse:function(t,n){if(null==n&&(n=!1),!this.zpp_inner.active)throw"Error: Arbiter not currently in use";if(null!=t&&t!=function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.b2.outer:t.zpp_inner.b1.outer}(this)&&t!=function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.b1.outer:t.zpp_inner.b2.outer}(this))throw"Error: Arbiter does not relate to body";var e=this.zpp_inner.colarb;return!n||e.oc1.fresh?e.oc1.wrapper().rollingImpulse(t):0},get_elasticity:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";var t=this.zpp_inner.colarb;return t.invalidated&&(t.invalidated=!1,t.userdef_restitution||(t.s1.material.elasticity<=Math.NEGATIVE_INFINITY||t.s2.material.elasticity<=Math.NEGATIVE_INFINITY?t.restitution=0:t.s1.material.elasticity>=Math.POSITIVE_INFINITY||t.s2.material.elasticity>=Math.POSITIVE_INFINITY?t.restitution=1:t.restitution=(t.s1.material.elasticity+t.s2.material.elasticity)/2,t.restitution<0&&(t.restitution=0),t.restitution>1&&(t.restitution=1)),t.userdef_dyn_fric||(t.dyn_fric=Math.sqrt(t.s1.material.dynamicFriction*t.s2.material.dynamicFriction)),t.userdef_stat_fric||(t.stat_fric=Math.sqrt(t.s1.material.staticFriction*t.s2.material.staticFriction)),t.userdef_rfric||(t.rfric=Math.sqrt(t.s1.material.rollingFriction*t.s2.material.rollingFriction))),t.restitution},set_elasticity:function(t){if(!this.zpp_inner.colarb.mutable)throw"Error: CollisionArbiter::elasticity is only mutable during a pre-handler";if(t!=t)throw"Error: CollisionArbiter::elasticity cannot be NaN";if(t<0)throw"Error: CollisionArbiter::elasticity cannot be negative";var n=this.zpp_inner.colarb;return n.restitution=t,n.userdef_restitution=!0,this.get_elasticity()},get_dynamicFriction:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";var t=this.zpp_inner.colarb;return t.invalidated&&(t.invalidated=!1,t.userdef_restitution||(t.s1.material.elasticity<=Math.NEGATIVE_INFINITY||t.s2.material.elasticity<=Math.NEGATIVE_INFINITY?t.restitution=0:t.s1.material.elasticity>=Math.POSITIVE_INFINITY||t.s2.material.elasticity>=Math.POSITIVE_INFINITY?t.restitution=1:t.restitution=(t.s1.material.elasticity+t.s2.material.elasticity)/2,t.restitution<0&&(t.restitution=0),t.restitution>1&&(t.restitution=1)),t.userdef_dyn_fric||(t.dyn_fric=Math.sqrt(t.s1.material.dynamicFriction*t.s2.material.dynamicFriction)),t.userdef_stat_fric||(t.stat_fric=Math.sqrt(t.s1.material.staticFriction*t.s2.material.staticFriction)),t.userdef_rfric||(t.rfric=Math.sqrt(t.s1.material.rollingFriction*t.s2.material.rollingFriction))),t.dyn_fric},set_dynamicFriction:function(t){if(!this.zpp_inner.colarb.mutable)throw"Error: CollisionArbiter::dynamicFriction is only mutable during a pre-handler";if(t!=t)throw"Error: CollisionArbiter::dynamicFriction cannot be NaN";if(t<0)throw"Error: CollisionArbiter::dynamicFriction cannot be negative";var n=this.zpp_inner.colarb;return n.dyn_fric=t,n.userdef_dyn_fric=!0,this.get_dynamicFriction()},get_staticFriction:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";var t=this.zpp_inner.colarb;return t.invalidated&&(t.invalidated=!1,t.userdef_restitution||(t.s1.material.elasticity<=Math.NEGATIVE_INFINITY||t.s2.material.elasticity<=Math.NEGATIVE_INFINITY?t.restitution=0:t.s1.material.elasticity>=Math.POSITIVE_INFINITY||t.s2.material.elasticity>=Math.POSITIVE_INFINITY?t.restitution=1:t.restitution=(t.s1.material.elasticity+t.s2.material.elasticity)/2,t.restitution<0&&(t.restitution=0),t.restitution>1&&(t.restitution=1)),t.userdef_dyn_fric||(t.dyn_fric=Math.sqrt(t.s1.material.dynamicFriction*t.s2.material.dynamicFriction)),t.userdef_stat_fric||(t.stat_fric=Math.sqrt(t.s1.material.staticFriction*t.s2.material.staticFriction)),t.userdef_rfric||(t.rfric=Math.sqrt(t.s1.material.rollingFriction*t.s2.material.rollingFriction))),t.stat_fric},set_staticFriction:function(t){if(!this.zpp_inner.colarb.mutable)throw"Error: CollisionArbiter::staticFriction is only mutable during a pre-handler";if(t!=t)throw"Error: CollisionArbiter::staticFriction cannot be NaN";if(t<0)throw"Error: CollisionArbiter::staticFriction cannot be negative";var n=this.zpp_inner.colarb;return n.stat_fric=t,n.userdef_stat_fric=!0,this.get_staticFriction()},get_rollingFriction:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";var t=this.zpp_inner.colarb;return t.invalidated&&(t.invalidated=!1,t.userdef_restitution||(t.s1.material.elasticity<=Math.NEGATIVE_INFINITY||t.s2.material.elasticity<=Math.NEGATIVE_INFINITY?t.restitution=0:t.s1.material.elasticity>=Math.POSITIVE_INFINITY||t.s2.material.elasticity>=Math.POSITIVE_INFINITY?t.restitution=1:t.restitution=(t.s1.material.elasticity+t.s2.material.elasticity)/2,t.restitution<0&&(t.restitution=0),t.restitution>1&&(t.restitution=1)),t.userdef_dyn_fric||(t.dyn_fric=Math.sqrt(t.s1.material.dynamicFriction*t.s2.material.dynamicFriction)),t.userdef_stat_fric||(t.stat_fric=Math.sqrt(t.s1.material.staticFriction*t.s2.material.staticFriction)),t.userdef_rfric||(t.rfric=Math.sqrt(t.s1.material.rollingFriction*t.s2.material.rollingFriction))),t.rfric},set_rollingFriction:function(t){if(!this.zpp_inner.colarb.mutable)throw"Error: CollisionArbiter::rollingFriction is only mutable during a pre-handler";if(t!=t)throw"Error: CollisionArbiter::rollingFriction cannot be NaN";if(t<0)throw"Error: CollisionArbiter::rollingFriction cannot be negative";var n=this.zpp_inner.colarb;return n.rfric=t,n.userdef_rfric=!0,this.get_rollingFriction()},__class__:p.dynamics.CollisionArbiter}),p.dynamics.Contact=function(){if(this.zpp_inner=null,!o.dynamics.ZPP_Contact.internal)throw"Error: Cannot instantiate Contact derp!"},p.dynamics.Contact.__name__=!0,p.dynamics.Contact.prototype={get_arbiter:function(){return null==this.zpp_inner.arbiter?null:this.zpp_inner.arbiter.outer.get_collisionArbiter()},get_penetration:function(){if(this.zpp_inner.inactiveme())throw"Error: Contact not currently in use";return-this.zpp_inner.dist},get_position:function(){if(this.zpp_inner.inactiveme())throw"Error: Contact not currently in use";return null==this.zpp_inner.wrap_position&&this.zpp_inner.getposition(),this.zpp_inner.wrap_position},get_fresh:function(){if(this.zpp_inner.inactiveme())throw"Error: Contact not currently in use";return this.zpp_inner.fresh},normalImpulse:function(t){if(this.zpp_inner.inactiveme())throw"Error: Contact not currently in use";var n=this.zpp_inner.arbiter.colarb,e=this.zpp_inner.inner,i=e.jnAcc;if(null==t)return p.geom.Vec3.get(n.nx*i,n.ny*i);if(t!=n.b1.outer&&t!=n.b2.outer)throw"Error: Contact does not relate to the given body";return t==n.b1.outer?p.geom.Vec3.get(n.nx*-i,n.ny*-i,-(n.ny*e.r1x-n.nx*e.r1y)*i):p.geom.Vec3.get(n.nx*i,n.ny*i,(n.ny*e.r2x-n.nx*e.r2y)*i)},tangentImpulse:function(t){if(this.zpp_inner.inactiveme())throw"Error: Contact not currently in use";var n=this.zpp_inner.arbiter.colarb,e=this.zpp_inner.inner,i=e.jtAcc;if(null==t)return p.geom.Vec3.get(-n.ny*i,n.nx*i);if(t!=n.b1.outer&&t!=n.b2.outer)throw"Error: Contact does not relate to the given body";return t==n.b1.outer?p.geom.Vec3.get(n.ny*i,-n.nx*i,-(e.r1x*n.nx+e.r1y*n.ny)*i):p.geom.Vec3.get(-n.ny*i,n.nx*i,(e.r2x*n.nx+e.r2y*n.ny)*i)},rollingImpulse:function(t){if(this.zpp_inner.inactiveme())throw"Error: Contact not currently in use";var n=this.zpp_inner.arbiter.colarb,e=this.zpp_inner.arbiter.colarb.jrAcc;if(null==t)return e;if(t!=n.b1.outer&&t!=n.b2.outer)throw"Error: Contact does not relate to the given body";return t==n.b1.outer?-e:e},totalImpulse:function(t){if(this.zpp_inner.inactiveme())throw"Error: Contact not currently in use";var n=this.zpp_inner.arbiter.colarb,e=this.zpp_inner.inner,i=e.jnAcc,r=e.jtAcc,s=n.jrAcc;if(null==t)return p.geom.Vec3.get(n.nx*i-n.ny*r,n.ny*i+n.nx*r,s);if(t!=n.b1.outer&&t!=n.b2.outer)throw"Error: Contact does not relate to the given body";var l=n.nx*i-n.ny*r,a=n.ny*i+n.nx*r;return t==n.b1.outer?p.geom.Vec3.get(-l,-a,-(a*e.r1x-l*e.r1y)-s):p.geom.Vec3.get(l,a,a*e.r2x-l*e.r2y+s)},get_friction:function(){if(this.zpp_inner.inactiveme())throw"Error: Contact not currently in use";return this.zpp_inner.inner.friction},toString:function(){return null==this.zpp_inner.arbiter||this.zpp_inner.arbiter.cleared?"{object-pooled}":"{Contact}"},__class__:p.dynamics.Contact},p.dynamics.ContactIterator=function(){if(this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null,!o.util.ZPP_ContactList.internal)throw"Error: Cannot instantiate ContactIterator derp!"},p.dynamics.ContactIterator.__name__=!0,p.dynamics.ContactIterator.get=function(t){var n;if(null==p.dynamics.ContactIterator.zpp_pool){o.util.ZPP_ContactList.internal=!0;var e=new p.dynamics.ContactIterator;o.util.ZPP_ContactList.internal=!1,n=e}else{var i=p.dynamics.ContactIterator.zpp_pool;p.dynamics.ContactIterator.zpp_pool=i.zpp_next,n=i}return n.zpp_i=0,n.zpp_inner=t,n.zpp_critical=!1,n},p.dynamics.ContactIterator.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=p.dynamics.ContactIterator.zpp_pool,p.dynamics.ContactIterator.zpp_pool=this,this.zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:p.dynamics.ContactIterator},p.dynamics.ContactList=function(){this.zpp_inner=null,this.zpp_inner=new o.util.ZPP_ContactList,this.zpp_inner.outer=this},p.dynamics.ContactList.__name__=!0,p.dynamics.ContactList.fromArray=function(t){if(null==t)throw"Error: Cannot convert null Array to Nape list";for(var n=new p.dynamics.ContactList,e=0;e<t.length;){var i=t[e];++e,n.push(i)}return n},p.dynamics.ContactList.prototype={get_length:function(){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var t=this.zpp_inner.inner.next;null!=t;){var n=t;n.active&&n.arbiter.active&&this.zpp_inner.user_length++,t=t.next}}return this.zpp_inner.user_length},has:function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},at:function(t){if(this.zpp_inner.valmod(),t<0||t>=this.get_length())throw"Error: Index out of bounds 5";if(this.zpp_inner.reverse_flag&&(t=this.get_length()-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)for(this.zpp_inner.at_index=0,this.zpp_inner.at_ite=this.zpp_inner.inner.next;;){var n=this.zpp_inner.at_ite;if(n.active&&n.arbiter.active)break;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}for(;this.zpp_inner.at_index!=t;)for(this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;;){var e=this.zpp_inner.at_ite;if(e.active&&e.arbiter.active)break;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}return this.zpp_inner.at_ite.wrapper()},push:function(t){if(this.zpp_inner.immutable)throw"Error: ContactList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(0==this.get_length()?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},unshift:function(t){if(this.zpp_inner.immutable)throw"Error: ContactList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(0==this.get_length()?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},pop:function(){if(this.zpp_inner.immutable)throw"Error: ContactList is immutable";if(this.zpp_inner.modify_test(),0==this.get_length())throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){t=this.zpp_inner.inner.next;var n=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var e;e=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==e?this.zpp_inner.inner.next:e.next;var i=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)}return this.zpp_inner.invalidate(),t.wrapper()},shift:function(){if(this.zpp_inner.immutable)throw"Error: ContactList is immutable";if(this.zpp_inner.modify_test(),0==this.get_length())throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n;n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==n?this.zpp_inner.inner.next:n.next;var e=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}else{t=this.zpp_inner.inner.next;var i=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),t.wrapper()},add:function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},remove:function(t){if(this.zpp_inner.immutable)throw"Error: ContactList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;n=!1;for(var e=this.zpp_inner.inner.next;null!=e;){if(e==t.zpp_inner){n=!0;break}e=e.next}return n&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),n},clear:function(){if(this.zpp_inner.immutable)throw"Error: ContactList is immutable";if(this.zpp_inner.reverse_flag)for(;0!=this.get_length();)this.pop();else for(;0!=this.get_length();)this.shift()},empty:function(){return 0==this.get_length()},iterator:function(){return this.zpp_inner.valmod(),p.dynamics.ContactIterator.get(this)},copy:function(t){null==t&&(t=!1);var n,e=new p.dynamics.ContactList;for(this.zpp_inner.valmod(),n=p.dynamics.ContactIterator.get(this);n.hasNext();){var i;n.zpp_critical=!1,i=n.zpp_inner.at(n.zpp_i++),e.push(t?function(t){throw"Error: Contact is not a copyable type"}():i)}return e},merge:function(t){if(null==t)throw"Error: Cannot merge with null list";var n;for(t.zpp_inner.valmod(),n=p.dynamics.ContactIterator.get(t);n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),this.has(e)||(this.zpp_inner.reverse_flag?this.push(e):this.unshift(e))}},toString:function(){var t,n="[",e=!0;for(this.zpp_inner.valmod(),t=p.dynamics.ContactIterator.get(this);t.hasNext();){var i;t.zpp_critical=!1,i=t.zpp_inner.at(t.zpp_i++),e||(n+=","),n+=null==i?"NULL":i.toString(),e=!1}return n+"]"},foreach:function(t){if(null==t)throw"Error: Cannot execute null on list elements";var n;for(this.zpp_inner.valmod(),n=p.dynamics.ContactIterator.get(this);n.hasNext();)try{t(function(t){return n.zpp_critical=!1,n.zpp_inner.at(n.zpp_i++)}())}catch(t){n.zpp_next=p.dynamics.ContactIterator.zpp_pool,p.dynamics.ContactIterator.zpp_pool=n,n.zpp_inner=null;break}return this},filter:function(t){if(null==t)throw"Error: Cannot select elements of list with null";for(var n=0;n<this.get_length();){var e=this.at(n);try{t(e)?n++:this.remove(e)}catch(t){break}}return this},__class__:p.dynamics.ContactList},p.dynamics.FluidArbiter=function(){if(!o.dynamics.ZPP_Arbiter.internal)throw"Error: Cannot instantiate FluidArbiter derp!";p.dynamics.Arbiter.call(this)},p.dynamics.FluidArbiter.__name__=!0,p.dynamics.FluidArbiter.__super__=p.dynamics.Arbiter,p.dynamics.FluidArbiter.prototype=t(p.dynamics.Arbiter.prototype,{get_position:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";return null==this.zpp_inner.fluidarb.wrap_position&&this.zpp_inner.fluidarb.getposition(),this.zpp_inner.fluidarb.wrap_position},set_position:function(t){if(!this.zpp_inner.fluidarb.mutable)throw"Error: Arbiter is mutable only within a pre-handler";if(null==t)throw"Error: FluidArbiter::position cannot be null";if(function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return null==t.zpp_inner.fluidarb.wrap_position&&t.zpp_inner.fluidarb.getposition(),t.zpp_inner.fluidarb.wrap_position}(this).set(t),!this.zpp_inner.active)throw"Error: Arbiter not currently in use";return null==this.zpp_inner.fluidarb.wrap_position&&this.zpp_inner.fluidarb.getposition(),this.zpp_inner.fluidarb.wrap_position},get_overlap:function(){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";return this.zpp_inner.fluidarb.overlap},set_overlap:function(t){if(!this.zpp_inner.fluidarb.mutable)throw"Error: Arbiter is mutable only within a pre-handler";if(t!=t)throw"Error: FluidArbiter::overlap cannot be NaN";if(t<=0||t==Math.POSITIVE_INFINITY)throw"Error: FluidArbiter::overlap must be strictly positive and non infinite";if(this.zpp_inner.fluidarb.overlap=t,!this.zpp_inner.active)throw"Error: Arbiter not currently in use";return this.zpp_inner.fluidarb.overlap},buoyancyImpulse:function(t){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";if(null!=t&&t!=function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.b2.outer:t.zpp_inner.b1.outer}(this)&&t!=function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.b1.outer:t.zpp_inner.b2.outer}(this))throw"Error: Arbiter does not relate to body";var n=this.zpp_inner.fluidarb;return null==t?p.geom.Vec3.get(n.buoyx,n.buoyy,0):t.zpp_inner==this.zpp_inner.b2?p.geom.Vec3.get(n.buoyx,n.buoyy,n.buoyy*n.r2x-n.buoyx*n.r2y):p.geom.Vec3.get(-n.buoyx,-n.buoyy,-(n.buoyy*n.r1x-n.buoyx*n.r1y))},dragImpulse:function(t){if(!this.zpp_inner.active)throw"Error: Arbiter not currently in use";if(null!=t&&t!=function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.b2.outer:t.zpp_inner.b1.outer}(this)&&t!=function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.b1.outer:t.zpp_inner.b2.outer}(this))throw"Error: Arbiter does not relate to body";var n,e=this.zpp_inner.fluidarb;return n=null==t||t.zpp_inner==this.zpp_inner.b2?1:-1,p.geom.Vec3.get(e.dampx*n,e.dampy*n,e.adamp*n)},totalImpulse:function(t,n){if(null==n&&(n=!1),!this.zpp_inner.active)throw"Error: Arbiter not currently in use";if(null!=t&&t!=function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.b2.outer:t.zpp_inner.b1.outer}(this)&&t!=function(t){if(!t.zpp_inner.active)throw"Error: Arbiter not currently in use";return t.zpp_inner.ws1.id>t.zpp_inner.ws2.id?t.zpp_inner.b1.outer:t.zpp_inner.b2.outer}(this))throw"Error: Arbiter does not relate to body";var e=this.buoyancyImpulse(t),i=this.dragImpulse(t),r=i;r.set_x(function(t){if(null!=r&&r.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return r.zpp_inner.validate(),r.zpp_inner.x}()+function(t){if(null!=e&&e.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return e.zpp_inner.validate(),e.zpp_inner.x}());var s=i;s.set_y(function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.y}()+function(t){if(null!=e&&e.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return e.zpp_inner.validate(),e.zpp_inner.y}());var l=i;return l.set_z(function(t){if(null!=l&&l.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return l.zpp_inner.validate(),l.zpp_inner.z}()+function(t){if(null!=e&&e.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return e.zpp_inner.validate(),e.zpp_inner.z}()),e.dispose(),i},__class__:p.dynamics.FluidArbiter}),p.dynamics.InteractionFilter=function(t,n,e,i,r,s){null==s&&(s=-1),null==r&&(r=1),null==i&&(i=-1),null==e&&(e=1),null==n&&(n=-1),null==t&&(t=1),this.zpp_inner=null,null==o.dynamics.ZPP_InteractionFilter.zpp_pool?this.zpp_inner=new o.dynamics.ZPP_InteractionFilter:(this.zpp_inner=o.dynamics.ZPP_InteractionFilter.zpp_pool,o.dynamics.ZPP_InteractionFilter.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null),this.zpp_inner.outer=this,this.zpp_inner.collisionGroup!=t&&(this.zpp_inner.collisionGroup=t,this.zpp_inner.invalidate()),this.zpp_inner.collisionGroup,this.zpp_inner.collisionMask!=n&&(this.zpp_inner.collisionMask=n,this.zpp_inner.invalidate()),this.zpp_inner.collisionMask,this.zpp_inner.sensorGroup!=e&&(this.zpp_inner.sensorGroup=e,this.zpp_inner.invalidate()),this.zpp_inner.sensorGroup,this.zpp_inner.sensorMask!=i&&(this.zpp_inner.sensorMask=i,this.zpp_inner.invalidate()),this.zpp_inner.sensorMask,this.zpp_inner.fluidGroup!=r&&(this.zpp_inner.fluidGroup=r,this.zpp_inner.invalidate()),this.zpp_inner.fluidGroup,this.zpp_inner.fluidMask!=s&&(this.zpp_inner.fluidMask=s,this.zpp_inner.invalidate()),this.zpp_inner.fluidMask},p.dynamics.InteractionFilter.__name__=!0,p.dynamics.InteractionFilter.prototype={get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_shapes:function(){return null==this.zpp_inner.wrap_shapes&&(this.zpp_inner.wrap_shapes=o.util.ZPP_ShapeList.get(this.zpp_inner.shapes,!0)),this.zpp_inner.wrap_shapes},get_collisionGroup:function(){return this.zpp_inner.collisionGroup},set_collisionGroup:function(t){return this.zpp_inner.collisionGroup!=t&&(this.zpp_inner.collisionGroup=t,this.zpp_inner.invalidate()),this.zpp_inner.collisionGroup},get_collisionMask:function(){return this.zpp_inner.collisionMask},set_collisionMask:function(t){return this.zpp_inner.collisionMask!=t&&(this.zpp_inner.collisionMask=t,this.zpp_inner.invalidate()),this.zpp_inner.collisionMask},get_sensorGroup:function(){return this.zpp_inner.sensorGroup},set_sensorGroup:function(t){return this.zpp_inner.sensorGroup!=t&&(this.zpp_inner.sensorGroup=t,this.zpp_inner.invalidate()),this.zpp_inner.sensorGroup},get_sensorMask:function(){return this.zpp_inner.sensorMask},set_sensorMask:function(t){return this.zpp_inner.sensorMask!=t&&(this.zpp_inner.sensorMask=t,this.zpp_inner.invalidate()),this.zpp_inner.sensorMask},get_fluidGroup:function(){return this.zpp_inner.fluidGroup},set_fluidGroup:function(t){return this.zpp_inner.fluidGroup!=t&&(this.zpp_inner.fluidGroup=t,this.zpp_inner.invalidate()),this.zpp_inner.fluidGroup},get_fluidMask:function(){return this.zpp_inner.fluidMask},set_fluidMask:function(t){return this.zpp_inner.fluidMask!=t&&(this.zpp_inner.fluidMask=t,this.zpp_inner.invalidate()),this.zpp_inner.fluidMask},shouldCollide:function(t){if(null==t)throw"Error: filter argument cannot be null for shouldCollide";return this.zpp_inner.shouldCollide(t.zpp_inner)},shouldSense:function(t){if(null==t)throw"Error: filter argument cannot be null for shouldSense";return this.zpp_inner.shouldSense(t.zpp_inner)},shouldFlow:function(t){if(null==t)throw"Error: filter argument cannot be null for shouldFlow";return this.zpp_inner.shouldFlow(t.zpp_inner)},copy:function(){return new p.dynamics.InteractionFilter(this.zpp_inner.collisionGroup,this.zpp_inner.collisionMask,this.zpp_inner.sensorGroup,this.zpp_inner.sensorMask,this.zpp_inner.fluidGroup,this.zpp_inner.fluidMask)},toString:function(){return"{ collision: "+s.hex(this.zpp_inner.collisionGroup,8)+"~"+s.hex(this.zpp_inner.collisionMask,8)+" sensor: "+s.hex(this.zpp_inner.sensorGroup,8)+"~"+s.hex(this.zpp_inner.sensorMask,8)+" fluid: "+s.hex(this.zpp_inner.fluidGroup,8)+"~"+s.hex(this.zpp_inner.fluidMask,8)+" }"},__class__:p.dynamics.InteractionFilter},p.dynamics.InteractionGroup=function(t){null==t&&(t=!1),this.zpp_inner=null,this.zpp_inner=new o.dynamics.ZPP_InteractionGroup,this.zpp_inner.outer=this,this.zpp_inner.ignore!=t&&(this.zpp_inner.invalidate(!0),this.zpp_inner.ignore=t),this.zpp_inner.ignore},p.dynamics.InteractionGroup.__name__=!0,p.dynamics.InteractionGroup.prototype={get_group:function(){return null==this.zpp_inner.group?null:this.zpp_inner.group.outer},set_group:function(t){if(t==this)throw"Error: Cannot assign InteractionGroup to itself";return this.zpp_inner.setGroup(null==t?null:t.zpp_inner),null==this.zpp_inner.group?null:this.zpp_inner.group.outer},get_ignore:function(){return this.zpp_inner.ignore},set_ignore:function(t){return this.zpp_inner.ignore!=t&&(this.zpp_inner.invalidate(!0),this.zpp_inner.ignore=t),this.zpp_inner.ignore},get_interactors:function(){return null==this.zpp_inner.wrap_interactors&&(this.zpp_inner.wrap_interactors=o.util.ZPP_InteractorList.get(this.zpp_inner.interactors,!0)),this.zpp_inner.wrap_interactors},get_groups:function(){return null==this.zpp_inner.wrap_groups&&(this.zpp_inner.wrap_groups=o.util.ZPP_InteractionGroupList.get(this.zpp_inner.groups,!0)),this.zpp_inner.wrap_groups},toString:function(){var t="InteractionGroup";return this.zpp_inner.ignore&&(t+=":ignore"),t},__class__:p.dynamics.InteractionGroup},p.dynamics.InteractionGroupIterator=function(){if(this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null,!o.util.ZPP_InteractionGroupList.internal)throw"Error: Cannot instantiate InteractionGroupIterator derp!"},p.dynamics.InteractionGroupIterator.__name__=!0,p.dynamics.InteractionGroupIterator.get=function(t){var n;if(null==p.dynamics.InteractionGroupIterator.zpp_pool){o.util.ZPP_InteractionGroupList.internal=!0;var e=new p.dynamics.InteractionGroupIterator;o.util.ZPP_InteractionGroupList.internal=!1,n=e}else{var i=p.dynamics.InteractionGroupIterator.zpp_pool;p.dynamics.InteractionGroupIterator.zpp_pool=i.zpp_next,n=i}return n.zpp_i=0,n.zpp_inner=t,n.zpp_critical=!1,n},p.dynamics.InteractionGroupIterator.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=p.dynamics.InteractionGroupIterator.zpp_pool,p.dynamics.InteractionGroupIterator.zpp_pool=this,this.zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:p.dynamics.InteractionGroupIterator},p.dynamics.InteractionGroupList=function(){this.zpp_inner=null,this.zpp_inner=new o.util.ZPP_InteractionGroupList,this.zpp_inner.outer=this},p.dynamics.InteractionGroupList.__name__=!0,p.dynamics.InteractionGroupList.fromArray=function(t){if(null==t)throw"Error: Cannot convert null Array to Nape list";for(var n=new p.dynamics.InteractionGroupList,e=0;e<t.length;){var i=t[e];++e,n.push(i)}return n},p.dynamics.InteractionGroupList.prototype={get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},at:function(t){if(this.zpp_inner.valmod(),t<0||t>=this.get_length())throw"Error: Index out of bounds 6";if(this.zpp_inner.reverse_flag&&(t=this.get_length()-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(t){if(this.zpp_inner.immutable)throw"Error: InteractionGroupList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),
this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},unshift:function(t){if(this.zpp_inner.immutable)throw"Error: InteractionGroupList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},pop:function(){if(this.zpp_inner.immutable)throw"Error: InteractionGroupList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){t=this.zpp_inner.inner.head.elt;var n=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var e;e=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==e?this.zpp_inner.inner.head.elt:e.next.elt;var i=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)}return this.zpp_inner.invalidate(),t.outer},shift:function(){if(this.zpp_inner.immutable)throw"Error: InteractionGroupList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n;n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==n?this.zpp_inner.inner.head.elt:n.next.elt;var e=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}else{t=this.zpp_inner.inner.head.elt;var i=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),t.outer},add:function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},remove:function(t){if(this.zpp_inner.immutable)throw"Error: InteractionGroupList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;n=!1;for(var e=this.zpp_inner.inner.head;null!=e;){if(e.elt==t.zpp_inner){n=!0;break}e=e.next}return n&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),n},clear:function(){if(this.zpp_inner.immutable)throw"Error: InteractionGroupList is immutable";if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){return this.zpp_inner.valmod(),p.dynamics.InteractionGroupIterator.get(this)},copy:function(t){null==t&&(t=!1);var n,e=new p.dynamics.InteractionGroupList;for(this.zpp_inner.valmod(),n=p.dynamics.InteractionGroupIterator.get(this);n.hasNext();){var i;n.zpp_critical=!1,i=n.zpp_inner.at(n.zpp_i++),e.push(t?function(t){throw"Error: InteractionGroup is not a copyable type"}():i)}return e},merge:function(t){if(null==t)throw"Error: Cannot merge with null list";var n;for(t.zpp_inner.valmod(),n=p.dynamics.InteractionGroupIterator.get(t);n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),this.has(e)||(this.zpp_inner.reverse_flag?this.push(e):this.unshift(e))}},toString:function(){var t,n="[",e=!0;for(this.zpp_inner.valmod(),t=p.dynamics.InteractionGroupIterator.get(this);t.hasNext();){var i;t.zpp_critical=!1,i=t.zpp_inner.at(t.zpp_i++),e||(n+=","),n+=null==i?"NULL":i.toString(),e=!1}return n+"]"},foreach:function(t){if(null==t)throw"Error: Cannot execute null on list elements";var n;for(this.zpp_inner.valmod(),n=p.dynamics.InteractionGroupIterator.get(this);n.hasNext();)try{t(function(t){return n.zpp_critical=!1,n.zpp_inner.at(n.zpp_i++)}())}catch(t){n.zpp_next=p.dynamics.InteractionGroupIterator.zpp_pool,p.dynamics.InteractionGroupIterator.zpp_pool=n,n.zpp_inner=null;break}return this},filter:function(t){if(null==t)throw"Error: Cannot select elements of list with null";for(var n=0;n<this.get_length();){var e=this.at(n);try{t(e)?n++:this.remove(e)}catch(t){break}}return this},__class__:p.dynamics.InteractionGroupList},p.geom={},p.geom.AABB=function(t,n,e,i){if(null==i&&(i=0),null==e&&(e=0),null==n&&(n=0),null==t&&(t=0),this.zpp_inner=null,t!=t||n!=n)throw"Error: AABB position cannot be NaN";if(e!=e||i!=i)throw"Error: AABB dimensions cannot be NaN";this.zpp_inner=o.geom.ZPP_AABB.get(t,n,t+e,n+i),this.zpp_inner.outer=this},p.geom.AABB.__name__=!0,p.geom.AABB.prototype={copy:function(){return this.zpp_inner.validate(),this.zpp_inner.copy().wrapper()},get_min:function(){return this.zpp_inner.getmin()},set_min:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner._immutable)throw"Error: AABB is immutable";if(null==t)throw"Error: Cannot assign null to AABB::min";if(function(t){return t.zpp_inner.validate(),t.zpp_inner.minx}(this)!=function(t){return t.zpp_inner.validate(),t.zpp_inner.minx}(this)||function(t){return t.zpp_inner.validate(),t.zpp_inner.miny}(this)!=function(t){return t.zpp_inner.validate(),t.zpp_inner.miny}(this))throw"Error: AABB::min components cannot be NaN";if(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()>this.zpp_inner.getmax().get_x())throw"Error: Assignment would cause negative width";if(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()>this.zpp_inner.getmax().get_y())throw"Error: Assignment would cause negative height";return this.zpp_inner.getmin().set(t),this.zpp_inner.getmin()},get_max:function(){return this.zpp_inner.getmax()},set_max:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner._immutable)throw"Error: AABB is immutable";if(null==t)throw"Error: Cannot assign null to AABB::max";if(function(t){return t.zpp_inner.validate(),t.zpp_inner.minx}(this)!=function(t){return t.zpp_inner.validate(),t.zpp_inner.minx}(this)||function(t){return t.zpp_inner.validate(),t.zpp_inner.miny}(this)!=function(t){return t.zpp_inner.validate(),t.zpp_inner.miny}(this))throw"Error: AABB::max components cannot be NaN";if(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()<this.zpp_inner.getmin().get_x())throw"Error: Assignment would cause negative width";if(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()<this.zpp_inner.getmin().get_y())throw"Error: Assignment would cause negative height";return this.zpp_inner.getmax().set(t),this.zpp_inner.getmax()},get_x:function(){return this.zpp_inner.validate(),this.zpp_inner.minx},set_x:function(t){if(this.zpp_inner._immutable)throw"Error: AABB is immutable";if(function(t){return t.zpp_inner.validate(),t.zpp_inner.minx}(this)!=t){if(t!=t)throw"Error: AABB::x cannot be NaN";this.zpp_inner.maxx+=t-this.zpp_inner.minx,this.zpp_inner.minx=t,this.zpp_inner.invalidate()}return this.zpp_inner.validate(),this.zpp_inner.minx},get_y:function(){return this.zpp_inner.validate(),this.zpp_inner.miny},set_y:function(t){if(this.zpp_inner._immutable)throw"Error: AABB is immutable";if(function(t){return t.zpp_inner.validate(),t.zpp_inner.miny}(this)!=t){if(t!=t)throw"Error: AABB::y cannot be NaN";this.zpp_inner.maxy+=t-this.zpp_inner.miny,this.zpp_inner.miny=t,this.zpp_inner.invalidate()}return this.zpp_inner.validate(),this.zpp_inner.miny},get_width:function(){return this.zpp_inner.validate(),this.zpp_inner.width()},set_width:function(t){if(this.zpp_inner._immutable)throw"Error: AABB is immutable";if(function(t){return t.zpp_inner.validate(),t.zpp_inner.width()}(this)!=t){if(t!=t)throw"Error: AABB::width cannot be NaN";if(t<0)throw"Error: AABB::width ("+t+") must be >= 0";this.zpp_inner.maxx=function(t){return t.zpp_inner.validate(),t.zpp_inner.minx}(this)+t,this.zpp_inner.invalidate()}return this.zpp_inner.validate(),this.zpp_inner.width()},get_height:function(){return this.zpp_inner.validate(),this.zpp_inner.height()},set_height:function(t){if(this.zpp_inner._immutable)throw"Error: AABB is immutable";if(function(t){return t.zpp_inner.validate(),t.zpp_inner.height()}(this)!=t){if(t!=t)throw"Error: AABB::height cannot be NaN";if(t<0)throw"Error: AABB::height ("+t+") must be >= 0";this.zpp_inner.maxy=function(t){return t.zpp_inner.validate(),t.zpp_inner.miny}(this)+t,this.zpp_inner.invalidate()}return this.zpp_inner.validate(),this.zpp_inner.height()},toString:function(){return this.zpp_inner.validate(),this.zpp_inner.toString()},__class__:p.geom.AABB},p.geom.ConvexResult=function(){if(this.zpp_inner=null,!o.geom.ZPP_ConvexRayResult.internal)throw"Error: ConvexResult cannot be instantiated derp!"},p.geom.ConvexResult.__name__=!0;p.geom.ConvexResult.prototype={get_normal:function(){if(null!=this.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return this.zpp_inner.normal},get_position:function(){if(null!=this.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return this.zpp_inner.position},get_toi:function(){if(null!=this.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return this.zpp_inner.toiDistance},get_shape:function(){if(null!=this.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return this.zpp_inner.shape},dispose:function(){if(null!=this.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";this.zpp_inner.free()},toString:function(){if(null!=this.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return"{ shape: "+r.string(function(t){if(null!=t.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return t.zpp_inner.shape}(this))+" toi: "+function(t){if(null!=t.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return t.zpp_inner.toiDistance}(this)+" }"},__class__:p.geom.ConvexResult},p.geom.ConvexResultIterator=function(){if(this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null,!o.util.ZPP_ConvexResultList.internal)throw"Error: Cannot instantiate ConvexResultIterator derp!"},p.geom.ConvexResultIterator.__name__=!0,p.geom.ConvexResultIterator.get=function(t){var n;if(null==p.geom.ConvexResultIterator.zpp_pool){o.util.ZPP_ConvexResultList.internal=!0;var e=new p.geom.ConvexResultIterator;o.util.ZPP_ConvexResultList.internal=!1,n=e}else{var i=p.geom.ConvexResultIterator.zpp_pool;p.geom.ConvexResultIterator.zpp_pool=i.zpp_next,n=i}return n.zpp_i=0,n.zpp_inner=t,n.zpp_critical=!1,n},p.geom.ConvexResultIterator.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=p.geom.ConvexResultIterator.zpp_pool,p.geom.ConvexResultIterator.zpp_pool=this,this.zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:p.geom.ConvexResultIterator},p.geom.ConvexResultList=function(){this.zpp_inner=null,this.zpp_inner=new o.util.ZPP_ConvexResultList,this.zpp_inner.outer=this},p.geom.ConvexResultList.__name__=!0,p.geom.ConvexResultList.fromArray=function(t){if(null==t)throw"Error: Cannot convert null Array to Nape list";for(var n=new p.geom.ConvexResultList,e=0;e<t.length;){var i=t[e];++e,n.push(i)}return n},p.geom.ConvexResultList.prototype={get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t)},at:function(t){if(this.zpp_inner.valmod(),t<0||t>=this.get_length())throw"Error: Index out of bounds 7";if(this.zpp_inner.reverse_flag&&(t=this.get_length()-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt},push:function(t){if(this.zpp_inner.immutable)throw"Error: ConvexResultList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t):(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},unshift:function(t){if(this.zpp_inner.immutable)throw"Error: ConvexResultList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t)):this.zpp_inner.inner.add(t),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},pop:function(){if(this.zpp_inner.immutable)throw"Error: ConvexResultList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){t=this.zpp_inner.inner.head.elt;var n=t;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var e;e=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==e?this.zpp_inner.inner.head.elt:e.next.elt;var i=t;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)}return this.zpp_inner.invalidate(),t},shift:function(){if(this.zpp_inner.immutable)throw"Error: ConvexResultList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n;n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==n?this.zpp_inner.inner.head.elt:n.next.elt;var e=t;null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}else{t=this.zpp_inner.inner.head.elt;var i=t;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),t},add:function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},remove:function(t){if(this.zpp_inner.immutable)throw"Error: ConvexResultList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;n=!1;for(var e=this.zpp_inner.inner.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t),this.zpp_inner.invalidate()),n},clear:function(){if(this.zpp_inner.immutable)throw"Error: ConvexResultList is immutable";if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){return this.zpp_inner.valmod(),p.geom.ConvexResultIterator.get(this)},copy:function(t){null==t&&(t=!1);var n,e=new p.geom.ConvexResultList;for(this.zpp_inner.valmod(),n=p.geom.ConvexResultIterator.get(this);n.hasNext();){var i;n.zpp_critical=!1,i=n.zpp_inner.at(n.zpp_i++),e.push(t?function(t){throw"Error: ConvexResult is not a copyable type"}():i)}return e},merge:function(t){if(null==t)throw"Error: Cannot merge with null list";var n;for(t.zpp_inner.valmod(),n=p.geom.ConvexResultIterator.get(t);n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),this.has(e)||(this.zpp_inner.reverse_flag?this.push(e):this.unshift(e))}},toString:function(){var t,n="[",e=!0;for(this.zpp_inner.valmod(),t=p.geom.ConvexResultIterator.get(this);t.hasNext();){var i;t.zpp_critical=!1,i=t.zpp_inner.at(t.zpp_i++),e||(n+=","),n+=null==i?"NULL":i.toString(),e=!1}return n+"]"},foreach:function(t){if(null==t)throw"Error: Cannot execute null on list elements";var n;for(this.zpp_inner.valmod(),n=p.geom.ConvexResultIterator.get(this);n.hasNext();)try{t(function(t){return n.zpp_critical=!1,n.zpp_inner.at(n.zpp_i++)}())}catch(t){n.zpp_next=p.geom.ConvexResultIterator.zpp_pool,p.geom.ConvexResultIterator.zpp_pool=n,n.zpp_inner=null;break}return this},filter:function(t){if(null==t)throw"Error: Cannot select elements of list with null";for(var n=0;n<this.get_length();){var e=this.at(n);try{t(e)?n++:this.remove(e)}catch(t){break}}return this},__class__:p.geom.ConvexResultList},p.geom.Geom=function(){},p.geom.Geom.__name__=!0,p.geom.Geom.distanceBody=function(t,n,e,i){if(null!=e&&e.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=i&&i.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(e.zpp_inner.immutable(),i.zpp_inner.immutable(),t.zpp_inner.wrap_shapes.empty()||n.zpp_inner.wrap_shapes.empty())throw"Error: Bodies cannot be empty in calculating distances";for(var r=t.zpp_inner.shapes.head;null!=r;){var s=r.elt;o.geom.ZPP_Geom.validateShape(s),r=r.next}for(var l=n.zpp_inner.shapes.head;null!=l;){var a=l.elt;o.geom.ZPP_Geom.validateShape(a),l=l.next}return o.geom.ZPP_SweepDistance.distanceBody(t.zpp_inner,n.zpp_inner,e.zpp_inner,i.zpp_inner)},p.geom.Geom.distance=function(t,n,e,i){if(null!=e&&e.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=i&&i.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(e.zpp_inner.immutable(),i.zpp_inner.immutable(),null==(null!=t.zpp_inner.body?t.zpp_inner.body.outer:null)||null==(null!=n.zpp_inner.body?n.zpp_inner.body.outer:null))throw"Error: Shape must be part of a Body to calculate distances";o.geom.ZPP_Geom.validateShape(t.zpp_inner),o.geom.ZPP_Geom.validateShape(n.zpp_inner);var r;null==o.geom.ZPP_Vec2.zpp_pool?r=new o.geom.ZPP_Vec2:(r=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=r.next,r.next=null),r.weak=!1;var s=o.geom.ZPP_SweepDistance.distance(t.zpp_inner,n.zpp_inner,e.zpp_inner,i.zpp_inner,r,1e100),l=r;return null!=l.outer&&(l.outer.zpp_inner=null,l.outer=null),l._isimmutable=null,l._validate=null,l._invalidate=null,l.next=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=l,s},p.geom.Geom.intersectsBody=function(t,n){if(t.zpp_inner.wrap_shapes.empty()||n.zpp_inner.wrap_shapes.empty())throw"Error: Bodies must have shapes to test for intersection.";for(var e=t.zpp_inner.shapes.head;null!=e;){var i=e.elt;o.geom.ZPP_Geom.validateShape(i),e=e.next}for(var r=n.zpp_inner.shapes.head;null!=r;){var s=r.elt;o.geom.ZPP_Geom.validateShape(s),r=r.next}if(t.zpp_inner.aabb.intersect(n.zpp_inner.aabb)){for(var l=t.zpp_inner.shapes.head;null!=l;){for(var a=l.elt,p=n.zpp_inner.shapes.head;null!=p;){var _=p.elt;if(o.geom.ZPP_Collide.testCollide_safe(a,_))return!0;p=p.next}l=l.next}return!1}return!1},p.geom.Geom.intersects=function(t,n){if(null==(null!=t.zpp_inner.body?t.zpp_inner.body.outer:null)||null==(null!=n.zpp_inner.body?n.zpp_inner.body.outer:null))throw"Error: Shape must be part of a Body to calculate intersection";return o.geom.ZPP_Geom.validateShape(t.zpp_inner),o.geom.ZPP_Geom.validateShape(n.zpp_inner),t.zpp_inner.aabb.intersect(n.zpp_inner.aabb)&&o.geom.ZPP_Collide.testCollide_safe(t.zpp_inner,n.zpp_inner)},p.geom.Geom.contains=function(t,n){if(null==(null!=t.zpp_inner.body?t.zpp_inner.body.outer:null)||null==(null!=n.zpp_inner.body?n.zpp_inner.body.outer:null))throw"Error: Shape must be part of a Body to calculate containment";return o.geom.ZPP_Geom.validateShape(t.zpp_inner),o.geom.ZPP_Geom.validateShape(n.zpp_inner),o.geom.ZPP_Collide.containTest(t.zpp_inner,n.zpp_inner)},p.geom.GeomPoly=function(t){if(this.zpp_inner=null,this.zpp_pool=null,this.zpp_inner=new o.geom.ZPP_GeomPoly(this),null!=t){if(t instanceof Array&&null==t.__enum__)for(var n=t,e=0;e<n.length;){var i=n[e];if(++e,null==i)throw"Error: Array<Vec2> contains null objects";if(!a.Boot.__instanceof(i,p.geom.Vec2))throw"Error: Array<Vec2> contains non Vec2 objects";var r=i;if(null!=r&&r.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";var s=o.geom.ZPP_GeomVert.get(function(t){if(null!=r&&r.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return r.zpp_inner.validate(),r.zpp_inner.x}(),function(t){if(null!=r&&r.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return r.zpp_inner.validate(),r.zpp_inner.y}());null==this.zpp_inner.vertices?this.zpp_inner.vertices=s.prev=s.next=s:(s.prev=this.zpp_inner.vertices,s.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=s,this.zpp_inner.vertices.next=s),this.zpp_inner.vertices=s}else if(a.Boot.__instanceof(t,p.geom.Vec2List))for(var l=t,_=l.iterator();_.hasNext();){var h;if(_.zpp_critical=!1,null==(h=_.zpp_inner.at(_.zpp_i++)))throw"Error: Vec2List contains null objects";if(null!=h&&h.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";var u=o.geom.ZPP_GeomVert.get(function(t){if(null!=h&&h.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return h.zpp_inner.validate(),h.zpp_inner.x}(),function(t){if(null!=h&&h.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return h.zpp_inner.validate(),h.zpp_inner.y}());null==this.zpp_inner.vertices?this.zpp_inner.vertices=u.prev=u.next=u:(u.prev=this.zpp_inner.vertices,u.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=u,this.zpp_inner.vertices.next=u),this.zpp_inner.vertices=u}else{if(!a.Boot.__instanceof(t,p.geom.GeomPoly))throw"Error: Invalid type for polygon object, should be Array<Vec2>, Vec2List, GeomPoly or for flash10+ flash.Vector<Vec2>";var d=t;if(null!=d&&d.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";var c=d.zpp_inner.vertices;if(null!=c){var P=c;do{var f=p.geom.Vec2.get(P.x,P.y,null);P=P.next;var z=o.geom.ZPP_GeomVert.get(function(t){if(null!=f&&f.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return f.zpp_inner.validate(),f.zpp_inner.x}(),function(t){if(null!=f&&f.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return f.zpp_inner.validate(),f.zpp_inner.y}());null==this.zpp_inner.vertices?this.zpp_inner.vertices=z.prev=z.next=z:(z.prev=this.zpp_inner.vertices,z.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=z,this.zpp_inner.vertices.next=z),this.zpp_inner.vertices=z,f.dispose()}while(P!=c)}}if(this.skipForward(1),t instanceof Array&&null==t.__enum__)for(var v=t,m=0;m<v.length;){var b=v[m];b.zpp_inner.weak&&function(t){return b.dispose(),!0}()?v.splice(m,1):m++}else if(a.Boot.__instanceof(t,p.geom.Vec2List)){var y=t;null!=y.zpp_inner._validate&&y.zpp_inner._validate();for(var g=y.zpp_inner.inner,x=null,Z=g.head;null!=Z;){var w=Z.elt;w.outer.zpp_inner.weak?(Z=g.erase(x),w.outer.zpp_inner.weak&&w.outer.dispose()):(x=Z,Z=Z.next)}}}},p.geom.GeomPoly.__name__=!0,p.geom.GeomPoly.get=function(t){var n;if(null==o.util.ZPP_PubPool.poolGeomPoly?n=new p.geom.GeomPoly:(n=o.util.ZPP_PubPool.poolGeomPoly,o.util.ZPP_PubPool.poolGeomPoly=n.zpp_pool,n.zpp_pool=null,n.zpp_disp=!1,n==o.util.ZPP_PubPool.nextGeomPoly&&(o.util.ZPP_PubPool.nextGeomPoly=null)),null!=t){if(t instanceof Array&&null==t.__enum__)for(var e=t,i=0;i<e.length;){var r=e[i];if(++i,null==r)throw"Error: Array<Vec2> contains null objects";if(!a.Boot.__instanceof(r,p.geom.Vec2))throw"Error: Array<Vec2> contains non Vec2 objects";var s=r;if(null!=s&&s.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";var l=o.geom.ZPP_GeomVert.get(function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.x}(),function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.y}());null==n.zpp_inner.vertices?n.zpp_inner.vertices=l.prev=l.next=l:(l.prev=n.zpp_inner.vertices,l.next=n.zpp_inner.vertices.next,n.zpp_inner.vertices.next.prev=l,n.zpp_inner.vertices.next=l),n.zpp_inner.vertices=l}else if(a.Boot.__instanceof(t,p.geom.Vec2List))for(var _=t,h=_.iterator();h.hasNext();){var u;if(h.zpp_critical=!1,null==(u=h.zpp_inner.at(h.zpp_i++)))throw"Error: Vec2List contains null objects";if(null!=u&&u.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";var d=o.geom.ZPP_GeomVert.get(function(t){if(null!=u&&u.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return u.zpp_inner.validate(),u.zpp_inner.x}(),function(t){if(null!=u&&u.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return u.zpp_inner.validate(),u.zpp_inner.y}());null==n.zpp_inner.vertices?n.zpp_inner.vertices=d.prev=d.next=d:(d.prev=n.zpp_inner.vertices,d.next=n.zpp_inner.vertices.next,n.zpp_inner.vertices.next.prev=d,n.zpp_inner.vertices.next=d),n.zpp_inner.vertices=d}else{if(!a.Boot.__instanceof(t,p.geom.GeomPoly))throw"Error: Invalid type for polygon object, should be Array<Vec2>, Vec2List, GeomPoly or for flash10+ flash.Vector<Vec2>";var c=t;if(null!=c&&c.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";var P=c.zpp_inner.vertices;if(null!=P){var f=P;do{var z=p.geom.Vec2.get(f.x,f.y,null);f=f.next;var v=o.geom.ZPP_GeomVert.get(function(t){if(null!=z&&z.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return z.zpp_inner.validate(),z.zpp_inner.x}(),function(t){if(null!=z&&z.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return z.zpp_inner.validate(),z.zpp_inner.y}());null==n.zpp_inner.vertices?n.zpp_inner.vertices=v.prev=v.next=v:(v.prev=n.zpp_inner.vertices,v.next=n.zpp_inner.vertices.next,n.zpp_inner.vertices.next.prev=v,n.zpp_inner.vertices.next=v),n.zpp_inner.vertices=v,z.dispose()}while(f!=P)}}if(n.skipForward(1),t instanceof Array&&null==t.__enum__)for(var m=t,b=0;b<m.length;){var y=m[b];y.zpp_inner.weak&&function(t){return y.dispose(),!0}()?m.splice(b,1):b++}else if(a.Boot.__instanceof(t,p.geom.Vec2List)){var g=t;null!=g.zpp_inner._validate&&g.zpp_inner._validate();for(var x=g.zpp_inner.inner,Z=null,w=x.head;null!=w;){var C=w.elt;C.outer.zpp_inner.weak?(w=x.erase(Z),C.outer.zpp_inner.weak&&C.outer.dispose()):(Z=w,w=w.next)}}}return n},p.geom.GeomPoly.prototype={empty:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";return null==this.zpp_inner.vertices},size:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";var t=0,n=this.zpp_inner.vertices,e=this.zpp_inner.vertices;if(null!=n){var i=n;do{t++,i=i.next}while(i!=e)}return t},iterator:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";return o.geom.ZPP_GeomVertexIterator.get(this.zpp_inner.vertices,!0)},forwardIterator:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";return o.geom.ZPP_GeomVertexIterator.get(this.zpp_inner.vertices,!0)},backwardsIterator:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";return o.geom.ZPP_GeomVertexIterator.get(this.zpp_inner.vertices,!1)},current:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(function(t){if(t.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";return null==t.zpp_inner.vertices}(this))throw"Error: GeomPoly is empty";return this.zpp_inner.vertices.wrapper()},push:function(t){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot push null vertex";var n=o.geom.ZPP_GeomVert.get(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}());return null==this.zpp_inner.vertices?this.zpp_inner.vertices=n.prev=n.next=n:(n.prev=this.zpp_inner.vertices,n.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=n,this.zpp_inner.vertices.next=n),this.zpp_inner.vertices=n,t.zpp_inner.weak&&t.dispose(),this},pop:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(null==this.zpp_inner.vertices)throw"Error: Cannot pop from empty polygon";var t=this.zpp_inner.vertices;if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null;else{var n=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,this.zpp_inner.vertices=n}var e=t;return null!=e.wrap&&(e.wrap.zpp_inner._inuse=!1,e.wrap.dispose(),e.wrap=null),e.prev=e.next=null,e.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=e,this},unshift:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot unshift null vertex";var n=o.geom.ZPP_GeomVert.get(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}());return null==this.zpp_inner.vertices?this.zpp_inner.vertices=n.prev=n.next=n:(n.next=this.zpp_inner.vertices,n.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.prev.next=n,this.zpp_inner.vertices.prev=n),this.zpp_inner.vertices=n,t.zpp_inner.weak&&t.dispose(),this},shift:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(null==this.zpp_inner.vertices)throw"Error: Cannot shift from empty polygon";var t=this.zpp_inner.vertices;if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=this.zpp_inner.vertices=null;else{var n=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,this.zpp_inner.vertices=n}var e=t;return null!=e.wrap&&(e.wrap.zpp_inner._inuse=!1,
e.wrap.dispose(),e.wrap=null),e.prev=e.next=null,e.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=e,this},skipForward:function(t){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(null!=this.zpp_inner.vertices)if(t>0)for(;t-- >0;)this.zpp_inner.vertices=this.zpp_inner.vertices.next;else if(t<0)for(;t++<0;)this.zpp_inner.vertices=this.zpp_inner.vertices.prev;return this},skipBackwards:function(t){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";return this.skipForward(-t)},erase:function(t){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";for(;0!=t&&null!=this.zpp_inner.vertices;){var n=this.zpp_inner.vertices;if(t>0){if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=this.zpp_inner.vertices=null;else{var e=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,this.zpp_inner.vertices=e}t--}else if(t<0){if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null;else{var i=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,this.zpp_inner.vertices=i}t++}var r=n;null!=r.wrap&&(r.wrap.zpp_inner._inuse=!1,r.wrap.dispose(),r.wrap=null),r.prev=r.next=null,r.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=r}return this},clear:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";for(;null!=this.zpp_inner.vertices;){var t=this.zpp_inner.vertices;if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=this.zpp_inner.vertices=null;else{var n=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,this.zpp_inner.vertices=n}var e=t;null!=e.wrap&&(e.wrap.zpp_inner._inuse=!1,e.wrap.dispose(),e.wrap=null),e.prev=e.next=null,e.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=e}return this},copy:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";var t=p.geom.GeomPoly.get(),n=this.zpp_inner.vertices,e=this.zpp_inner.vertices;if(null!=n){var i=n;do{var r=i,s=o.geom.ZPP_GeomVert.get(r.x,r.y);null==t.zpp_inner.vertices?t.zpp_inner.vertices=s.prev=s.next=s:(s.prev=t.zpp_inner.vertices,s.next=t.zpp_inner.vertices.next,t.zpp_inner.vertices.next.prev=s,t.zpp_inner.vertices.next=s),t.zpp_inner.vertices=s,i=i.next}while(i!=e)}return t.skipForward(1)},dispose:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";this.clear();var t=this;t.zpp_pool=null,null!=o.util.ZPP_PubPool.nextGeomPoly?o.util.ZPP_PubPool.nextGeomPoly.zpp_pool=t:o.util.ZPP_PubPool.poolGeomPoly=t,o.util.ZPP_PubPool.nextGeomPoly=t,t.zpp_disp=!0},toString:function(){var t="GeomPoly[",n=this.zpp_inner.vertices,e=this.zpp_inner.vertices;if(null!=n){var i=n;do{var r=i;r!=this.zpp_inner.vertices&&(t+=","),t+="{"+r.x+","+r.y+"}",i=i.next}while(i!=e)}return t+"]"},area:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return 0;var t,n=0,e=this.zpp_inner.vertices,i=this.zpp_inner.vertices;if(null!=e){var r=e;do{var s=r;n+=s.x*(s.next.y-s.prev.y),r=r.next}while(r!=i)}return t=.5*n,t<0?-t:t},winding:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return null==o.util.ZPP_Flags.Winding_UNDEFINED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Winding_UNDEFINED=new p.geom.Winding,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Winding_UNDEFINED;var t,n=0,e=this.zpp_inner.vertices,i=this.zpp_inner.vertices;if(null!=e){var r=e;do{var s=r;n+=s.x*(s.next.y-s.prev.y),r=r.next}while(r!=i)}return t=.5*n,t>0?(null==o.util.ZPP_Flags.Winding_CLOCKWISE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Winding_CLOCKWISE=new p.geom.Winding,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Winding_CLOCKWISE):0==t?(null==o.util.ZPP_Flags.Winding_UNDEFINED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Winding_UNDEFINED=new p.geom.Winding,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Winding_UNDEFINED):(null==o.util.ZPP_Flags.Winding_ANTICLOCKWISE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Winding_ANTICLOCKWISE=new p.geom.Winding,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Winding_ANTICLOCKWISE)},contains:function(t){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: GeomPoly::contains point cannot be null";var n,e;if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";t.zpp_inner.validate(),e=t.zpp_inner.x;var i;if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";t.zpp_inner.validate(),i=t.zpp_inner.y;var r=!1,s=this.zpp_inner.vertices,l=this.zpp_inner.vertices;if(null!=s){var a=s;do{var p=a,o=p.prev;(p.y<i&&o.y>=i||o.y<i&&p.y>=i)&&(p.x<=e||o.x<=e)&&p.x+(i-p.y)/(o.y-p.y)*(o.x-p.x)<e&&(r=!r),a=a.next}while(a!=l)}return n=r,t.zpp_inner.weak&&t.dispose(),n},isClockwise:function(){return this.winding()==function(t){return null==o.util.ZPP_Flags.Winding_CLOCKWISE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Winding_CLOCKWISE=new p.geom.Winding,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Winding_CLOCKWISE}()},isConvex:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return!0;var t=!1,n=!1,e=!0,i=this.zpp_inner.vertices,r=this.zpp_inner.vertices;if(null!=i){var s=i;do{var l=s,a=l.prev,p=l.next,o=0,_=0;o=p.x-l.x,_=p.y-l.y;var h=0,u=0;h=l.x-a.x,u=l.y-a.y;var d=u*o-h*_;if(d>0?n=!0:d<0&&(t=!0),n&&t){e=!1;break}s=s.next}while(s!=r)}return e},isSimple:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";return null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next||o.geom.ZPP_Simple.isSimple(this.zpp_inner.vertices)},isMonotone:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";return null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next||o.geom.ZPP_Monotone.isMonotone(this.zpp_inner.vertices)},isDegenerate:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";return null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next||this.area()<p.Config.epsilon},simplify:function(t){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(t<=0)throw"Error: Epsilon should be > 0 for simplifying a GeomPoly";if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return this.copy();var n=o.geom.ZPP_Simplify.simplify(this.zpp_inner.vertices,t),e=p.geom.GeomPoly.get();return e.zpp_inner.vertices=n,e},simpleDecomposition:function(t){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)throw"Error: Cannot decompose a degenerate polygon";var n,e=o.geom.ZPP_Simple.decompose(this.zpp_inner.vertices,function(t){return null==o.geom.ZPP_PartitionedPoly.sharedGVList&&(o.geom.ZPP_PartitionedPoly.sharedGVList=new o.util.ZNPList_ZPP_GeomVert),o.geom.ZPP_PartitionedPoly.sharedGVList}());for(n=null==t?new p.geom.GeomPolyList:t;null!=e.head;){var i=e.pop_unsafe(),r=p.geom.GeomPoly.get();r.zpp_inner.vertices=i,n.zpp_inner.reverse_flag?n.push(r):n.unshift(r)}return n},monotoneDecomposition:function(t){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)throw"Error: Cannot decompose a degenerate polygon";var n,e=o.geom.ZPP_Monotone.decompose(this.zpp_inner.vertices,function(t){return null==o.geom.ZPP_Monotone.sharedPPoly&&(o.geom.ZPP_Monotone.sharedPPoly=new o.geom.ZPP_PartitionedPoly),o.geom.ZPP_Monotone.sharedPPoly}()),i=e.extract(function(t){return null==o.geom.ZPP_PartitionedPoly.sharedGVList&&(o.geom.ZPP_PartitionedPoly.sharedGVList=new o.util.ZNPList_ZPP_GeomVert),o.geom.ZPP_PartitionedPoly.sharedGVList}());for(n=null==t?new p.geom.GeomPolyList:t;null!=i.head;){var r=i.pop_unsafe(),s=p.geom.GeomPoly.get();s.zpp_inner.vertices=r,n.zpp_inner.reverse_flag?n.push(s):n.unshift(s)}return n},convexDecomposition:function(t,n){if(null==t&&(t=!1),this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)throw"Error: Cannot decompose a degenerate polygon";var e,i=o.geom.ZPP_Monotone.decompose(this.zpp_inner.vertices,function(t){return null==o.geom.ZPP_Monotone.sharedPPoly&&(o.geom.ZPP_Monotone.sharedPPoly=new o.geom.ZPP_PartitionedPoly),o.geom.ZPP_Monotone.sharedPPoly}()),r=i.extract_partitions(function(t){return null==o.geom.ZPP_PartitionedPoly.sharedPPList&&(o.geom.ZPP_PartitionedPoly.sharedPPList=new o.util.ZNPList_ZPP_PartitionedPoly),o.geom.ZPP_PartitionedPoly.sharedPPList}());for(e=null==n?new p.geom.GeomPolyList:n;null!=r.head;){var s=r.pop_unsafe();o.geom.ZPP_Triangular.triangulate(s),t&&o.geom.ZPP_Triangular.optimise(s),o.geom.ZPP_Convex.optimise(s);var l=s.extract(function(t){return null==o.geom.ZPP_PartitionedPoly.sharedGVList&&(o.geom.ZPP_PartitionedPoly.sharedGVList=new o.util.ZNPList_ZPP_GeomVert),o.geom.ZPP_PartitionedPoly.sharedGVList}()),a=s;for(a.next=o.geom.ZPP_PartitionedPoly.zpp_pool,o.geom.ZPP_PartitionedPoly.zpp_pool=a;null!=l.head;){var _=l.pop_unsafe(),h=p.geom.GeomPoly.get();h.zpp_inner.vertices=_,e.zpp_inner.reverse_flag?e.push(h):e.unshift(h)}}return e},triangularDecomposition:function(t,n){if(null==t&&(t=!1),this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)throw"Error: Cannot decompose a degenerate polygon";var e,i=o.geom.ZPP_Monotone.decompose(this.zpp_inner.vertices,function(t){return null==o.geom.ZPP_Monotone.sharedPPoly&&(o.geom.ZPP_Monotone.sharedPPoly=new o.geom.ZPP_PartitionedPoly),o.geom.ZPP_Monotone.sharedPPoly}()),r=i.extract_partitions(function(t){return null==o.geom.ZPP_PartitionedPoly.sharedPPList&&(o.geom.ZPP_PartitionedPoly.sharedPPList=new o.util.ZNPList_ZPP_PartitionedPoly),o.geom.ZPP_PartitionedPoly.sharedPPList}());for(e=null==n?new p.geom.GeomPolyList:n;null!=r.head;){var s=r.pop_unsafe();o.geom.ZPP_Triangular.triangulate(s),t&&o.geom.ZPP_Triangular.optimise(s);var l=s.extract(function(t){return null==o.geom.ZPP_PartitionedPoly.sharedGVList&&(o.geom.ZPP_PartitionedPoly.sharedGVList=new o.util.ZNPList_ZPP_GeomVert),o.geom.ZPP_PartitionedPoly.sharedGVList}()),a=s;for(a.next=o.geom.ZPP_PartitionedPoly.zpp_pool,o.geom.ZPP_PartitionedPoly.zpp_pool=a;null!=l.head;){var _=l.pop_unsafe(),h=p.geom.GeomPoly.get();h.zpp_inner.vertices=_,e.zpp_inner.reverse_flag?e.push(h):e.unshift(h)}}return e},inflate:function(t){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";var n=p.geom.GeomPoly.get();this.winding()==function(t){return null==o.util.ZPP_Flags.Winding_CLOCKWISE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Winding_CLOCKWISE=new p.geom.Winding,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Winding_CLOCKWISE}()&&(t=-t);var e=this.zpp_inner.vertices,i=this.zpp_inner.vertices;if(null!=e){var r=e;do{var s=r,l=s.prev,a=s.next,_=0,h=0,u=0,d=0;_=s.x-l.x,h=s.y-l.y,u=a.x-s.x,d=a.y-s.y;var c=0,P=0,f=0,z=0;c=_,P=h;var v=c*c+P*P,m=1/Math.sqrt(v),b=m;c*=b,P*=b;var y=c;c=-P,P=y;var g=t;c*=g,P*=g,f=u,z=d;var x=f*f+z*z,Z=1/Math.sqrt(x),w=Z;f*=w,z*=w;var C=f;f=-z,z=C;var E=t;f*=E,z*=E;var S=0,N=0;S=f-c,N=z-P;var k,M=d*S-u*N;k=0==M?0:M/(d*_-u*h);var I=0,F=0;I=s.x+c,F=s.y+P;var A=k;I+=_*A,F+=h*A,n.push(p.geom.Vec2.get(I,F,null)),r=r.next}while(r!=i)}return n.skipForward(1)},cut:function(t,n,e,i,r){if(null==i&&(i=!1),null==e&&(e=!1),this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(!function(t){if(t.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";return null==t.zpp_inner.vertices||null==t.zpp_inner.vertices.next||t.zpp_inner.vertices.prev==t.zpp_inner.vertices.next||o.geom.ZPP_Simple.isSimple(t.zpp_inner.vertices)}(this))throw"Error: Cut requires a truly simple polygon";if(null==t||null==n)throw"Error: Cannot cut with null start/end's";if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";var s=o.geom.ZPP_Cutter.run(this.zpp_inner.vertices,t,n,e,i,r);return t.zpp_inner.weak&&t.dispose(),n.zpp_inner.weak&&n.dispose(),s},transform:function(t){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(null==t)throw"Error: Cannot transform by null matrix";var n=this.zpp_inner.vertices,e=this.zpp_inner.vertices;if(null!=n){var i=n;do{var r=i,s=t.zpp_inner.a*r.x+t.zpp_inner.b*r.y+t.zpp_inner.tx;r.y=t.zpp_inner.c*r.x+t.zpp_inner.d*r.y+t.zpp_inner.ty,r.x=s,i=i.next}while(i!=e)}return this},bounds:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(function(t){if(t.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";return null==t.zpp_inner.vertices}(this))throw"Error: empty GeomPoly has no defineable bounds";var t=1e100,n=1e100,e=-1e100,i=-1e100,r=this.zpp_inner.vertices,s=this.zpp_inner.vertices;if(null!=r){var l=r;do{var a=l;a.x<t&&(t=a.x),a.y<n&&(n=a.y),a.x>e&&(e=a.x),a.y>i&&(i=a.y),l=l.next}while(l!=s)}return new p.geom.AABB(t,n,e-t,i-n)},top:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(function(t){if(t.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";return null==t.zpp_inner.vertices}(this))throw"Error: empty GeomPoly has no defineable topmost vertex";var t=this.zpp_inner.vertices,e=this.zpp_inner.vertices.next,i=this.zpp_inner.vertices;if(null!=e){var r=e;do{var s=r;s.y<t.y&&(t=s),r=r.next}while(r!=i)}return null==t.wrap&&(t.wrap=p.geom.Vec2.get(t.x,t.y,null),t.wrap.zpp_inner._inuse=!0,t.wrap.zpp_inner._invalidate=n(t,t.modwrap),t.wrap.zpp_inner._validate=n(t,t.getwrap)),t.wrap},bottom:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(function(t){if(t.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";return null==t.zpp_inner.vertices}(this))throw"Error: empty GeomPoly has no defineable bottommost vertex";var t=this.zpp_inner.vertices,e=this.zpp_inner.vertices.next,i=this.zpp_inner.vertices;if(null!=e){var r=e;do{var s=r;s.y>t.y&&(t=s),r=r.next}while(r!=i)}return null==t.wrap&&(t.wrap=p.geom.Vec2.get(t.x,t.y,null),t.wrap.zpp_inner._inuse=!0,t.wrap.zpp_inner._invalidate=n(t,t.modwrap),t.wrap.zpp_inner._validate=n(t,t.getwrap)),t.wrap},left:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(function(t){if(t.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";return null==t.zpp_inner.vertices}(this))throw"Error: empty GeomPoly has no defineable leftmost vertex";var t=this.zpp_inner.vertices,e=this.zpp_inner.vertices.next,i=this.zpp_inner.vertices;if(null!=e){var r=e;do{var s=r;s.x<t.x&&(t=s),r=r.next}while(r!=i)}return null==t.wrap&&(t.wrap=p.geom.Vec2.get(t.x,t.y,null),t.wrap.zpp_inner._inuse=!0,t.wrap.zpp_inner._invalidate=n(t,t.modwrap),t.wrap.zpp_inner._validate=n(t,t.getwrap)),t.wrap},right:function(){if(this.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";if(function(t){if(t.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";return null==t.zpp_inner.vertices}(this))throw"Error: empty GeomPoly has no defineable rightmmost vertex";var t=this.zpp_inner.vertices,e=this.zpp_inner.vertices.next,i=this.zpp_inner.vertices;if(null!=e){var r=e;do{var s=r;s.x>t.x&&(t=s),r=r.next}while(r!=i)}return null==t.wrap&&(t.wrap=p.geom.Vec2.get(t.x,t.y,null),t.wrap.zpp_inner._inuse=!0,t.wrap.zpp_inner._invalidate=n(t,t.modwrap),t.wrap.zpp_inner._validate=n(t,t.getwrap)),t.wrap},__class__:p.geom.GeomPoly},p.geom.GeomPolyIterator=function(){if(this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null,!o.util.ZPP_GeomPolyList.internal)throw"Error: Cannot instantiate GeomPolyIterator derp!"},p.geom.GeomPolyIterator.__name__=!0,p.geom.GeomPolyIterator.get=function(t){var n;if(null==p.geom.GeomPolyIterator.zpp_pool){o.util.ZPP_GeomPolyList.internal=!0;var e=new p.geom.GeomPolyIterator;o.util.ZPP_GeomPolyList.internal=!1,n=e}else{var i=p.geom.GeomPolyIterator.zpp_pool;p.geom.GeomPolyIterator.zpp_pool=i.zpp_next,n=i}return n.zpp_i=0,n.zpp_inner=t,n.zpp_critical=!1,n},p.geom.GeomPolyIterator.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=p.geom.GeomPolyIterator.zpp_pool,p.geom.GeomPolyIterator.zpp_pool=this,this.zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:p.geom.GeomPolyIterator},p.geom.GeomPolyList=function(){this.zpp_inner=null,this.zpp_inner=new o.util.ZPP_GeomPolyList,this.zpp_inner.outer=this},p.geom.GeomPolyList.__name__=!0,p.geom.GeomPolyList.fromArray=function(t){if(null==t)throw"Error: Cannot convert null Array to Nape list";for(var n=new p.geom.GeomPolyList,e=0;e<t.length;){var i=t[e];++e,n.push(i)}return n},p.geom.GeomPolyList.prototype={get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},at:function(t){if(this.zpp_inner.valmod(),t<0||t>=this.get_length())throw"Error: Index out of bounds 8";if(this.zpp_inner.reverse_flag&&(t=this.get_length()-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(t){if(this.zpp_inner.immutable)throw"Error: GeomPolyList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},unshift:function(t){if(this.zpp_inner.immutable)throw"Error: GeomPolyList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},pop:function(){if(this.zpp_inner.immutable)throw"Error: GeomPolyList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){t=this.zpp_inner.inner.head.elt;var n=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var e;e=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==e?this.zpp_inner.inner.head.elt:e.next.elt;var i=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)}return this.zpp_inner.invalidate(),t.outer},shift:function(){if(this.zpp_inner.immutable)throw"Error: GeomPolyList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n;n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==n?this.zpp_inner.inner.head.elt:n.next.elt;var e=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}else{t=this.zpp_inner.inner.head.elt;var i=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),t.outer},add:function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},remove:function(t){if(this.zpp_inner.immutable)throw"Error: GeomPolyList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;n=!1;for(var e=this.zpp_inner.inner.head;null!=e;){if(e.elt==t.zpp_inner){n=!0;break}e=e.next}return n&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),n},clear:function(){if(this.zpp_inner.immutable)throw"Error: GeomPolyList is immutable";if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){return this.zpp_inner.valmod(),p.geom.GeomPolyIterator.get(this)},copy:function(t){null==t&&(t=!1);var n,e=new p.geom.GeomPolyList;for(this.zpp_inner.valmod(),n=p.geom.GeomPolyIterator.get(this);n.hasNext();){var i;n.zpp_critical=!1,i=n.zpp_inner.at(n.zpp_i++),e.push(t?function(t){throw"Error: GeomPoly is not a copyable type"}():i)}return e},merge:function(t){if(null==t)throw"Error: Cannot merge with null list";var n;for(t.zpp_inner.valmod(),n=p.geom.GeomPolyIterator.get(t);n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),this.has(e)||(this.zpp_inner.reverse_flag?this.push(e):this.unshift(e))}},toString:function(){var t,n="[",e=!0;for(this.zpp_inner.valmod(),t=p.geom.GeomPolyIterator.get(this);t.hasNext();){var i;t.zpp_critical=!1,i=t.zpp_inner.at(t.zpp_i++),e||(n+=","),n+=null==i?"NULL":i.toString(),e=!1}return n+"]"},foreach:function(t){if(null==t)throw"Error: Cannot execute null on list elements";var n;for(this.zpp_inner.valmod(),n=p.geom.GeomPolyIterator.get(this);n.hasNext();)try{t(function(t){return n.zpp_critical=!1,n.zpp_inner.at(n.zpp_i++)}())}catch(t){n.zpp_next=p.geom.GeomPolyIterator.zpp_pool,p.geom.GeomPolyIterator.zpp_pool=n,n.zpp_inner=null;break}return this},filter:function(t){if(null==t)throw"Error: Cannot select elements of list with null";for(var n=0;n<this.get_length();){var e=this.at(n);try{t(e)?n++:this.remove(e)}catch(t){break}}return this},__class__:p.geom.GeomPolyList},p.geom.GeomVertexIterator=function(){if(!o.geom.ZPP_GeomVertexIterator.internal)throw"Error: Cannot instantiate GeomVertexIterator"},p.geom.GeomVertexIterator.__name__=!0,p.geom.GeomVertexIterator.prototype={hasNext:function(){if(null==this.zpp_inner)throw"Error: Iterator has been disposed";var t=this.zpp_inner.ptr!=this.zpp_inner.start||this.zpp_inner.first;if(this.zpp_inner.first=!1,!t){var n=this.zpp_inner;n.outer.zpp_inner=null,n.ptr=n.start=null,n.next=o.geom.ZPP_GeomVertexIterator.zpp_pool,o.geom.ZPP_GeomVertexIterator.zpp_pool=n}return t},next:function(){if(null==this.zpp_inner)throw"Error: Iterator has been disposed";var t=this.zpp_inner.ptr.wrapper();return this.zpp_inner.forward?this.zpp_inner.ptr=this.zpp_inner.ptr.next:this.zpp_inner.ptr=this.zpp_inner.ptr.prev,t},__class__:p.geom.GeomVertexIterator},p.geom.MarchingSquares=function(){},p.geom.MarchingSquares.__name__=!0,p.geom.MarchingSquares.run=function(t,n,e,i,r,s,l){if(null==s&&(s=!0),null==i&&(i=2),null!=e&&e.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=r&&r.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: MarchingSquares requires an iso function to operate";if(null==n)throw"Error: MarchingSquares requires an AABB to define bounds of surface extraction";if(null==e)throw"Error: MarchingSquares requires a Vec2 to define cell size for surface extraction";if(function(t){if(null!=e&&e.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return e.zpp_inner.validate(),e.zpp_inner.x}()<=0||function(t){if(null!=e&&e.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return e.zpp_inner.validate(),e.zpp_inner.y}()<=0)throw"Error: MarchingSquares cannot operate with non-positive cell dimensions";if(i<0)throw"Error: MarchingSquares cannot use a negative quality value for interpolation";if(null!=r&&(function(t){if(null!=r&&r.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return r.zpp_inner.validate(),r.zpp_inner.x}()<=0||function(t){if(null!=r&&r.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return r.zpp_inner.validate(),r.zpp_inner.y}()<=0))throw"Error: MarchingSquares cannot with non-positive sub-grid dimensions";var a;if(a=null!=l?l:new p.geom.GeomPolyList,null==r)o.geom.ZPP_MarchingSquares.run(t,function(t){return n.zpp_inner.validate(),n.zpp_inner.minx}(),function(t){return n.zpp_inner.validate(),n.zpp_inner.miny}(),n.zpp_inner.getmax().get_x(),n.zpp_inner.getmax().get_y(),e,i,s,a);else{var _;_=function(t){return n.zpp_inner.validate(),n.zpp_inner.width()}()/function(t){if(null!=r&&r.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return r.zpp_inner.validate(),r.zpp_inner.x}();var h;h=function(t){return n.zpp_inner.validate(),n.zpp_inner.height()}()/function(t){if(null!=r&&r.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return r.zpp_inner.validate(),r.zpp_inner.y}();var u=0|_,d=0|h;u!=_&&u++,d!=h&&d++;for(var c=0;c<u;){var P,f=c++;P=function(t){return n.zpp_inner.validate(),n.zpp_inner.minx}()+function(t){if(null!=r&&r.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return r.zpp_inner.validate(),r.zpp_inner.x}()*f;var z;z=f==u-1?n.zpp_inner.getmax().get_x():P+function(t){if(null!=r&&r.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return r.zpp_inner.validate(),r.zpp_inner.x}();for(var v=0;v<d;){var m,b=v++;m=function(t){return n.zpp_inner.validate(),n.zpp_inner.miny}()+function(t){if(null!=r&&r.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return r.zpp_inner.validate(),r.zpp_inner.y}()*b;var y;y=b==d-1?n.zpp_inner.getmax().get_y():m+function(t){if(null!=r&&r.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return r.zpp_inner.validate(),r.zpp_inner.y}(),o.geom.ZPP_MarchingSquares.run(t,P,m,z,y,e,i,s,a)}}}return e.zpp_inner.weak&&e.dispose(),null!=r&&r.zpp_inner.weak&&r.dispose(),a},p.geom.Mat23=function(t,n,e,i,r,s){if(null==s&&(s=0),null==r&&(r=0),null==i&&(i=1),null==e&&(e=0),null==n&&(n=0),null==t&&(t=1),this.zpp_inner=null,this.zpp_inner=o.geom.ZPP_Mat23.get(),this.zpp_inner.outer=this,t!=t)throw"Error: Mat23::a cannot be NaN";if(this.zpp_inner.a=t,this.zpp_inner.invalidate(),this.zpp_inner.a,n!=n)throw"Error: Mat23::b cannot be NaN";if(this.zpp_inner.b=n,this.zpp_inner.invalidate(),this.zpp_inner.b,r!=r)throw"Error: Mat23::tx cannot be NaN";if(this.zpp_inner.tx=r,this.zpp_inner.invalidate(),this.zpp_inner.tx,e!=e)throw"Error: Mat23::c cannot be NaN";if(this.zpp_inner.c=e,this.zpp_inner.invalidate(),this.zpp_inner.c,i!=i)throw"Error: Mat23::d cannot be NaN";if(this.zpp_inner.d=i,this.zpp_inner.invalidate(),this.zpp_inner.d,s!=s)throw"Error: Mat23::ty cannot be NaN";this.zpp_inner.ty=s,this.zpp_inner.invalidate(),this.zpp_inner.ty},p.geom.Mat23.__name__=!0,p.geom.Mat23.rotation=function(t){if(t!=t)throw"Error: Cannot create rotation matrix with NaN angle";var n=Math.cos(t),e=Math.sin(t);return new p.geom.Mat23(n,-e,e,n,0,0)},p.geom.Mat23.translation=function(t,n){return new p.geom.Mat23(1,0,0,1,t,n)},p.geom.Mat23.scale=function(t,n){return new p.geom.Mat23(t,0,0,n,0,0)},p.geom.Mat23.prototype={get_a:function(){return this.zpp_inner.a},set_a:function(t){if(t!=t)throw"Error: Mat23::a cannot be NaN";return this.zpp_inner.a=t,this.zpp_inner.invalidate(),this.zpp_inner.a},get_b:function(){return this.zpp_inner.b},set_b:function(t){if(t!=t)throw"Error: Mat23::b cannot be NaN";return this.zpp_inner.b=t,this.zpp_inner.invalidate(),this.zpp_inner.b},get_c:function(){return this.zpp_inner.c},set_c:function(t){if(t!=t)throw"Error: Mat23::c cannot be NaN";return this.zpp_inner.c=t,this.zpp_inner.invalidate(),this.zpp_inner.c},get_d:function(){return this.zpp_inner.d},set_d:function(t){if(t!=t)throw"Error: Mat23::d cannot be NaN";return this.zpp_inner.d=t,this.zpp_inner.invalidate(),this.zpp_inner.d},get_tx:function(){return this.zpp_inner.tx},set_tx:function(t){if(t!=t)throw"Error: Mat23::tx cannot be NaN";return this.zpp_inner.tx=t,this.zpp_inner.invalidate(),this.zpp_inner.tx},get_ty:function(){return this.zpp_inner.ty},set_ty:function(t){if(t!=t)throw"Error: Mat23::ty cannot be NaN";return this.zpp_inner.ty=t,this.zpp_inner.invalidate(),this.zpp_inner.ty},copy:function(){return new p.geom.Mat23(this.zpp_inner.a,this.zpp_inner.b,this.zpp_inner.c,this.zpp_inner.d,this.zpp_inner.tx,this.zpp_inner.ty)},set:function(t){if(null==t)throw"Error: Cannot set form null matrix";return this.zpp_inner.set(t.zpp_inner),this.zpp_inner.invalidate(),this},setAs:function(t,n,e,i,r,s){return null==s&&(s=0),null==r&&(r=0),null==i&&(i=1),null==e&&(e=0),null==n&&(n=0),null==t&&(t=1),this.zpp_inner.setas(t,n,e,i,r,s),this.zpp_inner.invalidate(),this},reset:function(){return this.setAs()},get_determinant:function(){return this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c},singular:function(){var t=this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.b*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.c+this.zpp_inner.d*this.zpp_inner.d,n=this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c;return n<0&&(n=-n),t>p.Config.illConditionedThreshold*n},inverse:function(){
if(this.singular())throw"Error: Matrix is singular and cannot be inverted";var t=1/(this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c);return new p.geom.Mat23(this.zpp_inner.d*t,-this.zpp_inner.b*t,-this.zpp_inner.c*t,this.zpp_inner.a*t,(this.zpp_inner.b*this.zpp_inner.ty-this.zpp_inner.d*this.zpp_inner.tx)*t,(this.zpp_inner.c*this.zpp_inner.tx-this.zpp_inner.a*this.zpp_inner.ty)*t)},transpose:function(){return new p.geom.Mat23(this.zpp_inner.a,this.zpp_inner.c,this.zpp_inner.b,this.zpp_inner.d,-this.zpp_inner.a*this.zpp_inner.tx-this.zpp_inner.c*this.zpp_inner.ty,-this.zpp_inner.b*this.zpp_inner.tx-this.zpp_inner.d*this.zpp_inner.ty)},concat:function(t){var n=t;if(null==n)throw"Error: Cannot concatenate with null Mat23";return new p.geom.Mat23(n.zpp_inner.a*this.zpp_inner.a+n.zpp_inner.b*this.zpp_inner.c,n.zpp_inner.a*this.zpp_inner.b+n.zpp_inner.b*this.zpp_inner.d,n.zpp_inner.c*this.zpp_inner.a+n.zpp_inner.d*this.zpp_inner.c,n.zpp_inner.c*this.zpp_inner.b+n.zpp_inner.d*this.zpp_inner.d,n.zpp_inner.a*this.zpp_inner.tx+n.zpp_inner.b*this.zpp_inner.ty+n.zpp_inner.tx,n.zpp_inner.c*this.zpp_inner.tx+n.zpp_inner.d*this.zpp_inner.ty+n.zpp_inner.ty)},transform:function(t,n,e){if(null==e&&(e=!1),null==n&&(n=!1),null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot transform null Vec2";var i;return i=n?p.geom.Vec2.get(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()*this.zpp_inner.a+function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()*this.zpp_inner.b,function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()*this.zpp_inner.c+function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()*this.zpp_inner.d,e):p.geom.Vec2.get(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()*this.zpp_inner.a+function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()*this.zpp_inner.b+this.zpp_inner.tx,function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()*this.zpp_inner.c+function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()*this.zpp_inner.d+this.zpp_inner.ty,e),t.zpp_inner.weak&&t.dispose(),i},inverseTransform:function(t,n,e){if(null==e&&(e=!1),null==n&&(n=!1),null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot transform null Vec2";if(this.singular())throw"Error: Matrix is singular and inverse transformation cannot be performed";var i,r=1/(this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c);if(n)i=p.geom.Vec2.get((function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()*this.zpp_inner.d-function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()*this.zpp_inner.b)*r,(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()*this.zpp_inner.a-function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()*this.zpp_inner.c)*r,e);else{var s;s=function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()-this.zpp_inner.tx;var l;l=function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()-this.zpp_inner.ty,i=p.geom.Vec2.get((s*this.zpp_inner.d-l*this.zpp_inner.b)*r,(l*this.zpp_inner.a-s*this.zpp_inner.c)*r,e)}return t.zpp_inner.weak&&t.dispose(),i},toString:function(){return"{ a: "+this.zpp_inner.a+" b: "+this.zpp_inner.b+" c: "+this.zpp_inner.c+" d: "+this.zpp_inner.d+" tx: "+this.zpp_inner.tx+" ty: "+this.zpp_inner.ty+" }"},equiorthogonal:function(){if(this.singular())return!1;var t=this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d;if(t*t<p.Config.epsilon){var n=this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.b*this.zpp_inner.b-this.zpp_inner.c*this.zpp_inner.c-this.zpp_inner.d*this.zpp_inner.d;return n*n<p.Config.epsilon}return!1},orthogonal:function(){var t=this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d;if(t*t<p.Config.epsilon){var n=this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.b*this.zpp_inner.b-1,e=this.zpp_inner.c*this.zpp_inner.c+this.zpp_inner.d*this.zpp_inner.d-1;return n*n<p.Config.epsilon&&e*e<p.Config.epsilon}return!1},equiorthogonalise:function(){if(!this.equiorthogonal()){var t=Math.sqrt(this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.c*this.zpp_inner.c),n=Math.sqrt(this.zpp_inner.b*this.zpp_inner.b+this.zpp_inner.d*this.zpp_inner.d);if(t*t<p.Config.epsilon||n*n<p.Config.epsilon)throw"Error: Matrix is singular and cannot be equiorthogonalised";var e=(t+n)/2;t=e/t,n=e/n;var i=this;i.set_a(i.zpp_inner.a*t);var r=this;r.set_c(r.zpp_inner.c*t);var s=this;s.set_b(s.zpp_inner.b*n);var l=this;l.set_d(l.zpp_inner.d*n);var a=this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d,o=.25*Math.PI-.5*Math.acos(a/(e*e));this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c>0&&(o=-o);var _=Math.sin(o),h=Math.cos(o),u=this.zpp_inner.a*h-this.zpp_inner.c*_,d=this.zpp_inner.b*h+this.zpp_inner.d*_;if(this.set_c(this.zpp_inner.c*h+this.zpp_inner.a*_),u!=u)throw"Error: Mat23::a cannot be NaN";if(this.zpp_inner.a=u,this.zpp_inner.invalidate(),this.zpp_inner.a,this.set_d(this.zpp_inner.d*h-this.zpp_inner.b*_),d!=d)throw"Error: Mat23::b cannot be NaN";this.zpp_inner.b=d,this.zpp_inner.invalidate(),this.zpp_inner.b,this.zpp_inner.invalidate()}return this},orthogonalise:function(){if(!this.orthogonal()){var t=Math.sqrt(this.zpp_inner.a*this.zpp_inner.a+this.zpp_inner.c*this.zpp_inner.c),n=Math.sqrt(this.zpp_inner.b*this.zpp_inner.b+this.zpp_inner.d*this.zpp_inner.d);if(t*t<p.Config.epsilon||n*n<p.Config.epsilon)throw"Error: Matrix is singular and cannot be orthogonalised";t=1/t,n=1/n;var e=this;e.set_a(e.zpp_inner.a*t);var i=this;i.set_c(i.zpp_inner.c*t);var r=this;r.set_b(r.zpp_inner.b*n);var s=this;s.set_d(s.zpp_inner.d*n);var l=this.zpp_inner.a*this.zpp_inner.b+this.zpp_inner.c*this.zpp_inner.d,a=.25*Math.PI-.5*Math.acos(l/1);this.zpp_inner.a*this.zpp_inner.d-this.zpp_inner.b*this.zpp_inner.c>0&&(a=-a);var o=Math.sin(a),_=Math.cos(a),h=this.zpp_inner.a*_-this.zpp_inner.c*o,u=this.zpp_inner.b*_+this.zpp_inner.d*o;if(this.set_c(this.zpp_inner.c*_+this.zpp_inner.a*o),h!=h)throw"Error: Mat23::a cannot be NaN";if(this.zpp_inner.a=h,this.zpp_inner.invalidate(),this.zpp_inner.a,this.set_d(this.zpp_inner.d*_-this.zpp_inner.b*o),u!=u)throw"Error: Mat23::b cannot be NaN";this.zpp_inner.b=u,this.zpp_inner.invalidate(),this.zpp_inner.b,this.zpp_inner.invalidate()}return this},__class__:p.geom.Mat23},p.geom.MatMN=function(t,n){if(this.zpp_inner=null,t<=0||n<=0)throw"Error: MatMN::dimensions cannot be < 1";this.zpp_inner=new o.geom.ZPP_MatMN(t,n),this.zpp_inner.outer=this},p.geom.MatMN.__name__=!0,p.geom.MatMN.prototype={get_rows:function(){return this.zpp_inner.m},get_cols:function(){return this.zpp_inner.n},x:function(t,n){if(t<0||n<0||t>=this.zpp_inner.m||n>=this.zpp_inner.n)throw"Error: MatMN indices out of range";return this.zpp_inner.x[t*this.zpp_inner.n+n]},setx:function(t,n,e){if(t<0||n<0||t>=this.zpp_inner.m||n>=this.zpp_inner.n)throw"Error: MatMN indices out of range";return this.zpp_inner.x[t*this.zpp_inner.n+n]=e},toString:function(){for(var t="{ ",n=!0,e=0,i=this.zpp_inner.m;e<i;){var r=e++;n||(t+="; "),n=!1;for(var s=0,l=this.zpp_inner.n;s<l;){var a=s++;t+=function(t){if(r<0||a<0||r>=t.zpp_inner.m||a>=t.zpp_inner.n)throw"Error: MatMN indices out of range";return t.zpp_inner.x[r*t.zpp_inner.n+a]}(this)+" "}}return t+="}"},transpose:function(){for(var t=new p.geom.MatMN(this.zpp_inner.n,this.zpp_inner.m),n=0,e=this.zpp_inner.m;n<e;)for(var i=n++,r=0,s=this.zpp_inner.n;r<s;){var l=r++;t.setx(l,i,function(t){if(i<0||l<0||i>=t.zpp_inner.m||l>=t.zpp_inner.n)throw"Error: MatMN indices out of range";return t.zpp_inner.x[i*t.zpp_inner.n+l]}(this))}return t},mul:function(t){var n=t;if(this.zpp_inner.n!=n.zpp_inner.m)throw"Error: Matrix dimensions aren't compatible";for(var e=new p.geom.MatMN(this.zpp_inner.m,n.zpp_inner.n),i=0,r=this.zpp_inner.m;i<r;)for(var s=i++,l=0,a=n.zpp_inner.n;l<a;){for(var o=l++,_=0,h=0,u=this.zpp_inner.n;h<u;){var d=h++;_+=function(t){if(s<0||d<0||s>=t.zpp_inner.m||d>=t.zpp_inner.n)throw"Error: MatMN indices out of range";return t.zpp_inner.x[s*t.zpp_inner.n+d]}(this)*function(t){if(d<0||o<0||d>=n.zpp_inner.m||o>=n.zpp_inner.n)throw"Error: MatMN indices out of range";return n.zpp_inner.x[d*n.zpp_inner.n+o]}()}if(s<0||o<0||s>=e.zpp_inner.m||o>=e.zpp_inner.n)throw"Error: MatMN indices out of range";e.zpp_inner.x[s*e.zpp_inner.n+o]=_}return e},__class__:p.geom.MatMN},p.geom.Ray=function(t,n){if(this.zpp_inner=null,null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner=new o.geom.ZPP_Ray,null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Ray::origin cannot be null";if(this.zpp_inner.origin.set(t),this.zpp_inner.origin,null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==n)throw"Error: Ray::direction cannot be null";this.zpp_inner.direction.set(n),this.zpp_inner.zip_dir=!0,this.zpp_inner.direction,this.zpp_inner.maxdist=Math.POSITIVE_INFINITY},p.geom.Ray.__name__=!0,p.geom.Ray.fromSegment=function(t,n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Ray::fromSegment::start is null";if(null==n)throw"Error: Ray::fromSegment::end is null";var e=n.sub(t,!0),i=new p.geom.Ray(t,e);return i.set_maxDistance(Math.sqrt(o.geom.ZPP_VecMath.vec_dsq(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(),function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.x}(),function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.y}()))),t.zpp_inner.weak&&t.dispose(),n.zpp_inner.weak&&n.dispose(),i},p.geom.Ray.prototype={get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_origin:function(){return this.zpp_inner.origin},set_origin:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Ray::origin cannot be null";return this.zpp_inner.origin.set(t),this.zpp_inner.origin},get_direction:function(){return this.zpp_inner.direction},set_direction:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Ray::direction cannot be null";return this.zpp_inner.direction.set(t),this.zpp_inner.zip_dir=!0,this.zpp_inner.direction},get_maxDistance:function(){return this.zpp_inner.maxdist},set_maxDistance:function(t){if(t!=t)throw"Error: maxDistance cannot be NaN";return this.zpp_inner.maxdist=t,this.zpp_inner.maxdist},aabb:function(){return this.zpp_inner.rayAABB().wrapper()},at:function(t,n){return null==n&&(n=!1),this.zpp_inner.validate_dir(),p.geom.Vec2.get(this.zpp_inner.origin.get_x()+t*this.zpp_inner.dirx,this.zpp_inner.origin.get_y()+t*this.zpp_inner.diry,n)},copy:function(){var t=new p.geom.Ray(this.zpp_inner.origin,this.zpp_inner.direction);return t.set_maxDistance(this.zpp_inner.maxdist),t},__class__:p.geom.Ray},p.geom.RayResult=function(){if(this.zpp_inner=null,!o.geom.ZPP_ConvexRayResult.internal)throw"Error: RayResult cannot be instantiated derp!"},p.geom.RayResult.__name__=!0,p.geom.RayResult.prototype={get_normal:function(){if(null!=this.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return this.zpp_inner.normal},get_distance:function(){if(null!=this.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return this.zpp_inner.toiDistance},get_inner:function(){if(null!=this.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return this.zpp_inner.inner},get_shape:function(){if(null!=this.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return this.zpp_inner.shape},dispose:function(){if(null!=this.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";this.zpp_inner.free()},toString:function(){if(null!=this.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return"{ shape: "+r.string(function(t){if(null!=t.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return t.zpp_inner.shape}(this))+" distance: "+function(t){if(null!=t.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return t.zpp_inner.toiDistance}(this)+" ?inner: "+r.string(function(t){if(null!=t.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return t.zpp_inner.inner}(this))+" }"},__class__:p.geom.RayResult},p.geom.RayResultIterator=function(){if(this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null,!o.util.ZPP_RayResultList.internal)throw"Error: Cannot instantiate RayResultIterator derp!"},p.geom.RayResultIterator.__name__=!0,p.geom.RayResultIterator.get=function(t){var n;if(null==p.geom.RayResultIterator.zpp_pool){o.util.ZPP_RayResultList.internal=!0;var e=new p.geom.RayResultIterator;o.util.ZPP_RayResultList.internal=!1,n=e}else{var i=p.geom.RayResultIterator.zpp_pool;p.geom.RayResultIterator.zpp_pool=i.zpp_next,n=i}return n.zpp_i=0,n.zpp_inner=t,n.zpp_critical=!1,n},p.geom.RayResultIterator.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=p.geom.RayResultIterator.zpp_pool,p.geom.RayResultIterator.zpp_pool=this,this.zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:p.geom.RayResultIterator},p.geom.RayResultList=function(){this.zpp_inner=null,this.zpp_inner=new o.util.ZPP_RayResultList,this.zpp_inner.outer=this},p.geom.RayResultList.__name__=!0,p.geom.RayResultList.fromArray=function(t){if(null==t)throw"Error: Cannot convert null Array to Nape list";for(var n=new p.geom.RayResultList,e=0;e<t.length;){var i=t[e];++e,n.push(i)}return n},p.geom.RayResultList.prototype={get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t)},at:function(t){if(this.zpp_inner.valmod(),t<0||t>=this.get_length())throw"Error: Index out of bounds 9";if(this.zpp_inner.reverse_flag&&(t=this.get_length()-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt},push:function(t){if(this.zpp_inner.immutable)throw"Error: RayResultList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t):(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},unshift:function(t){if(this.zpp_inner.immutable)throw"Error: RayResultList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t)):this.zpp_inner.inner.add(t),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},pop:function(){if(this.zpp_inner.immutable)throw"Error: RayResultList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){t=this.zpp_inner.inner.head.elt;var n=t;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var e;e=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==e?this.zpp_inner.inner.head.elt:e.next.elt;var i=t;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)}return this.zpp_inner.invalidate(),t},shift:function(){if(this.zpp_inner.immutable)throw"Error: RayResultList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n;n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==n?this.zpp_inner.inner.head.elt:n.next.elt;var e=t;null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}else{t=this.zpp_inner.inner.head.elt;var i=t;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),t},add:function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},remove:function(t){if(this.zpp_inner.immutable)throw"Error: RayResultList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;n=!1;for(var e=this.zpp_inner.inner.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t),this.zpp_inner.invalidate()),n},clear:function(){if(this.zpp_inner.immutable)throw"Error: RayResultList is immutable";if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){return this.zpp_inner.valmod(),p.geom.RayResultIterator.get(this)},copy:function(t){null==t&&(t=!1);var n,e=new p.geom.RayResultList;for(this.zpp_inner.valmod(),n=p.geom.RayResultIterator.get(this);n.hasNext();){var i;n.zpp_critical=!1,i=n.zpp_inner.at(n.zpp_i++),e.push(t?function(t){throw"Error: RayResult is not a copyable type"}():i)}return e},merge:function(t){if(null==t)throw"Error: Cannot merge with null list";var n;for(t.zpp_inner.valmod(),n=p.geom.RayResultIterator.get(t);n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),this.has(e)||(this.zpp_inner.reverse_flag?this.push(e):this.unshift(e))}},toString:function(){var t,n="[",e=!0;for(this.zpp_inner.valmod(),t=p.geom.RayResultIterator.get(this);t.hasNext();){var i;t.zpp_critical=!1,i=t.zpp_inner.at(t.zpp_i++),e||(n+=","),n+=null==i?"NULL":i.toString(),e=!1}return n+"]"},foreach:function(t){if(null==t)throw"Error: Cannot execute null on list elements";var n;for(this.zpp_inner.valmod(),n=p.geom.RayResultIterator.get(this);n.hasNext();)try{t(function(t){return n.zpp_critical=!1,n.zpp_inner.at(n.zpp_i++)}())}catch(t){n.zpp_next=p.geom.RayResultIterator.zpp_pool,p.geom.RayResultIterator.zpp_pool=n,n.zpp_inner=null;break}return this},filter:function(t){if(null==t)throw"Error: Cannot select elements of list with null";for(var n=0;n<this.get_length();){var e=this.at(n);try{t(e)?n++:this.remove(e)}catch(t){break}}return this},__class__:p.geom.RayResultList},p.geom.Vec2=function(t,n){if(null==n&&(n=0),null==t&&(t=0),this.zpp_pool=null,this.zpp_inner=null,t!=t||n!=n)throw"Error: Vec2 components cannot be NaN";this.zpp_inner=o.geom.ZPP_Vec2.get(t,n,null),this.zpp_inner.outer=this},p.geom.Vec2.__name__=!0,p.geom.Vec2.weak=function(t,n){return null==n&&(n=0),null==t&&(t=0),p.geom.Vec2.get(t,n,!0)},p.geom.Vec2.get=function(t,n,e){if(null==e&&(e=!1),null==n&&(n=0),null==t&&(t=0),t!=t||n!=n)throw"Error: Vec2 components cannot be NaN";var i;if(null==o.util.ZPP_PubPool.poolVec2?i=new p.geom.Vec2:(i=o.util.ZPP_PubPool.poolVec2,o.util.ZPP_PubPool.poolVec2=i.zpp_pool,i.zpp_pool=null,i.zpp_disp=!1,i==o.util.ZPP_PubPool.nextVec2&&(o.util.ZPP_PubPool.nextVec2=null)),null==i.zpp_inner)i.zpp_inner=o.geom.ZPP_Vec2.get(t,n,null),i.zpp_inner.outer=i;else{if(null!=i&&i.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(i.zpp_inner.immutable(),t!=t||n!=n)throw"Error: Vec2 components cannot be NaN";(function(t){if(null!=i&&i.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return i.zpp_inner.validate(),i.zpp_inner.x})()==t&&function(t){if(null!=i&&i.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return i.zpp_inner.validate(),i.zpp_inner.y}()==n||(i.zpp_inner.x=t,i.zpp_inner.y=n,i.zpp_inner.invalidate())}return i.zpp_inner.weak=e,i},p.geom.Vec2.fromPolar=function(t,n,e){if(null==e&&(e=!1),t!=t)throw"Error: Vec2::length cannot be NaN";if(n!=n)throw"Error: Vec2::angle cannot be NaN";return p.geom.Vec2.get(t*Math.cos(n),t*Math.sin(n),e)},p.geom.Vec2.dsq=function(t,n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t||null==n)throw"Error: Cannot compute squared distance between null Vec2";var e=o.geom.ZPP_VecMath.vec_dsq(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(),function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.x}(),function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.y}());return t.zpp_inner.weak&&t.dispose(),n.zpp_inner.weak&&n.dispose(),e},p.geom.Vec2.distance=function(t,n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t||null==n)throw"Error: Cannot compute squared distance between null Vec2";var e=Math.sqrt(o.geom.ZPP_VecMath.vec_dsq(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(),function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.x}(),function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.y}()));return t.zpp_inner.weak&&t.dispose(),n.zpp_inner.weak&&n.dispose(),e},p.geom.Vec2.prototype={dispose:function(){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner.immutable(),this.zpp_inner._inuse)throw"Error: This Vec2 is not disposable";var t=this.zpp_inner;this.zpp_inner.outer=null,this.zpp_inner=null;var n=this;n.zpp_pool=null,null!=o.util.ZPP_PubPool.nextVec2?o.util.ZPP_PubPool.nextVec2.zpp_pool=n:o.util.ZPP_PubPool.poolVec2=n,o.util.ZPP_PubPool.nextVec2=n,n.zpp_disp=!0;var e=t;null!=e.outer&&(e.outer.zpp_inner=null,e.outer=null),e._isimmutable=null,e._validate=null,e._invalidate=null,e.next=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=e},copy:function(t){if(null==t&&(t=!1),this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return p.geom.Vec2.get(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this),function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this),t)},get_x:function(){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return this.zpp_inner.validate(),this.zpp_inner.x},set_x:function(t){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner.immutable(),function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)!=t){if(t!=t)throw"Error: Vec2::x cannot be NaN";this.zpp_inner.x=t,this.zpp_inner.invalidate()}if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return this.zpp_inner.validate(),this.zpp_inner.x},get_y:function(){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return this.zpp_inner.validate(),this.zpp_inner.y},set_y:function(t){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner.immutable(),function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)!=t){if(t!=t)throw"Error: Vec2::y cannot be NaN";this.zpp_inner.y=t,this.zpp_inner.invalidate()}if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return this.zpp_inner.validate(),this.zpp_inner.y},get_length:function(){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return Math.sqrt(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)+function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this))},set_length:function(t){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner.immutable(),t!=t)throw"Error: Vec2::length cannot be NaN";if(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)+function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)==0)throw"Error: Cannot set length of a zero vector";var n=t/Math.sqrt(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)+function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)),e=this;e.set_x(function(t){if(null!=e&&e.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return e.zpp_inner.validate(),e.zpp_inner.x}()*n);var i=this;if(i.set_y(function(t){if(null!=i&&i.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return i.zpp_inner.validate(),i.zpp_inner.y}()*n),this.zpp_inner.invalidate(),this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return Math.sqrt(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)+function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this))},lsq:function(){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)+function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)},set:function(t){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner.immutable(),null==t)throw"Error: Cannot assign null Vec2";var n=this.setxy(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}());return t.zpp_inner.weak&&t.dispose(),n},setxy:function(t,n){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner.immutable(),t!=t||n!=n)throw"Error: Vec2 components cannot be NaN";return function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)==t&&function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)==n||(this.zpp_inner.x=t,this.zpp_inner.y=n,this.zpp_inner.invalidate()),this},get_angle:function(){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)==function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)&&0==function(t){
if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)?0:Math.atan2(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this),function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this))},set_angle:function(t){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner.immutable(),t!=t)throw"Error: Vec2::angle cannot be NaN";var n;if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(n=Math.sqrt(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)+function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)),this.setxy(n*Math.cos(t),n*Math.sin(t)),this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)==function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)&&0==function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)?0:Math.atan2(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this),function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this))},rotate:function(t){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner.immutable(),t!=t)throw"Error: Cannot rotate Vec2 by NaN";if(t%(2*Math.PI)!=0){var n=Math.sin(t),e=Math.cos(t),i=e*this.zpp_inner.x-n*this.zpp_inner.y;this.zpp_inner.y=this.zpp_inner.x*n+this.zpp_inner.y*e,this.zpp_inner.x=i,this.zpp_inner.invalidate()}return this},reflect:function(t,n){if(null==n&&(n=!1),this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(0==function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return Math.sqrt(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(t)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(t)+function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(t)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(t))}(this))throw"Error: Cannot reflect in zero vector";var e=function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return p.geom.Vec2.get(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(t),function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(t),!0)}(this).normalise(),i=t.sub(e.muleq(2*e.dot(t)),n);return t.zpp_inner.weak&&t.dispose(),i},normalise:function(){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner.immutable(),0==function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return Math.sqrt(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(t)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(t)+function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(t)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(t))}(this))throw"Error: Cannot normalise vector of length 0";var t;t=function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)+function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this);var n=1/Math.sqrt(t),e=n,i=this;i.set_x(function(t){if(null!=i&&i.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return i.zpp_inner.validate(),i.zpp_inner.x}()*e);var r=this;return r.set_y(function(t){if(null!=r&&r.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return r.zpp_inner.validate(),r.zpp_inner.y}()*e),this.zpp_inner.invalidate(),this},unit:function(t){if(null==t&&(t=!1),this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(0==function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return Math.sqrt(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(t)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(t)+function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(t)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(t))}(this))throw"Error: Cannot normalise vector of length 0";var n=1/o.util.ZPP_Math.sqrt(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)+function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this));return p.geom.Vec2.get(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)*n,function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)*n,t)},add:function(t,n){if(null==n&&(n=!1),this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot add null vectors";var e=p.geom.Vec2.get(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)+function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)+function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(),n);return t.zpp_inner.weak&&t.dispose(),e},addMul:function(t,n,e){if(null==e&&(e=!1),this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot add null vectors";var i=p.geom.Vec2.get(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)+function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()*n,function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)+function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()*n,e);return t.zpp_inner.weak&&t.dispose(),i},sub:function(t,n){if(null==n&&(n=!1),this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot subtract null vectors";var e=p.geom.Vec2.get(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)-function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)-function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(),n);return t.zpp_inner.weak&&t.dispose(),e},mul:function(t,n){if(null==n&&(n=!1),this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(t!=t)throw"Error: Cannot multiply with NaN";return p.geom.Vec2.get(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)*t,function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)*t,n)},addeq:function(t){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner.immutable(),null==t)throw"Error: Cannot add null vectors";return this.setxy(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)+function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)+function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()),t.zpp_inner.weak&&t.dispose(),this},subeq:function(t){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner.immutable(),null==t)throw"Error: Cannot subtract null vectors";return this.setxy(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)-function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)-function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()),t.zpp_inner.weak&&t.dispose(),this},muleq:function(t){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner.immutable(),t!=t)throw"Error: Cannot multiply with NaN";return this.setxy(function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)*t,function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)*t)},dot:function(t){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot take dot product with null vector";var n;return n=function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)*function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()+function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)*function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(),t.zpp_inner.weak&&t.dispose(),n},cross:function(t){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot take cross product with null vector";var n;return n=function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)-function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()*function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this),t.zpp_inner.weak&&t.dispose(),n},perp:function(t){if(null==t&&(t=!1),this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return p.geom.Vec2.get(-function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this),function(t){if(t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this),t)},toString:function(){if(this.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return this.zpp_inner.validate(),this.zpp_inner.toString()},__class__:p.geom.Vec2},p.geom.Vec2Iterator=function(){if(this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null,!o.util.ZPP_Vec2List.internal)throw"Error: Cannot instantiate Vec2Iterator derp!"},p.geom.Vec2Iterator.__name__=!0,p.geom.Vec2Iterator.get=function(t){var n;if(null==p.geom.Vec2Iterator.zpp_pool){o.util.ZPP_Vec2List.internal=!0;var e=new p.geom.Vec2Iterator;o.util.ZPP_Vec2List.internal=!1,n=e}else{var i=p.geom.Vec2Iterator.zpp_pool;p.geom.Vec2Iterator.zpp_pool=i.zpp_next,n=i}return n.zpp_i=0,n.zpp_inner=t,n.zpp_critical=!1,n},p.geom.Vec2Iterator.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.zpp_gl();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=p.geom.Vec2Iterator.zpp_pool,p.geom.Vec2Iterator.zpp_pool=this,this.zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:p.geom.Vec2Iterator},p.geom.Vec2List=function(){this.zpp_inner=null,this.zpp_inner=new o.util.ZPP_Vec2List,this.zpp_inner.outer=this},p.geom.Vec2List.__name__=!0,p.geom.Vec2List.fromArray=function(t){if(null==t)throw"Error: Cannot convert null Array to Nape list";for(var n=new p.geom.Vec2List,e=0;e<t.length;){var i=t[e];++e,n.push(i)}return n},p.geom.Vec2List.prototype={get_length:function(){return this.zpp_gl()},zpp_gl:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},zpp_vm:function(){this.zpp_inner.valmod()},has:function(t){return this.zpp_vm(),this.zpp_inner.inner.has(t.zpp_inner)},at:function(t){if(this.zpp_vm(),t<0||t>=this.zpp_gl())throw"Error: Index out of bound1s";if(this.zpp_inner.reverse_flag&&(t=this.zpp_gl()-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.wrapper()},push:function(t){if(this.zpp_inner.immutable)throw"Error: Vec2List is immutable";this.zpp_inner.modify_test(),this.zpp_vm();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(this.empty()?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},unshift:function(t){if(this.zpp_inner.immutable)throw"Error: Vec2List is immutable";this.zpp_inner.modify_test(),this.zpp_vm();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(this.empty()?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.zpp_gl()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},pop:function(){if(this.zpp_inner.immutable)throw"Error: Vec2List is immutable";if(this.zpp_inner.modify_test(),this.empty())throw"Error: Cannot remove from empty list";this.zpp_vm();var t=null;if(this.zpp_inner.reverse_flag){t=this.zpp_inner.inner.head.elt;var n=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var e;e=1==this.zpp_gl()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2),t=null==e?this.zpp_inner.inner.head.elt:e.next.elt;var i=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)}return this.zpp_inner.invalidate(),t.wrapper()},shift:function(){if(this.zpp_inner.immutable)throw"Error: Vec2List is immutable";if(this.zpp_inner.modify_test(),this.empty())throw"Error: Cannot remove from empty list";this.zpp_vm();var t=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n;n=1==this.zpp_gl()?null:this.zpp_inner.inner.iterator_at(this.zpp_gl()-2),t=null==n?this.zpp_inner.inner.head.elt:n.next.elt;var e=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}else{t=this.zpp_inner.inner.head.elt;var i=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),t.wrapper()},add:function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},remove:function(t){if(this.zpp_inner.immutable)throw"Error: Vec2List is immutable";this.zpp_inner.modify_test(),this.zpp_vm();var n;n=!1;for(var e=this.zpp_inner.inner.head;null!=e;){if(e.elt==t.zpp_inner){n=!0;break}e=e.next}return n&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),n},clear:function(){if(this.zpp_inner.immutable)throw"Error: Vec2List is immutable";if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return 0==this.zpp_gl()},iterator:function(){return this.zpp_vm(),p.geom.Vec2Iterator.get(this)},copy:function(t){null==t&&(t=!1);for(var n=new p.geom.Vec2List,e=this.iterator();e.hasNext();){var i;e.zpp_critical=!1,i=e.zpp_inner.at(e.zpp_i++),n.push(t?function(t){if(null!=i&&i.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return p.geom.Vec2.get(function(t){if(null!=i&&i.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return i.zpp_inner.validate(),i.zpp_inner.x}(),function(t){if(null!=i&&i.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return i.zpp_inner.validate(),i.zpp_inner.y}(),!1)}():i)}return n},merge:function(t){if(null==t)throw"Error: Cannot merge with null list";for(var n=t.iterator();n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),this.has(e)||this.add(e)}},toString:function(){for(var t="[",n=!0,e=this.iterator();e.hasNext();){var i;e.zpp_critical=!1,i=e.zpp_inner.at(e.zpp_i++),n||(t+=","),t+=null==i?"NULL":i.toString(),n=!1}return t+"]"},foreach:function(t){if(null==t)throw"Error: Cannot execute null on list elements";for(var n=this.iterator();n.hasNext();)try{t(function(t){return n.zpp_critical=!1,n.zpp_inner.at(n.zpp_i++)}())}catch(t){n.zpp_next=p.geom.Vec2Iterator.zpp_pool,p.geom.Vec2Iterator.zpp_pool=n,n.zpp_inner=null;break}return this},filter:function(t){if(null==t)throw"Error: Cannot select elements of list with null";for(var n=0;n<this.zpp_gl();){var e=this.at(n);try{t(e)?n++:this.remove(e)}catch(t){break}}return this},__class__:p.geom.Vec2List},p.geom.Vec3=function(t,n,e){if(null==e&&(e=0),null==n&&(n=0),null==t&&(t=0),this.zpp_pool=null,this.zpp_inner=null,this.zpp_inner=new o.geom.ZPP_Vec3,this.zpp_inner.outer=this,this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(this.zpp_inner.immutable)throw"Error: Vec3 is immutable";if(this.zpp_inner.x=t,this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(this.zpp_inner.validate(),this.zpp_inner.x,this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(this.zpp_inner.immutable)throw"Error: Vec3 is immutable";if(this.zpp_inner.y=n,this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(this.zpp_inner.validate(),this.zpp_inner.y,this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(this.zpp_inner.immutable)throw"Error: Vec3 is immutable";if(this.zpp_inner.z=e,this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";this.zpp_inner.validate(),this.zpp_inner.z},p.geom.Vec3.__name__=!0,p.geom.Vec3.get=function(t,n,e){null==e&&(e=0),null==n&&(n=0),null==t&&(t=0);var i;return null==o.util.ZPP_PubPool.poolVec3?i=new p.geom.Vec3:(i=o.util.ZPP_PubPool.poolVec3,o.util.ZPP_PubPool.poolVec3=i.zpp_pool,i.zpp_pool=null,i.zpp_disp=!1,i==o.util.ZPP_PubPool.nextVec3&&(o.util.ZPP_PubPool.nextVec3=null)),i.setxyz(t,n,e),i.zpp_inner.immutable=!1,i.zpp_inner._validate=null,i},p.geom.Vec3.prototype={get_x:function(){if(this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return this.zpp_inner.validate(),this.zpp_inner.x},set_x:function(t){if(this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(this.zpp_inner.immutable)throw"Error: Vec3 is immutable";if(this.zpp_inner.x=t,this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return this.zpp_inner.validate(),this.zpp_inner.x},get_y:function(){if(this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return this.zpp_inner.validate(),this.zpp_inner.y},set_y:function(t){if(this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(this.zpp_inner.immutable)throw"Error: Vec3 is immutable";if(this.zpp_inner.y=t,this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return this.zpp_inner.validate(),this.zpp_inner.y},get_z:function(){if(this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return this.zpp_inner.validate(),this.zpp_inner.z},set_z:function(t){if(this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(this.zpp_inner.immutable)throw"Error: Vec3 is immutable";if(this.zpp_inner.z=t,this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return this.zpp_inner.validate(),this.zpp_inner.z},dispose:function(){if(this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(this.zpp_inner.immutable)throw"Error: This Vec3 is not disposable";var t=this;t.zpp_pool=null,null!=o.util.ZPP_PubPool.nextVec3?o.util.ZPP_PubPool.nextVec3.zpp_pool=t:o.util.ZPP_PubPool.poolVec3=t,o.util.ZPP_PubPool.nextVec3=t,t.zpp_disp=!0},get_length:function(){if(this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return Math.sqrt(function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)*function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)+function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)*function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)+function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.z}(this)*function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.z}(this))},set_length:function(t){if(this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(t!=t)throw"Error: Vec3::length cannot be NaN";if(function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)*function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)+function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)*function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)+function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.z}(this)*function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.z}(this)==0)throw"Error: Cannot set length of a zero vector";var n;n=t/function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return Math.sqrt(function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(t)*function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(t)+function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(t)*function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(t)+function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.z}(t)*function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.z}(t))}(this);var e=n,i=this;i.set_x(function(t){if(null!=i&&i.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return i.zpp_inner.validate(),i.zpp_inner.x}()*e);var r=this;r.set_y(function(t){if(null!=r&&r.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return r.zpp_inner.validate(),r.zpp_inner.y}()*e);var s=this;if(s.set_z(function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.z}()*n),this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return Math.sqrt(function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)*function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)+function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)*function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)+function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.z}(this)*function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.z}(this))},lsq:function(){if(this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)*function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this)+function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)*function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)+function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.z}(this)*function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.z}(this)},set:function(t){if(this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(null!=t&&t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot assign null Vec3";return this.setxyz(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(),function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.z}())},setxyz:function(t,n,e){if(this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(this.zpp_inner.immutable)throw"Error: Vec3 is immutable";if(this.zpp_inner.x=t,this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(this.zpp_inner.validate(),this.zpp_inner.x,this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(this.zpp_inner.immutable)throw"Error: Vec3 is immutable";if(this.zpp_inner.y=n,this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(this.zpp_inner.validate(),this.zpp_inner.y,this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";if(this.zpp_inner.immutable)throw"Error: Vec3 is immutable";if(this.zpp_inner.z=e,this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return this.zpp_inner.validate(),this.zpp_inner.z,this},xy:function(t){if(null==t&&(t=!1),this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return p.geom.Vec2.get(function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(this),function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this),t)},toString:function(){if(this.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return"{ x: "+function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x
}(this)+" y: "+function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(this)+" z: "+function(t){if(t.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.z}(this)+" }"},__class__:p.geom.Vec3},p.geom.Winding=function(){if(!o.util.ZPP_Flags.internal)throw"Error: Cannot instantiate Winding derp!"},p.geom.Winding.__name__=!0,p.geom.Winding.get_UNDEFINED=function(){return null==o.util.ZPP_Flags.Winding_UNDEFINED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Winding_UNDEFINED=new p.geom.Winding,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Winding_UNDEFINED},p.geom.Winding.get_CLOCKWISE=function(){return null==o.util.ZPP_Flags.Winding_CLOCKWISE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Winding_CLOCKWISE=new p.geom.Winding,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Winding_CLOCKWISE},p.geom.Winding.get_ANTICLOCKWISE=function(){return null==o.util.ZPP_Flags.Winding_ANTICLOCKWISE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Winding_ANTICLOCKWISE=new p.geom.Winding,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Winding_ANTICLOCKWISE},p.geom.Winding.prototype={toString:function(){return this==function(t){return null==o.util.ZPP_Flags.Winding_UNDEFINED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Winding_UNDEFINED=new p.geom.Winding,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Winding_UNDEFINED}()?"UNDEFINED":this==function(t){return null==o.util.ZPP_Flags.Winding_CLOCKWISE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Winding_CLOCKWISE=new p.geom.Winding,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Winding_CLOCKWISE}()?"CLOCKWISE":this==function(t){return null==o.util.ZPP_Flags.Winding_ANTICLOCKWISE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Winding_ANTICLOCKWISE=new p.geom.Winding,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Winding_ANTICLOCKWISE}()?"ANTICLOCKWISE":""},__class__:p.geom.Winding},p.phys={},p.phys.Interactor=function(){if(this.zpp_inner_i=null,!p.phys.Interactor.zpp_internalAlloc)throw"Error: Cannot instantiate an Interactor, only Shape/Body/Compound"},p.phys.Interactor.__name__=!0,p.phys.Interactor.prototype={get_id:function(){return this.zpp_inner_i.id},get_userData:function(){return null==this.zpp_inner_i.userData&&(this.zpp_inner_i.userData={}),this.zpp_inner_i.userData},isShape:function(){return null!=this.zpp_inner_i.ishape},isBody:function(){return null!=this.zpp_inner_i.ibody},isCompound:function(){return null!=this.zpp_inner_i.icompound},get_castShape:function(){return null!=this.zpp_inner_i.ishape?this.zpp_inner_i.ishape.outer:null},get_castBody:function(){return null!=this.zpp_inner_i.ibody?this.zpp_inner_i.ibody.outer:null},get_castCompound:function(){return null!=this.zpp_inner_i.icompound?this.zpp_inner_i.icompound.outer:null},get_group:function(){return null==this.zpp_inner_i.group?null:this.zpp_inner_i.group.outer},set_group:function(t){return this.zpp_inner_i.immutable_midstep("Interactor::group"),this.zpp_inner_i.setGroup(null==t?null:t.zpp_inner),null==this.zpp_inner_i.group?null:this.zpp_inner_i.group.outer},get_cbTypes:function(){return null==this.zpp_inner_i.wrap_cbTypes&&this.zpp_inner_i.setupcbTypes(),this.zpp_inner_i.wrap_cbTypes},toString:function(){return""},__class__:p.phys.Interactor},p.phys.Body=function(t,n){if(this.debugDraw=!0,this.zpp_inner=null,p.phys.Interactor.zpp_internalAlloc=!0,p.phys.Interactor.call(this),p.phys.Interactor.zpp_internalAlloc=!1,this.zpp_inner=new o.phys.ZPP_Body,this.zpp_inner.outer=this,this.zpp_inner.outer_i=this,this.zpp_inner_i=this.zpp_inner,null!=n){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(n.zpp_inner.validate(),this.zpp_inner.posx=n.zpp_inner.x,null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";n.zpp_inner.validate(),this.zpp_inner.posy=n.zpp_inner.y}else this.zpp_inner.posx=0,this.zpp_inner.posy=0;this.set_type(null==t?function(t){return null==o.util.ZPP_Flags.BodyType_DYNAMIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_DYNAMIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_DYNAMIC}():t),null!=n&&n.zpp_inner.weak&&n.dispose(),this.zpp_inner_i.insert_cbtype(o.callbacks.ZPP_CbType.ANY_BODY.zpp_inner)},p.phys.Body.__name__=!0,p.phys.Body.__super__=p.phys.Interactor,p.phys.Body.prototype=t(p.phys.Interactor.prototype,{get_type:function(){return o.phys.ZPP_Body.types[this.zpp_inner.type]},set_type:function(t){if(this.zpp_inner.immutable_midstep("Body::type"),this.zpp_inner.world)throw"Error: Space::world is immutable";if(o.phys.ZPP_Body.types[this.zpp_inner.type]!=t){if(null==t)throw"Error: Cannot use null BodyType";var n;n=t==function(t){return null==o.util.ZPP_Flags.BodyType_DYNAMIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_DYNAMIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_DYNAMIC}()?o.util.ZPP_Flags.id_BodyType_DYNAMIC:t==function(t){return null==o.util.ZPP_Flags.BodyType_KINEMATIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_KINEMATIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_KINEMATIC}()?o.util.ZPP_Flags.id_BodyType_KINEMATIC:o.util.ZPP_Flags.id_BodyType_STATIC,n==o.util.ZPP_Flags.id_BodyType_STATIC&&null!=this.zpp_inner.space&&(this.zpp_inner.velx=0,this.zpp_inner.vely=0,this.zpp_inner.angvel=0),this.zpp_inner.invalidate_type(),null!=this.zpp_inner.space?this.zpp_inner.space.transmitType(this.zpp_inner,n):this.zpp_inner.type=n}return o.phys.ZPP_Body.types[this.zpp_inner.type]},get_isBullet:function(){return this.zpp_inner.bulletEnabled},set_isBullet:function(t){return this.zpp_inner.bulletEnabled=t,this.zpp_inner.bulletEnabled},get_disableCCD:function(){return this.zpp_inner.disableCCD},set_disableCCD:function(t){return this.zpp_inner.disableCCD=t,this.zpp_inner.disableCCD},integrate:function(t){if(t!=t)throw"Cannot integrate by NaN time";if(this.zpp_inner.immutable_midstep("Body::space"),this.zpp_inner.world)throw"Error: Space::world is immutable";if(0==t)return this;var n=this.zpp_inner;return n.sweepTime=0,n.sweep_angvel=n.angvel,n.sweepIntegrate(t),n.invalidate_pos(),n.invalidate_rot(),n.sweepTime=0,this},isStatic:function(){return this.zpp_inner.type==o.util.ZPP_Flags.id_BodyType_STATIC},isDynamic:function(){return this.zpp_inner.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC},isKinematic:function(){return this.zpp_inner.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC},get_shapes:function(){return this.zpp_inner.wrap_shapes},get_compound:function(){return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},set_compound:function(t){return(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)!=t&&(null!=(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)&&(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer).zpp_inner.wrap_bodies.remove(this),null!=t&&t.zpp_inner.wrap_bodies.add(this)),null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},get_space:function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},set_space:function(t){if(null!=this.zpp_inner.compound)throw"Error: Cannot set the space of a Body belonging to a Compound, only the root Compound space can be set";if(this.zpp_inner.immutable_midstep("Body::space"),this.zpp_inner.world)throw"Error: Space::world is immutable";return(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=t&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(this.zpp_inner.component.woken=!1),null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(null==this.zpp_inner.space?null:this.zpp_inner.space.outer).zpp_inner.wrap_bodies.remove(this),null!=t&&t.zpp_inner.wrap_bodies.add(this)),null==this.zpp_inner.space?null:this.zpp_inner.space.outer},get_arbiters:function(){return null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=o.util.ZPP_ArbiterList.get(this.zpp_inner.arbiters,!0)),this.zpp_inner.wrap_arbiters},get_isSleeping:function(){if(null==this.zpp_inner.space)throw"Error: isSleeping makes no sense if the object is not contained within a Space";return this.zpp_inner.component.sleeping},get_constraints:function(){return null==this.zpp_inner.wrap_constraints&&(this.zpp_inner.wrap_constraints=o.util.ZPP_ConstraintList.get(this.zpp_inner.constraints,!0)),this.zpp_inner.wrap_constraints},copy:function(){if(this.zpp_inner.world)throw"Error: Space::world cannot be copied";return this.zpp_inner.copy()},get_position:function(){return null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition(),this.zpp_inner.wrap_pos},set_position:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Body::position cannot be null";return function(t){return null==t.zpp_inner.wrap_pos&&t.zpp_inner.setupPosition(),t.zpp_inner.wrap_pos}(this).set(t),null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition(),this.zpp_inner.wrap_pos},get_velocity:function(){return null==this.zpp_inner.wrap_vel&&this.zpp_inner.setupVelocity(),this.zpp_inner.wrap_vel},set_velocity:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Body::velocity cannot be null";return function(t){return null==t.zpp_inner.wrap_vel&&t.zpp_inner.setupVelocity(),t.zpp_inner.wrap_vel}(this).set(t),null==this.zpp_inner.wrap_vel&&this.zpp_inner.setupVelocity(),this.zpp_inner.wrap_vel},setVelocityFromTarget:function(t,n,e){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Cannot set velocity for null target position";if(0==e)throw"deltaTime cannot be 0 for setVelocityFromTarget";var i=1/e;return function(t){return null==t.zpp_inner.wrap_vel&&t.zpp_inner.setupVelocity(),t.zpp_inner.wrap_vel}(this).set(t.sub(function(t){return null==t.zpp_inner.wrap_pos&&t.zpp_inner.setupPosition(),t.zpp_inner.wrap_pos}(this),!0).muleq(i)),this.set_angularVel((n-this.zpp_inner.rot)*i),t.zpp_inner.weak&&t.dispose(),this},get_kinematicVel:function(){return null==this.zpp_inner.wrap_kinvel&&this.zpp_inner.setupkinvel(),this.zpp_inner.wrap_kinvel},set_kinematicVel:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Body::kinematicVel cannot be null";return function(t){return null==t.zpp_inner.wrap_kinvel&&t.zpp_inner.setupkinvel(),t.zpp_inner.wrap_kinvel}(this).set(t),null==this.zpp_inner.wrap_kinvel&&this.zpp_inner.setupkinvel(),this.zpp_inner.wrap_kinvel},get_surfaceVel:function(){return null==this.zpp_inner.wrap_svel&&this.zpp_inner.setupsvel(),this.zpp_inner.wrap_svel},set_surfaceVel:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Body::surfaceVel cannot be null";return function(t){return null==t.zpp_inner.wrap_svel&&t.zpp_inner.setupsvel(),t.zpp_inner.wrap_svel}(this).set(t),null==this.zpp_inner.wrap_svel&&this.zpp_inner.setupsvel(),this.zpp_inner.wrap_svel},get_force:function(){return null==this.zpp_inner.wrap_force&&this.zpp_inner.setupForce(),this.zpp_inner.wrap_force},set_force:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Body::force cannot be null";return function(t){return null==t.zpp_inner.wrap_force&&t.zpp_inner.setupForce(),t.zpp_inner.wrap_force}(this).set(t),null==this.zpp_inner.wrap_force&&this.zpp_inner.setupForce(),this.zpp_inner.wrap_force},get_constraintVelocity:function(){return null==this.zpp_inner.wrapcvel&&this.zpp_inner.setup_cvel(),this.zpp_inner.wrapcvel},get_rotation:function(){return this.zpp_inner.rot},set_rotation:function(t){if(this.zpp_inner.immutable_midstep("Body::rotation"),this.zpp_inner.world)throw"Error: Space::world is immutable";if(this.zpp_inner.type==o.util.ZPP_Flags.id_BodyType_STATIC&&null!=this.zpp_inner.space)throw"Error: Static objects cannot be rotated once inside a Space";if(this.zpp_inner.rot!=t){if(t!=t)throw"Error: Body::rotation cannot be NaN";this.zpp_inner.rot=t,this.zpp_inner.invalidate_rot(),this.zpp_inner.wake()}return this.zpp_inner.rot},get_angularVel:function(){return this.zpp_inner.angvel},set_angularVel:function(t){if(this.zpp_inner.world)throw"Error: Space::world is immutable";if(this.zpp_inner.angvel!=t){if(t!=t)throw"Error: Body::angularVel cannot be NaN";if(this.zpp_inner.type==o.util.ZPP_Flags.id_BodyType_STATIC)throw"Error: A static object cannot be given a velocity";this.zpp_inner.angvel=t,this.zpp_inner.wake()}return this.zpp_inner.angvel},get_kinAngVel:function(){return this.zpp_inner.kinangvel},set_kinAngVel:function(t){if(this.zpp_inner.world)throw"Error: Space::world is immutable";if(this.zpp_inner.kinangvel!=t){if(t!=t)throw"Error: Body::kinAngVel cannot be NaN";this.zpp_inner.kinangvel=t,this.zpp_inner.wake()}return this.zpp_inner.kinangvel},get_torque:function(){return this.zpp_inner.torque},set_torque:function(t){if(this.zpp_inner.world)throw"Error: Space::world is immutable";if(this.zpp_inner.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC)throw"Error: Non-dynamic body cannot have torque applied.";if(t!=t)throw"Error: Body::torque cannot be NaN";return this.zpp_inner.torque!=t&&(this.zpp_inner.torque=t,this.zpp_inner.wake()),this.zpp_inner.torque},get_bounds:function(){if(this.zpp_inner.world)throw"Error: Space::world has no bounds";return this.zpp_inner.aabb.wrapper()},get_allowMovement:function(){return!this.zpp_inner.nomove},set_allowMovement:function(t){return this.zpp_inner.immutable_midstep("Body::"+(null==t?"null":""+t)),!this.zpp_inner.nomove!=t&&(this.zpp_inner.nomove=!t,this.zpp_inner.invalidate_mass()),!this.zpp_inner.nomove},get_allowRotation:function(){return!this.zpp_inner.norotate},set_allowRotation:function(t){return this.zpp_inner.immutable_midstep("Body::"+(null==t?"null":""+t)),!this.zpp_inner.norotate!=t&&(this.zpp_inner.norotate=!t,this.zpp_inner.invalidate_inertia()),!this.zpp_inner.norotate},get_massMode:function(){return[function(t){return null==o.util.ZPP_Flags.MassMode_DEFAULT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.MassMode_DEFAULT=new p.phys.MassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.MassMode_DEFAULT}(),function(t){return null==o.util.ZPP_Flags.MassMode_FIXED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.MassMode_FIXED=new p.phys.MassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.MassMode_FIXED}()][this.zpp_inner.massMode]},set_massMode:function(t){if(this.zpp_inner.immutable_midstep("Body::massMode"),this.zpp_inner.world)throw"Error: Space::world is immutable";if(null==t)throw"Error: cannot use null massMode";return t==function(t){return null==o.util.ZPP_Flags.MassMode_DEFAULT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.MassMode_DEFAULT=new p.phys.MassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.MassMode_DEFAULT}()?this.zpp_inner.massMode=o.util.ZPP_Flags.id_MassMode_DEFAULT:this.zpp_inner.massMode=o.util.ZPP_Flags.id_MassMode_FIXED,this.zpp_inner.invalidate_mass(),[function(t){return null==o.util.ZPP_Flags.MassMode_DEFAULT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.MassMode_DEFAULT=new p.phys.MassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.MassMode_DEFAULT}(),function(t){return null==o.util.ZPP_Flags.MassMode_FIXED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.MassMode_FIXED=new p.phys.MassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.MassMode_FIXED}()][this.zpp_inner.massMode]},get_constraintMass:function(){return this.zpp_inner.world||this.zpp_inner.validate_mass(),this.zpp_inner.smass},get_mass:function(){if(this.zpp_inner.world)throw"Error: Space::world has no mass";if(this.zpp_inner.validate_mass(),this.zpp_inner.massMode==o.util.ZPP_Flags.id_MassMode_DEFAULT&&null==this.zpp_inner.shapes.head)throw"Error: Given current mass mode, Body::mass only makes sense if it contains shapes";return this.zpp_inner.cmass},set_mass:function(t){if(this.zpp_inner.immutable_midstep("Body::mass"),this.zpp_inner.world)throw"Error: Space::world is immutable";if(t!=t)throw"Error: Mass cannot be NaN";if(t<=0)throw"Error: Mass must be strictly positive";if(t>=Math.POSITIVE_INFINITY)throw"Error: Mass cannot be infinite, use allowMovement = false instead";if(this.zpp_inner.massMode=o.util.ZPP_Flags.id_MassMode_FIXED,this.zpp_inner.cmass=t,this.zpp_inner.invalidate_mass(),this.zpp_inner.world)throw"Error: Space::world has no mass";if(this.zpp_inner.validate_mass(),this.zpp_inner.massMode==o.util.ZPP_Flags.id_MassMode_DEFAULT&&null==this.zpp_inner.shapes.head)throw"Error: Given current mass mode, Body::mass only makes sense if it contains shapes";return this.zpp_inner.cmass},get_gravMassMode:function(){return[function(t){return null==o.util.ZPP_Flags.GravMassMode_DEFAULT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.GravMassMode_DEFAULT=new p.phys.GravMassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.GravMassMode_DEFAULT}(),function(t){return null==o.util.ZPP_Flags.GravMassMode_FIXED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.GravMassMode_FIXED=new p.phys.GravMassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.GravMassMode_FIXED}(),function(t){return null==o.util.ZPP_Flags.GravMassMode_SCALED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.GravMassMode_SCALED=new p.phys.GravMassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.GravMassMode_SCALED}()][this.zpp_inner.massMode]},set_gravMassMode:function(t){if(this.zpp_inner.immutable_midstep("Body::gravMassMode"),this.zpp_inner.world)throw"Error: Space::world is immutable";if(null==t)throw"Error: Cannot use null gravMassMode";return t==function(t){return null==o.util.ZPP_Flags.GravMassMode_SCALED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.GravMassMode_SCALED=new p.phys.GravMassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.GravMassMode_SCALED}()?this.zpp_inner.gravMassMode=o.util.ZPP_Flags.id_GravMassMode_SCALED:t==function(t){return null==o.util.ZPP_Flags.GravMassMode_DEFAULT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.GravMassMode_DEFAULT=new p.phys.GravMassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.GravMassMode_DEFAULT}()?this.zpp_inner.gravMassMode=o.util.ZPP_Flags.id_GravMassMode_DEFAULT:this.zpp_inner.gravMassMode=o.util.ZPP_Flags.id_GravMassMode_FIXED,this.zpp_inner.invalidate_gravMass(),[function(t){return null==o.util.ZPP_Flags.GravMassMode_DEFAULT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.GravMassMode_DEFAULT=new p.phys.GravMassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.GravMassMode_DEFAULT}(),function(t){return null==o.util.ZPP_Flags.GravMassMode_FIXED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.GravMassMode_FIXED=new p.phys.GravMassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.GravMassMode_FIXED}(),function(t){return null==o.util.ZPP_Flags.GravMassMode_SCALED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.GravMassMode_SCALED=new p.phys.GravMassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.GravMassMode_SCALED}()][this.zpp_inner.massMode]},get_gravMass:function(){if(this.zpp_inner.world)throw"Error: Space::world has no gravMass";if(this.zpp_inner.validate_gravMass(),null==this.zpp_inner.shapes.head&&this.zpp_inner.massMode==o.util.ZPP_Flags.id_MassMode_DEFAULT&&this.zpp_inner.gravMassMode!=o.util.ZPP_Flags.id_GravMassMode_FIXED)throw"Error: Given current mass/gravMass modes; Body::gravMass only makes sense if it contains Shapes";return this.zpp_inner.gravMass},set_gravMass:function(t){if(this.zpp_inner.immutable_midstep("Body::gravMass"),this.zpp_inner.world)throw"Error: Space::world is immutable";if(t!=t)throw"Error: gravMass cannot be NaN";if(this.zpp_inner.gravMassMode=o.util.ZPP_Flags.id_GravMassMode_FIXED,this.zpp_inner.gravMass=t,this.zpp_inner.invalidate_gravMass(),this.zpp_inner.world)throw"Error: Space::world has no gravMass";if(this.zpp_inner.validate_gravMass(),null==this.zpp_inner.shapes.head&&this.zpp_inner.massMode==o.util.ZPP_Flags.id_MassMode_DEFAULT&&this.zpp_inner.gravMassMode!=o.util.ZPP_Flags.id_GravMassMode_FIXED)throw"Error: Given current mass/gravMass modes; Body::gravMass only makes sense if it contains Shapes";return this.zpp_inner.gravMass},get_gravMassScale:function(){if(this.zpp_inner.validate_gravMassScale(),null==this.zpp_inner.shapes.head&&this.zpp_inner.massMode==o.util.ZPP_Flags.id_MassMode_DEFAULT&&this.zpp_inner.gravMassMode!=o.util.ZPP_Flags.id_GravMassMode_SCALED)throw"Error: Given current mass/gravMass modes; Body::gravMassScale only makes sense if it contains Shapes";return this.zpp_inner.gravMassScale},set_gravMassScale:function(t){if(this.zpp_inner.immutable_midstep("Body::gravMassScale"),this.zpp_inner.world)throw"Error: Space::world is immutable";if(t!=t)throw"Error: gravMassScale cannot be NaN";if(this.zpp_inner.gravMassMode=o.util.ZPP_Flags.id_GravMassMode_SCALED,this.zpp_inner.gravMassScale=t,this.zpp_inner.invalidate_gravMassScale(),this.zpp_inner.validate_gravMassScale(),null==this.zpp_inner.shapes.head&&this.zpp_inner.massMode==o.util.ZPP_Flags.id_MassMode_DEFAULT&&this.zpp_inner.gravMassMode!=o.util.ZPP_Flags.id_GravMassMode_SCALED)throw"Error: Given current mass/gravMass modes; Body::gravMassScale only makes sense if it contains Shapes";return this.zpp_inner.gravMassScale},get_inertiaMode:function(){return[function(t){return null==o.util.ZPP_Flags.InertiaMode_DEFAULT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InertiaMode_DEFAULT=new p.phys.InertiaMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InertiaMode_DEFAULT}(),function(t){return null==o.util.ZPP_Flags.InertiaMode_FIXED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InertiaMode_FIXED=new p.phys.InertiaMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InertiaMode_FIXED}()][this.zpp_inner.inertiaMode]},set_inertiaMode:function(t){if(this.zpp_inner.immutable_midstep("Body::inertiaMode"),this.zpp_inner.world)throw"Error: Space::world is immutable";if(null==t)throw"Error: Cannot use null InertiaMode";return t==function(t){return null==o.util.ZPP_Flags.InertiaMode_FIXED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InertiaMode_FIXED=new p.phys.InertiaMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InertiaMode_FIXED}()?this.zpp_inner.inertiaMode=o.util.ZPP_Flags.id_InertiaMode_FIXED:this.zpp_inner.inertiaMode=o.util.ZPP_Flags.id_InertiaMode_DEFAULT,this.zpp_inner.invalidate_inertia(),[function(t){return null==o.util.ZPP_Flags.InertiaMode_DEFAULT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InertiaMode_DEFAULT=new p.phys.InertiaMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InertiaMode_DEFAULT}(),function(t){return null==o.util.ZPP_Flags.InertiaMode_FIXED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InertiaMode_FIXED=new p.phys.InertiaMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InertiaMode_FIXED}()][this.zpp_inner.inertiaMode]},get_constraintInertia:function(){return this.zpp_inner.world||this.zpp_inner.validate_inertia(),this.zpp_inner.sinertia},get_inertia:function(){if(this.zpp_inner.world)throw"Error: Space::world has no inertia";if(this.zpp_inner.validate_inertia(),this.zpp_inner.inertiaMode==o.util.ZPP_Flags.id_InertiaMode_DEFAULT&&this.zpp_inner.wrap_shapes.empty())throw"Error: Given current inertia mode flag, Body::inertia only makes sense if Body contains Shapes";return this.zpp_inner.cinertia},set_inertia:function(t){if(this.zpp_inner.immutable_midstep("Body::inertia"),this.zpp_inner.world)throw"Error: Space::world is immutable";if(t!=t)throw"Error: Inertia cannot be NaN";if(t<=0)throw"Error: Inertia must be strictly positive";if(t>=Math.POSITIVE_INFINITY)throw"Error: Inertia cannot be infinite, use allowRotation = false instead";if(this.zpp_inner.inertiaMode=o.util.ZPP_Flags.id_InertiaMode_FIXED,this.zpp_inner.cinertia=t,this.zpp_inner.invalidate_inertia(),this.zpp_inner.world)throw"Error: Space::world has no inertia";if(this.zpp_inner.validate_inertia(),this.zpp_inner.inertiaMode==o.util.ZPP_Flags.id_InertiaMode_DEFAULT&&this.zpp_inner.wrap_shapes.empty())throw"Error: Given current inertia mode flag, Body::inertia only makes sense if Body contains Shapes";return this.zpp_inner.cinertia},connectedBodies:function(t,n){return null==t&&(t=-1),this.zpp_inner.connectedBodies(t,n)},interactingBodies:function(t,n,e){null==n&&(n=-1);var i;return i=null==t?o.dynamics.ZPP_Arbiter.COL|o.dynamics.ZPP_Arbiter.SENSOR|o.dynamics.ZPP_Arbiter.FLUID:t==function(t){return null==o.util.ZPP_Flags.InteractionType_COLLISION&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_COLLISION=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_COLLISION}()?o.dynamics.ZPP_Arbiter.COL:t==function(t){return null==o.util.ZPP_Flags.InteractionType_SENSOR&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_SENSOR=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_SENSOR}()?o.dynamics.ZPP_Arbiter.SENSOR:o.dynamics.ZPP_Arbiter.FLUID,this.zpp_inner.interactingBodies(i,n,e)},crushFactor:function(){if(null==(null==this.zpp_inner.space?null:this.zpp_inner.space.outer))throw"Error: Makes no sense to see how much an object not taking part in a simulation is being crushed";for(var t=0,n=p.geom.Vec2.get(null,null,null),e=function(t){return null==t.zpp_inner.wrap_arbiters&&(t.zpp_inner.wrap_arbiters=o.util.ZPP_ArbiterList.get(t.zpp_inner.arbiters,!0)),t.zpp_inner.wrap_arbiters}(this).iterator();e.hasNext();){var i;e.zpp_critical=!1,i=e.zpp_inner.at(e.zpp_i++);var r=i.totalImpulse(this),s=r.xy();if(n.addeq(s),null!=s&&s.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";t+=Math.sqrt(function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.x}()*function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.x}()+function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.y}()*function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.y}()),s.dispose(),r.dispose()}for(var l=function(t){return null==t.zpp_inner.wrap_constraints&&(t.zpp_inner.wrap_constraints=o.util.ZPP_ConstraintList.get(t.zpp_inner.constraints,!0)),t.zpp_inner.wrap_constraints}(this).iterator();l.hasNext();){var a;l.zpp_critical=!1,a=l.zpp_inner.at(l.zpp_i++);var _=a.bodyImpulse(this),h=_.xy();if(n.addeq(h),null!=h&&h.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";t+=Math.sqrt(function(t){if(null!=h&&h.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return h.zpp_inner.validate(),h.zpp_inner.x}()*function(t){if(null!=h&&h.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return h.zpp_inner.validate(),h.zpp_inner.x}()+function(t){if(null!=h&&h.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return h.zpp_inner.validate(),h.zpp_inner.y}()*function(t){if(null!=h&&h.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return h.zpp_inner.validate(),h.zpp_inner.y}()),h.dispose(),_.dispose()}var u;return u=(t-function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return Math.sqrt(function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.x}()*function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.x}()+function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.y}()*function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.y}())}())/(function(t){if(t.zpp_inner.world)throw"Error: Space::world has no mass";if(t.zpp_inner.validate_mass(),t.zpp_inner.massMode==o.util.ZPP_Flags.id_MassMode_DEFAULT&&null==t.zpp_inner.shapes.head)throw"Error: Given current mass mode, Body::mass only makes sense if it contains shapes";return t.zpp_inner.cmass}(this)*(null==this.zpp_inner.space?null:this.zpp_inner.space.outer).zpp_inner.pre_dt),n.dispose(),u},localPointToWorld:function(t,n){if(null==n&&(n=!1),null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot transform null Vec2";this.zpp_inner.validate_axis();var e=0,i=0;return e=this.zpp_inner.axisy*function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()-this.zpp_inner.axisx*function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(),i=function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()*this.zpp_inner.axisx+function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()*this.zpp_inner.axisy,t.zpp_inner.weak&&t.dispose(),p.geom.Vec2.get(e+this.zpp_inner.posx,i+this.zpp_inner.posy,n)},worldPointToLocal:function(t,n){if(null==n&&(n=!1),null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot transform null Vec2";this.zpp_inner.validate_axis();var e=0,i=0,r=0,s=0;return r=function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()-this.zpp_inner.posx,s=function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()-this.zpp_inner.posy,e=r*this.zpp_inner.axisy+s*this.zpp_inner.axisx,i=s*this.zpp_inner.axisy-r*this.zpp_inner.axisx,t.zpp_inner.weak&&t.dispose(),p.geom.Vec2.get(e,i,n)},localVectorToWorld:function(t,n){if(null==n&&(n=!1),null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot transform null Vec2";this.zpp_inner.validate_axis();var e=0,i=0;return e=this.zpp_inner.axisy*function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()-this.zpp_inner.axisx*function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(),i=function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()*this.zpp_inner.axisx+function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()*this.zpp_inner.axisy,t.zpp_inner.weak&&t.dispose(),p.geom.Vec2.get(e,i,n)},worldVectorToLocal:function(t,n){if(null==n&&(n=!1),null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot transform null Vec2";this.zpp_inner.validate_axis();var e=0,i=0;return e=function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()*this.zpp_inner.axisy+function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()*this.zpp_inner.axisx,i=function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()*this.zpp_inner.axisy-function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()*this.zpp_inner.axisx,t.zpp_inner.weak&&t.dispose(),p.geom.Vec2.get(e,i,n)},applyImpulse:function(t,n,e){if(null==e&&(e=!1),
null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner.world)throw"Error: Space::world is immutable";if(null==t)throw"Error: Cannot apply null impulse to Body";if(e&&function(t){if(null==t.zpp_inner.space)throw"Error: isSleeping makes no sense if the object is not contained within a Space";return t.zpp_inner.component.sleeping}(this))return t.zpp_inner.weak&&t.dispose(),null!=n&&n.zpp_inner.weak&&n.dispose(),this;this.zpp_inner.validate_mass();var i=this.zpp_inner.imass;if(this.zpp_inner.velx+=function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()*i,this.zpp_inner.vely+=function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()*i,null!=n){var r=0,s=0;r=function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.x}()-this.zpp_inner.posx,s=function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.y}()-this.zpp_inner.posy,this.zpp_inner.validate_inertia(),this.zpp_inner.angvel+=(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()*r-function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}()*s)*this.zpp_inner.iinertia,n.zpp_inner.weak&&n.dispose()}return e||this.zpp_inner.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.zpp_inner.wake(),t.zpp_inner.weak&&t.dispose(),this},applyAngularImpulse:function(t,n){if(null==n&&(n=!1),this.zpp_inner.world)throw"Error: Space::world is immutable";return n&&function(t){if(null==t.zpp_inner.space)throw"Error: isSleeping makes no sense if the object is not contained within a Space";return t.zpp_inner.component.sleeping}(this)?this:(this.zpp_inner.validate_inertia(),this.zpp_inner.angvel+=t*this.zpp_inner.iinertia,n||this.zpp_inner.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.zpp_inner.wake(),this)},translateShapes:function(t){if(this.zpp_inner.immutable_midstep("Body::translateShapes()"),null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(this.zpp_inner.world)throw"Error: Space::world is immutable";if(null==t)throw"Error: Cannot displace by null Vec2";var n=t.zpp_inner.weak;t.zpp_inner.weak=!1;for(var e=this.zpp_inner.shapes.head;null!=e;){e.elt.outer.translate(t),e=e.next}return t.zpp_inner.weak=n,t.zpp_inner.weak&&t.dispose(),this},rotateShapes:function(t){if(this.zpp_inner.immutable_midstep("Body::rotateShapes()"),this.zpp_inner.world)throw"Error: Space::world is immutable";for(var n=this.zpp_inner.shapes.head;null!=n;){n.elt.outer.rotate(t),n=n.next}return this},scaleShapes:function(t,n){if(this.zpp_inner.immutable_midstep("Body::scaleShapes()"),this.zpp_inner.world)throw"Error: Space::world is immutable";for(var e=this.zpp_inner.shapes.head;null!=e;){e.elt.outer.scale(t,n),e=e.next}return this},transformShapes:function(t){if(this.zpp_inner.immutable_midstep("Body::transformShapes()"),this.zpp_inner.world)throw"Error: Space::world is immutable";for(var n=this.zpp_inner.shapes.head;null!=n;){n.elt.outer.transform(t),n=n.next}return this},align:function(){if(this.zpp_inner.immutable_midstep("Body::align()"),this.zpp_inner.world)throw"Error: Space::world is immutable";if(null==this.zpp_inner.shapes.head)throw"Error: Cannot align empty Body";this.zpp_inner.validate_localCOM();var t=p.geom.Vec2.get(-this.zpp_inner.localCOMx,-this.zpp_inner.localCOMy,null);this.translateShapes(t);var n=this.localVectorToWorld(t);if(function(t){return null==t.zpp_inner.wrap_pos&&t.zpp_inner.setupPosition(),t.zpp_inner.wrap_pos}(this).subeq(n),this.zpp_inner.pre_posx<Math.POSITIVE_INFINITY){this.zpp_inner.pre_posx-=1*function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.x}(),this.zpp_inner.pre_posy-=1*function(t){if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return n.zpp_inner.validate(),n.zpp_inner.y}()}return t.dispose(),n.dispose(),this},rotate:function(t,n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot rotate about a null Vec2";if(n!=n)throw"Error: Cannot rotate by NaN radians";var e=t.zpp_inner.weak;t.zpp_inner.weak=!1;var i=function(t){return null==t.zpp_inner.wrap_pos&&t.zpp_inner.setupPosition(),t.zpp_inner.wrap_pos}(this).sub(t);i.rotate(n),this.set_position(t.add(i,!0)),i.dispose();var r=this;return r.set_rotation(r.zpp_inner.rot+n),t.zpp_inner.weak=e,t.zpp_inner.weak&&t.dispose(),this},setShapeMaterials:function(t){if(this.zpp_inner.immutable_midstep("Body::setShapeMaterials()"),this.zpp_inner.world)throw"Error: Space::world is immutable";for(var n=this.zpp_inner.shapes.head;null!=n;){n.elt.outer.set_material(t),n=n.next}return this},setShapeFilters:function(t){if(this.zpp_inner.immutable_midstep("Body::setShapeFilters()"),this.zpp_inner.world)throw"Error: Space::world is immutable";for(var n=this.zpp_inner.shapes.head;null!=n;){n.elt.outer.set_filter(t),n=n.next}return this},setShapeFluidProperties:function(t){if(this.zpp_inner.immutable_midstep("Body::setShapeFluidProperties()"),this.zpp_inner.world)throw"Error: Space::world is immutable";for(var n=this.zpp_inner.shapes.head;null!=n;){n.elt.outer.set_fluidProperties(t),n=n.next}return this},get_localCOM:function(){if(this.zpp_inner.world)throw"Error: Space::world has no localCOM";return null==this.zpp_inner.wrap_localCOM&&(this.zpp_inner.wrap_localCOM=p.geom.Vec2.get(this.zpp_inner.localCOMx,this.zpp_inner.localCOMy,null),this.zpp_inner.wrap_localCOM.zpp_inner._inuse=!0,this.zpp_inner.wrap_localCOM.zpp_inner._immutable=!0,this.zpp_inner.wrap_localCOM.zpp_inner._validate=(_=this.zpp_inner,n(_,_.getlocalCOM))),this.zpp_inner.wrap_localCOM},get_worldCOM:function(){if(this.zpp_inner.world)throw"Error: Space::world has no worldCOM";return null==this.zpp_inner.wrap_worldCOM&&(this.zpp_inner.wrap_worldCOM=p.geom.Vec2.get(this.zpp_inner.worldCOMx,this.zpp_inner.worldCOMy,null),this.zpp_inner.wrap_worldCOM.zpp_inner._inuse=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._immutable=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._validate=(_=this.zpp_inner,n(_,_.getworldCOM))),this.zpp_inner.wrap_worldCOM},normalImpulse:function(t,n){null==n&&(n=!1);for(var e=0,i=0,r=0,s=(this.zpp_inner.arbiters,function(t){return null==t.zpp_inner.wrap_arbiters&&(t.zpp_inner.wrap_arbiters=o.util.ZPP_ArbiterList.get(t.zpp_inner.arbiters,!0)),t.zpp_inner.wrap_arbiters}(this).iterator());s.hasNext();){var l;s.zpp_critical=!1,l=s.zpp_inner.at(s.zpp_i++);var a=l.zpp_inner;if(a.type==o.dynamics.ZPP_Arbiter.COL&&(null==t||a.b2==t.zpp_inner||a.b1==t.zpp_inner)){var _=a.wrapper().get_collisionArbiter().normalImpulse(this,n);e+=1*function(t){if(null!=_&&_.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return _.zpp_inner.validate(),_.zpp_inner.x}(),i+=1*function(t){if(null!=_&&_.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return _.zpp_inner.validate(),_.zpp_inner.y}(),r+=1*function(t){if(null!=_&&_.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return _.zpp_inner.validate(),_.zpp_inner.z}(),_.dispose()}}return p.geom.Vec3.get(e,i,r)},tangentImpulse:function(t,n){null==n&&(n=!1);for(var e=0,i=0,r=0,s=(this.zpp_inner.arbiters,function(t){return null==t.zpp_inner.wrap_arbiters&&(t.zpp_inner.wrap_arbiters=o.util.ZPP_ArbiterList.get(t.zpp_inner.arbiters,!0)),t.zpp_inner.wrap_arbiters}(this).iterator());s.hasNext();){var l;s.zpp_critical=!1,l=s.zpp_inner.at(s.zpp_i++);var a=l.zpp_inner;if(a.type==o.dynamics.ZPP_Arbiter.COL&&(null==t||a.b2==t.zpp_inner||a.b1==t.zpp_inner)){var _=a.wrapper().get_collisionArbiter().tangentImpulse(this,n);e+=1*function(t){if(null!=_&&_.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return _.zpp_inner.validate(),_.zpp_inner.x}(),i+=1*function(t){if(null!=_&&_.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return _.zpp_inner.validate(),_.zpp_inner.y}(),r+=1*function(t){if(null!=_&&_.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return _.zpp_inner.validate(),_.zpp_inner.z}(),_.dispose()}}return p.geom.Vec3.get(e,i,r)},totalContactsImpulse:function(t,n){null==n&&(n=!1);for(var e=0,i=0,r=0,s=(this.zpp_inner.arbiters,function(t){return null==t.zpp_inner.wrap_arbiters&&(t.zpp_inner.wrap_arbiters=o.util.ZPP_ArbiterList.get(t.zpp_inner.arbiters,!0)),t.zpp_inner.wrap_arbiters}(this).iterator());s.hasNext();){var l;s.zpp_critical=!1,l=s.zpp_inner.at(s.zpp_i++);var a=l.zpp_inner;if(a.type==o.dynamics.ZPP_Arbiter.COL&&(null==t||a.b2==t.zpp_inner||a.b1==t.zpp_inner)){var _=a.wrapper().get_collisionArbiter().totalImpulse(this,n);e+=1*function(t){if(null!=_&&_.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return _.zpp_inner.validate(),_.zpp_inner.x}(),i+=1*function(t){if(null!=_&&_.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return _.zpp_inner.validate(),_.zpp_inner.y}(),r+=1*function(t){if(null!=_&&_.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return _.zpp_inner.validate(),_.zpp_inner.z}(),_.dispose()}}return p.geom.Vec3.get(e,i,r)},rollingImpulse:function(t,n){null==n&&(n=!1);for(var e=0,i=(this.zpp_inner.arbiters,function(t){return null==t.zpp_inner.wrap_arbiters&&(t.zpp_inner.wrap_arbiters=o.util.ZPP_ArbiterList.get(t.zpp_inner.arbiters,!0)),t.zpp_inner.wrap_arbiters}(this).iterator());i.hasNext();){var r;i.zpp_critical=!1,r=i.zpp_inner.at(i.zpp_i++);var s=r.zpp_inner;s.type==o.dynamics.ZPP_Arbiter.COL&&(null!=t&&s.b2!=t.zpp_inner&&s.b1!=t.zpp_inner||(e+=s.wrapper().get_collisionArbiter().rollingImpulse(this,n)))}return e},buoyancyImpulse:function(t){for(var n=0,e=0,i=0,r=(this.zpp_inner.arbiters,function(t){return null==t.zpp_inner.wrap_arbiters&&(t.zpp_inner.wrap_arbiters=o.util.ZPP_ArbiterList.get(t.zpp_inner.arbiters,!0)),t.zpp_inner.wrap_arbiters}(this).iterator());r.hasNext();){var s;r.zpp_critical=!1,s=r.zpp_inner.at(r.zpp_i++);var l=s.zpp_inner;if(l.type==o.dynamics.ZPP_Arbiter.FLUID&&(null==t||l.b2==t.zpp_inner||l.b1==t.zpp_inner)){var a=l.wrapper().get_fluidArbiter().buoyancyImpulse(this);n+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.x}(),e+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.y}(),i+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.z}(),a.dispose()}}return p.geom.Vec3.get(n,e,i)},dragImpulse:function(t){for(var n=0,e=0,i=0,r=(this.zpp_inner.arbiters,function(t){return null==t.zpp_inner.wrap_arbiters&&(t.zpp_inner.wrap_arbiters=o.util.ZPP_ArbiterList.get(t.zpp_inner.arbiters,!0)),t.zpp_inner.wrap_arbiters}(this).iterator());r.hasNext();){var s;r.zpp_critical=!1,s=r.zpp_inner.at(r.zpp_i++);var l=s.zpp_inner;if(l.type==o.dynamics.ZPP_Arbiter.FLUID&&(null==t||l.b2==t.zpp_inner||l.b1==t.zpp_inner)){var a=l.wrapper().get_fluidArbiter().dragImpulse(this);n+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.x}(),e+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.y}(),i+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.z}(),a.dispose()}}return p.geom.Vec3.get(n,e,i)},totalFluidImpulse:function(t){for(var n=0,e=0,i=0,r=(this.zpp_inner.arbiters,function(t){return null==t.zpp_inner.wrap_arbiters&&(t.zpp_inner.wrap_arbiters=o.util.ZPP_ArbiterList.get(t.zpp_inner.arbiters,!0)),t.zpp_inner.wrap_arbiters}(this).iterator());r.hasNext();){var s;r.zpp_critical=!1,s=r.zpp_inner.at(r.zpp_i++);var l=s.zpp_inner;if(l.type==o.dynamics.ZPP_Arbiter.FLUID&&(null==t||l.b2==t.zpp_inner||l.b1==t.zpp_inner)){var a=l.wrapper().get_fluidArbiter().totalImpulse(this);n+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.x}(),e+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.y}(),i+=1*function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.z}(),a.dispose()}}return p.geom.Vec3.get(n,e,i)},constraintsImpulse:function(){for(var t=0,n=0,e=0,i=this.zpp_inner.constraints.head;null!=i;){var r=i.elt,s=r.outer.bodyImpulse(this);t+=1*function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.x}(),n+=1*function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.y}(),e+=1*function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.z}(),s.dispose(),i=i.next}return p.geom.Vec3.get(t,n,e)},totalImpulse:function(t,n){null==n&&(n=!1);for(var e=0,i=0,r=0,s=(this.zpp_inner.arbiters,function(t){return null==t.zpp_inner.wrap_arbiters&&(t.zpp_inner.wrap_arbiters=o.util.ZPP_ArbiterList.get(t.zpp_inner.arbiters,!0)),t.zpp_inner.wrap_arbiters}(this).iterator());s.hasNext();){var l;s.zpp_critical=!1,l=s.zpp_inner.at(s.zpp_i++);var a=l.zpp_inner;if(a.type!=o.dynamics.ZPP_Arbiter.SENSOR&&(null==t||a.b2==t.zpp_inner||a.b1==t.zpp_inner)){var _=a.wrapper().totalImpulse(this,n);e+=1*function(t){if(null!=_&&_.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return _.zpp_inner.validate(),_.zpp_inner.x}(),i+=1*function(t){if(null!=_&&_.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return _.zpp_inner.validate(),_.zpp_inner.y}(),r+=1*function(t){if(null!=_&&_.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return _.zpp_inner.validate(),_.zpp_inner.z}(),_.dispose()}}for(var h=this.zpp_inner.constraints.head;null!=h;){var u=h.elt;if(u.active){var d=u.outer.bodyImpulse(this);e+=1*function(t){if(null!=d&&d.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return d.zpp_inner.validate(),d.zpp_inner.x}(),i+=1*function(t){if(null!=d&&d.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return d.zpp_inner.validate(),d.zpp_inner.y}(),r+=1*function(t){if(null!=d&&d.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return d.zpp_inner.validate(),d.zpp_inner.z}(),d.dispose()}h=h.next}return p.geom.Vec3.get(e,i,r)},contains:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot check containment of null point";var n=t.zpp_inner.weak;t.zpp_inner.weak=!1;var e;e=!1;for(var i=this.zpp_inner.shapes.head;null!=i;){if(i.elt.outer.contains(t)){e=!0;break}i=i.next}return t.zpp_inner.weak=n,t.zpp_inner.weak&&t.dispose(),e},toString:function(){return(this.zpp_inner.world?"(space::world":"("+(this.zpp_inner.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC?"dynamic":this.zpp_inner.type==o.util.ZPP_Flags.id_BodyType_STATIC?"static":"kinematic"))+")#"+this.zpp_inner_i.id},__class__:p.phys.Body}),p.phys.BodyIterator=function(){if(this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null,!o.util.ZPP_BodyList.internal)throw"Error: Cannot instantiate BodyIterator derp!"},p.phys.BodyIterator.__name__=!0,p.phys.BodyIterator.get=function(t){var n;if(null==p.phys.BodyIterator.zpp_pool){o.util.ZPP_BodyList.internal=!0;var e=new p.phys.BodyIterator;o.util.ZPP_BodyList.internal=!1,n=e}else{var i=p.phys.BodyIterator.zpp_pool;p.phys.BodyIterator.zpp_pool=i.zpp_next,n=i}return n.zpp_i=0,n.zpp_inner=t,n.zpp_critical=!1,n},p.phys.BodyIterator.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=p.phys.BodyIterator.zpp_pool,p.phys.BodyIterator.zpp_pool=this,this.zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:p.phys.BodyIterator},p.phys.BodyList=function(){this.zpp_inner=null,this.zpp_inner=new o.util.ZPP_BodyList,this.zpp_inner.outer=this},p.phys.BodyList.__name__=!0,p.phys.BodyList.fromArray=function(t){if(null==t)throw"Error: Cannot convert null Array to Nape list";for(var n=new p.phys.BodyList,e=0;e<t.length;){var i=t[e];++e,n.push(i)}return n},p.phys.BodyList.prototype={get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},at:function(t){if(this.zpp_inner.valmod(),t<0||t>=this.get_length())throw"Error: Index out of bounds 10";if(this.zpp_inner.reverse_flag&&(t=this.get_length()-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(t){if(this.zpp_inner.immutable)throw"Error: BodyList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},unshift:function(t){if(this.zpp_inner.immutable)throw"Error: BodyList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},pop:function(){if(this.zpp_inner.immutable)throw"Error: BodyList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){t=this.zpp_inner.inner.head.elt;var n=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var e;e=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==e?this.zpp_inner.inner.head.elt:e.next.elt;var i=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)}return this.zpp_inner.invalidate(),t.outer},shift:function(){if(this.zpp_inner.immutable)throw"Error: BodyList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n;n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==n?this.zpp_inner.inner.head.elt:n.next.elt;var e=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}else{t=this.zpp_inner.inner.head.elt;var i=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),t.outer},add:function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},remove:function(t){if(this.zpp_inner.immutable)throw"Error: BodyList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;n=!1;for(var e=this.zpp_inner.inner.head;null!=e;){if(e.elt==t.zpp_inner){n=!0;break}e=e.next}return n&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),n},clear:function(){if(this.zpp_inner.immutable)throw"Error: BodyList is immutable";if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){return this.zpp_inner.valmod(),p.phys.BodyIterator.get(this)},copy:function(t){null==t&&(t=!1);var n,e=new p.phys.BodyList;for(this.zpp_inner.valmod(),n=p.phys.BodyIterator.get(this);n.hasNext();){var i;n.zpp_critical=!1,i=n.zpp_inner.at(n.zpp_i++),e.push(t?function(t){throw"Error: Body is not a copyable type"}():i)}return e},merge:function(t){if(null==t)throw"Error: Cannot merge with null list";var n;for(t.zpp_inner.valmod(),n=p.phys.BodyIterator.get(t);n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),this.has(e)||(this.zpp_inner.reverse_flag?this.push(e):this.unshift(e))}},toString:function(){var t,n="[",e=!0;for(this.zpp_inner.valmod(),t=p.phys.BodyIterator.get(this);t.hasNext();){var i;t.zpp_critical=!1,i=t.zpp_inner.at(t.zpp_i++),e||(n+=","),n+=null==i?"NULL":i.toString(),e=!1}return n+"]"},foreach:function(t){if(null==t)throw"Error: Cannot execute null on list elements";var n;for(this.zpp_inner.valmod(),n=p.phys.BodyIterator.get(this);n.hasNext();)try{t(function(t){return n.zpp_critical=!1,n.zpp_inner.at(n.zpp_i++)}())}catch(t){n.zpp_next=p.phys.BodyIterator.zpp_pool,p.phys.BodyIterator.zpp_pool=n,n.zpp_inner=null;break}return this},filter:function(t){if(null==t)throw"Error: Cannot select elements of list with null";for(var n=0;n<this.get_length();){var e=this.at(n);try{t(e)?n++:this.remove(e)}catch(t){break}}return this},__class__:p.phys.BodyList},p.phys.BodyType=function(){if(!o.util.ZPP_Flags.internal)throw"Error: Cannot instantiate BodyType derp!"},p.phys.BodyType.__name__=!0,p.phys.BodyType.get_STATIC=function(){return null==o.util.ZPP_Flags.BodyType_STATIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_STATIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_STATIC},p.phys.BodyType.get_DYNAMIC=function(){return null==o.util.ZPP_Flags.BodyType_DYNAMIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_DYNAMIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_DYNAMIC},p.phys.BodyType.get_KINEMATIC=function(){return null==o.util.ZPP_Flags.BodyType_KINEMATIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_KINEMATIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_KINEMATIC},p.phys.BodyType.prototype={toString:function(){return this==function(t){return null==o.util.ZPP_Flags.BodyType_STATIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_STATIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_STATIC}()?"STATIC":this==function(t){return null==o.util.ZPP_Flags.BodyType_DYNAMIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_DYNAMIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_DYNAMIC}()?"DYNAMIC":this==function(t){return null==o.util.ZPP_Flags.BodyType_KINEMATIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_KINEMATIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_KINEMATIC}()?"KINEMATIC":""},__class__:p.phys.BodyType},p.phys.Compound=function(){this.zpp_inner=null,p.phys.Interactor.zpp_internalAlloc=!0,p.phys.Interactor.call(this),p.phys.Interactor.zpp_internalAlloc=!1,this.zpp_inner=new o.phys.ZPP_Compound,this.zpp_inner.outer=this,this.zpp_inner.outer_i=this,this.zpp_inner_i=this.zpp_inner,this.zpp_inner.insert_cbtype(o.callbacks.ZPP_CbType.ANY_COMPOUND.zpp_inner)},p.phys.Compound.__name__=!0,p.phys.Compound.__super__=p.phys.Interactor,p.phys.Compound.prototype=t(p.phys.Interactor.prototype,{get_bodies:function(){return this.zpp_inner.wrap_bodies},get_constraints:function(){return this.zpp_inner.wrap_constraints},get_compounds:function(){return this.zpp_inner.wrap_compounds},get_compound:function(){return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},set_compound:function(t){return this.zpp_inner.immutable_midstep("Compound::compound"),(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)!=t&&(null!=(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer)&&(null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer).zpp_inner.wrap_compounds.remove(this),null!=t&&t.zpp_inner.wrap_compounds.add(this)),null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},get_space:function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},set_space:function(t){if(null!=this.zpp_inner.compound)throw"Error: Cannot set the space of an inner Compound, only the root Compound space can be set";return this.zpp_inner.immutable_midstep("Compound::space"),(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)!=t&&(null!=(null==this.zpp_inner.space?null:this.zpp_inner.space.outer)&&(null==this.zpp_inner.space?null:this.zpp_inner.space.outer).zpp_inner.wrap_compounds.remove(this),null!=t&&t.zpp_inner.wrap_compounds.add(this)),null==this.zpp_inner.space?null:this.zpp_inner.space.outer},toString:function(){return"Compound"+this.zpp_inner_i.id},copy:function(){return this.zpp_inner.copy()},breakApart:function(){this.zpp_inner.breakApart()},visitBodies:function(t){if(null==t)throw"Error: lambda cannot be null for Compound::visitBodies";for(var n=this.zpp_inner.wrap_bodies.iterator();n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),t(e)}for(var i=this.zpp_inner.wrap_compounds.iterator();i.hasNext();){var r;i.zpp_critical=!1,r=i.zpp_inner.at(i.zpp_i++),r.visitBodies(t)}},visitConstraints:function(t){if(null==t)throw"Error: lambda cannot be null for Compound::visitConstraints";for(var n=this.zpp_inner.wrap_constraints.iterator();n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),t(e)}for(var i=this.zpp_inner.wrap_compounds.iterator();i.hasNext();){var r;i.zpp_critical=!1,r=i.zpp_inner.at(i.zpp_i++),r.visitConstraints(t)}},visitCompounds:function(t){if(null==t)throw"Error: lambda cannot be null for Compound::visitConstraints";for(var n=this.zpp_inner.wrap_compounds.iterator();n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),t(e),e.visitCompounds(t)}},COM:function(t){null==t&&(t=!1);var e=p.geom.Vec2.get(0,0,t),i=0;if(this.visitBodies(function(t){if(!t.zpp_inner.wrap_shapes.empty()){if(e.addeq(function(e){if(t.zpp_inner.world)throw"Error: Space::world has no worldCOM";return null==t.zpp_inner.wrap_worldCOM&&(t.zpp_inner.wrap_worldCOM=p.geom.Vec2.get(t.zpp_inner.worldCOMx,t.zpp_inner.worldCOMy,null),t.zpp_inner.wrap_worldCOM.zpp_inner._inuse=!0,t.zpp_inner.wrap_worldCOM.zpp_inner._immutable=!0,t.zpp_inner.wrap_worldCOM.zpp_inner._validate=(_=t.zpp_inner,n(_,_.getworldCOM))),t.zpp_inner.wrap_worldCOM}().mul(function(n){if(t.zpp_inner.world)throw"Error: Space::world has no mass";if(t.zpp_inner.validate_mass(),t.zpp_inner.massMode==o.util.ZPP_Flags.id_MassMode_DEFAULT&&null==t.zpp_inner.shapes.head)throw"Error: Given current mass mode, Body::mass only makes sense if it contains shapes";return t.zpp_inner.cmass}(),!0)),t.zpp_inner.world)throw"Error: Space::world has no mass";if(t.zpp_inner.validate_mass(),t.zpp_inner.massMode==o.util.ZPP_Flags.id_MassMode_DEFAULT&&null==t.zpp_inner.shapes.head)throw"Error: Given current mass mode, Body::mass only makes sense if it contains shapes";i+=t.zpp_inner.cmass}}),0==i)throw"Error: COM of an empty Compound is undefined silly";return e.muleq(1/i),e},translate:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot translate by null Vec2";var n=t.zpp_inner.weak;return t.zpp_inner.weak=!1,this.visitBodies(function(n){(function(t){return null==n.zpp_inner.wrap_pos&&n.zpp_inner.setupPosition(),n.zpp_inner.wrap_pos})().addeq(t)}),t.zpp_inner.weak=n,t.zpp_inner.weak&&t.dispose(),this},rotate:function(t,n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot rotate about a null Vec2";if(n!=n)throw"Error: Cannot rotate by NaN radians";var e=t.zpp_inner.weak;return t.zpp_inner.weak=!1,this.visitBodies(function(e){e.rotate(t,n)}),t.zpp_inner.weak=e,t.zpp_inner.weak&&t.dispose(),this},__class__:p.phys.Compound}),p.phys.CompoundIterator=function(){if(this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null,!o.util.ZPP_CompoundList.internal)throw"Error: Cannot instantiate CompoundIterator derp!"},p.phys.CompoundIterator.__name__=!0,p.phys.CompoundIterator.get=function(t){var n;if(null==p.phys.CompoundIterator.zpp_pool){o.util.ZPP_CompoundList.internal=!0;var e=new p.phys.CompoundIterator;o.util.ZPP_CompoundList.internal=!1,n=e}else{var i=p.phys.CompoundIterator.zpp_pool;p.phys.CompoundIterator.zpp_pool=i.zpp_next,n=i}return n.zpp_i=0,n.zpp_inner=t,n.zpp_critical=!1,n},p.phys.CompoundIterator.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=p.phys.CompoundIterator.zpp_pool,p.phys.CompoundIterator.zpp_pool=this,this.zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:p.phys.CompoundIterator},p.phys.CompoundList=function(){this.zpp_inner=null,this.zpp_inner=new o.util.ZPP_CompoundList,this.zpp_inner.outer=this},p.phys.CompoundList.__name__=!0,p.phys.CompoundList.fromArray=function(t){if(null==t)throw"Error: Cannot convert null Array to Nape list";for(var n=new p.phys.CompoundList,e=0;e<t.length;){var i=t[e];++e,n.push(i)}return n},p.phys.CompoundList.prototype={get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},at:function(t){if(this.zpp_inner.valmod(),t<0||t>=this.get_length())throw"Error: Index out of bounds 11";if(this.zpp_inner.reverse_flag&&(t=this.get_length()-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(t){if(this.zpp_inner.immutable)throw"Error: CompoundList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),
this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},unshift:function(t){if(this.zpp_inner.immutable)throw"Error: CompoundList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},pop:function(){if(this.zpp_inner.immutable)throw"Error: CompoundList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){t=this.zpp_inner.inner.head.elt;var n=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var e;e=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==e?this.zpp_inner.inner.head.elt:e.next.elt;var i=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)}return this.zpp_inner.invalidate(),t.outer},shift:function(){if(this.zpp_inner.immutable)throw"Error: CompoundList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n;n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==n?this.zpp_inner.inner.head.elt:n.next.elt;var e=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}else{t=this.zpp_inner.inner.head.elt;var i=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),t.outer},add:function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},remove:function(t){if(this.zpp_inner.immutable)throw"Error: CompoundList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;n=!1;for(var e=this.zpp_inner.inner.head;null!=e;){if(e.elt==t.zpp_inner){n=!0;break}e=e.next}return n&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),n},clear:function(){if(this.zpp_inner.immutable)throw"Error: CompoundList is immutable";if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){return this.zpp_inner.valmod(),p.phys.CompoundIterator.get(this)},copy:function(t){null==t&&(t=!1);var n,e=new p.phys.CompoundList;for(this.zpp_inner.valmod(),n=p.phys.CompoundIterator.get(this);n.hasNext();){var i;n.zpp_critical=!1,i=n.zpp_inner.at(n.zpp_i++),e.push(t?function(t){throw"Error: Compound is not a copyable type"}():i)}return e},merge:function(t){if(null==t)throw"Error: Cannot merge with null list";var n;for(t.zpp_inner.valmod(),n=p.phys.CompoundIterator.get(t);n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),this.has(e)||(this.zpp_inner.reverse_flag?this.push(e):this.unshift(e))}},toString:function(){var t,n="[",e=!0;for(this.zpp_inner.valmod(),t=p.phys.CompoundIterator.get(this);t.hasNext();){var i;t.zpp_critical=!1,i=t.zpp_inner.at(t.zpp_i++),e||(n+=","),n+=null==i?"NULL":i.toString(),e=!1}return n+"]"},foreach:function(t){if(null==t)throw"Error: Cannot execute null on list elements";var n;for(this.zpp_inner.valmod(),n=p.phys.CompoundIterator.get(this);n.hasNext();)try{t(function(t){return n.zpp_critical=!1,n.zpp_inner.at(n.zpp_i++)}())}catch(t){n.zpp_next=p.phys.CompoundIterator.zpp_pool,p.phys.CompoundIterator.zpp_pool=n,n.zpp_inner=null;break}return this},filter:function(t){if(null==t)throw"Error: Cannot select elements of list with null";for(var n=0;n<this.get_length();){var e=this.at(n);try{t(e)?n++:this.remove(e)}catch(t){break}}return this},__class__:p.phys.CompoundList},p.phys.FluidProperties=function(t,n){if(null==n&&(n=1),null==t&&(t=1),this.zpp_inner=null,null==o.phys.ZPP_FluidProperties.zpp_pool?this.zpp_inner=new o.phys.ZPP_FluidProperties:(this.zpp_inner=o.phys.ZPP_FluidProperties.zpp_pool,o.phys.ZPP_FluidProperties.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null),this.zpp_inner.outer=this,t!=1e3*this.zpp_inner.density){if(t!=t)throw"Error: FluidProperties::density cannot be NaN";this.zpp_inner.density=t/1e3,this.zpp_inner.invalidate()}if(this.zpp_inner.density,n!=this.zpp_inner.viscosity){if(n!=n)throw"Error: FluidProperties::viscosity cannot be NaN";if(n<0)throw"Error: FluidProperties::viscosity ("+n+") must be >= 0";this.zpp_inner.viscosity=n/1,this.zpp_inner.invalidate()}this.zpp_inner.viscosity},p.phys.FluidProperties.__name__=!0,p.phys.FluidProperties.prototype={get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_shapes:function(){return null==this.zpp_inner.wrap_shapes&&(this.zpp_inner.wrap_shapes=o.util.ZPP_ShapeList.get(this.zpp_inner.shapes,!0)),this.zpp_inner.wrap_shapes},copy:function(){var t=new p.phys.FluidProperties(1e3*this.zpp_inner.density,this.zpp_inner.viscosity);return null!=this.zpp_inner.userData&&(t.zpp_inner.userData=i.copy(this.zpp_inner.userData)),t.set_gravity(this.zpp_inner.wrap_gravity),t},get_density:function(){return 1e3*this.zpp_inner.density},set_density:function(t){if(t!=1e3*this.zpp_inner.density){if(t!=t)throw"Error: FluidProperties::density cannot be NaN";this.zpp_inner.density=t/1e3,this.zpp_inner.invalidate()}return 1e3*this.zpp_inner.density},get_viscosity:function(){return this.zpp_inner.viscosity},set_viscosity:function(t){if(t!=this.zpp_inner.viscosity){if(t!=t)throw"Error: FluidProperties::viscosity cannot be NaN";if(t<0)throw"Error: FluidProperties::viscosity ("+t+") must be >= 0";this.zpp_inner.viscosity=t/1,this.zpp_inner.invalidate()}return this.zpp_inner.viscosity},get_gravity:function(){return this.zpp_inner.wrap_gravity},set_gravity:function(t){if(null==t)null!=this.zpp_inner.wrap_gravity&&(this.zpp_inner.wrap_gravity.zpp_inner._inuse=!1,this.zpp_inner.wrap_gravity.dispose(),this.zpp_inner.wrap_gravity=null);else{if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";null==this.zpp_inner.wrap_gravity&&this.zpp_inner.getgravity(),this.zpp_inner.wrap_gravity.set(t)}return this.zpp_inner.wrap_gravity},toString:function(){return"{ density: "+1e3*this.zpp_inner.density+" viscosity: "+this.zpp_inner.viscosity+" gravity: "+r.string(this.zpp_inner.wrap_gravity)+" }"},__class__:p.phys.FluidProperties},p.phys.GravMassMode=function(){if(!o.util.ZPP_Flags.internal)throw"Error: Cannot instantiate GravMassMode derp!"},p.phys.GravMassMode.__name__=!0,p.phys.GravMassMode.get_DEFAULT=function(){return null==o.util.ZPP_Flags.GravMassMode_DEFAULT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.GravMassMode_DEFAULT=new p.phys.GravMassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.GravMassMode_DEFAULT},p.phys.GravMassMode.get_FIXED=function(){return null==o.util.ZPP_Flags.GravMassMode_FIXED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.GravMassMode_FIXED=new p.phys.GravMassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.GravMassMode_FIXED},p.phys.GravMassMode.get_SCALED=function(){return null==o.util.ZPP_Flags.GravMassMode_SCALED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.GravMassMode_SCALED=new p.phys.GravMassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.GravMassMode_SCALED},p.phys.GravMassMode.prototype={toString:function(){return this==function(t){return null==o.util.ZPP_Flags.GravMassMode_DEFAULT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.GravMassMode_DEFAULT=new p.phys.GravMassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.GravMassMode_DEFAULT}()?"DEFAULT":this==function(t){return null==o.util.ZPP_Flags.GravMassMode_FIXED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.GravMassMode_FIXED=new p.phys.GravMassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.GravMassMode_FIXED}()?"FIXED":this==function(t){return null==o.util.ZPP_Flags.GravMassMode_SCALED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.GravMassMode_SCALED=new p.phys.GravMassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.GravMassMode_SCALED}()?"SCALED":""},__class__:p.phys.GravMassMode},p.phys.InertiaMode=function(){if(!o.util.ZPP_Flags.internal)throw"Error: Cannot instantiate InertiaMode derp!"},p.phys.InertiaMode.__name__=!0,p.phys.InertiaMode.get_DEFAULT=function(){return null==o.util.ZPP_Flags.InertiaMode_DEFAULT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InertiaMode_DEFAULT=new p.phys.InertiaMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InertiaMode_DEFAULT},p.phys.InertiaMode.get_FIXED=function(){return null==o.util.ZPP_Flags.InertiaMode_FIXED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InertiaMode_FIXED=new p.phys.InertiaMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InertiaMode_FIXED},p.phys.InertiaMode.prototype={toString:function(){return this==function(t){return null==o.util.ZPP_Flags.InertiaMode_DEFAULT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InertiaMode_DEFAULT=new p.phys.InertiaMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InertiaMode_DEFAULT}()?"DEFAULT":this==function(t){return null==o.util.ZPP_Flags.InertiaMode_FIXED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InertiaMode_FIXED=new p.phys.InertiaMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InertiaMode_FIXED}()?"FIXED":""},__class__:p.phys.InertiaMode},p.phys.InteractorIterator=function(){if(this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null,!o.util.ZPP_InteractorList.internal)throw"Error: Cannot instantiate InteractorIterator derp!"},p.phys.InteractorIterator.__name__=!0,p.phys.InteractorIterator.get=function(t){var n;if(null==p.phys.InteractorIterator.zpp_pool){o.util.ZPP_InteractorList.internal=!0;var e=new p.phys.InteractorIterator;o.util.ZPP_InteractorList.internal=!1,n=e}else{var i=p.phys.InteractorIterator.zpp_pool;p.phys.InteractorIterator.zpp_pool=i.zpp_next,n=i}return n.zpp_i=0,n.zpp_inner=t,n.zpp_critical=!1,n},p.phys.InteractorIterator.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=p.phys.InteractorIterator.zpp_pool,p.phys.InteractorIterator.zpp_pool=this,this.zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:p.phys.InteractorIterator},p.phys.InteractorList=function(){this.zpp_inner=null,this.zpp_inner=new o.util.ZPP_InteractorList,this.zpp_inner.outer=this},p.phys.InteractorList.__name__=!0,p.phys.InteractorList.fromArray=function(t){if(null==t)throw"Error: Cannot convert null Array to Nape list";for(var n=new p.phys.InteractorList,e=0;e<t.length;){var i=t[e];++e,n.push(i)}return n},p.phys.InteractorList.prototype={get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner_i)},at:function(t){if(this.zpp_inner.valmod(),t<0||t>=this.get_length())throw"Error: Index out of bounds 12";if(this.zpp_inner.reverse_flag&&(t=this.get_length()-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer_i},push:function(t){if(this.zpp_inner.immutable)throw"Error: InteractorList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner_i):(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner_i)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},unshift:function(t){if(this.zpp_inner.immutable)throw"Error: InteractorList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner_i)):this.zpp_inner.inner.add(t.zpp_inner_i),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},pop:function(){if(this.zpp_inner.immutable)throw"Error: InteractorList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){t=this.zpp_inner.inner.head.elt;var n=t.outer_i;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var e;e=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==e?this.zpp_inner.inner.head.elt:e.next.elt;var i=t.outer_i;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)}return this.zpp_inner.invalidate(),t.outer_i},shift:function(){if(this.zpp_inner.immutable)throw"Error: InteractorList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n;n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==n?this.zpp_inner.inner.head.elt:n.next.elt;var e=t.outer_i;null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}else{t=this.zpp_inner.inner.head.elt;var i=t.outer_i;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),t.outer_i},add:function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},remove:function(t){if(this.zpp_inner.immutable)throw"Error: InteractorList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;n=!1;for(var e=this.zpp_inner.inner.head;null!=e;){if(e.elt==t.zpp_inner_i){n=!0;break}e=e.next}return n&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner_i),this.zpp_inner.invalidate()),n},clear:function(){if(this.zpp_inner.immutable)throw"Error: InteractorList is immutable";if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){return this.zpp_inner.valmod(),p.phys.InteractorIterator.get(this)},copy:function(t){null==t&&(t=!1);var n,e=new p.phys.InteractorList;for(this.zpp_inner.valmod(),n=p.phys.InteractorIterator.get(this);n.hasNext();){var i;n.zpp_critical=!1,i=n.zpp_inner.at(n.zpp_i++),e.push(t?function(t){throw"Error: Interactor is not a copyable type"}():i)}return e},merge:function(t){if(null==t)throw"Error: Cannot merge with null list";var n;for(t.zpp_inner.valmod(),n=p.phys.InteractorIterator.get(t);n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),this.has(e)||(this.zpp_inner.reverse_flag?this.push(e):this.unshift(e))}},toString:function(){var t,n="[",e=!0;for(this.zpp_inner.valmod(),t=p.phys.InteractorIterator.get(this);t.hasNext();){var i;t.zpp_critical=!1,i=t.zpp_inner.at(t.zpp_i++),e||(n+=","),n+=null==i?"NULL":i.toString(),e=!1}return n+"]"},foreach:function(t){if(null==t)throw"Error: Cannot execute null on list elements";var n;for(this.zpp_inner.valmod(),n=p.phys.InteractorIterator.get(this);n.hasNext();)try{t(function(t){return n.zpp_critical=!1,n.zpp_inner.at(n.zpp_i++)}())}catch(t){n.zpp_next=p.phys.InteractorIterator.zpp_pool,p.phys.InteractorIterator.zpp_pool=n,n.zpp_inner=null;break}return this},filter:function(t){if(null==t)throw"Error: Cannot select elements of list with null";for(var n=0;n<this.get_length();){var e=this.at(n);try{t(e)?n++:this.remove(e)}catch(t){break}}return this},__class__:p.phys.InteractorList},p.phys.MassMode=function(){if(!o.util.ZPP_Flags.internal)throw"Error: Cannot instantiate MassMode derp!"},p.phys.MassMode.__name__=!0,p.phys.MassMode.get_DEFAULT=function(){return null==o.util.ZPP_Flags.MassMode_DEFAULT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.MassMode_DEFAULT=new p.phys.MassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.MassMode_DEFAULT},p.phys.MassMode.get_FIXED=function(){return null==o.util.ZPP_Flags.MassMode_FIXED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.MassMode_FIXED=new p.phys.MassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.MassMode_FIXED},p.phys.MassMode.prototype={toString:function(){return this==function(t){return null==o.util.ZPP_Flags.MassMode_DEFAULT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.MassMode_DEFAULT=new p.phys.MassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.MassMode_DEFAULT}()?"DEFAULT":this==function(t){return null==o.util.ZPP_Flags.MassMode_FIXED&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.MassMode_FIXED=new p.phys.MassMode,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.MassMode_FIXED}()?"FIXED":""},__class__:p.phys.MassMode},p.phys.Material=function(t,n,e,i,r){if(null==r&&(r=.001),null==i&&(i=1),null==e&&(e=2),null==n&&(n=1),null==t&&(t=0),this.zpp_inner=null,null==o.phys.ZPP_Material.zpp_pool?this.zpp_inner=new o.phys.ZPP_Material:(this.zpp_inner=o.phys.ZPP_Material.zpp_pool,o.phys.ZPP_Material.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null),this.zpp_inner.outer=this,t!=this.zpp_inner.elasticity){if(t!=t)throw"Error: Material::elasticity cannot be NaN";this.zpp_inner.elasticity=t/1,this.zpp_inner.invalidate(o.phys.ZPP_Material.WAKE|o.phys.ZPP_Material.ARBITERS)}if(this.zpp_inner.elasticity,n!=this.zpp_inner.dynamicFriction){if(n!=n)throw"Error: Material::dynamicFriction cannot be NaN";if(n<0)throw"Error: Material::dynamicFriction cannot be negative";this.zpp_inner.dynamicFriction=n/1,this.zpp_inner.invalidate(o.phys.ZPP_Material.WAKE|o.phys.ZPP_Material.ANGDRAG|o.phys.ZPP_Material.ARBITERS)}if(this.zpp_inner.dynamicFriction,e!=this.zpp_inner.staticFriction){if(e!=e)throw"Error: Material::staticFriction cannot be NaN";if(e<0)throw"Error: Material::staticFriction cannot be negative";this.zpp_inner.staticFriction=e/1,this.zpp_inner.invalidate(o.phys.ZPP_Material.WAKE|o.phys.ZPP_Material.ARBITERS)}if(this.zpp_inner.staticFriction,i!=1e3*this.zpp_inner.density){if(i!=i)throw"Error: Material::density cannot be NaN";if(i<0)throw"Error: Material::density must be positive";if(i<0)throw"Error: Material::density cannot be negative";this.zpp_inner.density=i/1e3,this.zpp_inner.invalidate(o.phys.ZPP_Material.WAKE|o.phys.ZPP_Material.PROPS)}if(this.zpp_inner.density,r!=this.zpp_inner.rollingFriction){if(r!=r)throw"Error: Material::rollingFriction cannot be NaN";if(r<0)throw"Error: Material::rollingFriction cannot be negative";this.zpp_inner.rollingFriction=r/1,this.zpp_inner.invalidate(o.phys.ZPP_Material.WAKE|o.phys.ZPP_Material.ARBITERS)}this.zpp_inner.rollingFriction},p.phys.Material.__name__=!0,p.phys.Material.wood=function(){return new p.phys.Material(.4,.2,.38,.7,.005)},p.phys.Material.steel=function(){return new p.phys.Material(.2,.57,.74,7.8,.001)},p.phys.Material.ice=function(){return new p.phys.Material(.3,.03,.1,.9,1e-4)},p.phys.Material.rubber=function(){return new p.phys.Material(.8,1,1.4,1.5,.01)},p.phys.Material.glass=function(){return new p.phys.Material(.4,.4,.94,2.6,.002)},p.phys.Material.sand=function(){return new p.phys.Material(-1,.45,.6,1.6,16)},p.phys.Material.prototype={get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_shapes:function(){return null==this.zpp_inner.wrap_shapes&&(this.zpp_inner.wrap_shapes=o.util.ZPP_ShapeList.get(this.zpp_inner.shapes,!0)),this.zpp_inner.wrap_shapes},copy:function(){var t=new p.phys.Material(this.zpp_inner.elasticity,this.zpp_inner.dynamicFriction,this.zpp_inner.staticFriction,1e3*this.zpp_inner.density,this.zpp_inner.rollingFriction);return null!=this.zpp_inner.userData&&(t.zpp_inner.userData=i.copy(this.zpp_inner.userData)),t},get_elasticity:function(){return this.zpp_inner.elasticity},set_elasticity:function(t){if(t!=this.zpp_inner.elasticity){if(t!=t)throw"Error: Material::elasticity cannot be NaN";this.zpp_inner.elasticity=t/1,this.zpp_inner.invalidate(o.phys.ZPP_Material.WAKE|o.phys.ZPP_Material.ARBITERS)}return this.zpp_inner.elasticity},get_dynamicFriction:function(){return this.zpp_inner.dynamicFriction},set_dynamicFriction:function(t){if(t!=this.zpp_inner.dynamicFriction){if(t!=t)throw"Error: Material::dynamicFriction cannot be NaN";if(t<0)throw"Error: Material::dynamicFriction cannot be negative";this.zpp_inner.dynamicFriction=t/1,this.zpp_inner.invalidate(o.phys.ZPP_Material.WAKE|o.phys.ZPP_Material.ANGDRAG|o.phys.ZPP_Material.ARBITERS)}return this.zpp_inner.dynamicFriction},get_staticFriction:function(){return this.zpp_inner.staticFriction},set_staticFriction:function(t){if(t!=this.zpp_inner.staticFriction){if(t!=t)throw"Error: Material::staticFriction cannot be NaN";if(t<0)throw"Error: Material::staticFriction cannot be negative";this.zpp_inner.staticFriction=t/1,this.zpp_inner.invalidate(o.phys.ZPP_Material.WAKE|o.phys.ZPP_Material.ARBITERS)}return this.zpp_inner.staticFriction},get_density:function(){return 1e3*this.zpp_inner.density},set_density:function(t){if(t!=1e3*this.zpp_inner.density){if(t!=t)throw"Error: Material::density cannot be NaN";if(t<0)throw"Error: Material::density must be positive";if(t<0)throw"Error: Material::density cannot be negative";this.zpp_inner.density=t/1e3,this.zpp_inner.invalidate(o.phys.ZPP_Material.WAKE|o.phys.ZPP_Material.PROPS)}return 1e3*this.zpp_inner.density},get_rollingFriction:function(){return this.zpp_inner.rollingFriction},set_rollingFriction:function(t){if(t!=this.zpp_inner.rollingFriction){if(t!=t)throw"Error: Material::rollingFriction cannot be NaN";if(t<0)throw"Error: Material::rollingFriction cannot be negative";this.zpp_inner.rollingFriction=t/1,this.zpp_inner.invalidate(o.phys.ZPP_Material.WAKE|o.phys.ZPP_Material.ARBITERS)}return this.zpp_inner.rollingFriction},toString:function(){return"{ elasticity: "+this.zpp_inner.elasticity+" dynamicFriction: "+this.zpp_inner.dynamicFriction+" staticFriction: "+this.zpp_inner.staticFriction+" density: "+1e3*this.zpp_inner.density+" rollingFriction: "+this.zpp_inner.rollingFriction+" }"},__class__:p.phys.Material},p.shape={},p.shape.Shape=function(){if(this.zpp_inner=null,p.phys.Interactor.zpp_internalAlloc=!0,p.phys.Interactor.call(this),p.phys.Interactor.zpp_internalAlloc=!1,!p.shape.Shape.zpp_internalAlloc)throw"Error: Shape cannot be instantiated derp!"},p.shape.Shape.__name__=!0,p.shape.Shape.__super__=p.phys.Interactor,p.shape.Shape.prototype=t(p.phys.Interactor.prototype,{get_type:function(){return o.shape.ZPP_Shape.types[this.zpp_inner.type]},isCircle:function(){return this.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE},isPolygon:function(){return this.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_POLYGON},get_body:function(){return null!=this.zpp_inner.body?this.zpp_inner.body.outer:null},set_body:function(t){return this.zpp_inner.immutable_midstep("Shape::body"),(null!=this.zpp_inner.body?this.zpp_inner.body.outer:null)!=t&&(null!=this.zpp_inner.body&&(null!=this.zpp_inner.body?this.zpp_inner.body.outer:null).zpp_inner.wrap_shapes.remove(this),null!=t&&t.zpp_inner.wrap_shapes.add(this)),null!=this.zpp_inner.body?this.zpp_inner.body.outer:null},get_castCircle:function(){return this.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?this.zpp_inner.circle.outer_zn:null},get_castPolygon:function(){return this.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_POLYGON?this.zpp_inner.polygon.outer_zn:null},get_worldCOM:function(){return null==this.zpp_inner.wrap_worldCOM&&(this.zpp_inner.wrap_worldCOM=p.geom.Vec2.get(this.zpp_inner.worldCOMx,this.zpp_inner.worldCOMy,null),this.zpp_inner.wrap_worldCOM.zpp_inner._inuse=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._immutable=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._validate=(_=this.zpp_inner,n(_,_.getworldCOM))),this.zpp_inner.wrap_worldCOM},get_localCOM:function(){return null==this.zpp_inner.wrap_localCOM&&(this.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?this.zpp_inner.circle.setupLocalCOM():this.zpp_inner.polygon.setupLocalCOM()),this.zpp_inner.wrap_localCOM},set_localCOM:function(t){if(this.zpp_inner.immutable_midstep("Body::localCOM"),null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=this.zpp_inner.body&&null!=this.zpp_inner.body.space&&this.zpp_inner.body.type==o.util.ZPP_Flags.id_BodyType_STATIC)throw"Error: Cannot modify Shape belonging to a static Object once inside a Space";if(null==t)throw"Error: Shape::localCOM cannot be null";return function(t){return null==t.zpp_inner.wrap_localCOM&&(t.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.zpp_inner.circle.setupLocalCOM():t.zpp_inner.polygon.setupLocalCOM()),t.zpp_inner.wrap_localCOM}(this).set(t),null==this.zpp_inner.wrap_localCOM&&(this.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?this.zpp_inner.circle.setupLocalCOM():this.zpp_inner.polygon.setupLocalCOM()),this.zpp_inner.wrap_localCOM},get_area:function(){return this.zpp_inner.validate_area_inertia(),this.zpp_inner.area},get_inertia:function(){return this.zpp_inner.validate_area_inertia(),this.zpp_inner.inertia},get_angDrag:function(){return this.zpp_inner.validate_angDrag(),this.zpp_inner.angDrag},get_material:function(){return this.zpp_inner.material.wrapper()},set_material:function(t){if(this.zpp_inner.immutable_midstep("Shape::material"),null==t)throw"Error: Cannot assign null as Shape material";return this.zpp_inner.setMaterial(t.zpp_inner),this.zpp_inner.material.wrapper()},get_filter:function(){return this.zpp_inner.filter.wrapper()},set_filter:function(t){if(this.zpp_inner.immutable_midstep("Shape::filter"),null==t)throw"Error: Cannot assign null as Shape filter";return this.zpp_inner.setFilter(t.zpp_inner),this.zpp_inner.filter.wrapper()},get_fluidProperties:function(){return this.zpp_inner.immutable_midstep("Shape::fluidProperties"),null==this.zpp_inner.fluidProperties&&this.zpp_inner.setFluid((new p.phys.FluidProperties).zpp_inner),this.zpp_inner.fluidProperties.wrapper()},set_fluidProperties:function(t){if(null==t)throw"Error: Cannot assign null as Shape fluidProperties, disable fluids by setting fluidEnabled to false";return this.zpp_inner.setFluid(t.zpp_inner),this.zpp_inner.immutable_midstep("Shape::fluidProperties"),null==this.zpp_inner.fluidProperties&&this.zpp_inner.setFluid((new p.phys.FluidProperties).zpp_inner),this.zpp_inner.fluidProperties.wrapper()},get_fluidEnabled:function(){return this.zpp_inner.fluidEnabled},set_fluidEnabled:function(t){return this.zpp_inner.immutable_midstep("Shape::fluidEnabled"),this.zpp_inner.fluidEnabled=t,t&&null==this.zpp_inner.fluidProperties&&this.set_fluidProperties(new p.phys.FluidProperties),this.zpp_inner.wake(),this.zpp_inner.fluidEnabled},get_sensorEnabled:function(){return this.zpp_inner.sensorEnabled},set_sensorEnabled:function(t){return this.zpp_inner.immutable_midstep("Shape::sensorEnabled"),this.zpp_inner.sensorEnabled=t,this.zpp_inner.wake(),this.zpp_inner.sensorEnabled},get_bounds:function(){return this.zpp_inner.aabb.wrapper()},translate:function(t){if(this.zpp_inner.immutable_midstep("Shape::translate()"),null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=this.zpp_inner.body&&null!=this.zpp_inner.body.space&&this.zpp_inner.body.type==o.util.ZPP_Flags.id_BodyType_STATIC)throw"Error: Cannot modify Shape belonging to a static Object once inside a Space";if(null==t)throw"Error: Cannot displace Shape by null Vec2";return t.lsq()>0&&(this.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?this.zpp_inner.circle.__translate(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}()):this.zpp_inner.polygon.__translate(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}())),t.zpp_inner.weak&&t.dispose(),this},scale:function(t,n){if(this.zpp_inner.immutable_midstep("Shape::scale()"),null!=this.zpp_inner.body&&null!=this.zpp_inner.body.space&&this.zpp_inner.body.type==o.util.ZPP_Flags.id_BodyType_STATIC)throw"Error: Cannot modify Shape belonging to a static Object once inside a Space";if(t!=t||n!=n)throw"Error: Cannot scale Shape by NaN";if(0==t||0==n)throw"Error: Cannot Scale shape by a factor of 0";if(this.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE){var e=t*t-n*n;if(!(e*e<p.Config.epsilon*p.Config.epsilon))throw"Error: Cannot perform a non equal scaling on a Circle";this.zpp_inner.circle.__scale(t,n)}else this.zpp_inner.polygon.__scale(t,n);return this},rotate:function(t){if(this.zpp_inner.immutable_midstep("Shape::rotate()"),null!=this.zpp_inner.body&&null!=this.zpp_inner.body.space&&this.zpp_inner.body.type==o.util.ZPP_Flags.id_BodyType_STATIC)throw"Error: Cannot modify Shape belonging to a static Object once inside a Space";if(t!=t)throw"Error: Cannot rotate Shape by NaN";if(0!=t%(2*Math.PI)){var n=Math.cos(t),e=Math.sin(t);this.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?this.zpp_inner.circle.__rotate(e,n):this.zpp_inner.polygon.__rotate(e,n)}return this},transform:function(t){if(this.zpp_inner.immutable_midstep("Shape::transform()"),null!=this.zpp_inner.body&&null!=this.zpp_inner.body.space&&this.zpp_inner.body.type==o.util.ZPP_Flags.id_BodyType_STATIC)throw"Error: Cannot modify Shape belonging to a static Object once inside a Space";if(null==t)throw"Error: Cannot transform Shape by null matrix";if(t.singular())throw"Error: Cannot transform Shape by a singular matrix";if(this.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE){if(!t.equiorthogonal())throw"Error: Cannot transform Circle by a non equiorthogonal matrix";this.zpp_inner.circle.__transform(t)}else this.zpp_inner.polygon.__transform(t);return this},contains:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Cannot check null point for containment"
;if(null==(null!=this.zpp_inner.body?this.zpp_inner.body.outer:null))throw"Error: Shape is not well defined without a Body";o.geom.ZPP_Geom.validateShape(this.zpp_inner),t.zpp_inner.validate();var n=o.geom.ZPP_Collide.shapeContains(this.zpp_inner,t.zpp_inner);return t.zpp_inner.weak&&t.dispose(),n},copy:function(){return this.zpp_inner.copy()},toString:function(){return(this.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?"Circle":"Polygon")+"#"+this.zpp_inner_i.id},__class__:p.shape.Shape}),p.shape.Circle=function(t,n,e,i){if(this.zpp_inner_zn=null,p.shape.Shape.zpp_internalAlloc=!0,p.shape.Shape.call(this),p.shape.Shape.zpp_internalAlloc=!1,this.zpp_inner_zn=new o.shape.ZPP_Circle,this.zpp_inner_zn.outer=this,this.zpp_inner_zn.outer_zn=this,this.zpp_inner=this.zpp_inner_zn,this.zpp_inner_i=this.zpp_inner,this.zpp_inner_i.outer_i=this,this.zpp_inner.immutable_midstep("Circle::radius"),null!=this.zpp_inner.body&&this.zpp_inner.body.type==o.util.ZPP_Flags.id_BodyType_STATIC&&null!=this.zpp_inner.body.space)throw"Error: Cannot modifiy radius of Circle contained in static object once added to space";if(t!=this.zpp_inner_zn.radius){if(t!=t)throw"Error: Circle::radius cannot be NaN";if(t<p.Config.epsilon)throw"Error: Circle::radius ("+t+") must be > Config.epsilon";if(t>1e100)throw"Error: Circle::radius ("+t+") must be < PR(Const).FMAX";this.zpp_inner_zn.radius=t,this.zpp_inner_zn.invalidate_radius()}if(this.zpp_inner_zn.radius,null==n)this.zpp_inner.localCOMx=0,this.zpp_inner.localCOMy=0;else{if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(n.zpp_inner.validate(),this.zpp_inner.localCOMx=n.zpp_inner.x,null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";n.zpp_inner.validate(),this.zpp_inner.localCOMy=n.zpp_inner.y,n.zpp_inner.weak&&n.dispose()}if(null==e)null==o.phys.ZPP_Material.zpp_pool?this.zpp_inner.material=new o.phys.ZPP_Material:(this.zpp_inner.material=o.phys.ZPP_Material.zpp_pool,o.phys.ZPP_Material.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null);else{if(this.zpp_inner.immutable_midstep("Shape::material"),null==e)throw"Error: Cannot assign null as Shape material";this.zpp_inner.setMaterial(e.zpp_inner),this.zpp_inner.material.wrapper()}if(null==i)null==o.dynamics.ZPP_InteractionFilter.zpp_pool?this.zpp_inner.filter=new o.dynamics.ZPP_InteractionFilter:(this.zpp_inner.filter=o.dynamics.ZPP_InteractionFilter.zpp_pool,o.dynamics.ZPP_InteractionFilter.zpp_pool=this.zpp_inner.filter.next,this.zpp_inner.filter.next=null);else{if(this.zpp_inner.immutable_midstep("Shape::filter"),null==i)throw"Error: Cannot assign null as Shape filter";this.zpp_inner.setFilter(i.zpp_inner),this.zpp_inner.filter.wrapper()}this.zpp_inner_i.insert_cbtype(o.callbacks.ZPP_CbType.ANY_SHAPE.zpp_inner)},p.shape.Circle.__name__=!0,p.shape.Circle.__super__=p.shape.Shape,p.shape.Circle.prototype=t(p.shape.Shape.prototype,{get_radius:function(){return this.zpp_inner_zn.radius},set_radius:function(t){if(this.zpp_inner.immutable_midstep("Circle::radius"),null!=this.zpp_inner.body&&this.zpp_inner.body.type==o.util.ZPP_Flags.id_BodyType_STATIC&&null!=this.zpp_inner.body.space)throw"Error: Cannot modifiy radius of Circle contained in static object once added to space";if(t!=this.zpp_inner_zn.radius){if(t!=t)throw"Error: Circle::radius cannot be NaN";if(t<p.Config.epsilon)throw"Error: Circle::radius ("+t+") must be > Config.epsilon";if(t>1e100)throw"Error: Circle::radius ("+t+") must be < PR(Const).FMAX";this.zpp_inner_zn.radius=t,this.zpp_inner_zn.invalidate_radius()}return this.zpp_inner_zn.radius},__class__:p.shape.Circle}),p.shape.Edge=function(){if(this.zpp_inner=null,!o.shape.ZPP_Edge.internal)throw"Error: Cannot instantiate an Edge derp!"},p.shape.Edge.__name__=!0,p.shape.Edge.prototype={get_polygon:function(){if(null==this.zpp_inner.polygon)throw"Error: Edge not current in use";return this.zpp_inner.polygon.outer_zn},get_localNormal:function(){if(null==this.zpp_inner.polygon)throw"Error: Edge not current in use";return null==this.zpp_inner.wrap_lnorm&&this.zpp_inner.getlnorm(),this.zpp_inner.wrap_lnorm},get_worldNormal:function(){if(null==this.zpp_inner.polygon)throw"Error: Edge not current in use";return null==this.zpp_inner.wrap_gnorm&&this.zpp_inner.getgnorm(),this.zpp_inner.wrap_gnorm},get_length:function(){if(null==this.zpp_inner.polygon)throw"Error: Edge not current in use";return this.zpp_inner.polygon.validate_laxi(),this.zpp_inner.length},get_localProjection:function(){if(null==this.zpp_inner.polygon)throw"Error: Edge not current in use";return this.zpp_inner.polygon.validate_laxi(),this.zpp_inner.lprojection},get_worldProjection:function(){if(null==this.zpp_inner.polygon)throw"Error: Edge not current in use";if(null==this.zpp_inner.polygon.body)throw"Error: Edge world projection only makes sense for Polygons contained within a rigid body";return this.zpp_inner.polygon.validate_gaxi(),this.zpp_inner.gprojection},get_localVertex1:function(){if(null==this.zpp_inner.polygon)throw"Error: Edge not current in use";return this.zpp_inner.polygon.validate_laxi(),this.zpp_inner.lp0.wrapper()},get_localVertex2:function(){if(null==this.zpp_inner.polygon)throw"Error: Edge not current in use";return this.zpp_inner.polygon.validate_laxi(),this.zpp_inner.lp1.wrapper()},get_worldVertex1:function(){if(null==this.zpp_inner.polygon)throw"Error: Edge not current in use";return this.zpp_inner.polygon.validate_gaxi(),this.zpp_inner.gp0.wrapper()},get_worldVertex2:function(){if(null==this.zpp_inner.polygon)throw"Error: Edge not current in use";return this.zpp_inner.polygon.validate_gaxi(),this.zpp_inner.gp1.wrapper()},toString:function(){return null==this.zpp_inner.polygon?"Edge(object-pooled)":null==this.zpp_inner.polygon.body?(this.zpp_inner.polygon.validate_laxi(),"{ localNormal : { x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" } }"):(this.zpp_inner.polygon.validate_gaxi(),"{ localNormal : { x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" } worldNormal : { x: "+this.zpp_inner.gnormx+" y: "+this.zpp_inner.gnormy+" } }")},__class__:p.shape.Edge},p.shape.EdgeIterator=function(){if(this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null,!o.util.ZPP_EdgeList.internal)throw"Error: Cannot instantiate EdgeIterator derp!"},p.shape.EdgeIterator.__name__=!0,p.shape.EdgeIterator.get=function(t){var n;if(null==p.shape.EdgeIterator.zpp_pool){o.util.ZPP_EdgeList.internal=!0;var e=new p.shape.EdgeIterator;o.util.ZPP_EdgeList.internal=!1,n=e}else{var i=p.shape.EdgeIterator.zpp_pool;p.shape.EdgeIterator.zpp_pool=i.zpp_next,n=i}return n.zpp_i=0,n.zpp_inner=t,n.zpp_critical=!1,n},p.shape.EdgeIterator.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=p.shape.EdgeIterator.zpp_pool,p.shape.EdgeIterator.zpp_pool=this,this.zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:p.shape.EdgeIterator},p.shape.EdgeList=function(){this.zpp_inner=null,this.zpp_inner=new o.util.ZPP_EdgeList,this.zpp_inner.outer=this},p.shape.EdgeList.__name__=!0,p.shape.EdgeList.fromArray=function(t){if(null==t)throw"Error: Cannot convert null Array to Nape list";for(var n=new p.shape.EdgeList,e=0;e<t.length;){var i=t[e];++e,n.push(i)}return n},p.shape.EdgeList.prototype={get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},at:function(t){if(this.zpp_inner.valmod(),t<0||t>=this.get_length())throw"Error: Index out of bounds 13";if(this.zpp_inner.reverse_flag&&(t=t==this.get_length()-1?t:this.get_length()-2-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.wrapper()},push:function(t){if(this.zpp_inner.immutable)throw"Error: EdgeList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},unshift:function(t){if(this.zpp_inner.immutable)throw"Error: EdgeList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},pop:function(){if(this.zpp_inner.immutable)throw"Error: EdgeList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){t=this.zpp_inner.inner.head.elt;var n=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var e;e=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==e?this.zpp_inner.inner.head.elt:e.next.elt;var i=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)}return this.zpp_inner.invalidate(),t.wrapper()},shift:function(){if(this.zpp_inner.immutable)throw"Error: EdgeList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n;n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==n?this.zpp_inner.inner.head.elt:n.next.elt;var e=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}else{t=this.zpp_inner.inner.head.elt;var i=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),t.wrapper()},add:function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},remove:function(t){if(this.zpp_inner.immutable)throw"Error: EdgeList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;n=!1;for(var e=this.zpp_inner.inner.head;null!=e;){if(e.elt==t.zpp_inner){n=!0;break}e=e.next}return n&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),n},clear:function(){if(this.zpp_inner.immutable)throw"Error: EdgeList is immutable";if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){return this.zpp_inner.valmod(),p.shape.EdgeIterator.get(this)},copy:function(t){null==t&&(t=!1);var n,e=new p.shape.EdgeList;for(this.zpp_inner.valmod(),n=p.shape.EdgeIterator.get(this);n.hasNext();){var i;n.zpp_critical=!1,i=n.zpp_inner.at(n.zpp_i++),e.push(t?function(t){throw"Error: Edge is not a copyable type"}():i)}return e},merge:function(t){if(null==t)throw"Error: Cannot merge with null list";var n;for(t.zpp_inner.valmod(),n=p.shape.EdgeIterator.get(t);n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),this.has(e)||(this.zpp_inner.reverse_flag?this.push(e):this.unshift(e))}},toString:function(){var t,n="[",e=!0;for(this.zpp_inner.valmod(),t=p.shape.EdgeIterator.get(this);t.hasNext();){var i;t.zpp_critical=!1,i=t.zpp_inner.at(t.zpp_i++),e||(n+=","),n+=null==i?"NULL":i.toString(),e=!1}return n+"]"},foreach:function(t){if(null==t)throw"Error: Cannot execute null on list elements";var n;for(this.zpp_inner.valmod(),n=p.shape.EdgeIterator.get(this);n.hasNext();)try{t(function(t){return n.zpp_critical=!1,n.zpp_inner.at(n.zpp_i++)}())}catch(t){n.zpp_next=p.shape.EdgeIterator.zpp_pool,p.shape.EdgeIterator.zpp_pool=n,n.zpp_inner=null;break}return this},filter:function(t){if(null==t)throw"Error: Cannot select elements of list with null";for(var n=0;n<this.get_length();){var e=this.at(n);try{t(e)?n++:this.remove(e)}catch(t){break}}return this},__class__:p.shape.EdgeList},p.shape.Polygon=function(t,n,e){if(this.zpp_inner_zn=null,p.shape.Shape.zpp_internalAlloc=!0,p.shape.Shape.call(this),p.shape.Shape.zpp_internalAlloc=!1,null==t)throw"Error: localVerts cannot be null";if(this.zpp_inner_zn=new o.shape.ZPP_Polygon,this.zpp_inner_zn.outer=this,this.zpp_inner_zn.outer_zn=this,this.zpp_inner=this.zpp_inner_zn,this.zpp_inner_i=this.zpp_inner,this.zpp_inner_i.outer_i=this,t instanceof Array&&null==t.__enum__)for(var i=t,r=0;r<i.length;){var s=i[r];if(++r,null==s)throw"Error: Array<Vec2> contains null objects";if(!a.Boot.__instanceof(s,p.geom.Vec2))throw"Error: Array<Vec2> contains non Vec2 objects";var l=s;if(null!=l&&l.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";(function(t){return null==t.zpp_inner_zn.wrap_lverts&&t.zpp_inner_zn.getlverts(),t.zpp_inner_zn.wrap_lverts})(this).push(function(t){if(null!=l&&l.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return p.geom.Vec2.get(function(t){if(null!=l&&l.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return l.zpp_inner.validate(),l.zpp_inner.x}(),function(t){if(null!=l&&l.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return l.zpp_inner.validate(),l.zpp_inner.y}(),!1)}())}else if(a.Boot.__instanceof(t,p.geom.Vec2List))for(var _=t,h=_.iterator();h.hasNext();){var u;if(h.zpp_critical=!1,null==(u=h.zpp_inner.at(h.zpp_i++)))throw"Error: Vec2List contains null objects";if(null!=u&&u.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";(function(t){return null==t.zpp_inner_zn.wrap_lverts&&t.zpp_inner_zn.getlverts(),t.zpp_inner_zn.wrap_lverts})(this).push(function(t){if(null!=u&&u.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return p.geom.Vec2.get(function(t){if(null!=u&&u.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return u.zpp_inner.validate(),u.zpp_inner.x}(),function(t){if(null!=u&&u.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return u.zpp_inner.validate(),u.zpp_inner.y}(),!1)}())}else{if(!a.Boot.__instanceof(t,p.geom.GeomPoly))throw"Error: Invalid type for polygon object, should be Array<Vec2>, Vec2List, GeomPoly or for flash10+ flash.Vector<Vec2>";var d=t;if(null!=d&&d.zpp_disp)throw"Error: GeomPoly has been disposed and cannot be used!";var c=d.zpp_inner.vertices;if(null!=c){var P=c;do{var f=p.geom.Vec2.get(P.x,P.y,null);P=P.next,function(t){return null==t.zpp_inner_zn.wrap_lverts&&t.zpp_inner_zn.getlverts(),t.zpp_inner_zn.wrap_lverts}(this).push(function(t){if(null!=f&&f.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return p.geom.Vec2.get(function(t){if(null!=f&&f.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return f.zpp_inner.validate(),f.zpp_inner.x}(),function(t){if(null!=f&&f.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return f.zpp_inner.validate(),f.zpp_inner.y}(),!1)}()),f.dispose()}while(P!=c)}}if(t instanceof Array&&null==t.__enum__)for(var z=t,v=0;v<z.length;){var m=z[v];m.zpp_inner.weak&&function(t){return m.dispose(),!0}()?z.splice(v,1):v++}else if(a.Boot.__instanceof(t,p.geom.Vec2List)){var b=t;null!=b.zpp_inner._validate&&b.zpp_inner._validate();for(var y=b.zpp_inner.inner,g=null,x=y.head;null!=x;){var Z=x.elt;Z.outer.zpp_inner.weak?(x=y.erase(g),Z.outer.zpp_inner.weak&&Z.outer.dispose()):(g=x,x=x.next)}}if(null==n)null==o.phys.ZPP_Material.zpp_pool?this.zpp_inner.material=new o.phys.ZPP_Material:(this.zpp_inner.material=o.phys.ZPP_Material.zpp_pool,o.phys.ZPP_Material.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null);else{if(this.zpp_inner.immutable_midstep("Shape::material"),null==n)throw"Error: Cannot assign null as Shape material";this.zpp_inner.setMaterial(n.zpp_inner),this.zpp_inner.material.wrapper()}if(null==e)null==o.dynamics.ZPP_InteractionFilter.zpp_pool?this.zpp_inner.filter=new o.dynamics.ZPP_InteractionFilter:(this.zpp_inner.filter=o.dynamics.ZPP_InteractionFilter.zpp_pool,o.dynamics.ZPP_InteractionFilter.zpp_pool=this.zpp_inner.filter.next,this.zpp_inner.filter.next=null);else{if(this.zpp_inner.immutable_midstep("Shape::filter"),null==e)throw"Error: Cannot assign null as Shape filter";this.zpp_inner.setFilter(e.zpp_inner),this.zpp_inner.filter.wrapper()}this.zpp_inner_i.insert_cbtype(o.callbacks.ZPP_CbType.ANY_SHAPE.zpp_inner)},p.shape.Polygon.__name__=!0,p.shape.Polygon.rect=function(t,n,e,i,r){if(null==r&&(r=!1),t!=t||n!=n||e!=e||i!=i)throw"Error: Polygon.rect cannot accept NaN arguments";return[p.geom.Vec2.get(t,n,r),p.geom.Vec2.get(t+e,n,r),p.geom.Vec2.get(t+e,n+i,r),p.geom.Vec2.get(t,n+i,r)]},p.shape.Polygon.box=function(t,n,e){if(null==e&&(e=!1),t!=t||n!=n)throw"Error: Polygon.box cannot accept NaN arguments";return p.shape.Polygon.rect(-t/2,-n/2,t,n,e)},p.shape.Polygon.regular=function(t,n,e,i,r){if(null==r&&(r=!1),null==i&&(i=0),t!=t||n!=n||i!=i)throw"Error: Polygon.regular cannot accept NaN arguments";for(var s=[],l=2*Math.PI/e,a=0;a<e;){var o=a++,_=o*l+i,h=p.geom.Vec2.get(Math.cos(_)*t,Math.sin(_)*n,r);s.push(h)}return s},p.shape.Polygon.__super__=p.shape.Shape,p.shape.Polygon.prototype=t(p.shape.Shape.prototype,{get_localVerts:function(){return null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts(),this.zpp_inner_zn.wrap_lverts},get_worldVerts:function(){return null==this.zpp_inner_zn.wrap_gverts&&this.zpp_inner_zn.getgverts(),this.zpp_inner_zn.wrap_gverts},get_edges:function(){return null==this.zpp_inner_zn.wrap_edges&&this.zpp_inner_zn.getedges(),this.zpp_inner_zn.wrap_edges},validity:function(){return this.zpp_inner_zn.valid()},__class__:p.shape.Polygon}),p.shape.ShapeIterator=function(){if(this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null,!o.util.ZPP_ShapeList.internal)throw"Error: Cannot instantiate ShapeIterator derp!"},p.shape.ShapeIterator.__name__=!0,p.shape.ShapeIterator.get=function(t){var n;if(null==p.shape.ShapeIterator.zpp_pool){o.util.ZPP_ShapeList.internal=!0;var e=new p.shape.ShapeIterator;o.util.ZPP_ShapeList.internal=!1,n=e}else{var i=p.shape.ShapeIterator.zpp_pool;p.shape.ShapeIterator.zpp_pool=i.zpp_next,n=i}return n.zpp_i=0,n.zpp_inner=t,n.zpp_critical=!1,n},p.shape.ShapeIterator.prototype={hasNext:function(){this.zpp_inner.zpp_inner.valmod();var t=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<t||(this.zpp_next=p.shape.ShapeIterator.zpp_pool,p.shape.ShapeIterator.zpp_pool=this,this.zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:p.shape.ShapeIterator},p.shape.ShapeList=function(){this.zpp_inner=null,this.zpp_inner=new o.util.ZPP_ShapeList,this.zpp_inner.outer=this},p.shape.ShapeList.__name__=!0,p.shape.ShapeList.fromArray=function(t){if(null==t)throw"Error: Cannot convert null Array to Nape list";for(var n=new p.shape.ShapeList,e=0;e<t.length;){var i=t[e];++e,n.push(i)}return n},p.shape.ShapeList.prototype={get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(t){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(t.zpp_inner)},at:function(t){if(this.zpp_inner.valmod(),t<0||t>=this.get_length())throw"Error: Index out of bounds 14";if(this.zpp_inner.reverse_flag&&(t=this.get_length()-1-t),t<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=t,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(t);else for(;this.zpp_inner.at_index!=t;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elt.outer},push:function(t){if(this.zpp_inner.immutable)throw"Error: ShapeList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?this.zpp_inner.inner.add(t.zpp_inner):(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},unshift:function(t){if(this.zpp_inner.immutable)throw"Error: ShapeList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;return n=null==this.zpp_inner.adder||this.zpp_inner.adder(t),n&&(this.zpp_inner.reverse_flag?(null==this.zpp_inner.push_ite&&(null==this.zpp_inner.inner.head?this.zpp_inner.push_ite=null:this.zpp_inner.push_ite=this.zpp_inner.inner.iterator_at(this.get_length()-1)),this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,t.zpp_inner)):this.zpp_inner.inner.add(t.zpp_inner),this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)),n},pop:function(){if(this.zpp_inner.immutable)throw"Error: ShapeList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){t=this.zpp_inner.inner.head.elt;var n=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var e;e=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==e?this.zpp_inner.inner.head.elt:e.next.elt;var i=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(e)}return this.zpp_inner.invalidate(),t.outer},shift:function(){if(this.zpp_inner.immutable)throw"Error: ShapeList is immutable";if(this.zpp_inner.modify_test(),null==this.zpp_inner.inner.head)throw"Error: Cannot remove from empty list";this.zpp_inner.valmod();var t=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n;n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),t=null==n?this.zpp_inner.inner.head.elt:n.next.elt;var e=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}else{t=this.zpp_inner.inner.head.elt;var i=t.outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),t.outer},add:function(t){return this.zpp_inner.reverse_flag?this.push(t):this.unshift(t)},remove:function(t){if(this.zpp_inner.immutable)throw"Error: ShapeList is immutable";this.zpp_inner.modify_test(),this.zpp_inner.valmod();var n;n=!1;for(var e=this.zpp_inner.inner.head;null!=e;){if(e.elt==t.zpp_inner){n=!0;break}e=e.next}return n&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),n},clear:function(){if(this.zpp_inner.immutable)throw"Error: ShapeList is immutable";if(this.zpp_inner.reverse_flag)for(;null!=this.zpp_inner.inner.head;)this.pop();else for(;null!=this.zpp_inner.inner.head;)this.shift()},empty:function(){return null==this.zpp_inner.inner.head},iterator:function(){return this.zpp_inner.valmod(),p.shape.ShapeIterator.get(this)},copy:function(t){null==t&&(t=!1);var n,e=new p.shape.ShapeList;for(this.zpp_inner.valmod(),n=p.shape.ShapeIterator.get(this);n.hasNext();){var i;n.zpp_critical=!1,i=n.zpp_inner.at(n.zpp_i++),e.push(t?function(t){throw"Error: Shape is not a copyable type"}():i)}return e},merge:function(t){if(null==t)throw"Error: Cannot merge with null list";var n;for(t.zpp_inner.valmod(),n=p.shape.ShapeIterator.get(t);n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),this.has(e)||(this.zpp_inner.reverse_flag?this.push(e):this.unshift(e))}},toString:function(){var t,n="[",e=!0;for(this.zpp_inner.valmod(),t=p.shape.ShapeIterator.get(this);t.hasNext();){var i;t.zpp_critical=!1,i=t.zpp_inner.at(t.zpp_i++),e||(n+=","),n+=null==i?"NULL":i.toString(),e=!1}return n+"]"},foreach:function(t){if(null==t)throw"Error: Cannot execute null on list elements";var n;for(this.zpp_inner.valmod(),n=p.shape.ShapeIterator.get(this);n.hasNext();)try{t(function(t){return n.zpp_critical=!1,n.zpp_inner.at(n.zpp_i++)}())}catch(t){n.zpp_next=p.shape.ShapeIterator.zpp_pool,p.shape.ShapeIterator.zpp_pool=n,n.zpp_inner=null;break}return this},filter:function(t){if(null==t)throw"Error: Cannot select elements of list with null";for(var n=0;n<this.get_length();){var e=this.at(n);try{t(e)?n++:this.remove(e)}catch(t){break}}return this},__class__:p.shape.ShapeList},p.shape.ShapeType=function(){if(!o.util.ZPP_Flags.internal)throw"Error: Cannot instantiate ShapeType derp!"},p.shape.ShapeType.__name__=!0,p.shape.ShapeType.get_CIRCLE=function(){return null==o.util.ZPP_Flags.ShapeType_CIRCLE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ShapeType_CIRCLE=new p.shape.ShapeType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ShapeType_CIRCLE},p.shape.ShapeType.get_POLYGON=function(){return null==o.util.ZPP_Flags.ShapeType_POLYGON&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ShapeType_POLYGON=new p.shape.ShapeType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ShapeType_POLYGON},p.shape.ShapeType.prototype={toString:function(){return this==function(t){return null==o.util.ZPP_Flags.ShapeType_CIRCLE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ShapeType_CIRCLE=new p.shape.ShapeType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ShapeType_CIRCLE}()?"CIRCLE":this==function(t){return null==o.util.ZPP_Flags.ShapeType_POLYGON&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ShapeType_POLYGON=new p.shape.ShapeType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ShapeType_POLYGON}()?"POLYGON":""},__class__:p.shape.ShapeType},p.shape.ValidationResult=function(){if(!o.util.ZPP_Flags.internal)throw"Error: Cannot instantiate ValidationResult derp!"},p.shape.ValidationResult.__name__=!0,p.shape.ValidationResult.get_VALID=function(){return null==o.util.ZPP_Flags.ValidationResult_VALID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_VALID=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ValidationResult_VALID},p.shape.ValidationResult.get_DEGENERATE=function(){return null==o.util.ZPP_Flags.ValidationResult_DEGENERATE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_DEGENERATE=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ValidationResult_DEGENERATE},p.shape.ValidationResult.get_CONCAVE=function(){return null==o.util.ZPP_Flags.ValidationResult_CONCAVE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_CONCAVE=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ValidationResult_CONCAVE},p.shape.ValidationResult.get_SELF_INTERSECTING=function(){return null==o.util.ZPP_Flags.ValidationResult_SELF_INTERSECTING&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_SELF_INTERSECTING=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ValidationResult_SELF_INTERSECTING};p.shape.ValidationResult.prototype={toString:function(){return this==function(t){return null==o.util.ZPP_Flags.ValidationResult_VALID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_VALID=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ValidationResult_VALID}()?"VALID":this==function(t){return null==o.util.ZPP_Flags.ValidationResult_DEGENERATE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_DEGENERATE=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ValidationResult_DEGENERATE}()?"DEGENERATE":this==function(t){return null==o.util.ZPP_Flags.ValidationResult_CONCAVE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_CONCAVE=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ValidationResult_CONCAVE}()?"CONCAVE":this==function(t){return null==o.util.ZPP_Flags.ValidationResult_SELF_INTERSECTING&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_SELF_INTERSECTING=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ValidationResult_SELF_INTERSECTING}()?"SELF_INTERSECTING":""},__class__:p.shape.ValidationResult},p.space={},p.space.Broadphase=function(){if(!o.util.ZPP_Flags.internal)throw"Error: Cannot instantiate Broadphase derp!"},p.space.Broadphase.__name__=!0,p.space.Broadphase.get_DYNAMIC_AABB_TREE=function(){return null==o.util.ZPP_Flags.Broadphase_DYNAMIC_AABB_TREE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Broadphase_DYNAMIC_AABB_TREE=new p.space.Broadphase,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Broadphase_DYNAMIC_AABB_TREE},p.space.Broadphase.get_SWEEP_AND_PRUNE=function(){return null==o.util.ZPP_Flags.Broadphase_SWEEP_AND_PRUNE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Broadphase_SWEEP_AND_PRUNE=new p.space.Broadphase,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Broadphase_SWEEP_AND_PRUNE},p.space.Broadphase.prototype={toString:function(){return this==function(t){return null==o.util.ZPP_Flags.Broadphase_DYNAMIC_AABB_TREE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Broadphase_DYNAMIC_AABB_TREE=new p.space.Broadphase,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Broadphase_DYNAMIC_AABB_TREE}()?"DYNAMIC_AABB_TREE":this==function(t){return null==o.util.ZPP_Flags.Broadphase_SWEEP_AND_PRUNE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Broadphase_SWEEP_AND_PRUNE=new p.space.Broadphase,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Broadphase_SWEEP_AND_PRUNE}()?"SWEEP_AND_PRUNE":""},__class__:p.space.Broadphase},p.space.Space=function(t,n){if(this.zpp_inner=null,null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";this.zpp_inner=new o.space.ZPP_Space(null==t?null:t.zpp_inner,n),this.zpp_inner.outer=this,null!=t&&t.zpp_inner.weak&&t.dispose()},p.space.Space.__name__=!0,p.space.Space.prototype={get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_gravity:function(){return null==this.zpp_inner.wrap_gravity&&this.zpp_inner.getgravity(),this.zpp_inner.wrap_gravity},set_gravity:function(t){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Space::gravity cannot be null";return function(t){return null==t.zpp_inner.wrap_gravity&&t.zpp_inner.getgravity(),t.zpp_inner.wrap_gravity}(this).set(t),null==this.zpp_inner.wrap_gravity&&this.zpp_inner.getgravity(),
this.zpp_inner.wrap_gravity},get_broadphase:function(){return this.zpp_inner.bphase.is_sweep?(null==o.util.ZPP_Flags.Broadphase_SWEEP_AND_PRUNE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Broadphase_SWEEP_AND_PRUNE=new p.space.Broadphase,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Broadphase_SWEEP_AND_PRUNE):(null==o.util.ZPP_Flags.Broadphase_DYNAMIC_AABB_TREE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Broadphase_DYNAMIC_AABB_TREE=new p.space.Broadphase,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Broadphase_DYNAMIC_AABB_TREE)},get_sortContacts:function(){return this.zpp_inner.sortcontacts},set_sortContacts:function(t){return this.zpp_inner.sortcontacts=t,this.zpp_inner.sortcontacts},get_worldAngularDrag:function(){return this.zpp_inner.global_ang_drag},set_worldAngularDrag:function(t){var n=t;if(n!=n)throw"Error: Space::worldAngularDrag cannot be NaN";return this.zpp_inner.global_ang_drag=n,this.zpp_inner.global_ang_drag},get_worldLinearDrag:function(){return this.zpp_inner.global_lin_drag},set_worldLinearDrag:function(t){var n=t;if(n!=n)throw"Error: Space::worldLinearDrag cannot be NaN";return this.zpp_inner.global_lin_drag=n,this.zpp_inner.global_lin_drag},get_compounds:function(){return this.zpp_inner.wrap_compounds},get_bodies:function(){return this.zpp_inner.wrap_bodies},get_liveBodies:function(){return this.zpp_inner.wrap_live},get_constraints:function(){return this.zpp_inner.wrap_constraints},get_liveConstraints:function(){return this.zpp_inner.wrap_livecon},visitBodies:function(t){if(null==t)throw"Error: lambda cannot be null for Space::visitBodies";for(var n=this.zpp_inner.wrap_bodies.iterator();n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),t(e)}for(var i=this.zpp_inner.wrap_compounds.iterator();i.hasNext();){var r;i.zpp_critical=!1,r=i.zpp_inner.at(i.zpp_i++),r.visitBodies(t)}},visitConstraints:function(t){if(null==t)throw"Error: lambda cannot be null for Space::visitConstraints";for(var n=this.zpp_inner.wrap_constraints.iterator();n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),t(e)}for(var i=this.zpp_inner.wrap_compounds.iterator();i.hasNext();){var r;i.zpp_critical=!1,r=i.zpp_inner.at(i.zpp_i++),r.visitConstraints(t)}},visitCompounds:function(t){if(null==t)throw"Error: lambda cannot be null for Space::visitCompounds";for(var n=this.zpp_inner.wrap_compounds.iterator();n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),t(e),e.visitCompounds(t)}},get_world:function(){return this.zpp_inner.__static},get_arbiters:function(){if(null==this.zpp_inner.wrap_arbiters){var t=new o.dynamics.ZPP_SpaceArbiterList;t.space=this.zpp_inner,this.zpp_inner.wrap_arbiters=t}return this.zpp_inner.wrap_arbiters},get_listeners:function(){return this.zpp_inner.wrap_listeners},clear:function(){if(this.zpp_inner.midstep)throw"Error: Space::clear() cannot be called during space step()";this.zpp_inner.clear()},step:function(t,n,e){if(null==e&&(e=10),null==n&&(n=10),t!=t)throw"Error: deltaTime cannot be NaN";if(t<=0)throw"Error: deltaTime must be strictly positive";if(n<=0)throw"Error: must use atleast one velocity iteration";if(e<=0)throw"Error: must use atleast one position iteration";this.zpp_inner.step(t,n,e)},get_timeStamp:function(){return this.zpp_inner.stamp},get_elapsedTime:function(){return this.zpp_inner.time},interactionType:function(t,n){if(null==t||null==n)throw"Error: Cannot evaluate interaction type for null shapes";if(null==(null!=t.zpp_inner.body?t.zpp_inner.body.outer:null)||null==(null!=n.zpp_inner.body?n.zpp_inner.body.outer:null))throw"Error: Cannot evaluate interaction type for shapes not part of a Body";if((null!=t.zpp_inner.body?t.zpp_inner.body.outer:null).zpp_inner.type==o.util.ZPP_Flags.id_BodyType_STATIC&&(null!=n.zpp_inner.body?n.zpp_inner.body.outer:null).zpp_inner.type==o.util.ZPP_Flags.id_BodyType_STATIC)return null;if((null!=t.zpp_inner.body?t.zpp_inner.body.outer:null)==(null!=n.zpp_inner.body?n.zpp_inner.body.outer:null))return null;var e=t.zpp_inner,i=n.zpp_inner;switch(this.zpp_inner.interactionType(e,i,e.body,i.body)){case 0:return null==o.util.ZPP_Flags.InteractionType_FLUID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_FLUID=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_FLUID;case 1:return null==o.util.ZPP_Flags.InteractionType_COLLISION&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_COLLISION=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_COLLISION;case 2:return null==o.util.ZPP_Flags.InteractionType_SENSOR&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.InteractionType_SENSOR=new p.callbacks.InteractionType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.InteractionType_SENSOR;default:return null}},shapesUnderPoint:function(t,n,e){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot evaluate shapes under a null point :)";var i=this.zpp_inner.shapesUnderPoint(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(),null==n?null:n.zpp_inner,e);return t.zpp_inner.weak&&t.dispose(),i},bodiesUnderPoint:function(t,n,e){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot evaluate objects under a null point :)";var i=this.zpp_inner.bodiesUnderPoint(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(),null==n?null:n.zpp_inner,e);return t.zpp_inner.weak&&t.dispose(),i},shapesInAABB:function(t,n,e,i,r){if(null==e&&(e=!0),null==n&&(n=!1),null==t)throw"Error: Cannot evaluate shapes in a null AABB :)";if(0==function(n){return t.zpp_inner.validate(),t.zpp_inner.width()}()||0==function(n){return t.zpp_inner.validate(),t.zpp_inner.height()}())throw"Error: Cannot evaluate shapes in degenerate AABB :/";return this.zpp_inner.shapesInAABB(t,e,n,null==i?null:i.zpp_inner,r)},bodiesInAABB:function(t,n,e,i,r){if(null==e&&(e=!0),null==n&&(n=!1),null==t)throw"Error: Cannot evaluate objects in a null AABB :)";if(0==function(n){return t.zpp_inner.validate(),t.zpp_inner.width()}()||0==function(n){return t.zpp_inner.validate(),t.zpp_inner.height()}())throw"Error: Cannot evaluate objects in degenerate AABB :/";return this.zpp_inner.bodiesInAABB(t,e,n,null==i?null:i.zpp_inner,r)},shapesInCircle:function(t,n,e,i,r){if(null==e&&(e=!1),null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot evaluate shapes at null circle :)";if(n!=n)throw"Error: Circle radius cannot be NaN";if(n<=0)throw"Error: Circle radius must be strictly positive";var s=this.zpp_inner.shapesInCircle(t,n,e,null==i?null:i.zpp_inner,r);return t.zpp_inner.weak&&t.dispose(),s},bodiesInCircle:function(t,n,e,i,r){if(null==e&&(e=!1),null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(null==t)throw"Error: Cannot evaluate objects at null circle :)";if(n!=n)throw"Error: Circle radius cannot be NaN";if(n<=0)throw"Error: Circle radius must be strictly positive";var s=this.zpp_inner.bodiesInCircle(t,n,e,null==i?null:i.zpp_inner,r);return t.zpp_inner.weak&&t.dispose(),s},shapesInShape:function(t,n,e,i){if(null==n&&(n=!1),null==t)throw"Error: Cannot evaluate shapes in a null shapes :)";if(null==(null!=t.zpp_inner.body?t.zpp_inner.body.outer:null))throw"Error: Query shape needs to be inside a Body to be well defined :)";if(t.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_POLYGON){var r=t.zpp_inner.polygon.valid();if(r!=function(t){return null==o.util.ZPP_Flags.ValidationResult_VALID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_VALID=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ValidationResult_VALID}())throw"Error: Polygon query shape is invalid : "+r.toString()}return this.zpp_inner.shapesInShape(t.zpp_inner,n,null==e?null:e.zpp_inner,i)},bodiesInShape:function(t,n,e,i){if(null==n&&(n=!1),null==t)throw"Error: Cannot evaluate bodies in a null shapes :)";if(null==(null!=t.zpp_inner.body?t.zpp_inner.body.outer:null))throw"Error: Query shape needs to be inside a Body to be well defined :)";if(t.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_POLYGON){var r=t.zpp_inner.polygon.valid();if(r!=function(t){return null==o.util.ZPP_Flags.ValidationResult_VALID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_VALID=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ValidationResult_VALID}())throw"Error: Polygon query shape is invalid : "+r.toString()}return this.zpp_inner.bodiesInShape(t.zpp_inner,n,null==e?null:e.zpp_inner,i)},shapesInBody:function(t,n,e){if(null==t)throw"Error: Cannot evaluate shapes in null body";var i;i=null==e?new p.shape.ShapeList:e;for(var r=t.zpp_inner.wrap_shapes.iterator();r.hasNext();){var s;r.zpp_critical=!1,s=r.zpp_inner.at(r.zpp_i++);this.shapesInShape(s,!1,n,i)}return i},bodiesInBody:function(t,n,e){if(null==t)throw"Error: Cannot evaluate shapes in null body";var i;i=null==e?new p.phys.BodyList:e;for(var r=t.zpp_inner.wrap_shapes.iterator();r.hasNext();){var s;r.zpp_critical=!1,s=r.zpp_inner.at(r.zpp_i++);this.bodiesInShape(s,!1,n,i)}return i},convexCast:function(t,n,e,i){if(null==e&&(e=!1),null==t)throw"Error: Cannot cast null shape :)";if(null==(null!=t.zpp_inner.body?t.zpp_inner.body.outer:null))throw"Error: Shape must belong to a body to be cast.";if(n<0||n!=n)throw"Error: deltaTime must be positive";return this.zpp_inner.convexCast(t.zpp_inner,n,i,e)},convexMultiCast:function(t,n,e,i,r){if(null==e&&(e=!1),null==t)throw"Error: Cannot cast null shape :)";if(null==(null!=t.zpp_inner.body?t.zpp_inner.body.outer:null))throw"Error: Shape must belong to a body to be cast.";if(n<0||n!=n)throw"Error: deltaTime must be positive";return this.zpp_inner.convexMultiCast(t.zpp_inner,n,i,e,r)},rayCast:function(t,n,e){if(null==n&&(n=!1),null==t)throw"Error: Cannot cast null ray :)";return this.zpp_inner.rayCast(t,n,e)},rayMultiCast:function(t,n,e,i){if(null==n&&(n=!1),null==t)throw"Error: Cannot cast null ray :)";return this.zpp_inner.rayMultiCast(t,n,e,i)},__class__:p.space.Space},p.util={},p.util.Debug=function(){},p.util.Debug.__name__=!0,p.util.Debug.version=function(){return"Nape 2.0.19"},p.util.Debug.clearObjectPools=function(){for(;null!=p.constraint.ConstraintIterator.zpp_pool;){var t=p.constraint.ConstraintIterator.zpp_pool.zpp_next;p.constraint.ConstraintIterator.zpp_pool.zpp_next=null,p.constraint.ConstraintIterator.zpp_pool=t}for(;null!=p.phys.InteractorIterator.zpp_pool;){var n=p.phys.InteractorIterator.zpp_pool.zpp_next;p.phys.InteractorIterator.zpp_pool.zpp_next=null,p.phys.InteractorIterator.zpp_pool=n}for(;null!=p.phys.BodyIterator.zpp_pool;){var e=p.phys.BodyIterator.zpp_pool.zpp_next;p.phys.BodyIterator.zpp_pool.zpp_next=null,p.phys.BodyIterator.zpp_pool=e}for(;null!=p.phys.CompoundIterator.zpp_pool;){var i=p.phys.CompoundIterator.zpp_pool.zpp_next;p.phys.CompoundIterator.zpp_pool.zpp_next=null,p.phys.CompoundIterator.zpp_pool=i}for(;null!=p.callbacks.ListenerIterator.zpp_pool;){var r=p.callbacks.ListenerIterator.zpp_pool.zpp_next;p.callbacks.ListenerIterator.zpp_pool.zpp_next=null,p.callbacks.ListenerIterator.zpp_pool=r}for(;null!=p.callbacks.CbTypeIterator.zpp_pool;){var s=p.callbacks.CbTypeIterator.zpp_pool.zpp_next;p.callbacks.CbTypeIterator.zpp_pool.zpp_next=null,p.callbacks.CbTypeIterator.zpp_pool=s}for(;null!=p.geom.ConvexResultIterator.zpp_pool;){var l=p.geom.ConvexResultIterator.zpp_pool.zpp_next;p.geom.ConvexResultIterator.zpp_pool.zpp_next=null,p.geom.ConvexResultIterator.zpp_pool=l}for(;null!=p.geom.GeomPolyIterator.zpp_pool;){var a=p.geom.GeomPolyIterator.zpp_pool.zpp_next;p.geom.GeomPolyIterator.zpp_pool.zpp_next=null,p.geom.GeomPolyIterator.zpp_pool=a}for(;null!=p.geom.Vec2Iterator.zpp_pool;){var _=p.geom.Vec2Iterator.zpp_pool.zpp_next;p.geom.Vec2Iterator.zpp_pool.zpp_next=null,p.geom.Vec2Iterator.zpp_pool=_}for(;null!=p.geom.RayResultIterator.zpp_pool;){var h=p.geom.RayResultIterator.zpp_pool.zpp_next;p.geom.RayResultIterator.zpp_pool.zpp_next=null,p.geom.RayResultIterator.zpp_pool=h}for(;null!=p.shape.ShapeIterator.zpp_pool;){var u=p.shape.ShapeIterator.zpp_pool.zpp_next;p.shape.ShapeIterator.zpp_pool.zpp_next=null,p.shape.ShapeIterator.zpp_pool=u}for(;null!=p.shape.EdgeIterator.zpp_pool;){var d=p.shape.EdgeIterator.zpp_pool.zpp_next;p.shape.EdgeIterator.zpp_pool.zpp_next=null,p.shape.EdgeIterator.zpp_pool=d}for(;null!=p.dynamics.ContactIterator.zpp_pool;){var c=p.dynamics.ContactIterator.zpp_pool.zpp_next;p.dynamics.ContactIterator.zpp_pool.zpp_next=null,p.dynamics.ContactIterator.zpp_pool=c}for(;null!=p.dynamics.ArbiterIterator.zpp_pool;){var P=p.dynamics.ArbiterIterator.zpp_pool.zpp_next;p.dynamics.ArbiterIterator.zpp_pool.zpp_next=null,p.dynamics.ArbiterIterator.zpp_pool=P}for(;null!=p.dynamics.InteractionGroupIterator.zpp_pool;){var f=p.dynamics.InteractionGroupIterator.zpp_pool.zpp_next;p.dynamics.InteractionGroupIterator.zpp_pool.zpp_next=null,p.dynamics.InteractionGroupIterator.zpp_pool=f}for(;null!=o.util.ZNPNode_ZPP_CbType.zpp_pool;){var z=o.util.ZNPNode_ZPP_CbType.zpp_pool.next;o.util.ZNPNode_ZPP_CbType.zpp_pool.next=null,o.util.ZNPNode_ZPP_CbType.zpp_pool=z}for(;null!=o.util.ZNPNode_ZPP_CallbackSet.zpp_pool;){var v=o.util.ZNPNode_ZPP_CallbackSet.zpp_pool.next;o.util.ZNPNode_ZPP_CallbackSet.zpp_pool.next=null,o.util.ZNPNode_ZPP_CallbackSet.zpp_pool=v}for(;null!=o.phys.ZPP_Material.zpp_pool;){var m=o.phys.ZPP_Material.zpp_pool.next;o.phys.ZPP_Material.zpp_pool.next=null,o.phys.ZPP_Material.zpp_pool=m}for(;null!=o.util.ZNPNode_ZPP_Shape.zpp_pool;){var b=o.util.ZNPNode_ZPP_Shape.zpp_pool.next;o.util.ZNPNode_ZPP_Shape.zpp_pool.next=null,o.util.ZNPNode_ZPP_Shape.zpp_pool=b}for(;null!=o.phys.ZPP_FluidProperties.zpp_pool;){var y=o.phys.ZPP_FluidProperties.zpp_pool.next;o.phys.ZPP_FluidProperties.zpp_pool.next=null,o.phys.ZPP_FluidProperties.zpp_pool=y}for(;null!=o.util.ZNPNode_ZPP_Body.zpp_pool;){var g=o.util.ZNPNode_ZPP_Body.zpp_pool.next;o.util.ZNPNode_ZPP_Body.zpp_pool.next=null,o.util.ZNPNode_ZPP_Body.zpp_pool=g}for(;null!=o.util.ZNPNode_ZPP_Constraint.zpp_pool;){var x=o.util.ZNPNode_ZPP_Constraint.zpp_pool.next;o.util.ZNPNode_ZPP_Constraint.zpp_pool.next=null,o.util.ZNPNode_ZPP_Constraint.zpp_pool=x}for(;null!=o.util.ZNPNode_ZPP_Compound.zpp_pool;){var Z=o.util.ZNPNode_ZPP_Compound.zpp_pool.next;o.util.ZNPNode_ZPP_Compound.zpp_pool.next=null,o.util.ZNPNode_ZPP_Compound.zpp_pool=Z}for(;null!=o.callbacks.ZPP_CbSetPair.zpp_pool;){var w=o.callbacks.ZPP_CbSetPair.zpp_pool.next;o.callbacks.ZPP_CbSetPair.zpp_pool.next=null,o.callbacks.ZPP_CbSetPair.zpp_pool=w}for(;null!=o.util.ZNPNode_ZPP_InteractionListener.zpp_pool;){var C=o.util.ZNPNode_ZPP_InteractionListener.zpp_pool.next;o.util.ZNPNode_ZPP_InteractionListener.zpp_pool.next=null,o.util.ZNPNode_ZPP_InteractionListener.zpp_pool=C}for(;null!=o.util.ZNPNode_ZPP_CbSet.zpp_pool;){var E=o.util.ZNPNode_ZPP_CbSet.zpp_pool.next;o.util.ZNPNode_ZPP_CbSet.zpp_pool.next=null,o.util.ZNPNode_ZPP_CbSet.zpp_pool=E}for(;null!=o.util.ZNPNode_ZPP_Interactor.zpp_pool;){var S=o.util.ZNPNode_ZPP_Interactor.zpp_pool.next;o.util.ZNPNode_ZPP_Interactor.zpp_pool.next=null,o.util.ZNPNode_ZPP_Interactor.zpp_pool=S}for(;null!=o.util.ZNPNode_ZPP_BodyListener.zpp_pool;){var N=o.util.ZNPNode_ZPP_BodyListener.zpp_pool.next;o.util.ZNPNode_ZPP_BodyListener.zpp_pool.next=null,o.util.ZNPNode_ZPP_BodyListener.zpp_pool=N}for(;null!=o.util.ZNPNode_ZPP_Arbiter.zpp_pool;){var k=o.util.ZNPNode_ZPP_Arbiter.zpp_pool.next;o.util.ZNPNode_ZPP_Arbiter.zpp_pool.next=null,o.util.ZNPNode_ZPP_Arbiter.zpp_pool=k}for(;null!=o.util.ZNPNode_ZPP_ConstraintListener.zpp_pool;){var M=o.util.ZNPNode_ZPP_ConstraintListener.zpp_pool.next;o.util.ZNPNode_ZPP_ConstraintListener.zpp_pool.next=null,o.util.ZNPNode_ZPP_ConstraintListener.zpp_pool=M}for(;null!=o.util.ZPP_Set_ZPP_Body.zpp_pool;){var I=o.util.ZPP_Set_ZPP_Body.zpp_pool.next;o.util.ZPP_Set_ZPP_Body.zpp_pool.next=null,o.util.ZPP_Set_ZPP_Body.zpp_pool=I}for(;null!=o.callbacks.ZPP_CbSet.zpp_pool;){var F=o.callbacks.ZPP_CbSet.zpp_pool.next;o.callbacks.ZPP_CbSet.zpp_pool.next=null,o.callbacks.ZPP_CbSet.zpp_pool=F}for(;null!=o.util.ZNPNode_ZPP_CbSetPair.zpp_pool;){var A=o.util.ZNPNode_ZPP_CbSetPair.zpp_pool.next;o.util.ZNPNode_ZPP_CbSetPair.zpp_pool.next=null,o.util.ZNPNode_ZPP_CbSetPair.zpp_pool=A}for(;null!=o.callbacks.ZPP_Callback.zpp_pool;){var T=o.callbacks.ZPP_Callback.zpp_pool.next;o.callbacks.ZPP_Callback.zpp_pool.next=null,o.callbacks.ZPP_Callback.zpp_pool=T}for(;null!=o.geom.ZPP_GeomVert.zpp_pool;){var V=o.geom.ZPP_GeomVert.zpp_pool.next;o.geom.ZPP_GeomVert.zpp_pool.next=null,o.geom.ZPP_GeomVert.zpp_pool=V}for(;null!=o.geom.ZPP_GeomVertexIterator.zpp_pool;){var L=o.geom.ZPP_GeomVertexIterator.zpp_pool.next;o.geom.ZPP_GeomVertexIterator.zpp_pool.next=null,o.geom.ZPP_GeomVertexIterator.zpp_pool=L}for(;null!=o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool;){var B=o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool.next;o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool.next=null,o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool=B}for(;null!=o.geom.ZPP_Mat23.zpp_pool;){var O=o.geom.ZPP_Mat23.zpp_pool.next;o.geom.ZPP_Mat23.zpp_pool.next=null,o.geom.ZPP_Mat23.zpp_pool=O}for(;null!=o.geom.ZPP_CutVert.zpp_pool;){var G=o.geom.ZPP_CutVert.zpp_pool.next;o.geom.ZPP_CutVert.zpp_pool.next=null,o.geom.ZPP_CutVert.zpp_pool=G}for(;null!=o.geom.ZPP_CutInt.zpp_pool;){var R=o.geom.ZPP_CutInt.zpp_pool.next;o.geom.ZPP_CutInt.zpp_pool.next=null,o.geom.ZPP_CutInt.zpp_pool=R}for(;null!=o.util.ZNPNode_ZPP_CutInt.zpp_pool;){var D=o.util.ZNPNode_ZPP_CutInt.zpp_pool.next;o.util.ZNPNode_ZPP_CutInt.zpp_pool.next=null,o.util.ZNPNode_ZPP_CutInt.zpp_pool=D}for(;null!=o.util.ZNPNode_ZPP_CutVert.zpp_pool;){var j=o.util.ZNPNode_ZPP_CutVert.zpp_pool.next;o.util.ZNPNode_ZPP_CutVert.zpp_pool.next=null,o.util.ZNPNode_ZPP_CutVert.zpp_pool=j}for(;null!=o.geom.ZPP_Vec2.zpp_pool;){var q=o.geom.ZPP_Vec2.zpp_pool.next;o.geom.ZPP_Vec2.zpp_pool.next=null,o.geom.ZPP_Vec2.zpp_pool=q}for(;null!=o.util.ZNPNode_ZPP_PartitionVertex.zpp_pool;){var Y=o.util.ZNPNode_ZPP_PartitionVertex.zpp_pool.next;o.util.ZNPNode_ZPP_PartitionVertex.zpp_pool.next=null,o.util.ZNPNode_ZPP_PartitionVertex.zpp_pool=Y}for(;null!=o.geom.ZPP_PartitionVertex.zpp_pool;){var U=o.geom.ZPP_PartitionVertex.zpp_pool.next;o.geom.ZPP_PartitionVertex.zpp_pool.next=null,o.geom.ZPP_PartitionVertex.zpp_pool=U}for(;null!=o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool;){var W=o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool.next;o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool.next=null,o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool=W}for(;null!=o.geom.ZPP_PartitionedPoly.zpp_pool;){var J=o.geom.ZPP_PartitionedPoly.zpp_pool.next;o.geom.ZPP_PartitionedPoly.zpp_pool.next=null,o.geom.ZPP_PartitionedPoly.zpp_pool=J}for(;null!=o.util.ZNPNode_ZPP_PartitionedPoly.zpp_pool;){var K=o.util.ZNPNode_ZPP_PartitionedPoly.zpp_pool.next;o.util.ZNPNode_ZPP_PartitionedPoly.zpp_pool.next=null,o.util.ZNPNode_ZPP_PartitionedPoly.zpp_pool=K}for(;null!=o.geom.ZPP_PartitionPair.zpp_pool;){var H=o.geom.ZPP_PartitionPair.zpp_pool.next;o.geom.ZPP_PartitionPair.zpp_pool.next=null,o.geom.ZPP_PartitionPair.zpp_pool=H}for(;null!=o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool;){var X=o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool.next;o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool.next=null,o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool=X}for(;null!=o.util.ZNPNode_ZPP_GeomVert.zpp_pool;){var Q=o.util.ZNPNode_ZPP_GeomVert.zpp_pool.next;o.util.ZNPNode_ZPP_GeomVert.zpp_pool.next=null,o.util.ZNPNode_ZPP_GeomVert.zpp_pool=Q}for(;null!=o.geom.ZPP_SimplifyV.zpp_pool;){var $=o.geom.ZPP_SimplifyV.zpp_pool.next;o.geom.ZPP_SimplifyV.zpp_pool.next=null,o.geom.ZPP_SimplifyV.zpp_pool=$}for(;null!=o.geom.ZPP_SimplifyP.zpp_pool;){var tt=o.geom.ZPP_SimplifyP.zpp_pool.next;o.geom.ZPP_SimplifyP.zpp_pool.next=null,o.geom.ZPP_SimplifyP.zpp_pool=tt}for(;null!=o.util.ZNPNode_ZPP_SimplifyP.zpp_pool;){var nt=o.util.ZNPNode_ZPP_SimplifyP.zpp_pool.next;o.util.ZNPNode_ZPP_SimplifyP.zpp_pool.next=null,o.util.ZNPNode_ZPP_SimplifyP.zpp_pool=nt}for(;null!=o.geom.ZPP_AABB.zpp_pool;){var et=o.geom.ZPP_AABB.zpp_pool.next;o.geom.ZPP_AABB.zpp_pool.next=null,o.geom.ZPP_AABB.zpp_pool=et}for(;null!=o.geom.ZPP_ToiEvent.zpp_pool;){var it=o.geom.ZPP_ToiEvent.zpp_pool.next;o.geom.ZPP_ToiEvent.zpp_pool.next=null,o.geom.ZPP_ToiEvent.zpp_pool=it}for(;null!=o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool;){var rt=o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool.next;o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool.next=null,o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool=rt}for(;null!=o.geom.ZPP_SimpleVert.zpp_pool;){var st=o.geom.ZPP_SimpleVert.zpp_pool.next;o.geom.ZPP_SimpleVert.zpp_pool.next=null,o.geom.ZPP_SimpleVert.zpp_pool=st}for(;null!=o.geom.ZPP_SimpleSeg.zpp_pool;){var lt=o.geom.ZPP_SimpleSeg.zpp_pool.next;o.geom.ZPP_SimpleSeg.zpp_pool.next=null,o.geom.ZPP_SimpleSeg.zpp_pool=lt}for(;null!=o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool;){var at=o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool.next;o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool.next=null,o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool=at}for(;null!=o.geom.ZPP_MarchSpan.zpp_pool;){var pt=o.geom.ZPP_MarchSpan.zpp_pool.next;o.geom.ZPP_MarchSpan.zpp_pool.next=null,o.geom.ZPP_MarchSpan.zpp_pool=pt}for(;null!=o.geom.ZPP_MarchPair.zpp_pool;){var ot=o.geom.ZPP_MarchPair.zpp_pool.next;o.geom.ZPP_MarchPair.zpp_pool.next=null,o.geom.ZPP_MarchPair.zpp_pool=ot}for(;null!=o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool;){var _t=o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool.next;o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool.next=null,o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool=_t}for(;null!=o.geom.ZPP_SimpleEvent.zpp_pool;){var ht=o.geom.ZPP_SimpleEvent.zpp_pool.next;o.geom.ZPP_SimpleEvent.zpp_pool.next=null,o.geom.ZPP_SimpleEvent.zpp_pool=ht}for(;null!=o.util.Hashable2_Boolfalse.zpp_pool;){var ut=o.util.Hashable2_Boolfalse.zpp_pool.next;o.util.Hashable2_Boolfalse.zpp_pool.next=null,o.util.Hashable2_Boolfalse.zpp_pool=ut}for(;null!=o.util.ZNPNode_ZPP_SimpleVert.zpp_pool;){var dt=o.util.ZNPNode_ZPP_SimpleVert.zpp_pool.next;o.util.ZNPNode_ZPP_SimpleVert.zpp_pool.next=null,o.util.ZNPNode_ZPP_SimpleVert.zpp_pool=dt}for(;null!=o.util.ZNPNode_ZPP_SimpleEvent.zpp_pool;){var ct=o.util.ZNPNode_ZPP_SimpleEvent.zpp_pool.next;o.util.ZNPNode_ZPP_SimpleEvent.zpp_pool.next=null,o.util.ZNPNode_ZPP_SimpleEvent.zpp_pool=ct}for(;null!=o.util.ZNPNode_ZPP_AABBPair.zpp_pool;){var Pt=o.util.ZNPNode_ZPP_AABBPair.zpp_pool.next;o.util.ZNPNode_ZPP_AABBPair.zpp_pool.next=null,o.util.ZNPNode_ZPP_AABBPair.zpp_pool=Pt}for(;null!=o.shape.ZPP_Edge.zpp_pool;){var ft=o.shape.ZPP_Edge.zpp_pool.next;o.shape.ZPP_Edge.zpp_pool.next=null,o.shape.ZPP_Edge.zpp_pool=ft}for(;null!=o.util.ZNPNode_ZPP_Edge.zpp_pool;){var zt=o.util.ZNPNode_ZPP_Edge.zpp_pool.next;o.util.ZNPNode_ZPP_Edge.zpp_pool.next=null,o.util.ZNPNode_ZPP_Edge.zpp_pool=zt}for(;null!=o.util.ZNPNode_ZPP_Vec2.zpp_pool;){var vt=o.util.ZNPNode_ZPP_Vec2.zpp_pool.next;o.util.ZNPNode_ZPP_Vec2.zpp_pool.next=null,o.util.ZNPNode_ZPP_Vec2.zpp_pool=vt}for(;null!=o.space.ZPP_SweepData.zpp_pool;){var mt=o.space.ZPP_SweepData.zpp_pool.next;o.space.ZPP_SweepData.zpp_pool.next=null,o.space.ZPP_SweepData.zpp_pool=mt}for(;null!=o.space.ZPP_AABBNode.zpp_pool;){var bt=o.space.ZPP_AABBNode.zpp_pool.next;o.space.ZPP_AABBNode.zpp_pool.next=null,o.space.ZPP_AABBNode.zpp_pool=bt}for(;null!=o.space.ZPP_AABBPair.zpp_pool;){var yt=o.space.ZPP_AABBPair.zpp_pool.next;o.space.ZPP_AABBPair.zpp_pool.next=null,o.space.ZPP_AABBPair.zpp_pool=yt}for(;null!=o.dynamics.ZPP_Contact.zpp_pool;){var gt=o.dynamics.ZPP_Contact.zpp_pool.next;o.dynamics.ZPP_Contact.zpp_pool.next=null,o.dynamics.ZPP_Contact.zpp_pool=gt}for(;null!=o.util.ZNPNode_ZPP_Component.zpp_pool;){var xt=o.util.ZNPNode_ZPP_Component.zpp_pool.next;o.util.ZNPNode_ZPP_Component.zpp_pool.next=null,o.util.ZNPNode_ZPP_Component.zpp_pool=xt}for(;null!=o.util.ZNPNode_ZPP_AABBNode.zpp_pool;){var Zt=o.util.ZNPNode_ZPP_AABBNode.zpp_pool.next;o.util.ZNPNode_ZPP_AABBNode.zpp_pool.next=null,o.util.ZNPNode_ZPP_AABBNode.zpp_pool=Zt}for(;null!=o.space.ZPP_Island.zpp_pool;){var wt=o.space.ZPP_Island.zpp_pool.next;o.space.ZPP_Island.zpp_pool.next=null,o.space.ZPP_Island.zpp_pool=wt}for(;null!=o.space.ZPP_Component.zpp_pool;){var Ct=o.space.ZPP_Component.zpp_pool.next;o.space.ZPP_Component.zpp_pool.next=null,o.space.ZPP_Component.zpp_pool=Ct}for(;null!=o.space.ZPP_CallbackSet.zpp_pool;){var Et=o.space.ZPP_CallbackSet.zpp_pool.next;o.space.ZPP_CallbackSet.zpp_pool.next=null,o.space.ZPP_CallbackSet.zpp_pool=Et}for(;null!=o.util.ZPP_Set_ZPP_CbSet.zpp_pool;){var St=o.util.ZPP_Set_ZPP_CbSet.zpp_pool.next;o.util.ZPP_Set_ZPP_CbSet.zpp_pool.next=null,o.util.ZPP_Set_ZPP_CbSet.zpp_pool=St}for(;null!=o.util.ZNPNode_ZPP_InteractionGroup.zpp_pool;){var Nt=o.util.ZNPNode_ZPP_InteractionGroup.zpp_pool.next;o.util.ZNPNode_ZPP_InteractionGroup.zpp_pool.next=null,o.util.ZNPNode_ZPP_InteractionGroup.zpp_pool=Nt}for(;null!=o.util.ZNPNode_ZPP_FluidArbiter.zpp_pool;){var kt=o.util.ZNPNode_ZPP_FluidArbiter.zpp_pool.next;o.util.ZNPNode_ZPP_FluidArbiter.zpp_pool.next=null,o.util.ZNPNode_ZPP_FluidArbiter.zpp_pool=kt}for(;null!=o.dynamics.ZPP_InteractionFilter.zpp_pool;){var Mt=o.dynamics.ZPP_InteractionFilter.zpp_pool.next;o.dynamics.ZPP_InteractionFilter.zpp_pool.next=null,o.dynamics.ZPP_InteractionFilter.zpp_pool=Mt}for(;null!=o.util.ZNPNode_ZPP_SensorArbiter.zpp_pool;){var It=o.util.ZNPNode_ZPP_SensorArbiter.zpp_pool.next;o.util.ZNPNode_ZPP_SensorArbiter.zpp_pool.next=null,o.util.ZNPNode_ZPP_SensorArbiter.zpp_pool=It}for(;null!=o.util.ZNPNode_ZPP_ColArbiter.zpp_pool;){var Ft=o.util.ZNPNode_ZPP_ColArbiter.zpp_pool.next;o.util.ZNPNode_ZPP_ColArbiter.zpp_pool.next=null,o.util.ZNPNode_ZPP_ColArbiter.zpp_pool=Ft}for(;null!=o.util.ZNPNode_ZPP_Listener.zpp_pool;){var At=o.util.ZNPNode_ZPP_Listener.zpp_pool.next;o.util.ZNPNode_ZPP_Listener.zpp_pool.next=null,o.util.ZNPNode_ZPP_Listener.zpp_pool=At}for(;null!=o.dynamics.ZPP_SensorArbiter.zpp_pool;){var Tt=o.dynamics.ZPP_SensorArbiter.zpp_pool.next;o.dynamics.ZPP_SensorArbiter.zpp_pool.next=null,o.dynamics.ZPP_SensorArbiter.zpp_pool=Tt}for(;null!=o.dynamics.ZPP_FluidArbiter.zpp_pool;){var Vt=o.dynamics.ZPP_FluidArbiter.zpp_pool.next;o.dynamics.ZPP_FluidArbiter.zpp_pool.next=null,o.dynamics.ZPP_FluidArbiter.zpp_pool=Vt}for(;null!=o.util.ZNPNode_ZPP_ToiEvent.zpp_pool;){var Lt=o.util.ZNPNode_ZPP_ToiEvent.zpp_pool.next;o.util.ZNPNode_ZPP_ToiEvent.zpp_pool.next=null,o.util.ZNPNode_ZPP_ToiEvent.zpp_pool=Lt}for(;null!=o.dynamics.ZPP_ColArbiter.zpp_pool;){var Bt=o.dynamics.ZPP_ColArbiter.zpp_pool.next;o.dynamics.ZPP_ColArbiter.zpp_pool.next=null,o.dynamics.ZPP_ColArbiter.zpp_pool=Bt}for(;null!=o.util.ZNPNode_ConvexResult.zpp_pool;){var Ot=o.util.ZNPNode_ConvexResult.zpp_pool.next;o.util.ZNPNode_ConvexResult.zpp_pool.next=null,o.util.ZNPNode_ConvexResult.zpp_pool=Ot}for(;null!=o.util.ZNPNode_ZPP_GeomPoly.zpp_pool;){var Gt=o.util.ZNPNode_ZPP_GeomPoly.zpp_pool.next;o.util.ZNPNode_ZPP_GeomPoly.zpp_pool.next=null,o.util.ZNPNode_ZPP_GeomPoly.zpp_pool=Gt}for(;null!=o.util.ZNPNode_RayResult.zpp_pool;){var Rt=o.util.ZNPNode_RayResult.zpp_pool.next;o.util.ZNPNode_RayResult.zpp_pool.next=null,o.util.ZNPNode_RayResult.zpp_pool=Rt}for(;null!=o.util.ZPP_PubPool.poolGeomPoly;){var Dt=o.util.ZPP_PubPool.poolGeomPoly.zpp_pool;o.util.ZPP_PubPool.poolGeomPoly.zpp_pool=null,o.util.ZPP_PubPool.poolGeomPoly=Dt}for(;null!=o.util.ZPP_PubPool.poolVec2;){var jt=o.util.ZPP_PubPool.poolVec2.zpp_pool;o.util.ZPP_PubPool.poolVec2.zpp_pool=null,o.util.ZPP_PubPool.poolVec2=jt}for(;null!=o.util.ZPP_PubPool.poolVec3;){var qt=o.util.ZPP_PubPool.poolVec3.zpp_pool;o.util.ZPP_PubPool.poolVec3.zpp_pool=null,o.util.ZPP_PubPool.poolVec3=qt}};var o={};o.ZPP_Const=function(){},o.ZPP_Const.__name__=!0,o.ZPP_Const.POSINF=function(){return Math.POSITIVE_INFINITY},o.ZPP_Const.NEGINF=function(){return Math.NEGATIVE_INFINITY},o.ZPP_ID=function(){},o.ZPP_ID.__name__=!0,o.ZPP_ID.Constraint=function(){return o.ZPP_ID._Constraint++},o.ZPP_ID.Interactor=function(){return o.ZPP_ID._Interactor++},o.ZPP_ID.CbType=function(){return o.ZPP_ID._CbType++},o.ZPP_ID.CbSet=function(){return o.ZPP_ID._CbSet++},o.ZPP_ID.Listener=function(){return o.ZPP_ID._Listener++},o.ZPP_ID.ZPP_SimpleVert=function(){return o.ZPP_ID._ZPP_SimpleVert++},o.ZPP_ID.ZPP_SimpleSeg=function(){return o.ZPP_ID._ZPP_SimpleSeg++},o.ZPP_ID.Space=function(){return o.ZPP_ID._Space++},o.ZPP_ID.InteractionGroup=function(){return o.ZPP_ID._InteractionGroup++},o.callbacks={},o.callbacks.ZPP_Callback=function(){this.constraint=null,this.body=null,this.pre_swapped=!1,this.pre_arbiter=null,this.wrap_arbiters=null,this.set=null,this.int2=null,this.int1=null,this.length=0,this.prev=null,this.next=null,this.index=0,this.space=null,this.listener=null,this.event=0,this.outer_int=null,this.outer_con=null,this.outer_body=null,this.length=0},o.callbacks.ZPP_Callback.__name__=!0,o.callbacks.ZPP_Callback.prototype={wrapper_body:function(){return null==this.outer_body&&(o.callbacks.ZPP_Callback.internal=!0,this.outer_body=new p.callbacks.BodyCallback,o.callbacks.ZPP_Callback.internal=!1,this.outer_body.zpp_inner=this),this.outer_body},wrapper_con:function(){return null==this.outer_con&&(o.callbacks.ZPP_Callback.internal=!0,this.outer_con=new p.callbacks.ConstraintCallback,o.callbacks.ZPP_Callback.internal=!1,this.outer_con.zpp_inner=this),this.outer_con},wrapper_int:function(){return null==this.outer_int&&(o.callbacks.ZPP_Callback.internal=!0,this.outer_int=new p.callbacks.InteractionCallback,o.callbacks.ZPP_Callback.internal=!1,this.outer_int.zpp_inner=this),null==this.wrap_arbiters?this.wrap_arbiters=o.util.ZPP_ArbiterList.get(this.set.arbiters,!0):this.wrap_arbiters.zpp_inner.inner=this.set.arbiters,this.wrap_arbiters.zpp_inner.zip_length=!0,this.wrap_arbiters.zpp_inner.at_ite=null,this.outer_int},push:function(t){null!=this.prev?this.prev.next=t:this.next=t,t.prev=this.prev,t.next=null,this.prev=t,this.length++},push_rev:function(t){null!=this.next?this.next.prev=t:this.prev=t,t.next=this.next,t.prev=null,this.next=t,this.length++},pop:function(){var t=this.next;return this.next=t.next,null==this.next?this.prev=null:this.next.prev=null,this.length--,t},pop_rev:function(){var t=this.prev;return this.prev=t.prev,null==this.prev?this.next=null:this.prev.next=null,this.length--,t},empty:function(){return null==this.next},clear:function(){for(;!this.empty();)this.pop()},splice:function(t){var n=t.next;return null==t.prev?(this.next=t.next,null!=this.next?this.next.prev=null:this.prev=null):(t.prev.next=t.next,null!=t.next?t.next.prev=t.prev:this.prev=t.prev),this.length--,n},rotateL:function(){this.push(this.pop())},rotateR:function(){this.push_rev(this.pop_rev())},cycleNext:function(t){return null==t.next?this.next:t.next},cyclePrev:function(t){return null==t.prev?this.prev:t.prev},at:function(t){for(var n=this.next;0!=t--;)n=n.next;return n},rev_at:function(t){for(var n=this.prev;0!=t--;)n=n.prev;return n},free:function(){this.int1=this.int2=null,this.body=null,this.constraint=null,this.listener=null,null!=this.wrap_arbiters&&(this.wrap_arbiters.zpp_inner.inner=null),this.set=null},alloc:function(){},genarbs:function(){null==this.wrap_arbiters?this.wrap_arbiters=o.util.ZPP_ArbiterList.get(this.set.arbiters,!0):this.wrap_arbiters.zpp_inner.inner=this.set.arbiters,this.wrap_arbiters.zpp_inner.zip_length=!0,this.wrap_arbiters.zpp_inner.at_ite=null},__class__:o.callbacks.ZPP_Callback},o.callbacks.ZPP_CbSet=function(){this.wrap_constraints=null,this.constraints=null,this.wrap_interactors=null,this.interactors=null,this.zip_conlisteners=!1,this.conlisteners=null,this.zip_bodylisteners=!1,
this.bodylisteners=null,this.zip_listeners=!1,this.listeners=null,this.cbpairs=null,this.manager=null,this.id=0,this.next=null,this.count=0,this.cbTypes=null,this.cbTypes=new o.util.ZNPList_ZPP_CbType,this.listeners=new o.util.ZNPList_ZPP_InteractionListener,this.zip_listeners=!0,this.bodylisteners=new o.util.ZNPList_ZPP_BodyListener,this.zip_bodylisteners=!0,this.conlisteners=new o.util.ZNPList_ZPP_ConstraintListener,this.zip_conlisteners=!0,this.constraints=new o.util.ZNPList_ZPP_Constraint,this.interactors=new o.util.ZNPList_ZPP_Interactor,this.id=o.ZPP_ID.CbSet(),this.cbpairs=new o.util.ZNPList_ZPP_CbSetPair},o.callbacks.ZPP_CbSet.__name__=!0,o.callbacks.ZPP_CbSet.setlt=function(t,n){for(var e=t.cbTypes.head,i=n.cbTypes.head;null!=e&&null!=i;){var r=e.elt,s=i.elt;if(r.id<s.id)return!0;if(s.id<r.id)return!1;e=e.next,i=i.next}return null!=i&&null==e},o.callbacks.ZPP_CbSet.get=function(t){var n;null==o.callbacks.ZPP_CbSet.zpp_pool?n=new o.callbacks.ZPP_CbSet:(n=o.callbacks.ZPP_CbSet.zpp_pool,o.callbacks.ZPP_CbSet.zpp_pool=n.next,n.next=null);for(var e=null,i=t.head;null!=i;){var r=i.elt;e=n.cbTypes.insert(e,r),r.cbsets.add(n),i=i.next}return n},o.callbacks.ZPP_CbSet.compatible=function(t,n,e){return t.options1.compatible(n.cbTypes)&&t.options2.compatible(e.cbTypes)||t.options2.compatible(n.cbTypes)&&t.options1.compatible(e.cbTypes)},o.callbacks.ZPP_CbSet.empty_intersection=function(t,n){return t.manager.pair(t,n).empty_intersection()},o.callbacks.ZPP_CbSet.single_intersection=function(t,n,e){return t.manager.pair(t,n).single_intersection(e)},o.callbacks.ZPP_CbSet.find_all=function(t,n,e,i){t.manager.pair(t,n).forall(e,i)},o.callbacks.ZPP_CbSet.prototype={increment:function(){this.count++},decrement:function(){return 0==--this.count},invalidate_pairs:function(){for(var t=this.cbpairs.head;null!=t;){t.elt.zip_listeners=!0,t=t.next}},invalidate_listeners:function(){this.zip_listeners=!0,this.invalidate_pairs()},validate_listeners:function(){this.zip_listeners&&(this.zip_listeners=!1,this.realvalidate_listeners())},realvalidate_listeners:function(){this.listeners.clear();for(var t=this.cbTypes.head;null!=t;){for(var n=t.elt,e=null,i=this.listeners.head,r=n.listeners.head;null!=r;){var s=r.elt;null!=i&&i.elt==s?(r=r.next,e=i,i=i.next):null==i||o.callbacks.ZPP_Listener.setlt(s,i.elt)?(s.space==this.manager.space&&(e=this.listeners.inlined_insert(e,s)),r=r.next):(e=i,i=i.next)}t=t.next}},invalidate_bodylisteners:function(){this.zip_bodylisteners=!0},validate_bodylisteners:function(){this.zip_bodylisteners&&(this.zip_bodylisteners=!1,this.realvalidate_bodylisteners())},realvalidate_bodylisteners:function(){this.bodylisteners.clear();for(var t=this.cbTypes.head;null!=t;){for(var n=t.elt,e=null,i=this.bodylisteners.head,r=n.bodylisteners.head;null!=r;){var s=r.elt;null!=i&&i.elt==s?(r=r.next,e=i,i=i.next):null==i||o.callbacks.ZPP_Listener.setlt(s,i.elt)?(s.options.excluded(this.cbTypes)||s.space!=this.manager.space||(e=this.bodylisteners.inlined_insert(e,s)),r=r.next):(e=i,i=i.next)}t=t.next}},invalidate_conlisteners:function(){this.zip_conlisteners=!0},validate_conlisteners:function(){this.zip_conlisteners&&(this.zip_conlisteners=!1,this.realvalidate_conlisteners())},realvalidate_conlisteners:function(){this.conlisteners.clear();for(var t=this.cbTypes.head;null!=t;){for(var n=t.elt,e=null,i=this.conlisteners.head,r=n.conlisteners.head;null!=r;){var s=r.elt;null!=i&&i.elt==s?(r=r.next,e=i,i=i.next):null==i||o.callbacks.ZPP_Listener.setlt(s,i.elt)?(s.options.excluded(this.cbTypes)||s.space!=this.manager.space||(e=this.conlisteners.inlined_insert(e,s)),r=r.next):(e=i,i=i.next)}t=t.next}},validate:function(){this.zip_listeners&&(this.zip_listeners=!1,this.realvalidate_listeners()),this.zip_bodylisteners&&(this.zip_bodylisteners=!1,this.realvalidate_bodylisteners()),this.zip_conlisteners&&(this.zip_conlisteners=!1,this.realvalidate_conlisteners())},addConstraint:function(t){this.constraints.add(t)},addInteractor:function(t){this.interactors.add(t)},remConstraint:function(t){this.constraints.remove(t)},remInteractor:function(t){this.interactors.remove(t)},free:function(){for(this.listeners.clear(),this.zip_listeners=!0,this.bodylisteners.clear(),this.zip_bodylisteners=!0,this.conlisteners.clear(),this.zip_conlisteners=!0;null!=this.cbTypes.head;){this.cbTypes.pop_unsafe().cbsets.remove(this)}},alloc:function(){},__class__:o.callbacks.ZPP_CbSet},o.callbacks.ZPP_CbSetPair=function(){this.listeners=null,this.zip_listeners=!1,this.next=null,this.b=null,this.a=null,this.listeners=new o.util.ZNPList_ZPP_InteractionListener},o.callbacks.ZPP_CbSetPair.__name__=!0,o.callbacks.ZPP_CbSetPair.get=function(t,n){var e;return null==o.callbacks.ZPP_CbSetPair.zpp_pool?e=new o.callbacks.ZPP_CbSetPair:(e=o.callbacks.ZPP_CbSetPair.zpp_pool,o.callbacks.ZPP_CbSetPair.zpp_pool=e.next,e.next=null),e.zip_listeners=!0,o.callbacks.ZPP_CbSet.setlt(t,n)?(e.a=t,e.b=n):(e.a=n,e.b=t),e},o.callbacks.ZPP_CbSetPair.setlt=function(t,n){return o.callbacks.ZPP_CbSet.setlt(t.a,n.a)||t.a==n.a&&o.callbacks.ZPP_CbSet.setlt(t.b,n.b)},o.callbacks.ZPP_CbSetPair.prototype={free:function(){this.a=this.b=null,this.listeners.clear()},alloc:function(){this.zip_listeners=!0},compatible:function(t){return t.options1.compatible(this.a.cbTypes)&&t.options2.compatible(this.b.cbTypes)||t.options2.compatible(this.a.cbTypes)&&t.options1.compatible(this.b.cbTypes)},invalidate:function(){this.zip_listeners=!0},validate:function(){this.zip_listeners&&(this.zip_listeners=!1,this.__validate())},__validate:function(){this.listeners.clear();for(var t=this.a.listeners.head,n=this.b.listeners.head;null!=t&&null!=n;){var e=t.elt,i=n.elt;e==i?((e.options1.compatible(this.a.cbTypes)&&e.options2.compatible(this.b.cbTypes)||e.options2.compatible(this.a.cbTypes)&&e.options1.compatible(this.b.cbTypes))&&this.listeners.add(e),t=t.next,n=n.next):e.precedence>i.precedence||e.precedence==i.precedence&&e.id>i.id?t=t.next:n=n.next}},empty_intersection:function(){return null==this.listeners.head},single_intersection:function(t){var n=this.listeners.head;return null!=n&&n.elt==t&&null==n.next},forall:function(t,n){for(var e=this.listeners.head;null!=e;){var i=e.elt;i.event==t&&n(i),e=e.next}},__class__:o.callbacks.ZPP_CbSetPair},o.util={},o.util.ZNPList_ZPP_InteractionListener=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_InteractionListener.__name__=!0,o.util.ZNPList_ZPP_InteractionListener.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_InteractionListener.zpp_pool?e=new o.util.ZNPNode_ZPP_InteractionListener:(e=o.util.ZNPNode_ZPP_InteractionListener.zpp_pool,o.util.ZNPNode_ZPP_InteractionListener.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_InteractionListener.zpp_pool?i=new o.util.ZNPNode_ZPP_InteractionListener:(i=o.util.ZNPNode_ZPP_InteractionListener.zpp_pool,o.util.ZNPNode_ZPP_InteractionListener.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_InteractionListener.zpp_pool,o.util.ZNPNode_ZPP_InteractionListener.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_InteractionListener.zpp_pool,o.util.ZNPNode_ZPP_InteractionListener.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_InteractionListener},o.util.ZNPList_ZPP_BodyListener=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_BodyListener.__name__=!0,o.util.ZNPList_ZPP_BodyListener.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_BodyListener.zpp_pool?e=new o.util.ZNPNode_ZPP_BodyListener:(e=o.util.ZNPNode_ZPP_BodyListener.zpp_pool,o.util.ZNPNode_ZPP_BodyListener.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_BodyListener.zpp_pool?i=new o.util.ZNPNode_ZPP_BodyListener:(i=o.util.ZNPNode_ZPP_BodyListener.zpp_pool,o.util.ZNPNode_ZPP_BodyListener.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_BodyListener.zpp_pool,o.util.ZNPNode_ZPP_BodyListener.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_BodyListener.zpp_pool,o.util.ZNPNode_ZPP_BodyListener.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_BodyListener},o.util.ZNPList_ZPP_ConstraintListener=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_ConstraintListener.__name__=!0,o.util.ZNPList_ZPP_ConstraintListener.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_ConstraintListener.zpp_pool?e=new o.util.ZNPNode_ZPP_ConstraintListener:(e=o.util.ZNPNode_ZPP_ConstraintListener.zpp_pool,o.util.ZNPNode_ZPP_ConstraintListener.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_ConstraintListener.zpp_pool?i=new o.util.ZNPNode_ZPP_ConstraintListener:(i=o.util.ZNPNode_ZPP_ConstraintListener.zpp_pool,o.util.ZNPNode_ZPP_ConstraintListener.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_ConstraintListener.zpp_pool,o.util.ZNPNode_ZPP_ConstraintListener.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_ConstraintListener.zpp_pool,o.util.ZNPNode_ZPP_ConstraintListener.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_ConstraintListener},o.util.ZNPList_ZPP_Constraint=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_Constraint.__name__=!0,o.util.ZNPList_ZPP_Constraint.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_Constraint.zpp_pool?e=new o.util.ZNPNode_ZPP_Constraint:(e=o.util.ZNPNode_ZPP_Constraint.zpp_pool,o.util.ZNPNode_ZPP_Constraint.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_Constraint.zpp_pool?i=new o.util.ZNPNode_ZPP_Constraint:(i=o.util.ZNPNode_ZPP_Constraint.zpp_pool,o.util.ZNPNode_ZPP_Constraint.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_Constraint.zpp_pool,o.util.ZNPNode_ZPP_Constraint.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_Constraint.zpp_pool,o.util.ZNPNode_ZPP_Constraint.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_Constraint},o.util.ZNPList_ZPP_Interactor=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_Interactor.__name__=!0,o.util.ZNPList_ZPP_Interactor.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_Interactor.zpp_pool?e=new o.util.ZNPNode_ZPP_Interactor:(e=o.util.ZNPNode_ZPP_Interactor.zpp_pool,o.util.ZNPNode_ZPP_Interactor.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_Interactor.zpp_pool?i=new o.util.ZNPNode_ZPP_Interactor:(i=o.util.ZNPNode_ZPP_Interactor.zpp_pool,o.util.ZNPNode_ZPP_Interactor.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_Interactor.zpp_pool,o.util.ZNPNode_ZPP_Interactor.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_Interactor.zpp_pool,o.util.ZNPNode_ZPP_Interactor.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_Interactor},o.util.ZNPList_ZPP_CbSet=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_CbSet.__name__=!0,o.util.ZNPList_ZPP_CbSet.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_CbSet.zpp_pool?e=new o.util.ZNPNode_ZPP_CbSet:(e=o.util.ZNPNode_ZPP_CbSet.zpp_pool,o.util.ZNPNode_ZPP_CbSet.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_CbSet.zpp_pool?i=new o.util.ZNPNode_ZPP_CbSet:(i=o.util.ZNPNode_ZPP_CbSet.zpp_pool,o.util.ZNPNode_ZPP_CbSet.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_CbSet.zpp_pool,o.util.ZNPNode_ZPP_CbSet.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_CbSet.zpp_pool,o.util.ZNPNode_ZPP_CbSet.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_CbSet},o.callbacks.ZPP_CbType=function(){this.conlisteners=null,this.bodylisteners=null,this.listeners=null,this.cbsets=null,this.id=0,this.userData=null,this.outer=null,this.id=o.ZPP_ID.CbType(),this.listeners=new o.util.ZNPList_ZPP_InteractionListener,this.bodylisteners=new o.util.ZNPList_ZPP_BodyListener,this.conlisteners=new o.util.ZNPList_ZPP_ConstraintListener,this.constraints=new o.util.ZNPList_ZPP_Constraint,this.interactors=new o.util.ZNPList_ZPP_Interactor,this.cbsets=new o.util.ZNPList_ZPP_CbSet},o.callbacks.ZPP_CbType.__name__=!0,o.callbacks.ZPP_CbType.setlt=function(t,n){return t.id<n.id},o.callbacks.ZPP_CbType.prototype={addConstraint:function(t){this.constraints.add(t)},addInteractor:function(t){this.interactors.add(t)},remConstraint:function(t){this.constraints.remove(t)},remInteractor:function(t){this.interactors.remove(t)},addint:function(t){for(var n=null,e=this.listeners.head;null!=e;){var i=e.elt;if(t.precedence>i.precedence||t.precedence==i.precedence&&t.id>i.id)break;n=e,e=e.next}this.listeners.inlined_insert(n,t),this.invalidateint()},removeint:function(t){this.listeners.remove(t),this.invalidateint()},invalidateint:function(){for(var t=this.cbsets.head;null!=t;){var n=t.elt;n.zip_listeners=!0,n.invalidate_pairs(),t=t.next}},addbody:function(t){for(var n=null,e=this.bodylisteners.head;null!=e;){var i=e.elt;if(t.precedence>i.precedence||t.precedence==i.precedence&&t.id>i.id)break;n=e,e=e.next}this.bodylisteners.inlined_insert(n,t),this.invalidatebody()},removebody:function(t){this.bodylisteners.remove(t),this.invalidatebody()},invalidatebody:function(){for(var t=this.cbsets.head;null!=t;){t.elt.zip_bodylisteners=!0,t=t.next}},addconstraint:function(t){for(var n=null,e=this.conlisteners.head;null!=e;){var i=e.elt;if(t.precedence>i.precedence||t.precedence==i.precedence&&t.id>i.id)break;n=e,e=e.next}this.conlisteners.inlined_insert(n,t),this.invalidateconstraint()},removeconstraint:function(t){this.conlisteners.remove(t),this.invalidateconstraint()},invalidateconstraint:function(){for(var t=this.cbsets.head;null!=t;){t.elt.zip_conlisteners=!0,t=t.next}},__class__:o.callbacks.ZPP_CbType},o.util.ZPP_Flags=function(){},o.util.ZPP_Flags.__name__=!0,o.callbacks.ZPP_Listener=function(){this.space=null,this.interaction=null,this.constraint=null,this.body=null,this.precedence=0,this.event=0,this.type=0,this.id=0,this.outer=null,this.id=o.ZPP_ID.Listener()},o.callbacks.ZPP_Listener.__name__=!0,o.callbacks.ZPP_Listener.setlt=function(t,n){return t.precedence>n.precedence||t.precedence==n.precedence&&t.id>n.id},o.callbacks.ZPP_Listener.prototype={swapEvent:function(t){},invalidate_precedence:function(){},addedToSpace:function(){},removedFromSpace:function(){},__class__:o.callbacks.ZPP_Listener},o.callbacks.ZPP_BodyListener=function(t,n,e){this.handler=null,this.options=null,this.outer_zn=null,o.callbacks.ZPP_Listener.call(this),this.event=n,this.handler=e,this.body=this,this.type=o.util.ZPP_Flags.id_ListenerType_BODY,this.options=t.zpp_inner},o.callbacks.ZPP_BodyListener.__name__=!0,o.callbacks.ZPP_BodyListener.__super__=o.callbacks.ZPP_Listener,o.callbacks.ZPP_BodyListener.prototype=t(o.callbacks.ZPP_Listener.prototype,{immutable_options:function(){if(null!=this.space&&this.space.midstep)throw"Error: Cannot change listener type options during space.step()"},addedToSpace:function(){this.options.handler=n(this,this.cbtype_change);for(var t=this.options.includes.head;null!=t;){t.elt.addbody(this),t=t.next}},removedFromSpace:function(){for(var t=this.options.includes.head;null!=t;){var n=t.elt;n.bodylisteners.remove(this),n.invalidatebody(),t=t.next}this.options.handler=null},cbtype_change:function(t,n,e){this.removedFromSpace(),this.options.effect_change(t,n,e),this.addedToSpace()},invalidate_precedence:function(){null!=this.space&&(this.removedFromSpace(),this.addedToSpace())},swapEvent:function(t){if(t!=o.util.ZPP_Flags.id_CbEvent_WAKE&&t!=o.util.ZPP_Flags.id_CbEvent_SLEEP)throw"Error: BodyListener event must be either WAKE or SLEEP only";this.removedFromSpace(),this.event=t,this.addedToSpace()},__class__:o.callbacks.ZPP_BodyListener}),o.callbacks.ZPP_ConstraintListener=function(t,n,e){this.handler=null,this.options=null,this.outer_zn=null,o.callbacks.ZPP_Listener.call(this),this.event=n,this.handler=e,this.constraint=this,this.type=o.util.ZPP_Flags.id_ListenerType_CONSTRAINT,this.options=t.zpp_inner},o.callbacks.ZPP_ConstraintListener.__name__=!0,o.callbacks.ZPP_ConstraintListener.__super__=o.callbacks.ZPP_Listener,o.callbacks.ZPP_ConstraintListener.prototype=t(o.callbacks.ZPP_Listener.prototype,{immutable_options:function(){if(null!=this.space&&this.space.midstep)throw"Error: Cannot change listener type options during space.step()"},addedToSpace:function(){this.options.handler=n(this,this.cbtype_change);for(var t=this.options.includes.head;null!=t;){t.elt.addconstraint(this),t=t.next}},removedFromSpace:function(){for(var t=this.options.includes.head;null!=t;){var n=t.elt;n.conlisteners.remove(this),n.invalidateconstraint(),t=t.next}this.options.handler=null},cbtype_change:function(t,n,e){this.removedFromSpace(),this.options.effect_change(t,n,e),this.addedToSpace()},invalidate_precedence:function(){null!=this.space&&(this.removedFromSpace(),this.addedToSpace())},swapEvent:function(t){if(t!=o.util.ZPP_Flags.id_CbEvent_WAKE&&t!=o.util.ZPP_Flags.id_CbEvent_SLEEP&&t!=o.util.ZPP_Flags.id_CbEvent_BREAK)throw"Error: ConstraintListener event must be either WAKE or SLEEP only";this.removedFromSpace(),this.event=t,this.addedToSpace()},__class__:o.callbacks.ZPP_ConstraintListener}),o.util.ZNPList_ZPP_CbType=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_CbType.__name__=!0,o.util.ZNPList_ZPP_CbType.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_CbType.zpp_pool?e=new o.util.ZNPNode_ZPP_CbType:(e=o.util.ZNPNode_ZPP_CbType.zpp_pool,o.util.ZNPNode_ZPP_CbType.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_CbType.zpp_pool?i=new o.util.ZNPNode_ZPP_CbType:(i=o.util.ZNPNode_ZPP_CbType.zpp_pool,o.util.ZNPNode_ZPP_CbType.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,
t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_CbType.zpp_pool,o.util.ZNPNode_ZPP_CbType.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_CbType.zpp_pool,o.util.ZNPNode_ZPP_CbType.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_CbType},o.callbacks.ZPP_InteractionListener=function(t,n,e,i){this.handlerp=null,this.pure=!1,this.allowSleepingCallbacks=!1,this.handleri=null,this.options2=null,this.options1=null,this.itype=0,this.outer_znp=null,this.outer_zni=null,o.callbacks.ZPP_Listener.call(this),this.type=i,this.interaction=this,this.event=e,this.options1=t.zpp_inner,this.options2=n.zpp_inner,this.allowSleepingCallbacks=!1},o.callbacks.ZPP_InteractionListener.__name__=!0,o.callbacks.ZPP_InteractionListener.__super__=o.callbacks.ZPP_Listener,o.callbacks.ZPP_InteractionListener.prototype=t(o.callbacks.ZPP_Listener.prototype,{setInteractionType:function(t){this.itype=t},wake:function(){this.with_union(function(t){for(var n=t.interactors.head;null!=n;){n.elt.wake(),n=n.next}})},CbSetset:function(t,n,e){for(var i=o.callbacks.ZPP_InteractionListener.UCbSet,r=o.callbacks.ZPP_InteractionListener.VCbSet,s=o.callbacks.ZPP_InteractionListener.WCbSet,l=t.head,a=n.head;null!=l&&null!=a;){var p=l.elt,_=a.elt;p==_?(s.inlined_add(p),l=l.next,a=a.next):o.callbacks.ZPP_CbSet.setlt(p,_)?(i.inlined_add(p),l=l.next):(r.inlined_add(_),a=a.next)}for(;null!=l;)i.inlined_add(l.elt),l=l.next;for(;null!=a;)r.inlined_add(a.elt),a=a.next;for(;null!=i.head;)for(var h=i.pop_unsafe(),u=n.head;null!=u;){var d=u.elt;e(h,d),u=u.next}for(;null!=r.head;)for(var c=r.pop_unsafe(),P=s.head;null!=P;){var f=P.elt;e(c,f),P=P.next}for(;null!=s.head;){var z=s.pop_unsafe();e(z,z);for(var v=s.head;null!=v;){e(z,v.elt),v=v.next}}},CbTypeset:function(t,n,e){for(var i=o.callbacks.ZPP_InteractionListener.UCbType,r=o.callbacks.ZPP_InteractionListener.VCbType,s=o.callbacks.ZPP_InteractionListener.WCbType,l=t.head,a=n.head;null!=l&&null!=a;){var p=l.elt,_=a.elt;p==_?(s.inlined_add(p),l=l.next,a=a.next):p.id<_.id?(i.inlined_add(p),l=l.next):(r.inlined_add(_),a=a.next)}for(;null!=l;)i.inlined_add(l.elt),l=l.next;for(;null!=a;)r.inlined_add(a.elt),a=a.next;for(;null!=i.head;)for(var h=i.pop_unsafe(),u=n.head;null!=u;){var d=u.elt;e(h,d),u=u.next}for(;null!=r.head;)for(var c=r.pop_unsafe(),P=s.head;null!=P;){var f=P.elt;e(c,f),P=P.next}for(;null!=s.head;){var z=s.pop_unsafe();e(z,z);for(var v=s.head;null!=v;){e(z,v.elt),v=v.next}}},with_uniquesets:function(t){var n,e=this;null==o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool?n=new o.util.ZPP_Set_ZPP_CbSetPair:(n=o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool,o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool=n.next,n.next=null),n.lt=o.callbacks.ZPP_CbSetPair.setlt,this.CbTypeset(this.options1.includes,this.options2.includes,function(t,i){e.CbSetset(t.cbsets,i.cbsets,function(t,i){t.validate(),i.validate(),o.callbacks.ZPP_CbSet.single_intersection(t,i,e)&&n.try_insert(o.callbacks.ZPP_CbSetPair.get(t,i))})}),n.clear_with(function(n){t?e.space.freshListenerType(n.a,n.b):e.space.nullListenerType(n.a,n.b);var i=n;i.a=i.b=null,i.listeners.clear(),i.next=o.callbacks.ZPP_CbSetPair.zpp_pool,o.callbacks.ZPP_CbSetPair.zpp_pool=i});var i=n;i.data=null,i.lt=null,i.swapped=null,i.next=o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool,o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool=i},with_union:function(t){for(var n=this.options1.includes.head,e=this.options2.includes.head;null!=n&&null!=e;){var i=n.elt,r=e.elt;i==r?(t(i),n=n.next,e=e.next):i.id<r.id?(t(i),n=n.next):(t(r),e=e.next)}for(;null!=n;)t(n.elt),n=n.next;for(;null!=e;)t(e.elt),e=e.next},addedToSpace:function(){var t=this,e=this.type==o.util.ZPP_Flags.id_ListenerType_PRE;this.with_union(function(n){if(n.addint(t),e)for(var i=n.interactors.head;null!=i;){var r=i.elt;r.wake(),i=i.next}}),this.options1.handler=n(this,this.cbtype_change1),this.options2.handler=n(this,this.cbtype_change2),this.with_uniquesets(!0)},removedFromSpace:function(){var t=this;this.with_uniquesets(!1);var n=this.type==o.util.ZPP_Flags.id_ListenerType_PRE;this.with_union(function(e){if(e.listeners.remove(t),e.invalidateint(),n)for(var i=e.interactors.head;null!=i;){var r=i.elt;r.wake(),i=i.next}}),this.options1.handler=null,this.options2.handler=null},invalidate_precedence:function(){var t=this;if(null!=this.space){var n=this.type==o.util.ZPP_Flags.id_ListenerType_PRE;this.with_union(function(e){if(e.listeners.remove(t),e.invalidateint(),e.addint(t),n)for(var i=e.interactors.head;null!=i;){var r=i.elt;r.wake(),i=i.next}})}},cbtype_change1:function(t,n,e){this.cbtype_change(this.options1,t,n,e)},cbtype_change2:function(t,n,e){this.cbtype_change(this.options2,t,n,e)},cbtype_change:function(t,n,e,i){this.removedFromSpace(),t.effect_change(n,e,i),this.addedToSpace()},swapEvent:function(t){if(this.type==o.util.ZPP_Flags.id_ListenerType_PRE)throw"Error: PreListener event can only be PRE";if(t!=o.util.ZPP_Flags.id_CbEvent_BEGIN&&t!=o.util.ZPP_Flags.id_CbEvent_END&&t!=o.util.ZPP_Flags.id_CbEvent_ONGOING)throw"Error: InteractionListener event must be either BEGIN, END, ONGOING";this.removedFromSpace(),this.event=t,this.addedToSpace()},__class__:o.callbacks.ZPP_InteractionListener}),o.callbacks.ZPP_OptionType=function(){this.wrap_excludes=null,this.wrap_includes=null,this.excludes=null,this.includes=null,this.handler=null,this.outer=null,this.includes=new o.util.ZNPList_ZPP_CbType,this.excludes=new o.util.ZNPList_ZPP_CbType},o.callbacks.ZPP_OptionType.__name__=!0,o.callbacks.ZPP_OptionType.argument=function(t){return null==t?new p.callbacks.OptionType:a.Boot.__instanceof(t,p.callbacks.OptionType)?t:(new p.callbacks.OptionType).including(t)},o.callbacks.ZPP_OptionType.prototype={setup_includes:function(){this.wrap_includes=o.util.ZPP_CbTypeList.get(this.includes,!0)},setup_excludes:function(){this.wrap_excludes=o.util.ZPP_CbTypeList.get(this.excludes,!0)},excluded:function(t){return this.nonemptyintersection(t,this.excludes)},included:function(t){return this.nonemptyintersection(t,this.includes)},compatible:function(t){return this.nonemptyintersection(t,this.includes)&&!this.nonemptyintersection(t,this.excludes)},nonemptyintersection:function(t,n){for(var e=!1,i=t.head,r=n.head;null!=r&&null!=i;){var s=r.elt,l=i.elt;if(s==l){e=!0;break}s.id<l.id?r=r.next:i=i.next}return e},effect_change:function(t,n,e){if(n)if(e){for(var i=null,r=this.includes.head;null!=r;){var s=r.elt;if(t.id<s.id)break;i=r,r=r.next}this.includes.inlined_insert(i,t)}else this.includes.remove(t);else if(e){for(var l=null,a=this.excludes.head;null!=a;){var p=a.elt;if(t.id<p.id)break;l=a,a=a.next}this.excludes.inlined_insert(l,t)}else this.excludes.remove(t)},append_type:function(t,n){t==this.includes?this.includes.has(n)||(this.excludes.has(n)?null!=this.handler?this.handler(n,!1,!1):this.effect_change(n,!1,!1):null!=this.handler?this.handler(n,!0,!0):this.effect_change(n,!0,!0)):this.excludes.has(n)||(this.includes.has(n)?null!=this.handler?this.handler(n,!0,!1):this.effect_change(n,!0,!1):null!=this.handler?this.handler(n,!1,!0):this.effect_change(n,!1,!0))},set:function(t){if(t!=this){for(;null!=this.includes.head;)this.append_type(this.excludes,this.includes.head.elt);for(;null!=this.excludes.head;)this.append_type(this.includes,this.excludes.head.elt);for(var n=t.excludes.head;null!=n;){var e=n.elt;this.append_type(this.excludes,e),n=n.next}for(var i=t.includes.head;null!=i;){var r=i.elt;this.append_type(this.includes,r),i=i.next}}return this},append:function(t,n){if(null==n)throw"Error: Cannot append null, only CbType and CbType list values";if(a.Boot.__instanceof(n,p.callbacks.CbType)){var e=n;this.append_type(t,e.zpp_inner)}else if(a.Boot.__instanceof(n,p.callbacks.CbTypeList)){var i,r=n;for(r.zpp_inner.valmod(),i=p.callbacks.CbTypeIterator.get(r);i.hasNext();){var s;i.zpp_critical=!1,s=i.zpp_inner.at(i.zpp_i++),this.append_type(t,s.zpp_inner)}}else{if(!(n instanceof Array&&null==n.__enum__))throw"Error: Cannot append non-CbType or CbType list value";for(var l=n,o=0;o<l.length;){var _=l[o];if(++o,!a.Boot.__instanceof(_,p.callbacks.CbType))throw"Error: Cannot append non-CbType or CbType list value";var h=_;this.append_type(t,h.zpp_inner)}}},__class__:o.callbacks.ZPP_OptionType},o.constraint={},o.constraint.ZPP_Constraint=function(){this.pre_dt=0,this.wrap_cbTypes=null,this.cbSet=null,this.cbTypes=null,this.__velocity=!1,this.ignore=!1,this.component=null,this.removeOnBreak=!1,this.breakUnderError=!1,this.breakUnderForce=!1,this.maxError=0,this.maxForce=0,this.damping=0,this.frequency=0,this.stiff=!1,this.active=!1,this.space=null,this.compound=null,this.userData=null,this.id=0,this.outer=null,this.__velocity=!1,this.id=o.ZPP_ID.Constraint(),this.stiff=!0,this.active=!0,this.ignore=!1,this.frequency=10,this.damping=1,this.maxForce=Math.POSITIVE_INFINITY,this.maxError=Math.POSITIVE_INFINITY,this.breakUnderForce=!1,this.removeOnBreak=!0,this.pre_dt=-1,this.cbTypes=new o.util.ZNPList_ZPP_CbType},o.constraint.ZPP_Constraint.__name__=!0,o.constraint.ZPP_Constraint.prototype={clear:function(){},immutable_midstep:function(t){if(null!=this.space&&this.space.midstep)throw"Error: Constraint::"+t+" cannot be set during space step()"},setupcbTypes:function(){this.wrap_cbTypes=o.util.ZPP_CbTypeList.get(this.cbTypes),this.wrap_cbTypes.zpp_inner.adder=n(this,this.wrap_cbTypes_adder),this.wrap_cbTypes.zpp_inner.subber=n(this,this.wrap_cbTypes_subber),this.wrap_cbTypes.zpp_inner.dontremove=!0,this.wrap_cbTypes.zpp_inner._modifiable=n(this,this.immutable_cbTypes)},immutable_cbTypes:function(){this.immutable_midstep("Constraint::cbTypes")},wrap_cbTypes_subber:function(t){var n=t.zpp_inner;this.cbTypes.has(n)&&(null!=this.space&&(this.dealloc_cbSet(),n.constraints.remove(this)),this.cbTypes.remove(n),null!=this.space&&(this.alloc_cbSet(),this.wake()))},wrap_cbTypes_adder:function(t){return this.insert_cbtype(t.zpp_inner),!1},insert_cbtype:function(t){if(!this.cbTypes.has(t)){null!=this.space&&(this.dealloc_cbSet(),t.constraints.add(this));for(var n=null,e=this.cbTypes.head;null!=e;){var i=e.elt;if(t.id<i.id)break;n=e,e=e.next}this.cbTypes.inlined_insert(n,t),null!=this.space&&(this.alloc_cbSet(),this.wake())}},alloc_cbSet:function(){null!=(this.cbSet=this.space.cbsets.get(this.cbTypes))&&(this.cbSet.count++,this.cbSet.constraints.add(this))},dealloc_cbSet:function(){if(null!=this.cbSet){if(this.cbSet.constraints.remove(this),0==--this.cbSet.count){this.space.cbsets.remove(this.cbSet);var t=this.cbSet;t.free(),t.next=o.callbacks.ZPP_CbSet.zpp_pool,o.callbacks.ZPP_CbSet.zpp_pool=t}this.cbSet=null}},activate:function(){null!=this.space&&this.activeInSpace()},deactivate:function(){null!=this.space&&this.inactiveOrOutSpace()},addedToSpace:function(){this.active&&this.activeInSpace(),this.activeBodies();for(var t=this.cbTypes.head;null!=t;){t.elt.constraints.add(this),t=t.next}},removedFromSpace:function(){this.active&&this.inactiveOrOutSpace(),this.inactiveBodies();for(var t=this.cbTypes.head;null!=t;){t.elt.constraints.remove(this),t=t.next}},activeInSpace:function(){this.alloc_cbSet(),null==o.space.ZPP_Component.zpp_pool?this.component=new o.space.ZPP_Component:(this.component=o.space.ZPP_Component.zpp_pool,o.space.ZPP_Component.zpp_pool=this.component.next,this.component.next=null),this.component.isBody=!1,this.component.constraint=this},inactiveOrOutSpace:function(){this.dealloc_cbSet();var t=this.component;t.body=null,t.constraint=null,t.next=o.space.ZPP_Component.zpp_pool,o.space.ZPP_Component.zpp_pool=t,this.component=null},activeBodies:function(){},inactiveBodies:function(){},clearcache:function(){},validate:function(){},wake_connected:function(){},forest:function(){},pair_exists:function(t,n){return!1},broken:function(){},warmStart:function(){},preStep:function(t){return!1},applyImpulseVel:function(){return!1},applyImpulsePos:function(){return!1},wake:function(){null!=this.space&&this.space.wake_constraint(this)},draw:function(t){},copy:function(t,n){return null},copyto:function(t){for(var n=this.outer,e=function(t){return null==n.zpp_inner.wrap_cbTypes&&n.zpp_inner.setupcbTypes(),n.zpp_inner.wrap_cbTypes}().iterator();e.hasNext();){var i;e.zpp_critical=!1,i=e.zpp_inner.at(e.zpp_i++),function(n){return null==t.zpp_inner.wrap_cbTypes&&t.zpp_inner.setupcbTypes(),t.zpp_inner.wrap_cbTypes}().add(i)}t.zpp_inner.removeOnBreak=n.zpp_inner.removeOnBreak,t.zpp_inner.removeOnBreak,t.set_breakUnderError(n.zpp_inner.breakUnderError),t.set_breakUnderForce(n.zpp_inner.breakUnderForce),t.set_maxError(n.zpp_inner.maxError),t.set_maxForce(n.zpp_inner.maxForce),t.set_damping(n.zpp_inner.damping),t.set_frequency(n.zpp_inner.frequency),t.set_stiff(n.zpp_inner.stiff),t.set_ignore(n.zpp_inner.ignore),t.set_active(n.zpp_inner.active)},__class__:o.constraint.ZPP_Constraint},o.constraint.ZPP_AngleJoint=function(){this.stepped=!1,this.bias=0,this.gamma=0,this.jMax=0,this.jAcc=0,this.kMass=0,this.b2=null,this.b1=null,this.scale=0,this.equal=!1,this.slack=!1,this.jointMax=0,this.jointMin=0,this.ratio=0,this.outer_zn=null,o.constraint.ZPP_Constraint.call(this),this.ratio=1,this.jAcc=0,this.slack=!1,this.jMax=Math.POSITIVE_INFINITY,this.stepped=!1},o.constraint.ZPP_AngleJoint.__name__=!0,o.constraint.ZPP_AngleJoint.__super__=o.constraint.ZPP_Constraint,o.constraint.ZPP_AngleJoint.prototype=t(o.constraint.ZPP_Constraint.prototype,{is_slack:function(){var t,n=this.ratio*this.b2.rot-this.b1.rot;return this.equal?(n-=this.jointMax,t=!1,this.scale=1):n<this.jointMin?(n=this.jointMin-n,this.scale=-1,t=!1):n>this.jointMax?(n-=this.jointMax,this.scale=1,t=!1):(this.scale=0,n=0,t=!0),t},bodyImpulse:function(t){return this.stepped?t==this.b1?p.geom.Vec3.get(0,0,-this.scale*this.jAcc):p.geom.Vec3.get(0,0,this.ratio*this.scale*this.jAcc):p.geom.Vec3.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},copy:function(t,n){var e=new p.constraint.AngleJoint(null,null,this.jointMin,this.jointMax,this.ratio);if(this.copyto(e),null!=t&&null!=this.b1){for(var i=null,r=0;r<t.length;){var s=t[r];if(++r,s.id==this.b1.id){i=s.bc;break}}null!=i?e.zpp_inner_zn.b1=i.zpp_inner:n.push(o.constraint.ZPP_CopyHelper.todo(this.b1.id,function(t){e.zpp_inner_zn.b1=t.zpp_inner}))}if(null!=t&&null!=this.b2){for(var l=null,a=0;a<t.length;){var _=t[a];if(++a,_.id==this.b2.id){l=_.bc;break}}null!=l?e.zpp_inner_zn.b2=l.zpp_inner:n.push(o.constraint.ZPP_CopyHelper.todo(this.b2.id,function(t){e.zpp_inner_zn.b2=t.zpp_inner}))}return e},validate:function(){if(null==this.b1||null==this.b2)throw"Error: AngleJoint cannot be simulated null bodies";if(this.b1==this.b2)throw"Error: AngleJoint cannot be simulated with body1 == body2";if(this.b1.space!=this.space||this.b2.space!=this.space)throw"Error: Constraints must have each body within the same space to which the constraint has been assigned";if(this.jointMin>this.jointMax)throw"Error: AngleJoint must have jointMin <= jointMax";if(this.b1.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b2.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC)throw"Error: Constraints cannot have both bodies non-dynamic"},wake_connected:function(){null!=this.b1&&this.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b1.wake(),null!=this.b2&&this.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b2.wake()},forest:function(){if(this.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var t;if(this.b1.component==this.b1.component.parent)t=this.b1.component;else{for(var n=this.b1.component,e=null;n!=n.parent;){var i=n.parent;n.parent=e,e=n,n=i}for(;null!=e;){var r=e.parent;e.parent=n,e=r}t=n}var s;if(this.component==this.component.parent)s=this.component;else{for(var l=this.component,a=null;l!=l.parent;){var p=l.parent;l.parent=a,a=l,l=p}for(;null!=a;){var _=a.parent;a.parent=l,a=_}s=l}t!=s&&(t.rank<s.rank?t.parent=s:t.rank>s.rank?s.parent=t:(s.parent=t,t.rank++))}if(this.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var h;if(this.b2.component==this.b2.component.parent)h=this.b2.component;else{for(var u=this.b2.component,d=null;u!=u.parent;){var c=u.parent;u.parent=d,d=u,u=c}for(;null!=d;){var P=d.parent;d.parent=u,d=P}h=u}var f;if(this.component==this.component.parent)f=this.component;else{for(var z=this.component,v=null;z!=z.parent;){var m=z.parent;z.parent=v,v=z,z=m}for(;null!=v;){var b=v.parent;v.parent=z,v=b}f=z}h!=f&&(h.rank<f.rank?h.parent=f:h.rank>f.rank?f.parent=h:(f.parent=h,h.rank++))}},pair_exists:function(t,n){return this.b1.id==t&&this.b2.id==n||this.b1.id==n&&this.b2.id==t},clearcache:function(){this.jAcc=0,this.pre_dt=-1,this.slack=!1},preStep:function(t){-1==this.pre_dt&&(this.pre_dt=t);var n=t/this.pre_dt;this.pre_dt=t,this.stepped=!0,this.equal=this.jointMin==this.jointMax;var e,i=this.ratio*this.b2.rot-this.b1.rot;if(this.equal?(i-=this.jointMax,this.slack=!1,this.scale=1):i<this.jointMin?(i=this.jointMin-i,this.scale=-1,this.slack=!1):i>this.jointMax?(i-=this.jointMax,this.scale=1,this.slack=!1):(this.scale=0,i=0,this.slack=!0),e=i,!this.slack){if(this.kMass=this.b1.sinertia+this.ratio*this.ratio*this.b2.sinertia,0!=this.kMass?this.kMass=1/this.kMass:this.jAcc=0,this.stiff)this.bias=0,this.gamma=0;else{if(this.breakUnderError&&e*e>this.maxError*this.maxError)return!0;var r,s=2*Math.PI*this.frequency;this.gamma=1/(t*s*(2*this.damping+s*t));var l=1/(1+this.gamma);r=t*s*s*this.gamma,this.gamma*=l,this.kMass*=l,this.bias=-e*r,this.bias<-this.maxError?this.bias=-this.maxError:this.bias>this.maxError&&(this.bias=this.maxError)}this.jAcc*=n,this.jMax=this.maxForce*t}return!1},warmStart:function(){this.slack||(this.b1.angvel-=this.scale*this.b1.iinertia*this.jAcc,this.b2.angvel+=this.ratio*this.scale*this.b2.iinertia*this.jAcc)},applyImpulseVel:function(){if(this.slack)return!1;var t=this.scale*(this.ratio*(this.b2.angvel+this.b2.kinangvel)-this.b1.angvel-this.b1.kinangvel),n=this.kMass*(this.bias-t)-this.jAcc*this.gamma,e=this.jAcc;return this.jAcc+=n,!this.equal&&this.jAcc>0&&(this.jAcc=0),!(!this.breakUnderForce||!(this.jAcc>this.jMax||this.jAcc<-this.jMax))||(this.stiff||(this.jAcc>this.jMax?this.jAcc=this.jMax:this.jAcc<-this.jMax&&(this.jAcc=-this.jMax)),n=this.jAcc-e,this.b1.angvel-=this.scale*this.b1.iinertia*n,this.b2.angvel+=this.ratio*this.scale*this.b2.iinertia*n,!1)},applyImpulsePos:function(){var t,n,e,i=this.ratio*this.b2.rot-this.b1.rot;if(this.equal?(i-=this.jointMax,e=!1,this.scale=1):i<this.jointMin?(i=this.jointMin-i,this.scale=-1,e=!1):i>this.jointMax?(i-=this.jointMax,this.scale=1,e=!1):(this.scale=0,i=0,e=!0),t=i,!e){if(this.breakUnderError&&t*t>this.maxError*this.maxError)return!0;t*=.5,n=-t*this.kMass,(this.equal||n<0)&&(this.b1.delta_rot(-this.scale*n*this.b1.iinertia),this.b2.delta_rot(this.ratio*this.scale*n*this.b2.iinertia))}return!1},draw:function(t){},__class__:o.constraint.ZPP_AngleJoint}),o.constraint.ZPP_CopyHelper=function(){this.cb=null,this.bc=null,this.id=0},o.constraint.ZPP_CopyHelper.__name__=!0,o.constraint.ZPP_CopyHelper.dict=function(t,n){var e=new o.constraint.ZPP_CopyHelper;return e.id=t,e.bc=n,e},o.constraint.ZPP_CopyHelper.todo=function(t,n){var e=new o.constraint.ZPP_CopyHelper;return e.id=t,e.cb=n,e},o.constraint.ZPP_CopyHelper.prototype={__class__:o.constraint.ZPP_CopyHelper},o.constraint.ZPP_DistanceJoint=function(){this.stepped=!1,this.bias=0,this.gamma=0,this.jMax=0,this.jAcc=0,this.kMass=0,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.b2=null,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.b1=null,this.cx2=0,this.cx1=0,this.ny=0,this.nx=0,this.equal=!1,this.slack=!1,this.jointMax=0,this.jointMin=0,this.outer_zn=null,o.constraint.ZPP_Constraint.call(this),this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0,this.jAcc=0,this.jMax=Math.POSITIVE_INFINITY,this.stepped=!1,this.cx1=this.cx2=0},o.constraint.ZPP_DistanceJoint.__name__=!0,o.constraint.ZPP_DistanceJoint.__super__=o.constraint.ZPP_Constraint,o.constraint.ZPP_DistanceJoint.prototype=t(o.constraint.ZPP_Constraint.prototype,{is_slack:function(){var t;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var n=0,e=0;n=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),e=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);var i=n*n+e*e;if(i<p.Config.epsilon)n=0,e=0,i=0,t=!0;else{i=Math.sqrt(i);var r=1/i;n*=r,e*=r,this.equal?(i-=this.jointMax,t=!1):i<this.jointMin?(i=this.jointMin-i,n=-n,e=-e,t=!1):i>this.jointMax?(i-=this.jointMax,t=!1):(n=0,e=0,i=0,t=!0)}return t},bodyImpulse:function(t){return this.stepped?t==this.b1?p.geom.Vec3.get(-this.jAcc*this.nx,-this.jAcc*this.ny,-this.cx1*this.jAcc):p.geom.Vec3.get(this.jAcc*this.nx,this.jAcc*this.ny,this.cx2*this.jAcc):p.geom.Vec3.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(t){this.immutable_midstep("Constraint::a1"),this.a1localx=t.x,this.a1localy=t.y,this.wake()},setup_a1:function(){this.wrap_a1=p.geom.Vec2.get(this.a1localx,this.a1localy,null),this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=n(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=n(this,this.invalidate_a1)},validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(t){this.immutable_midstep("Constraint::a2"),this.a2localx=t.x,this.a2localy=t.y,this.wake()},setup_a2:function(){this.wrap_a2=p.geom.Vec2.get(this.a2localx,this.a2localy,null),this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=n(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=n(this,this.invalidate_a2)},copy:function(t,n){var e=new p.constraint.DistanceJoint(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2(),this.jointMin,this.jointMax);if(this.copyto(e),null!=t&&null!=this.b1){for(var i=null,r=0;r<t.length;){var s=t[r];if(++r,s.id==this.b1.id){i=s.bc;break}}null!=i?e.zpp_inner_zn.b1=i.zpp_inner:n.push(o.constraint.ZPP_CopyHelper.todo(this.b1.id,function(t){e.zpp_inner_zn.b1=t.zpp_inner}))}if(null!=t&&null!=this.b2){for(var l=null,a=0;a<t.length;){var _=t[a];if(++a,_.id==this.b2.id){l=_.bc;break}}null!=l?e.zpp_inner_zn.b2=l.zpp_inner:n.push(o.constraint.ZPP_CopyHelper.todo(this.b2.id,function(t){e.zpp_inner_zn.b2=t.zpp_inner}))}return e},validate:function(){if(null==this.b1||null==this.b2)throw"Error: DistanceJoint cannot be simulated null bodies";if(this.b1==this.b2)throw"Error: DistanceJoint cannot be simulated with body1 == body2";if(this.b1.space!=this.space||this.b2.space!=this.space)throw"Error: Constraints must have each body within the same space to which the constraint has been assigned";if(this.jointMin>this.jointMax)throw"Error: DistanceJoint must have jointMin <= jointMax";if(this.b1.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b2.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC)throw"Error: Constraints cannot have both bodies non-dynamic"},wake_connected:function(){null!=this.b1&&this.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b1.wake(),null!=this.b2&&this.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b2.wake()},forest:function(){if(this.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var t;if(this.b1.component==this.b1.component.parent)t=this.b1.component;else{for(var n=this.b1.component,e=null;n!=n.parent;){var i=n.parent;n.parent=e,e=n,n=i}for(;null!=e;){var r=e.parent;e.parent=n,e=r}t=n}var s;if(this.component==this.component.parent)s=this.component;else{for(var l=this.component,a=null;l!=l.parent;){var p=l.parent;l.parent=a,a=l,l=p}for(;null!=a;){var _=a.parent;a.parent=l,a=_}s=l}t!=s&&(t.rank<s.rank?t.parent=s:t.rank>s.rank?s.parent=t:(s.parent=t,t.rank++))}if(this.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var h;if(this.b2.component==this.b2.component.parent)h=this.b2.component;else{for(var u=this.b2.component,d=null;u!=u.parent;){var c=u.parent;u.parent=d,d=u,u=c}for(;null!=d;){var P=d.parent;d.parent=u,d=P}h=u}var f;if(this.component==this.component.parent)f=this.component;else{for(var z=this.component,v=null;z!=z.parent;){var m=z.parent;z.parent=v,v=z,z=m}for(;null!=v;){var b=v.parent;v.parent=z,v=b}f=z}h!=f&&(h.rank<f.rank?h.parent=f:h.rank>f.rank?f.parent=h:(f.parent=h,h.rank++))}},pair_exists:function(t,n){return this.b1.id==t&&this.b2.id==n||this.b1.id==n&&this.b2.id==t},clearcache:function(){this.jAcc=0,this.pre_dt=-1},preStep:function(t){-1==this.pre_dt&&(this.pre_dt=t);var n=t/this.pre_dt;this.pre_dt=t,this.stepped=!0,this.equal=this.jointMin==this.jointMax,this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var e;this.nx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),this.ny=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);var i=this.nx*this.nx+this.ny*this.ny;if(i<p.Config.epsilon)this.nx=0,this.ny=0,i=0,this.slack=!0;else{i=Math.sqrt(i);var r=1/i;this.nx*=r,this.ny*=r,this.equal?(i-=this.jointMax,this.slack=!1):i<this.jointMin?(i=this.jointMin-i,this.nx=-this.nx,this.ny=-this.ny,this.slack=!1):i>this.jointMax?(i-=this.jointMax,this.slack=!1):(this.nx=0,this.ny=0,i=0,this.slack=!0)}if(e=i,!this.slack){if(this.cx1=this.ny*this.a1relx-this.nx*this.a1rely,this.cx2=this.ny*this.a2relx-this.nx*this.a2rely,this.kMass=this.b1.smass+this.b2.smass+this.cx1*this.cx1*this.b1.sinertia+this.cx2*this.cx2*this.b2.sinertia,0!=this.kMass?this.kMass=1/this.kMass:this.jAcc=0,this.stiff)this.bias=0,this.gamma=0;else{if(this.breakUnderError&&e*e>this.maxError*this.maxError)return!0;var s,l=2*Math.PI*this.frequency;this.gamma=1/(t*l*(2*this.damping+l*t));var a=1/(1+this.gamma);s=t*l*l*this.gamma,this.gamma*=a,this.kMass*=a,this.bias=-e*s,this.bias<-this.maxError?this.bias=-this.maxError:this.bias>this.maxError&&(this.bias=this.maxError)}this.jAcc*=n,this.jMax=this.maxForce*t}return!1},warmStart:function(){if(!this.slack){var t=this.b1.imass*this.jAcc;this.b1.velx-=this.nx*t,this.b1.vely-=this.ny*t;var n=this.b2.imass*this.jAcc;this.b2.velx+=this.nx*n,this.b2.vely+=this.ny*n,this.b1.angvel-=this.cx1*this.b1.iinertia*this.jAcc,this.b2.angvel+=this.cx2*this.b2.iinertia*this.jAcc}},applyImpulseVel:function(){if(this.slack)return!1;var t=this.nx*(this.b2.velx+this.b2.kinvelx-this.b1.velx-this.b1.kinvelx)+this.ny*(this.b2.vely+this.b2.kinvely-this.b1.vely-this.b1.kinvely)+(this.b2.angvel+this.b2.kinangvel)*this.cx2-(this.b1.angvel+this.b1.kinangvel)*this.cx1,n=this.kMass*(this.bias-t)-this.jAcc*this.gamma,e=this.jAcc;if(this.jAcc+=n,!this.equal&&this.jAcc>0&&(this.jAcc=0),this.breakUnderForce&&this.jAcc<-this.jMax)return!0;this.stiff||this.jAcc<-this.jMax&&(this.jAcc=-this.jMax),n=this.jAcc-e;var i=this.b1.imass*n;this.b1.velx-=this.nx*i,this.b1.vely-=this.ny*i;var r=this.b2.imass*n;return this.b2.velx+=this.nx*r,this.b2.vely+=this.ny*r,this.b1.angvel-=this.cx1*this.b1.iinertia*n,this.b2.angvel+=this.cx2*this.b2.iinertia*n,!1},applyImpulsePos:function(){var t,n,e=0,i=0;e=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,i=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;var r=0,s=0;r=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,s=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var l,a=0,o=0;a=this.b2.posx+r-(this.b1.posx+e),o=this.b2.posy+s-(this.b1.posy+i);var _=a*a+o*o;if(_<p.Config.epsilon)a=0,o=0,_=0,l=!0;else{_=Math.sqrt(_);var h=1/_;a*=h,o*=h,this.equal?(_-=this.jointMax,l=!1):_<this.jointMin?(_=this.jointMin-_,a=-a,o=-o,l=!1):_>this.jointMax?(_-=this.jointMax,l=!1):(a=0,o=0,_=0,l=!0)}if(t=_,!l){if(this.breakUnderError&&t*t>this.maxError*this.maxError)return!0;if(t*t<p.Config.constraintLinearSlop*p.Config.constraintLinearSlop)return!1;if((t*=.5)*t>6){var u=this.b1.smass+this.b2.smass;if(u>p.Config.epsilon&&(u=.75/u,n=-t*u,this.equal||n<0)){var d=n*this.b1.imass;this.b1.posx-=a*d,this.b1.posy-=o*d;var c=n*this.b2.imass;this.b2.posx+=a*c,this.b2.posy+=o*c,a=this.b2.posx+r-(this.b1.posx+e),o=this.b2.posy+s-(this.b1.posy+i);var P=a*a+o*o;if(P<p.Config.epsilon)a=0,o=0,P=0,l=!0;else{P=Math.sqrt(P);var f=1/P;a*=f,o*=f,this.equal?(P-=this.jointMax,l=!1):P<this.jointMin?(P=this.jointMin-P,a=-a,o=-o,l=!1):P>this.jointMax?(P-=this.jointMax,l=!1):(a=0,o=0,P=0,l=!0)}t=P,t*=.5}}var z,v,m;if(z=o*e-a*i,v=o*r-a*s,m=this.b1.smass+this.b2.smass+z*z*this.b1.sinertia+v*v*this.b2.sinertia,0!=m&&(m=1/m),n=-t*m,this.equal||n<0){var b=this.b1.imass*n;this.b1.posx-=a*b,this.b1.posy-=o*b;var y=this.b2.imass*n;this.b2.posx+=a*y,this.b2.posy+=o*y,this.b1.delta_rot(-z*this.b1.iinertia*n),this.b2.delta_rot(v*this.b2.iinertia*n)}}return!1},draw:function(t){},__class__:o.constraint.ZPP_DistanceJoint}),o.constraint.ZPP_LineJoint=function(){this.biasy=0,this.biasx=0,this.jAccy=0,this.jAccx=0,this.kMassc=0,this.kMassb=0,this.kMassa=0,this.wrap_n=null,this.nrely=0,this.nrelx=0,this.nlocaly=0,this.nlocalx=0,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.cx2=0,this.cx1=0,this.dot2=0,this.dot1=0,this.equal=!1,this.jointMax=0,this.jointMin=0,this.scale=0,this.outer_zn=null,o.constraint.ZPP_Constraint.call(this),this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0,this.nlocalx=0,this.nlocaly=0,this.nrelx=0,this.nrely=0,this.jAccx=0,this.jAccy=0,this.jMax=Math.POSITIVE_INFINITY,this.jointMin=Math.NEGATIVE_INFINITY,this.jointMax=Math.POSITIVE_INFINITY,
this.stepped=!1},o.constraint.ZPP_LineJoint.__name__=!0,o.constraint.ZPP_LineJoint.__super__=o.constraint.ZPP_Constraint,o.constraint.ZPP_LineJoint.prototype=t(o.constraint.ZPP_Constraint.prototype,{bodyImpulse:function(t){if(this.stepped){var n=this.scale*this.nrelx*this.jAccy-this.nrely*this.jAccx,e=this.nrelx*this.jAccx+this.scale*this.nrely*this.jAccy;return t==this.b1?p.geom.Vec3.get(-n,-e,this.scale*this.cx1*e-this.dot1*n):p.geom.Vec3.get(n,e,this.scale*this.cx1*e-this.dot1*n)}return p.geom.Vec3.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(t){this.immutable_midstep("Constraint::a1"),this.a1localx=t.x,this.a1localy=t.y,this.wake()},setup_a1:function(){this.wrap_a1=p.geom.Vec2.get(this.a1localx,this.a1localy,null),this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=n(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=n(this,this.invalidate_a1)},validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(t){this.immutable_midstep("Constraint::a2"),this.a2localx=t.x,this.a2localy=t.y,this.wake()},setup_a2:function(){this.wrap_a2=p.geom.Vec2.get(this.a2localx,this.a2localy,null),this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=n(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=n(this,this.invalidate_a2)},validate_n:function(){this.wrap_n.zpp_inner.x=this.nlocalx,this.wrap_n.zpp_inner.y=this.nlocaly},invalidate_n:function(t){this.immutable_midstep("Constraint::n"),this.nlocalx=t.x,this.nlocaly=t.y,this.zip_n=!0,this.wake()},setup_n:function(){this.wrap_n=p.geom.Vec2.get(this.nlocalx,this.nlocaly,null),this.wrap_n.zpp_inner._inuse=!0,this.wrap_n.zpp_inner._validate=n(this,this.validate_n),this.wrap_n.zpp_inner._invalidate=n(this,this.invalidate_n)},validate_norm:function(){if(this.zip_n){this.zip_n=!1;var t=this.nlocalx*this.nlocalx+this.nlocaly*this.nlocaly,n=1/Math.sqrt(t),e=n;this.nlocalx*=e,this.nlocaly*=e}},copy:function(t,n){var e=new p.constraint.LineJoint(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2(),this.outer_zn.get_direction(),this.jointMin,this.jointMax);if(this.copyto(e),null!=t&&null!=this.b1){for(var i=null,r=0;r<t.length;){var s=t[r];if(++r,s.id==this.b1.id){i=s.bc;break}}null!=i?e.zpp_inner_zn.b1=i.zpp_inner:n.push(o.constraint.ZPP_CopyHelper.todo(this.b1.id,function(t){e.zpp_inner_zn.b1=t.zpp_inner}))}if(null!=t&&null!=this.b2){for(var l=null,a=0;a<t.length;){var _=t[a];if(++a,_.id==this.b2.id){l=_.bc;break}}null!=l?e.zpp_inner_zn.b2=l.zpp_inner:n.push(o.constraint.ZPP_CopyHelper.todo(this.b2.id,function(t){e.zpp_inner_zn.b2=t.zpp_inner}))}return e},validate:function(){if(null==this.b1||null==this.b2)throw"Error: AngleJoint cannot be simulated null bodies";if(this.b1==this.b2)throw"Error: DistanceJoint cannot be simulated with body1 == body2";if(this.b1.space!=this.space||this.b2.space!=this.space)throw"Error: Constraints must have each body within the same space to which the constraint has been assigned";if(this.jointMin>this.jointMax)throw"Error: DistanceJoint must have jointMin <= jointMax";if(this.nlocalx*this.nlocalx+this.nlocaly*this.nlocaly<p.Config.epsilon)throw"Error: DistanceJoint direction must be non-degenerate";if(this.b1.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b2.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC)throw"Error: Constraints cannot have both bodies non-dynamic"},wake_connected:function(){null!=this.b1&&this.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b1.wake(),null!=this.b2&&this.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b2.wake()},forest:function(){if(this.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var t;if(this.b1.component==this.b1.component.parent)t=this.b1.component;else{for(var n=this.b1.component,e=null;n!=n.parent;){var i=n.parent;n.parent=e,e=n,n=i}for(;null!=e;){var r=e.parent;e.parent=n,e=r}t=n}var s;if(this.component==this.component.parent)s=this.component;else{for(var l=this.component,a=null;l!=l.parent;){var p=l.parent;l.parent=a,a=l,l=p}for(;null!=a;){var _=a.parent;a.parent=l,a=_}s=l}t!=s&&(t.rank<s.rank?t.parent=s:t.rank>s.rank?s.parent=t:(s.parent=t,t.rank++))}if(this.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var h;if(this.b2.component==this.b2.component.parent)h=this.b2.component;else{for(var u=this.b2.component,d=null;u!=u.parent;){var c=u.parent;u.parent=d,d=u,u=c}for(;null!=d;){var P=d.parent;d.parent=u,d=P}h=u}var f;if(this.component==this.component.parent)f=this.component;else{for(var z=this.component,v=null;z!=z.parent;){var m=z.parent;z.parent=v,v=z,z=m}for(;null!=v;){var b=v.parent;v.parent=z,v=b}f=z}h!=f&&(h.rank<f.rank?h.parent=f:h.rank>f.rank?f.parent=h:(f.parent=h,h.rank++))}},pair_exists:function(t,n){return this.b1.id==t&&this.b2.id==n||this.b1.id==n&&this.b2.id==t},clearcache:function(){this.jAccx=0,this.jAccy=0,this.pre_dt=-1},preStep:function(t){-1==this.pre_dt&&(this.pre_dt=t);var n=t/this.pre_dt;this.pre_dt=t,this.equal=this.jointMin==this.jointMax,this.stepped=!0,this.validate_norm(),this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.nrelx=this.b1.axisy*this.nlocalx-this.b1.axisx*this.nlocaly,this.nrely=this.nlocalx*this.b1.axisx+this.nlocaly*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var e=0,i=0,r=0,s=0;e=this.b2.posx+this.a2relx-this.b1.posx-this.a1relx,i=this.b2.posy+this.a2rely-this.b1.posy-this.a1rely,r=i*this.nrelx-e*this.nrely,s=this.nrelx*e+this.nrely*i,this.equal?(s-=this.jointMin,this.scale=1):s>this.jointMax?(s-=this.jointMax,this.scale=1):s<this.jointMin?(s=this.jointMin-s,this.scale=-1):(s=0,this.scale=0);var l=0,a=0;l=e+this.a1relx,a=i+this.a1rely,this.dot1=this.nrelx*l+this.nrely*a,this.cx1=a*this.nrelx-l*this.nrely,this.dot2=this.nrelx*this.a2relx+this.nrely*this.a2rely,this.cx2=this.a2rely*this.nrelx-this.a2relx*this.nrely,this.kMassa=this.b1.smass+this.b2.smass+this.dot1*this.dot1*this.b1.sinertia+this.dot2*this.dot2*this.b2.sinertia,this.kMassb=-this.scale*(this.dot1*this.cx1*this.b1.sinertia+this.dot2*this.cx2*this.b2.sinertia),this.kMassc=this.scale*this.scale*(this.b1.smass+this.b2.smass+this.cx1*this.cx1*this.b1.sinertia+this.cx2*this.cx2*this.b2.sinertia);var p,o=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(o!=o)this.kMassa=this.kMassb=this.kMassc=0,p=3;else if(0==o){var _=0;0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,_|=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,_|=2),this.kMassb=0,p=_}else{o=1/o;var h=this.kMassc*o;this.kMassc=this.kMassa*o,this.kMassa=h,this.kMassb*=-o,p=0}if(0!=(1&p)&&(this.jAccx=0),0!=(2&p)&&(this.jAccy=0),this.stiff)this.gamma=0,this.biasx=0,this.biasy=0;else{if(this.breakUnderError&&r*r+s*s>this.maxError*this.maxError)return!0;var u,d,c=2*Math.PI*this.frequency;this.gamma=1/(t*c*(2*this.damping+c*t));var P=1/(1+this.gamma);u=t*c*c*this.gamma,this.gamma*=P,d=P,this.kMassa*=d,this.kMassb*=d,this.kMassc*=d,this.biasx=r,this.biasy=s;var f=-u;this.biasx*=f,this.biasy*=f;var z=this.maxError,v=this.biasx*this.biasx+this.biasy*this.biasy;if(v>z*z){var m=z*(1/Math.sqrt(v));this.biasx*=m,this.biasy*=m}}var b=n;return this.jAccx*=b,this.jAccy*=b,this.jMax=this.maxForce*t,!1},warmStart:function(){var t=this.scale*this.nrelx*this.jAccy-this.nrely*this.jAccx,n=this.nrelx*this.jAccx+this.scale*this.nrely*this.jAccy,e=this.b1.imass;this.b1.velx-=t*e,this.b1.vely-=n*e;var i=this.b2.imass;this.b2.velx+=t*i,this.b2.vely+=n*i,this.b1.angvel+=(this.scale*this.cx1*this.jAccy-this.dot1*this.jAccx)*this.b1.iinertia,this.b2.angvel+=(this.dot2*this.jAccx-this.scale*this.cx2*this.jAccy)*this.b2.iinertia},applyImpulseVel:function(){var t=0,n=0,e=0,i=0;e=this.b2.velx-this.b1.velx,i=this.b2.vely-this.b1.vely,e+=this.b2.kinvelx-this.b1.kinvelx,i+=this.b2.kinvely-this.b1.kinvely,t=i*this.nrelx-e*this.nrely+(this.b2.angvel+this.b2.kinangvel)*this.dot2-(this.b1.angvel+this.b1.kinangvel)*this.dot1,n=this.scale*(this.nrelx*e+this.nrely*i-(this.b2.angvel+this.b2.kinangvel)*this.cx2+(this.b1.angvel+this.b1.kinangvel)*this.cx1);var r=0,s=0;r=this.biasx-t,s=this.biasy-n;var l=this.kMassa*r+this.kMassb*s;s=this.kMassb*r+this.kMassc*s,r=l;var a=this.gamma;r-=this.jAccx*a,s-=this.jAccy*a;var p=0,o=0;p=this.jAccx,o=this.jAccy;if(this.jAccx+=1*r,this.jAccy+=1*s,this.jAccy>0&&(this.jAccy=0),this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy>this.jMax*this.jMax)return!0}else if(!this.stiff){var _=this.jMax,h=this.jAccx*this.jAccx+this.jAccy*this.jAccy;if(h>_*_){var u=_*(1/Math.sqrt(h));this.jAccx*=u,this.jAccy*=u}}r=this.jAccx-p,s=this.jAccy-o;var d=this.scale*this.nrelx*s-this.nrely*r,c=this.nrelx*r+this.scale*this.nrely*s,P=this.b1.imass;this.b1.velx-=d*P,this.b1.vely-=c*P;var f=this.b2.imass;return this.b2.velx+=d*f,this.b2.vely+=c*f,this.b1.angvel+=(this.scale*this.cx1*s-this.dot1*r)*this.b1.iinertia,this.b2.angvel+=(this.dot2*r-this.scale*this.cx2*s)*this.b2.iinertia,!1},applyImpulsePos:function(){var t=0,n=0;t=this.b1.axisy*this.nlocalx-this.b1.axisx*this.nlocaly,n=this.nlocalx*this.b1.axisx+this.nlocaly*this.b1.axisy;var e=0,i=0;e=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,i=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;var r=0,s=0;r=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,s=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var l,a=0,o=0,_=0,h=0;if(a=this.b2.posx+r-this.b1.posx-e,o=this.b2.posy+s-this.b1.posy-i,_=o*t-a*n,h=t*a+n*o,this.equal?(h-=this.jointMin,l=1):h>this.jointMax?(h-=this.jointMax,l=1):h<this.jointMin?(h=this.jointMin-h,l=-1):(h=0,l=0),this.breakUnderError&&_*_+h*h>this.maxError*this.maxError)return!0;if(_*_+h*h<p.Config.constraintLinearSlop*p.Config.constraintLinearSlop)return!1;var u=0,d=0;if(_*=.5,h*=.5,_*_+h*h>6){var c=this.b1.smass+this.b2.smass;if(c>p.Config.epsilon){c=.8/c;var P=c*(n*_-l*t*h),f=c*(t*_*l-n*_),z=this.b1.imass;this.b1.posx-=P*z,this.b1.posy-=f*z;var v=this.b2.imass;this.b2.posx+=P*v,this.b2.posy+=f*v,a=this.b2.posx+r-this.b1.posx-e,o=this.b2.posy+s-this.b1.posy-i,_=o*t-a*n,h=t*a+n*o,this.equal?(h-=this.jointMin,l=1):h>this.jointMax?(h-=this.jointMax,l=1):h<this.jointMin?(h=this.jointMin-h,l=-1):(h=0,l=0);_*=.5,h*=.5}}var m,b,y,g,x=0,Z=0,w=0,C=0,E=0;C=a+e,E=o+i,m=t*C+n*E,y=E*t-C*n,b=t*r+n*s,g=s*t-r*n,x=this.b1.smass+this.b2.smass+m*m*this.b1.sinertia+b*b*this.b2.sinertia,Z=-l*(m*y*this.b1.sinertia+b*g*this.b2.sinertia),w=l*l*(this.b1.smass+this.b2.smass+y*y*this.b1.sinertia+g*g*this.b2.sinertia),u=-_,d=-h;var S=x*w-Z*Z;if(S!=S)u=d=0;else if(0==S)0!=x?u/=x:u=0,0!=w?d/=w:d=0;else{S=1/S;var N=S*(w*u-Z*d);d=S*(x*d-Z*u),u=N}d>0&&(d=0);var k=l*t*d-n*u,M=t*u+l*n*d,I=this.b1.imass;this.b1.posx-=k*I,this.b1.posy-=M*I;var F=this.b2.imass;return this.b2.posx+=k*F,this.b2.posy+=M*F,this.b1.delta_rot((l*y*d-m*u)*this.b1.iinertia),this.b2.delta_rot((b*u-l*g*d)*this.b2.iinertia),!1},draw:function(t){},__class__:o.constraint.ZPP_LineJoint}),o.constraint.ZPP_MotorJoint=function(){this.stepped=!1,this.jMax=0,this.jAcc=0,this.kMass=0,this.b2=null,this.b1=null,this.rate=0,this.ratio=0,this.outer_zn=null,o.constraint.ZPP_Constraint.call(this),this.jAcc=0,this.stepped=!1,this.__velocity=!0},o.constraint.ZPP_MotorJoint.__name__=!0,o.constraint.ZPP_MotorJoint.__super__=o.constraint.ZPP_Constraint,o.constraint.ZPP_MotorJoint.prototype=t(o.constraint.ZPP_Constraint.prototype,{bodyImpulse:function(t){return this.stepped?t==this.b1?p.geom.Vec3.get(0,0,-this.jAcc):p.geom.Vec3.get(0,0,this.ratio*this.jAcc):p.geom.Vec3.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},copy:function(t,n){var e=new p.constraint.MotorJoint(null,null,this.rate,this.ratio);if(this.copyto(e),null!=t&&null!=this.b1){for(var i=null,r=0;r<t.length;){var s=t[r];if(++r,s.id==this.b1.id){i=s.bc;break}}null!=i?e.zpp_inner_zn.b1=i.zpp_inner:n.push(o.constraint.ZPP_CopyHelper.todo(this.b1.id,function(t){e.zpp_inner_zn.b1=t.zpp_inner}))}if(null!=t&&null!=this.b2){for(var l=null,a=0;a<t.length;){var _=t[a];if(++a,_.id==this.b2.id){l=_.bc;break}}null!=l?e.zpp_inner_zn.b2=l.zpp_inner:n.push(o.constraint.ZPP_CopyHelper.todo(this.b2.id,function(t){e.zpp_inner_zn.b2=t.zpp_inner}))}return e},validate:function(){if(null==this.b1||null==this.b2)throw"Error: AngleJoint cannot be simulated null bodies";if(this.b1==this.b2)throw"Error: MotorJoint cannot be simulated with body1 == body2";if(this.b1.space!=this.space||this.b2.space!=this.space)throw"Error: Constraints must have each body within the same space to which the constraint has been assigned";if(this.b1.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b2.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC)throw"Error: Constraints cannot have both bodies non-dynamic"},wake_connected:function(){null!=this.b1&&this.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b1.wake(),null!=this.b2&&this.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b2.wake()},forest:function(){if(this.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var t;if(this.b1.component==this.b1.component.parent)t=this.b1.component;else{for(var n=this.b1.component,e=null;n!=n.parent;){var i=n.parent;n.parent=e,e=n,n=i}for(;null!=e;){var r=e.parent;e.parent=n,e=r}t=n}var s;if(this.component==this.component.parent)s=this.component;else{for(var l=this.component,a=null;l!=l.parent;){var p=l.parent;l.parent=a,a=l,l=p}for(;null!=a;){var _=a.parent;a.parent=l,a=_}s=l}t!=s&&(t.rank<s.rank?t.parent=s:t.rank>s.rank?s.parent=t:(s.parent=t,t.rank++))}if(this.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var h;if(this.b2.component==this.b2.component.parent)h=this.b2.component;else{for(var u=this.b2.component,d=null;u!=u.parent;){var c=u.parent;u.parent=d,d=u,u=c}for(;null!=d;){var P=d.parent;d.parent=u,d=P}h=u}var f;if(this.component==this.component.parent)f=this.component;else{for(var z=this.component,v=null;z!=z.parent;){var m=z.parent;z.parent=v,v=z,z=m}for(;null!=v;){var b=v.parent;v.parent=z,v=b}f=z}h!=f&&(h.rank<f.rank?h.parent=f:h.rank>f.rank?f.parent=h:(f.parent=h,h.rank++))}},pair_exists:function(t,n){return this.b1.id==t&&this.b2.id==n||this.b1.id==n&&this.b2.id==t},clearcache:function(){this.jAcc=0,this.pre_dt=-1},preStep:function(t){-1==this.pre_dt&&(this.pre_dt=t);var n=t/this.pre_dt;return this.pre_dt=t,this.stepped=!0,this.kMass=this.b1.sinertia+this.ratio*this.ratio*this.b2.sinertia,this.kMass=1/this.kMass,this.jAcc*=n,this.jMax=this.maxForce*t,!1},warmStart:function(){this.b1.angvel-=this.b1.iinertia*this.jAcc,this.b2.angvel+=this.ratio*this.b2.iinertia*this.jAcc},applyImpulseVel:function(){var t=this.ratio*(this.b2.angvel+this.b2.kinangvel)-this.b1.angvel-this.b1.kinangvel-this.rate,n=-this.kMass*t,e=this.jAcc;if(this.jAcc+=n,this.breakUnderForce){if(this.jAcc>this.jMax||this.jAcc<-this.jMax)return!0}else this.jAcc<-this.jMax?this.jAcc=-this.jMax:this.jAcc>this.jMax&&(this.jAcc=this.jMax);return n=this.jAcc-e,this.b1.angvel-=this.b1.iinertia*n,this.b2.angvel+=this.ratio*this.b2.iinertia*n,!1},applyImpulsePos:function(){return!1},__class__:o.constraint.ZPP_MotorJoint}),o.constraint.ZPP_PivotJoint=function(){this.stepped=!1,this.biasy=0,this.biasx=0,this.gamma=0,this.jMax=0,this.jAccy=0,this.jAccx=0,this.kMassc=0,this.kMassb=0,this.kMassa=0,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.b2=null,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.b1=null,this.outer_zn=null,o.constraint.ZPP_Constraint.call(this),this.stepped=!1,this.jAccx=0,this.jAccy=0,this.jMax=Math.POSITIVE_INFINITY,this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0},o.constraint.ZPP_PivotJoint.__name__=!0,o.constraint.ZPP_PivotJoint.__super__=o.constraint.ZPP_Constraint,o.constraint.ZPP_PivotJoint.prototype=t(o.constraint.ZPP_Constraint.prototype,{bodyImpulse:function(t){return this.stepped?t==this.b1?p.geom.Vec3.get(-this.jAccx,-this.jAccy,-(this.jAccy*this.a1relx-this.jAccx*this.a1rely)):p.geom.Vec3.get(this.jAccx,this.jAccy,this.jAccy*this.a2relx-this.jAccx*this.a2rely):p.geom.Vec3.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(t){this.immutable_midstep("Constraint::a1"),this.a1localx=t.x,this.a1localy=t.y,this.wake()},setup_a1:function(){this.wrap_a1=p.geom.Vec2.get(this.a1localx,this.a1localy,null),this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=n(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=n(this,this.invalidate_a1)},validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(t){this.immutable_midstep("Constraint::a2"),this.a2localx=t.x,this.a2localy=t.y,this.wake()},setup_a2:function(){this.wrap_a2=p.geom.Vec2.get(this.a2localx,this.a2localy,null),this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=n(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=n(this,this.invalidate_a2)},copy:function(t,n){var e=new p.constraint.PivotJoint(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2());if(this.copyto(e),null!=t&&null!=this.b1){for(var i=null,r=0;r<t.length;){var s=t[r];if(++r,s.id==this.b1.id){i=s.bc;break}}null!=i?e.zpp_inner_zn.b1=i.zpp_inner:n.push(o.constraint.ZPP_CopyHelper.todo(this.b1.id,function(t){e.zpp_inner_zn.b1=t.zpp_inner}))}if(null!=t&&null!=this.b2){for(var l=null,a=0;a<t.length;){var _=t[a];if(++a,_.id==this.b2.id){l=_.bc;break}}null!=l?e.zpp_inner_zn.b2=l.zpp_inner:n.push(o.constraint.ZPP_CopyHelper.todo(this.b2.id,function(t){e.zpp_inner_zn.b2=t.zpp_inner}))}return e},validate:function(){if(null==this.b1||null==this.b2)throw"Error: PivotJoint cannot be simulated null bodies";if(this.b1==this.b2)throw"Error: PivotJoint cannot be simulated with body1 == body2 (body1=body2="+this.b1.outer.toString()+")";if(this.b1.space!=this.space||this.b2.space!=this.space)throw"Error: Constraints must have each body within the same space to which the constraint has been assigned (body1="+this.b1.outer.toString()+", body2="+this.b2.outer.toString()+")";if(this.b1.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b2.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC)throw"Error: Constraints cannot have both bodies non-dynamic (body1="+this.b1.outer.toString()+", body2="+this.b2.outer.toString()+")"},wake_connected:function(){null!=this.b1&&this.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b1.wake(),null!=this.b2&&this.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b2.wake()},forest:function(){if(this.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var t;if(this.b1.component==this.b1.component.parent)t=this.b1.component;else{for(var n=this.b1.component,e=null;n!=n.parent;){var i=n.parent;n.parent=e,e=n,n=i}for(;null!=e;){var r=e.parent;e.parent=n,e=r}t=n}var s;if(this.component==this.component.parent)s=this.component;else{for(var l=this.component,a=null;l!=l.parent;){var p=l.parent;l.parent=a,a=l,l=p}for(;null!=a;){var _=a.parent;a.parent=l,a=_}s=l}t!=s&&(t.rank<s.rank?t.parent=s:t.rank>s.rank?s.parent=t:(s.parent=t,t.rank++))}if(this.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var h;if(this.b2.component==this.b2.component.parent)h=this.b2.component;else{for(var u=this.b2.component,d=null;u!=u.parent;){var c=u.parent;u.parent=d,d=u,u=c}for(;null!=d;){var P=d.parent;d.parent=u,d=P}h=u}var f;if(this.component==this.component.parent)f=this.component;else{for(var z=this.component,v=null;z!=z.parent;){var m=z.parent;z.parent=v,v=z,z=m}for(;null!=v;){var b=v.parent;v.parent=z,v=b}f=z}h!=f&&(h.rank<f.rank?h.parent=f:h.rank>f.rank?f.parent=h:(f.parent=h,h.rank++))}},pair_exists:function(t,n){return this.b1.id==t&&this.b2.id==n||this.b1.id==n&&this.b2.id==t},clearcache:function(){this.jAccx=0,this.jAccy=0,this.pre_dt=-1},preStep:function(t){-1==this.pre_dt&&(this.pre_dt=t);var n=t/this.pre_dt;this.pre_dt=t,this.stepped=!0,this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var e=this.b1.smass+this.b2.smass;if(this.kMassa=e,this.kMassb=0,this.kMassc=e,0!=this.b1.sinertia){var i=this.a1relx*this.b1.sinertia,r=this.a1rely*this.b1.sinertia;this.kMassa+=r*this.a1rely,this.kMassb+=-r*this.a1relx,this.kMassc+=i*this.a1relx}if(0!=this.b2.sinertia){var s=this.a2relx*this.b2.sinertia,l=this.a2rely*this.b2.sinertia;this.kMassa+=l*this.a2rely,this.kMassb+=-l*this.a2relx,this.kMassc+=s*this.a2relx}var a,p=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(p!=p)this.kMassa=this.kMassb=this.kMassc=0,a=3;else if(0==p){var o=0;0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,o|=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,o|=2),this.kMassb=0,a=o}else{p=1/p;var _=this.kMassc*p;this.kMassc=this.kMassa*p,this.kMassa=_,this.kMassb*=-p,a=0}if(0!=(1&a)&&(this.jAccx=0),0!=(2&a)&&(this.jAccy=0),this.stiff)this.biasx=0,this.biasy=0,this.gamma=0;else{var h,u,d=2*Math.PI*this.frequency;this.gamma=1/(t*d*(2*this.damping+d*t));var c=1/(1+this.gamma);if(h=t*d*d*this.gamma,this.gamma*=c,u=c,this.kMassa*=u,this.kMassb*=u,this.kMassc*=u,this.biasx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),this.biasy=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),this.breakUnderError&&this.biasx*this.biasx+this.biasy*this.biasy>this.maxError*this.maxError)return!0;var P=-h;this.biasx*=P,this.biasy*=P;var f=this.maxError,z=this.biasx*this.biasx+this.biasy*this.biasy;if(z>f*f){var v=f*(1/Math.sqrt(z));this.biasx*=v,this.biasy*=v}}var m=n;return this.jAccx*=m,this.jAccy*=m,this.jMax=this.maxForce*t,!1},warmStart:function(){var t=this.b1.imass;this.b1.velx-=this.jAccx*t,this.b1.vely-=this.jAccy*t;var n=this.b2.imass;this.b2.velx+=this.jAccx*n,this.b2.vely+=this.jAccy*n,this.b1.angvel-=(this.jAccy*this.a1relx-this.jAccx*this.a1rely)*this.b1.iinertia,this.b2.angvel+=(this.jAccy*this.a2relx-this.jAccx*this.a2rely)*this.b2.iinertia},applyImpulseVel:function(){var t=0,n=0;t=this.b2.velx+this.b2.kinvelx-this.a2rely*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.a1rely*(this.b1.angvel+this.b1.kinangvel)),n=this.b2.vely+this.b2.kinvely+this.a2relx*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.a1relx*(this.b1.angvel+this.b1.kinangvel));var e=0,i=0;e=this.biasx-t,i=this.biasy-n;var r=this.kMassa*e+this.kMassb*i;i=this.kMassb*e+this.kMassc*i,e=r;var s=this.gamma;e-=this.jAccx*s,i-=this.jAccy*s;var l=0,a=0;l=this.jAccx,a=this.jAccy;if(this.jAccx+=1*e,this.jAccy+=1*i,this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy>this.jMax*this.jMax)return!0}else if(!this.stiff){var p=this.jMax,o=this.jAccx*this.jAccx+this.jAccy*this.jAccy;if(o>p*p){var _=p*(1/Math.sqrt(o));this.jAccx*=_,this.jAccy*=_}}e=this.jAccx-l,i=this.jAccy-a;var h=this.b1.imass;this.b1.velx-=e*h,this.b1.vely-=i*h;var u=this.b2.imass;return this.b2.velx+=e*u,this.b2.vely+=i*u,this.b1.angvel-=(i*this.a1relx-e*this.a1rely)*this.b1.iinertia,this.b2.angvel+=(i*this.a2relx-e*this.a2rely)*this.b2.iinertia,!1},applyImpulsePos:function(){var t=0,n=0;t=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,n=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;var e=0,i=0;e=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,i=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var r=0,s=0;if(r=this.b2.posx+e-(this.b1.posx+t),s=this.b2.posy+i-(this.b1.posy+n),this.breakUnderError&&r*r+s*s>this.maxError*this.maxError)return!0;if(r*r+s*s<p.Config.constraintLinearSlop*p.Config.constraintLinearSlop)return!1;r*=.5,s*=.5;var l=0,a=0;if(r*r+s*s>6){var o=this.b1.smass+this.b2.smass;if(o>p.Config.epsilon){o=.75/o,l=-r*o,a=-s*o;var _=l*l+a*a;if(_>400){var h=1/Math.sqrt(_)*20;l*=h,a*=h}var u=this.b1.imass;this.b1.posx-=l*u,this.b1.posy-=a*u;var d=this.b2.imass;this.b2.posx+=l*d,this.b2.posy+=a*d,r=this.b2.posx+e-(this.b1.posx+t),s=this.b2.posy+i-(this.b1.posy+n);r*=.5,s*=.5}}var c=0,P=0,f=0,z=this.b1.smass+this.b2.smass;if(c=z,P=0,f=z,0!=this.b1.sinertia){var v=t*this.b1.sinertia,m=n*this.b1.sinertia;c+=m*n,P+=-m*t,f+=v*t}if(0!=this.b2.sinertia){var b=e*this.b2.sinertia,y=i*this.b2.sinertia;c+=y*i,P+=-y*e,f+=b*e}l=-r,a=-s;var g=l*l+a*a;if(g>36){var x=1/Math.sqrt(g)*6;l*=x,a*=x}var Z=c*f-P*P;if(Z!=Z)l=a=0;else if(0==Z)0!=c?l/=c:l=0,0!=f?a/=f:a=0;else{Z=1/Z;var w=Z*(f*l-P*a);a=Z*(c*a-P*l),l=w}var C=this.b1.imass;this.b1.posx-=l*C,this.b1.posy-=a*C;var E=this.b2.imass;return this.b2.posx+=l*E,this.b2.posy+=a*E,this.b1.delta_rot(-(a*t-l*n)*this.b1.iinertia),this.b2.delta_rot((a*e-l*i)*this.b2.iinertia),!1},draw:function(t){},__class__:o.constraint.ZPP_PivotJoint}),o.constraint.ZPP_PulleyJoint=function(){this.stepped=!1,this.bias=0,this.gamma=0,this.jMax=0,this.jAcc=0,this.kMass=0,this.wrap_a4=null,this.a4rely=0,this.a4relx=0,this.a4localy=0,this.a4localx=0,this.b4=null,this.wrap_a3=null,this.a3rely=0,this.a3relx=0,this.a3localy=0,this.a3localx=0,this.b3=null,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.b2=null,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.b1=null,this.cx4=0,this.cx3=0,this.cx2=0,this.cx1=0,this.n34y=0,this.n34x=0,this.n12y=0,this.n12x=0,this.equal=!1,this.slack=!1,this.jointMax=0,this.jointMin=0,this.ratio=1,this.outer_zn=null,o.constraint.ZPP_Constraint.call(this),this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0,this.a3localx=0,this.a3localy=0,this.a3relx=0,this.a3rely=0,this.a4localx=0,this.a4localy=0,this.a4relx=0,this.a4rely=0,this.n12x=1,this.n12y=0,this.n34x=1,this.n34y=0,this.jAcc=0,this.jMax=Math.POSITIVE_INFINITY,this.stepped=!1,this.cx1=this.cx2=this.cx3=this.cx4=0},o.constraint.ZPP_PulleyJoint.__name__=!0,o.constraint.ZPP_PulleyJoint.__super__=o.constraint.ZPP_Constraint,o.constraint.ZPP_PulleyJoint.prototype=t(o.constraint.ZPP_Constraint.prototype,{is_slack:function(){var t;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,this.a3relx=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy,this.a3rely=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy,this.a4relx=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy,this.a4rely=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy;var n=0,e=0,i=0,r=0,s=0,l=0,a=0,p=0;s=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),l=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),a=this.b4.posx+this.a4relx-(this.b3.posx+this.a3relx),p=this.b4.posy+this.a4rely-(this.b3.posy+this.a3rely);var o=Math.sqrt(s*s+l*l),_=Math.sqrt(a*a+p*p);if(0!=o){var h=1/o;n=s*h,e=l*h}if(0!=_){var u=1/_;i=a*u,r=p*u;var d=this.ratio;i*=d,r*=d}else{var c=this.ratio/Math.sqrt(i*i+r*r);i*=c,r*=c}var P=o+this.ratio*_;return this.equal?(P-=this.jointMax,t=!1):P<this.jointMin?(P=this.jointMin-P,n=-n,e=-e,i=-i,r=-r,t=!1):P>this.jointMax?(P-=this.jointMax,t=!1):(n=0,e=0,i=0,r=0,P=0,t=!0),t},bodyImpulse:function(t){if(this.stepped){var n=p.geom.Vec3.get();if(t==this.b1){var e=n;e.set_x(function(t){if(null!=e&&e.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return e.zpp_inner.validate(),e.zpp_inner.x}()-this.jAcc*this.n12x);var i=n;i.set_y(function(t){if(null!=i&&i.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return i.zpp_inner.validate(),i.zpp_inner.y}()-this.jAcc*this.n12y);var r=n;r.set_z(function(t){if(null!=r&&r.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return r.zpp_inner.validate(),r.zpp_inner.z}()-this.cx1*this.jAcc)}if(t==this.b2){var s=n;s.set_x(function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.x}()+this.jAcc*this.n12x);var l=n;l.set_y(function(t){if(null!=l&&l.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return l.zpp_inner.validate(),l.zpp_inner.y}()+this.jAcc*this.n12y);var a=n;a.set_z(function(t){if(null!=a&&a.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return a.zpp_inner.validate(),a.zpp_inner.z}()+this.cx2*this.jAcc)}if(t==this.b3){var o=n;o.set_x(function(t){if(null!=o&&o.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return o.zpp_inner.validate(),o.zpp_inner.x}()-this.jAcc*this.n34x);var _=n;_.set_y(function(t){if(null!=_&&_.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return _.zpp_inner.validate(),_.zpp_inner.y}()-this.jAcc*this.n34y);var h=n;h.set_z(function(t){if(null!=h&&h.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return h.zpp_inner.validate(),h.zpp_inner.z}()-this.cx3*this.jAcc)}if(t==this.b4){var u=n;u.set_x(function(t){if(null!=u&&u.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return u.zpp_inner.validate(),u.zpp_inner.x}()+this.jAcc*this.n34x);var d=n;d.set_y(function(t){if(null!=d&&d.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return d.zpp_inner.validate(),d.zpp_inner.y}()+this.jAcc*this.n34y);var c=n;c.set_z(function(t){if(null!=c&&c.zpp_disp)throw"Error: Vec3 has been disposed and cannot be used!";return c.zpp_inner.validate(),c.zpp_inner.z}()+this.cx4*this.jAcc)}return n}return p.geom.Vec3.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this),this.b3!=this.b1&&this.b3!=this.b2&&null!=this.b3&&this.b3.constraints.add(this),this.b4!=this.b1&&this.b4!=this.b2&&this.b4!=this.b3&&null!=this.b4&&this.b4.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this),this.b3!=this.b1&&this.b3!=this.b2&&null!=this.b3&&this.b3.constraints.remove(this),this.b4!=this.b1&&this.b4!=this.b2&&this.b4!=this.b3&&null!=this.b4&&this.b4.constraints.remove(this)},validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(t){this.immutable_midstep("Constraint::a1"),this.a1localx=t.x,this.a1localy=t.y,this.wake()},setup_a1:function(){this.wrap_a1=p.geom.Vec2.get(this.a1localx,this.a1localy,null),this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=n(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=n(this,this.invalidate_a1)},validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(t){this.immutable_midstep("Constraint::a2"),this.a2localx=t.x,this.a2localy=t.y,this.wake()},setup_a2:function(){this.wrap_a2=p.geom.Vec2.get(this.a2localx,this.a2localy,null),this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=n(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=n(this,this.invalidate_a2)},validate_a3:function(){
this.wrap_a3.zpp_inner.x=this.a3localx,this.wrap_a3.zpp_inner.y=this.a3localy},invalidate_a3:function(t){this.immutable_midstep("Constraint::a3"),this.a3localx=t.x,this.a3localy=t.y,this.wake()},setup_a3:function(){this.wrap_a3=p.geom.Vec2.get(this.a3localx,this.a3localy,null),this.wrap_a3.zpp_inner._inuse=!0,this.wrap_a3.zpp_inner._validate=n(this,this.validate_a3),this.wrap_a3.zpp_inner._invalidate=n(this,this.invalidate_a3)},validate_a4:function(){this.wrap_a4.zpp_inner.x=this.a4localx,this.wrap_a4.zpp_inner.y=this.a4localy},invalidate_a4:function(t){this.immutable_midstep("Constraint::a4"),this.a4localx=t.x,this.a4localy=t.y,this.wake()},setup_a4:function(){this.wrap_a4=p.geom.Vec2.get(this.a4localx,this.a4localy,null),this.wrap_a4.zpp_inner._inuse=!0,this.wrap_a4.zpp_inner._validate=n(this,this.validate_a4),this.wrap_a4.zpp_inner._invalidate=n(this,this.invalidate_a4)},copy:function(t,n){var e=new p.constraint.PulleyJoint(null,null,null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2(),this.outer_zn.get_anchor3(),this.outer_zn.get_anchor4(),this.jointMin,this.jointMax,this.ratio);if(this.copyto(e),null!=t&&null!=this.b1){for(var i=null,r=0;r<t.length;){var s=t[r];if(++r,s.id==this.b1.id){i=s.bc;break}}null!=i?e.zpp_inner_zn.b1=i.zpp_inner:n.push(o.constraint.ZPP_CopyHelper.todo(this.b1.id,function(t){e.zpp_inner_zn.b1=t.zpp_inner}))}if(null!=t&&null!=this.b2){for(var l=null,a=0;a<t.length;){var _=t[a];if(++a,_.id==this.b2.id){l=_.bc;break}}null!=l?e.zpp_inner_zn.b2=l.zpp_inner:n.push(o.constraint.ZPP_CopyHelper.todo(this.b2.id,function(t){e.zpp_inner_zn.b2=t.zpp_inner}))}if(null!=t&&null!=this.b3){for(var h=null,u=0;u<t.length;){var d=t[u];if(++u,d.id==this.b3.id){h=d.bc;break}}null!=h?e.zpp_inner_zn.b3=h.zpp_inner:n.push(o.constraint.ZPP_CopyHelper.todo(this.b3.id,function(t){e.zpp_inner_zn.b3=t.zpp_inner}))}if(null!=t&&null!=this.b4){for(var c=null,P=0;P<t.length;){var f=t[P];if(++P,f.id==this.b4.id){c=f.bc;break}}null!=c?e.zpp_inner_zn.b4=c.zpp_inner:n.push(o.constraint.ZPP_CopyHelper.todo(this.b4.id,function(t){e.zpp_inner_zn.b4=t.zpp_inner}))}return e},validate:function(){if(null==this.b1||null==this.b2||null==this.b3||null==this.b4)throw"Error: PulleyJoint cannot be simulated with null bodies";if(this.b1==this.b2||this.b3==this.b4)throw"Error: PulleyJoint cannot have body1==body2 or body3==body4";if(this.b1.space!=this.space||this.b2.space!=this.space||this.b3.space!=this.space||this.b4.space!=this.space)throw"Error: Constraints must have each body within the same space to which the constraint has been assigned";if(this.jointMin>this.jointMax)throw"Error: PulleyJoint must have jointMin <= jointMax";if(this.b1.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b2.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC)throw"Error: PulleyJoint cannot have both bodies in a linked pair non-dynamic";if(this.b3.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b4.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC)throw"Error: PulleyJoint cannot have both bodies in a linked pair non-dynamic"},wake_connected:function(){null!=this.b1&&this.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b1.wake(),null!=this.b2&&this.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b2.wake(),null!=this.b3&&this.b3.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b3.wake(),null!=this.b4&&this.b4.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b4.wake()},forest:function(){if(this.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var t;if(this.b1.component==this.b1.component.parent)t=this.b1.component;else{for(var n=this.b1.component,e=null;n!=n.parent;){var i=n.parent;n.parent=e,e=n,n=i}for(;null!=e;){var r=e.parent;e.parent=n,e=r}t=n}var s;if(this.component==this.component.parent)s=this.component;else{for(var l=this.component,a=null;l!=l.parent;){var p=l.parent;l.parent=a,a=l,l=p}for(;null!=a;){var _=a.parent;a.parent=l,a=_}s=l}t!=s&&(t.rank<s.rank?t.parent=s:t.rank>s.rank?s.parent=t:(s.parent=t,t.rank++))}if(this.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var h;if(this.b2.component==this.b2.component.parent)h=this.b2.component;else{for(var u=this.b2.component,d=null;u!=u.parent;){var c=u.parent;u.parent=d,d=u,u=c}for(;null!=d;){var P=d.parent;d.parent=u,d=P}h=u}var f;if(this.component==this.component.parent)f=this.component;else{for(var z=this.component,v=null;z!=z.parent;){var m=z.parent;z.parent=v,v=z,z=m}for(;null!=v;){var b=v.parent;v.parent=z,v=b}f=z}h!=f&&(h.rank<f.rank?h.parent=f:h.rank>f.rank?f.parent=h:(f.parent=h,h.rank++))}if(this.b3.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var y;if(this.b3.component==this.b3.component.parent)y=this.b3.component;else{for(var g=this.b3.component,x=null;g!=g.parent;){var Z=g.parent;g.parent=x,x=g,g=Z}for(;null!=x;){var w=x.parent;x.parent=g,x=w}y=g}var C;if(this.component==this.component.parent)C=this.component;else{for(var E=this.component,S=null;E!=E.parent;){var N=E.parent;E.parent=S,S=E,E=N}for(;null!=S;){var k=S.parent;S.parent=E,S=k}C=E}y!=C&&(y.rank<C.rank?y.parent=C:y.rank>C.rank?C.parent=y:(C.parent=y,y.rank++))}if(this.b4.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var M;if(this.b4.component==this.b4.component.parent)M=this.b4.component;else{for(var I=this.b4.component,F=null;I!=I.parent;){var A=I.parent;I.parent=F,F=I,I=A}for(;null!=F;){var T=F.parent;F.parent=I,F=T}M=I}var V;if(this.component==this.component.parent)V=this.component;else{for(var L=this.component,B=null;L!=L.parent;){var O=L.parent;L.parent=B,B=L,L=O}for(;null!=B;){var G=B.parent;B.parent=L,B=G}V=L}M!=V&&(M.rank<V.rank?M.parent=V:M.rank>V.rank?V.parent=M:(V.parent=M,M.rank++))}},pair_exists:function(t,n){return this.b1.id==t&&(this.b2.id==n||this.b3.id==n||this.b4.id==n)||this.b2.id==t&&(this.b3.id==n||this.b4.id==n||this.b1.id==n)||this.b3.id==t&&(this.b4.id==n||this.b1.id==n||this.b2.id==n)||this.b4.id==t&&(this.b1.id==n||this.b2.id==n||this.b3.id==n)},clearcache:function(){this.jAcc=0,this.pre_dt=-1},preStep:function(t){-1==this.pre_dt&&(this.pre_dt=t);var n=t/this.pre_dt;this.pre_dt=t,this.stepped=!0,this.equal=this.jointMin==this.jointMax,this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,this.a3relx=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy,this.a3rely=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy,this.a4relx=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy,this.a4rely=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy;var e,i=0,r=0,s=0,l=0;i=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),r=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),s=this.b4.posx+this.a4relx-(this.b3.posx+this.a3relx),l=this.b4.posy+this.a4rely-(this.b3.posy+this.a3rely);var a=Math.sqrt(i*i+r*r),p=Math.sqrt(s*s+l*l);if(0!=a){var o=1/a;this.n12x=i*o,this.n12y=r*o}if(0!=p){var _=1/p;this.n34x=s*_,this.n34y=l*_;var h=this.ratio;this.n34x*=h,this.n34y*=h}else{var u=this.ratio/Math.sqrt(this.n34x*this.n34x+this.n34y*this.n34y);this.n34x*=u,this.n34y*=u}var d=a+this.ratio*p;if(this.equal?(d-=this.jointMax,this.slack=!1):d<this.jointMin?(d=this.jointMin-d,this.n12x=-this.n12x,this.n12y=-this.n12y,this.n34x=-this.n34x,this.n34y=-this.n34y,this.slack=!1):d>this.jointMax?(d-=this.jointMax,this.slack=!1):(this.n12x=0,this.n12y=0,this.n34x=0,this.n34y=0,d=0,this.slack=!0),e=d,!this.slack){this.cx1=this.n12y*this.a1relx-this.n12x*this.a1rely,this.cx2=this.n12y*this.a2relx-this.n12x*this.a2rely,this.cx3=this.n34y*this.a3relx-this.n34x*this.a3rely,this.cx4=this.n34y*this.a4relx-this.n34x*this.a4rely;var c=this.ratio*this.ratio,P=this.b1.smass+this.b2.smass+c*(this.b3.smass+this.b4.smass)+this.b1.sinertia*this.cx1*this.cx1+this.b2.sinertia*this.cx2*this.cx2+this.b3.sinertia*this.cx3*this.cx3+this.b4.sinertia*this.cx4*this.cx4;if(this.b1==this.b4&&(P-=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b1.smass+this.cx1*this.cx4*this.b1.sinertia)),this.b1==this.b3&&(P+=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b1.smass+this.cx1*this.cx3*this.b1.sinertia)),this.b2==this.b3&&(P-=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b2.smass+this.cx2*this.cx3*this.b2.sinertia)),this.b2==this.b4&&(P+=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b2.smass+this.cx2*this.cx4*this.b2.sinertia)),this.kMass=P,0!=this.kMass?this.kMass=1/this.kMass:this.jAcc=0,this.stiff)this.bias=0,this.gamma=0;else{if(this.breakUnderError&&e*e>this.maxError*this.maxError)return!0;var f,z=2*Math.PI*this.frequency;this.gamma=1/(t*z*(2*this.damping+z*t));var v=1/(1+this.gamma);f=t*z*z*this.gamma,this.gamma*=v,this.kMass*=v,this.bias=-e*f,this.bias<-this.maxError?this.bias=-this.maxError:this.bias>this.maxError&&(this.bias=this.maxError)}this.jAcc*=n,this.jMax=this.maxForce*t}return!1},warmStart:function(){if(!this.slack){var t=this.b1.imass*this.jAcc;this.b1.velx-=this.n12x*t,this.b1.vely-=this.n12y*t;var n=this.b2.imass*this.jAcc;this.b2.velx+=this.n12x*n,this.b2.vely+=this.n12y*n;var e=this.b3.imass*this.jAcc;this.b3.velx-=this.n34x*e,this.b3.vely-=this.n34y*e;var i=this.b4.imass*this.jAcc;this.b4.velx+=this.n34x*i,this.b4.vely+=this.n34y*i,this.b1.angvel-=this.cx1*this.b1.iinertia*this.jAcc,this.b2.angvel+=this.cx2*this.b2.iinertia*this.jAcc,this.b3.angvel-=this.cx3*this.b3.iinertia*this.jAcc,this.b4.angvel+=this.cx4*this.b4.iinertia*this.jAcc}},applyImpulseVel:function(){if(this.slack)return!1;var t=this.n12x*(this.b2.velx+this.b2.kinvelx-this.b1.velx-this.b1.kinvelx)+this.n12y*(this.b2.vely+this.b2.kinvely-this.b1.vely-this.b1.kinvely)+this.n34x*(this.b4.velx+this.b4.kinvelx-this.b3.velx-this.b3.kinvelx)+this.n34y*(this.b4.vely+this.b4.kinvely-this.b3.vely-this.b3.kinvely)+(this.b2.angvel+this.b2.kinangvel)*this.cx2-(this.b1.angvel+this.b1.kinangvel)*this.cx1+(this.b4.angvel+this.b4.kinangvel)*this.cx4-(this.b3.angvel+this.b3.kinangvel)*this.cx3,n=this.kMass*(this.bias-t)-this.jAcc*this.gamma,e=this.jAcc;if(this.jAcc+=n,!this.equal&&this.jAcc>0&&(this.jAcc=0),this.breakUnderForce&&this.jAcc<-this.jMax)return!0;this.stiff||this.jAcc<-this.jMax&&(this.jAcc=-this.jMax),n=this.jAcc-e;var i=this.b1.imass*n;this.b1.velx-=this.n12x*i,this.b1.vely-=this.n12y*i;var r=this.b2.imass*n;this.b2.velx+=this.n12x*r,this.b2.vely+=this.n12y*r;var s=this.b3.imass*n;this.b3.velx-=this.n34x*s,this.b3.vely-=this.n34y*s;var l=this.b4.imass*n;return this.b4.velx+=this.n34x*l,this.b4.vely+=this.n34y*l,this.b1.angvel-=this.cx1*this.b1.iinertia*n,this.b2.angvel+=this.cx2*this.b2.iinertia*n,this.b3.angvel-=this.cx3*this.b3.iinertia*n,this.b4.angvel+=this.cx4*this.b4.iinertia*n,!1},applyImpulsePos:function(){var t,n,e=0,i=0;e=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,i=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;var r=0,s=0;r=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,s=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var l=0,a=0;l=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy,a=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy;var o=0,_=0;o=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy,_=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy;var h,u=0,d=0,c=0,P=0;u=this.n12x,d=this.n12y,c=this.n34x,P=this.n34y;var f=0,z=0,v=0,m=0;f=this.b2.posx+r-(this.b1.posx+e),z=this.b2.posy+s-(this.b1.posy+i),v=this.b4.posx+o-(this.b3.posx+l),m=this.b4.posy+_-(this.b3.posy+a);var b=Math.sqrt(f*f+z*z),y=Math.sqrt(v*v+m*m);if(0!=b){var g=1/b;u=f*g,d=z*g}if(0!=y){var x=1/y;c=v*x,P=m*x;var Z=this.ratio;c*=Z,P*=Z}else{var w=this.ratio/Math.sqrt(c*c+P*P);c*=w,P*=w}var C=b+this.ratio*y;if(this.equal?(C-=this.jointMax,h=!1):C<this.jointMin?(C=this.jointMin-C,u=-u,d=-d,c=-c,P=-P,h=!1):C>this.jointMax?(C-=this.jointMax,h=!1):(u=0,d=0,c=0,P=0,C=0,h=!0),t=C,!h){if(this.breakUnderError&&t*t>this.maxError*this.maxError)return!0;if(t*t<p.Config.constraintLinearSlop*p.Config.constraintLinearSlop)return!1;if((t*=.5)*t>6){var E=this.b1.smass+this.b2.smass;if(E>p.Config.epsilon&&(E=.75/E,n=-t*E,this.equal||n<0)){var S=n*this.b1.imass;this.b1.posx-=u*S,this.b1.posy-=d*S;var N=n*this.b2.imass;this.b2.posx+=u*N,this.b2.posy+=d*N;var k=n*this.b3.imass;this.b3.posx-=c*k,this.b3.posy-=P*k;var M=n*this.b4.imass;this.b4.posx+=c*M,this.b4.posy+=P*M;var I=0,F=0,A=0,T=0;I=this.b2.posx+r-(this.b1.posx+e),F=this.b2.posy+s-(this.b1.posy+i),A=this.b4.posx+o-(this.b3.posx+l),T=this.b4.posy+_-(this.b3.posy+a);var V=Math.sqrt(I*I+F*F),L=Math.sqrt(A*A+T*T);if(0!=V){var B=1/V;u=I*B,d=F*B}if(0!=L){var O=1/L;c=A*O,P=T*O;var G=this.ratio;c*=G,P*=G}else{var R=this.ratio/Math.sqrt(c*c+P*P);c*=R,P*=R}var D=V+this.ratio*L;this.equal?(D-=this.jointMax,h=!1):D<this.jointMin?(D=this.jointMin-D,u=-u,d=-d,c=-c,P=-P,h=!1):D>this.jointMax?(D-=this.jointMax,h=!1):(u=0,d=0,c=0,P=0,D=0,h=!0),t=D,t*=.5}}var j,q,Y,U,W;j=d*e-u*i,q=d*r-u*s,Y=P*l-c*a,U=P*o-c*_;var J=this.ratio*this.ratio,K=this.b1.smass+this.b2.smass+J*(this.b3.smass+this.b4.smass)+this.b1.sinertia*j*j+this.b2.sinertia*q*q+this.b3.sinertia*Y*Y+this.b4.sinertia*U*U;if(this.b1==this.b4&&(K-=2*((u*c+d*P)*this.b1.smass+j*U*this.b1.sinertia)),this.b1==this.b3&&(K+=2*((u*c+d*P)*this.b1.smass+j*Y*this.b1.sinertia)),this.b2==this.b3&&(K-=2*((u*c+d*P)*this.b2.smass+q*Y*this.b2.sinertia)),this.b2==this.b4&&(K+=2*((u*c+d*P)*this.b2.smass+q*U*this.b2.sinertia)),W=K,0!=W&&(W=1/W),n=-t*W,this.equal||n<0){var H=this.b1.imass*n;this.b1.posx-=u*H,this.b1.posy-=d*H;var X=this.b2.imass*n;this.b2.posx+=u*X,this.b2.posy+=d*X;var Q=this.b3.imass*n;this.b3.posx-=c*Q,this.b3.posy-=P*Q;var $=this.b4.imass*n;this.b4.posx+=c*$,this.b4.posy+=P*$,this.b1.delta_rot(-j*this.b1.iinertia*n),this.b2.delta_rot(q*this.b2.iinertia*n),this.b3.delta_rot(-Y*this.b3.iinertia*n),this.b4.delta_rot(U*this.b4.iinertia*n)}}return!1},draw:function(t){},__class__:o.constraint.ZPP_PulleyJoint}),o.constraint.ZPP_UserConstraint=function(t,n){this.jOld=null,this.J=null,this.vec3=null,this.Keff=null,this.jMax=0,this.velonly=!1,this.gamma=0,this.soft=0,this.y=null,this.L=null,this.stepped=!1,this.bias=null,this.jAcc=null,this.dim=0,this.bodies=null,this.outer_zn=null,o.constraint.ZPP_Constraint.call(this),this.bodies=new Array,this.dim=t,this.velonly=n,this.jAcc=new Array,this.bias=new Array,this.L=new Array,this.J=new Array,this.jOld=new Array,this.y=new Array,this.Keff=new Array,this.vec3=p.geom.Vec3.get(0,0,0);for(var e=0;e<t;){var i=e++;this.jAcc[i]=this.bias[i]=this.J[i]=this.jOld[i]=this.y[i]=0;for(var r=0;r<t;){var s=r++;this.L[i*t+s]=0}}this.stepped=!1},o.constraint.ZPP_UserConstraint.__name__=!0,o.constraint.ZPP_UserConstraint.__super__=o.constraint.ZPP_Constraint,o.constraint.ZPP_UserConstraint.prototype=t(o.constraint.ZPP_Constraint.prototype,{bindVec2_invalidate:function(t){this.outer_zn.__invalidate()},addBody:function(t){for(var n=null,e=0,i=this.bodies;e<i.length;){var r=i[e];if(++e,r.body==t){n=r;break}}null==n?(this.bodies.push(new o.constraint.ZPP_UserBody(1,t)),this.active&&null!=this.space&&null!=t&&t.constraints.add(this)):n.cnt++},remBody:function(t){for(var n=null,e=0|this.bodies.length,i=0;i<e;){var r=this.bodies[i];if(r.body==t){r.cnt--,0==r.cnt&&(e>0&&(this.bodies[i]=this.bodies[e-1]),this.bodies.pop(),this.active&&null!=this.space&&null!=t&&t.constraints.remove(this)),n=r;break}i++}return null!=n},bodyImpulse:function(t){for(var n=0,e=this.dim;n<e;){var i=n++;this.J[i]=this.jAcc[i]}var r=p.geom.Vec3.get(0,0,0);return this.stepped&&this.outer_zn.__impulse(this.J,t.outer,r),r},activeBodies:function(){for(var t=0,n=this.bodies;t<n.length;){var e=n[t];++t,null!=e.body&&e.body.constraints.add(this)}},inactiveBodies:function(){for(var t=0,n=this.bodies;t<n.length;){var e=n[t];++t,null!=e.body&&e.body.constraints.remove(this)}},copy:function(t,n){var e=this.outer_zn.__copy();throw this.copyto(e),"not done yet"},validate:function(){for(var t=0,n=this.bodies;t<n.length;){var e=n[t];if(++t,e.body.space!=this.space)throw"Error: Constraints must have each body within the same sapce to which the constraint has been assigned"}this.outer_zn.__validate()},wake_connected:function(){for(var t=0,n=this.bodies;t<n.length;){var e=n[t];++t,e.body.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&e.body.wake()}},forest:function(){for(var t=0,n=this.bodies;t<n.length;){var e=n[t];if(++t,e.body.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var i;if(e.body.component==e.body.component.parent)i=e.body.component;else{for(var r=e.body.component,s=null;r!=r.parent;){var l=r.parent;r.parent=s,s=r,r=l}for(;null!=s;){var a=s.parent;s.parent=r,s=a}i=r}var p;if(this.component==this.component.parent)p=this.component;else{for(var _=this.component,h=null;_!=_.parent;){var u=_.parent;_.parent=h,h=_,_=u}for(;null!=h;){var d=h.parent;h.parent=_,h=d}p=_}i!=p&&(i.rank<p.rank?i.parent=p:i.rank>p.rank?p.parent=i:(p.parent=i,i.rank++))}}},pair_exists:function(t,n){for(var e=!1,i=0|this.bodies.length,r=0;r<i;){for(var s=r++,l=this.bodies[s].body,a=s+1;a<i;){var p=a++,o=this.bodies[p].body;if(l.id==t&&o.id==n||l.id==n&&o.id==t){e=!0;break}}if(e)break}return e},broken:function(){this.outer_zn.__broken()},clearcache:function(){for(var t=0,n=this.dim;t<n;){var e=t++;this.jAcc[e]=0}this.pre_dt=-1},lsq:function(t){for(var n=0,e=0,i=this.dim;e<i;){var r=e++;n+=t[r]*t[r]}return n},_clamp:function(t,n){var e=this.lsq(t);if(e>n*n)for(var i=n/Math.sqrt(e),r=0,s=this.dim;r<s;){var l=r++;t[l]*=i}},solve:function(t){for(var n=0,e=0,i=this.dim;e<i;){for(var r=e++,s=0,l=0,a=r-1;l<a;){var p=l++;s+=this.L[r*this.dim+p]*this.L[r*this.dim+p]}var o=Math.sqrt(t[n++]-s);if(this.L[r*this.dim+r]=o,0!=o){o=1/o;for(var _=r+1,h=this.dim;_<h;){for(var u=_++,d=0,c=0,P=r-1;c<P;){var f=c++;d+=this.L[u*this.dim+f]*this.L[r*this.dim+f]}this.L[u*this.dim+r]=o*(t[n++]-d)}}else{for(var z=r+1,v=this.dim;z<v;){var m=z++;this.L[m*this.dim+r]=0}n+=this.dim-r-1}}return this.L},transform:function(t,n){for(var e=0,i=this.dim;e<i;){var r=e++,s=n[r],l=t[r*this.dim+r];if(0!=l){for(var a=0;a<r;){var p=a++;s-=t[r*this.dim+p]*this.y[p]}this.y[r]=s/l}else this.y[r]=0}for(var o=0,_=this.dim;o<_;){var h=o++,u=this.dim-1-h,d=t[u*this.dim+u];if(0!=d){for(var c=this.y[u],P=u+1,f=this.dim;P<f;){var z=P++;c-=t[z*this.dim+u]*n[z]}n[u]=c/d}else n[u]=0}},preStep:function(t){-1==this.pre_dt&&(this.pre_dt=t);var n=t/this.pre_dt;if(this.pre_dt=t,this.stepped=!0,this.outer_zn.__prepare(),this.outer_zn.__eff_mass(this.Keff),this.L=this.solve(this.Keff),this.stiff||this.velonly){for(var e=0,i=this.dim;e<i;){var r=e++;this.bias[r]=0}this.gamma=0,this.soft=1}else{var s,l=2*Math.PI*this.frequency;this.gamma=1/(t*l*(2*this.damping+l*t));var a=1/(1+this.gamma);if(s=t*l*l*this.gamma,this.gamma*=a,this.soft=a,this.outer_zn.__position(this.bias),this.breakUnderError&&this.lsq(this.bias)>this.maxError*this.maxError)return!0;for(var p=0,o=this.dim;p<o;){var _=p++;this.bias[_]*=-s}this._clamp(this.bias,this.maxError)}for(var h=0,u=this.dim;h<u;){var d=h++;this.jAcc[d]*=n}return this.jMax=this.maxForce*t,!1},warmStart:function(){for(var t=0,n=this.bodies;t<n.length;){var e=n[t];++t;var i=e.body;this.outer_zn.__impulse(this.jAcc,i.outer,this.vec3);var r=i.imass;i.velx+=this.vec3.get_x()*r,i.vely+=this.vec3.get_y()*r,i.angvel+=this.vec3.get_z()*i.iinertia}},applyImpulseVel:function(){this.outer_zn.__velocity(this.J);for(var t=0,n=this.dim;t<n;){var e=t++;this.J[e]=this.bias[e]-this.J[e]}this.transform(this.L,this.J);for(var i=0,r=this.dim;i<r;){var s=i++;this.jOld[s]=this.jAcc[s],this.jAcc[s]+=this.J[s]=this.J[s]*this.soft-this.jAcc[s]*this.gamma}if(this.outer_zn.__clamp(this.jAcc),(this.breakUnderForce||!this.stiff)&&this.lsq(this.jAcc)>this.jMax*this.jMax){if(this.breakUnderForce)return!0;this.stiff||this._clamp(this.jAcc,this.jMax)}for(var l=0,a=this.dim;l<a;){var p=l++;this.J[p]=this.jAcc[p]-this.jOld[p]}for(var o=0,_=this.bodies;o<_.length;){var h=_[o];++o;var u=h.body;this.outer_zn.__impulse(this.J,u.outer,this.vec3);var d=u.imass;u.velx+=this.vec3.get_x()*d,u.vely+=this.vec3.get_y()*d,u.angvel+=this.vec3.get_z()*u.iinertia}return!1},applyImpulsePos:function(){if(this.velonly)return!1;this.outer_zn.__prepare(),this.outer_zn.__position(this.J);var t=this.lsq(this.J);if(this.breakUnderError&&t>this.maxError*this.maxError)return!0;if(t<p.Config.constraintLinearSlop*p.Config.constraintLinearSlop)return!1;for(var n=0,e=this.dim;n<e;){var i=n++;this.J[i]*=-1}this.outer_zn.__eff_mass(this.Keff),this.transform(this.solve(this.Keff),this.J),this.outer_zn.__clamp(this.J);for(var r=0,s=this.bodies;r<s.length;){var l=s[r];++r;var a=l.body;this.outer_zn.__impulse(this.J,a.outer,this.vec3);var o=a.imass;a.posx+=this.vec3.get_x()*o,a.posy+=this.vec3.get_y()*o,a.delta_rot(this.vec3.get_z()*a.iinertia)}return!1},draw:function(t){this.outer_zn.__draw(t)},__class__:o.constraint.ZPP_UserConstraint}),o.constraint.ZPP_UserBody=function(t,n){this.body=null,this.cnt=0,this.cnt=t,this.body=n},o.constraint.ZPP_UserBody.__name__=!0,o.constraint.ZPP_UserBody.prototype={__class__:o.constraint.ZPP_UserBody},o.constraint.ZPP_WeldJoint=function(){this.stepped=!1,this.biasz=0,this.biasy=0,this.biasx=0,this.gamma=0,this.jMax=0,this.jAccz=0,this.jAccy=0,this.jAccx=0,this.kMassf=0,this.kMasse=0,this.kMassc=0,this.kMassd=0,this.kMassb=0,this.kMassa=0,this.phase=0,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.b2=null,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.b1=null,this.outer_zn=null,o.constraint.ZPP_Constraint.call(this),this.phase=0,this.jAccx=0,this.jAccy=0,this.jAccz=0,this.jMax=Math.POSITIVE_INFINITY,this.stepped=!1,this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0},o.constraint.ZPP_WeldJoint.__name__=!0,o.constraint.ZPP_WeldJoint.__super__=o.constraint.ZPP_Constraint,o.constraint.ZPP_WeldJoint.prototype=t(o.constraint.ZPP_Constraint.prototype,{bodyImpulse:function(t){return this.stepped?t==this.b1?p.geom.Vec3.get(-this.jAccx,-this.jAccy,-(this.jAccy*this.a1relx-this.jAccx*this.a1rely+this.jAccz)):p.geom.Vec3.get(this.jAccx,this.jAccy,this.jAccy*this.a2relx-this.jAccx*this.a2rely+this.jAccz):p.geom.Vec3.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(t){this.immutable_midstep("Constraint::a1"),this.a1localx=t.x,this.a1localy=t.y,this.wake()},setup_a1:function(){this.wrap_a1=p.geom.Vec2.get(this.a1localx,this.a1localy,null),this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=n(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=n(this,this.invalidate_a1)},validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(t){this.immutable_midstep("Constraint::a2"),this.a2localx=t.x,this.a2localy=t.y,this.wake()},setup_a2:function(){this.wrap_a2=p.geom.Vec2.get(this.a2localx,this.a2localy,null),this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=n(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=n(this,this.invalidate_a2)},copy:function(t,n){var e=new p.constraint.PivotJoint(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2());if(this.copyto(e),null!=t&&null!=this.b1){for(var i=null,r=0;r<t.length;){var s=t[r];if(++r,s.id==this.b1.id){i=s.bc;break}}null!=i?e.zpp_inner_zn.b1=i.zpp_inner:n.push(o.constraint.ZPP_CopyHelper.todo(this.b1.id,function(t){e.zpp_inner_zn.b1=t.zpp_inner}))}if(null!=t&&null!=this.b2){for(var l=null,a=0;a<t.length;){var _=t[a];if(++a,_.id==this.b2.id){l=_.bc;break}}null!=l?e.zpp_inner_zn.b2=l.zpp_inner:n.push(o.constraint.ZPP_CopyHelper.todo(this.b2.id,function(t){e.zpp_inner_zn.b2=t.zpp_inner}))}return e},validate:function(){if(null==this.b1||null==this.b2)throw"Error: AngleJoint cannot be simulated null bodies";if(this.b1==this.b2)throw"Error: WeldJoint cannot be simulated with body1 == body2";if(this.b1.space!=this.space||this.b2.space!=this.space)throw"Error: Constraints must have each body within the same space to which the constraint has been assigned";if(this.b1.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b2.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC)throw"Error: Constraints cannot have both bodies non-dynamic"},wake_connected:function(){null!=this.b1&&this.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b1.wake(),null!=this.b2&&this.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b2.wake()},forest:function(){if(this.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var t;if(this.b1.component==this.b1.component.parent)t=this.b1.component;else{for(var n=this.b1.component,e=null;n!=n.parent;){var i=n.parent;n.parent=e,e=n,n=i}for(;null!=e;){var r=e.parent;e.parent=n,e=r}t=n}var s;if(this.component==this.component.parent)s=this.component;else{for(var l=this.component,a=null;l!=l.parent;){var p=l.parent;l.parent=a,a=l,l=p}for(;null!=a;){var _=a.parent;a.parent=l,a=_}s=l}t!=s&&(t.rank<s.rank?t.parent=s:t.rank>s.rank?s.parent=t:(s.parent=t,t.rank++))}if(this.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var h;if(this.b2.component==this.b2.component.parent)h=this.b2.component;else{for(var u=this.b2.component,d=null;u!=u.parent;){var c=u.parent;u.parent=d,d=u,u=c}for(;null!=d;){var P=d.parent;d.parent=u,d=P}h=u}var f;if(this.component==this.component.parent)f=this.component;else{for(var z=this.component,v=null;z!=z.parent;){var m=z.parent;z.parent=v,v=z,z=m}for(;null!=v;){var b=v.parent;v.parent=z,v=b}f=z}h!=f&&(h.rank<f.rank?h.parent=f:h.rank>f.rank?f.parent=h:(f.parent=h,h.rank++))}},pair_exists:function(t,n){return this.b1.id==t&&this.b2.id==n||this.b1.id==n&&this.b2.id==t},clearcache:function(){this.jAccx=0,this.jAccy=0,this.jAccz=0,this.pre_dt=-1},preStep:function(t){-1==this.pre_dt&&(this.pre_dt=t);var n=t/this.pre_dt;this.pre_dt=t,this.stepped=!0,this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var e=this.b1.smass+this.b2.smass;if(this.kMassa=e,this.kMassb=0,this.kMassd=e,this.kMassc=0,this.kMasse=0,this.kMassf=0,0!=this.b1.sinertia){var i=this.a1relx*this.b1.sinertia,r=this.a1rely*this.b1.sinertia;this.kMassa+=r*this.a1rely,this.kMassb+=-r*this.a1relx,this.kMassd+=i*this.a1relx,this.kMassc+=-r,this.kMasse+=i,this.kMassf+=this.b1.sinertia}if(0!=this.b2.sinertia){var s=this.a2relx*this.b2.sinertia,l=this.a2rely*this.b2.sinertia;this.kMassa+=l*this.a2rely,this.kMassb+=-l*this.a2relx,this.kMassd+=s*this.a2relx,this.kMassc+=-l,this.kMasse+=s,this.kMassf+=this.b2.sinertia}var a,p=this.kMassa*(this.kMassd*this.kMassf-this.kMasse*this.kMasse)+this.kMassb*(this.kMassc*this.kMasse-this.kMassb*this.kMassf)+this.kMassc*(this.kMassb*this.kMasse-this.kMassc*this.kMassd);if(p!=p)this.kMassa=0,this.kMassb=0,this.kMassd=0,this.kMassc=0,this.kMasse=0,this.kMassf=0,a=7;else if(0==p){var o=0;0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,o|=1),0!=this.kMassd?this.kMassd=1/this.kMassd:(this.kMassd=0,o|=2),0!=this.kMassf?this.kMassf=1/this.kMassf:(this.kMassf=0,o|=4),this.kMassb=this.kMassc=this.kMasse=0,a=o}else{p=1/p;var _=p*(this.kMassd*this.kMassf-this.kMasse*this.kMasse),h=p*(this.kMasse*this.kMassc-this.kMassb*this.kMassf),u=p*(this.kMassa*this.kMassf-this.kMassc*this.kMassc),d=p*(this.kMassb*this.kMasse-this.kMassc*this.kMassd),c=p*(this.kMassb*this.kMassc-this.kMassa*this.kMasse),P=p*(this.kMassa*this.kMassd-this.kMassb*this.kMassb);this.kMassa=_,this.kMassb=h,this.kMassd=u,this.kMassc=d,this.kMasse=c,this.kMassf=P,a=0}if(0!=(1&a)&&(this.jAccx=0),0!=(2&a)&&(this.jAccy=0),0!=(4&a)&&(this.jAccz=0),this.stiff)this.biasx=0,this.biasy=0,this.biasz=0,this.gamma=0;else{var f,z,v=2*Math.PI*this.frequency;this.gamma=1/(t*v*(2*this.damping+v*t));var m=1/(1+this.gamma);if(f=t*v*v*this.gamma,this.gamma*=m,z=m,this.kMassa*=z,this.kMassb*=z,this.kMassd*=z,this.kMassc*=z,this.kMasse*=z,this.kMassf*=z,this.biasx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),this.biasy=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),this.biasz=this.b2.rot-this.b1.rot-this.phase,this.breakUnderError&&this.biasx*this.biasx+this.biasy*this.biasy+this.biasz*this.biasz>this.maxError*this.maxError)return!0;var b=-f,y=b;this.biasx*=y,this.biasy*=y,this.biasz*=b;var g=this.maxError,x=this.biasx*this.biasx+this.biasy*this.biasy+this.biasz*this.biasz;if(x>g*g){var Z=g*(1/Math.sqrt(x)),w=Z;this.biasx*=w,this.biasy*=w,this.biasz*=Z}}var C=n,E=C;return this.jAccx*=E,this.jAccy*=E,this.jAccz*=C,this.jMax=this.maxForce*t,!1},warmStart:function(){var t=this.b1.imass;this.b1.velx-=this.jAccx*t,this.b1.vely-=this.jAccy*t;var n=this.b2.imass;this.b2.velx+=this.jAccx*n,this.b2.vely+=this.jAccy*n,this.b1.angvel-=(this.jAccy*this.a1relx-this.jAccx*this.a1rely+this.jAccz)*this.b1.iinertia,this.b2.angvel+=(this.jAccy*this.a2relx-this.jAccx*this.a2rely+this.jAccz)*this.b2.iinertia},applyImpulseVel:function(){var t=0,n=0,e=0;t=this.b2.velx+this.b2.kinvelx-this.a2rely*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.a1rely*(this.b1.angvel+this.b1.kinangvel)),n=this.b2.vely+this.b2.kinvely+this.a2relx*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.a1relx*(this.b1.angvel+this.b1.kinangvel)),e=this.b2.angvel+this.b2.kinangvel-this.b1.angvel-this.b1.kinangvel;var i=0,r=0,s=0;i=this.biasx-t,r=this.biasy-n,s=this.biasz-e;var l=this.kMassa*i+this.kMassb*r+this.kMassc*s,a=this.kMassb*i+this.kMassd*r+this.kMasse*s;s=this.kMassc*i+this.kMasse*r+this.kMassf*s,i=l,r=a;var p=this.gamma,o=p;i-=this.jAccx*o,r-=this.jAccy*o,s-=this.jAccz*p;var _=0,h=0,u=0;_=this.jAccx,h=this.jAccy,u=this.jAccz;if(this.jAccx+=1*i,this.jAccy+=1*r,this.jAccz+=1*s,this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy+this.jAccz*this.jAccz>this.jMax*this.jMax)return!0}else if(!this.stiff){var d=this.jMax,c=this.jAccx*this.jAccx+this.jAccy*this.jAccy+this.jAccz*this.jAccz;if(c>d*d){var P=d*(1/Math.sqrt(c)),f=P;this.jAccx*=f,this.jAccy*=f,this.jAccz*=P}}i=this.jAccx-_,r=this.jAccy-h,s=this.jAccz-u;var z=this.b1.imass;this.b1.velx-=i*z,this.b1.vely-=r*z;var v=this.b2.imass;return this.b2.velx+=i*v,this.b2.vely+=r*v,this.b1.angvel-=(r*this.a1relx-i*this.a1rely+s)*this.b1.iinertia,this.b2.angvel+=(r*this.a2relx-i*this.a2rely+s)*this.b2.iinertia,!1},applyImpulsePos:function(){var t=0,n=0;t=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,n=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy;var e=0,i=0;e=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,i=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var r=0,s=0,l=0;r=this.b2.posx+e-(this.b1.posx+t),s=this.b2.posy+i-(this.b1.posy+n),l=this.b2.rot-this.b1.rot-this.phase;var a=0,_=0,h=0;if(this.breakUnderError&&r*r+s*s+l*l>this.maxError*this.maxError)return!0;var u=!0;if(r*r+s*s<p.Config.constraintLinearSlop*p.Config.constraintLinearSlop&&(u=!1,r=0,s=0),l*l<o.util.ZPP_Math.sqr(p.Config.constraintAngularSlop)){if(!u)return!1;l=0}if(r*=.5,s*=.5,l*=.5,r*r+s*s>6){var d=this.b1.smass+this.b2.smass;if(d>p.Config.epsilon){d=.75/d,a=-r*d,_=-s*d;var c=a*a+_*_;if(c>400){var P=1/Math.sqrt(c)*20;a*=P,_*=P}var f=this.b1.imass;this.b1.posx-=a*f,this.b1.posy-=_*f;var z=this.b2.imass;this.b2.posx+=a*z,this.b2.posy+=_*z,r=this.b2.posx+e-(this.b1.posx+t),s=this.b2.posy+i-(this.b1.posy+n),l=this.b2.rot-this.b1.rot-this.phase;r*=.5,s*=.5,l*=.5}}var v=0,m=0,b=0,y=0,g=0,x=0,Z=this.b1.smass+this.b2.smass;if(v=Z,m=0,b=Z,y=0,g=0,x=0,0!=this.b1.sinertia){var w=t*this.b1.sinertia,C=n*this.b1.sinertia;v+=C*n,m+=-C*t,b+=w*t,y+=-C,g+=w,x+=this.b1.sinertia}if(0!=this.b2.sinertia){var E=e*this.b2.sinertia,S=i*this.b2.sinertia;v+=S*i,m+=-S*e,
b+=E*e,y+=-S,g+=E,x+=this.b2.sinertia}a=-r,_=-s,h=-l;var N=a*a+_*_;if(N>36){var k=1/Math.sqrt(N)*6;a*=k,_*=k}o.util.ZPP_Math.clamp(h,-.25,.25);var M=v*(b*x-g*g)+m*(y*g-m*x)+y*(m*g-y*b);if(M!=M)a=_=h=0;else if(0==M)0!=v?a/=v:a=0,0!=b?_/=b:_=0,0!=x?h/=x:h=0;else{M=1/M;var I=g*y-m*x,F=m*g-y*b,A=m*y-v*g,T=M*(a*(b*x-g*g)+_*I+h*F),V=M*(a*I+_*(v*x-y*y)+h*A);h=M*(a*F+_*A+h*(v*b-m*m)),a=T,_=V}var L=this.b1.imass;this.b1.posx-=a*L,this.b1.posy-=_*L;var B=this.b2.imass;return this.b2.posx+=a*B,this.b2.posy+=_*B,this.b1.delta_rot(-(_*t-a*n+h)*this.b1.iinertia),this.b2.delta_rot((_*e-a*i+h)*this.b2.iinertia),!1},draw:function(t){},__class__:o.constraint.ZPP_WeldJoint}),o.dynamics={},o.dynamics.ZPP_Arbiter=function(){this.sensorarb=null,this.fluidarb=null,this.colarb=null,this.type=0,this.pair=null,this.ws2=null,this.ws1=null,this.b2=null,this.b1=null,this.invalidated=!1,this.immState=0,this.fresh=!1,this.continuous=!1,this.presentable=!1,this.intchange=!1,this.present=0,this.sleeping=!1,this.cleared=!1,this.active=!1,this.endGenerated=0,this.sleep_stamp=0,this.up_stamp=0,this.stamp=0,this.di=0,this.id=0,this.hnext=null,this.outer=null},o.dynamics.ZPP_Arbiter.__name__=!0,o.dynamics.ZPP_Arbiter.prototype={wrapper:function(){return null==this.outer&&(o.dynamics.ZPP_Arbiter.internal=!0,this.type==o.dynamics.ZPP_Arbiter.COL?(this.colarb.outer_zn=new p.dynamics.CollisionArbiter,this.outer=this.colarb.outer_zn):this.type==o.dynamics.ZPP_Arbiter.FLUID?(this.fluidarb.outer_zn=new p.dynamics.FluidArbiter,this.outer=this.fluidarb.outer_zn):this.outer=new p.dynamics.Arbiter,this.outer.zpp_inner=this,o.dynamics.ZPP_Arbiter.internal=!1),this.outer},inactiveme:function(){return!this.active},acting:function(){return this.active&&0!=(this.immState&o.util.ZPP_Flags.id_ImmState_ACCEPT)},swap_features:function(){var t=this.b1;this.b1=this.b2,this.b2=t;var n=this.ws1;this.ws1=this.ws2,this.ws2=n;var e=this.colarb.s1;this.colarb.s1=this.colarb.s2,this.colarb.s2=e},lazyRetire:function(t,n){this.cleared=!0,null!=n&&this.b2!=n||this.b1.arbiters.inlined_try_remove(this),null!=n&&this.b1!=n||this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair.arb=null,this.pair=null),this.active=!1,t.f_arbiters.modified=!0},sup_assign:function(t,n,e,i){this.b1=t.body,this.ws1=t,this.b2=n.body,this.ws2=n,this.id=e,this.di=i,this.b1.arbiters.inlined_add(this),this.b2.arbiters.inlined_add(this),this.active=!0,this.present=0,this.cleared=!1,this.sleeping=!1,this.fresh=!1,this.presentable=!1},sup_retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair.arb=null,this.pair=null)),this.b1=this.b2=null,this.active=!1,this.intchange=!1},__class__:o.dynamics.ZPP_Arbiter},o.dynamics.ZPP_SensorArbiter=function(){this.next=null,o.dynamics.ZPP_Arbiter.call(this),this.type=o.dynamics.ZPP_Arbiter.SENSOR,this.sensorarb=this},o.dynamics.ZPP_SensorArbiter.__name__=!0,o.dynamics.ZPP_SensorArbiter.__super__=o.dynamics.ZPP_Arbiter,o.dynamics.ZPP_SensorArbiter.prototype=t(o.dynamics.ZPP_Arbiter.prototype,{alloc:function(){},free:function(){},assign:function(t,n,e,i){this.b1=t.body,this.ws1=t,this.b2=n.body,this.ws2=n,this.id=e,this.di=i,this.b1.arbiters.inlined_add(this),this.b2.arbiters.inlined_add(this),this.active=!0,this.present=0,this.cleared=!1,this.sleeping=!1,this.fresh=!1,this.presentable=!1},retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair.arb=null,this.pair=null)),this.b1=this.b2=null,this.active=!1,this.intchange=!1;var t=this;t.next=o.dynamics.ZPP_SensorArbiter.zpp_pool,o.dynamics.ZPP_SensorArbiter.zpp_pool=t},makemutable:function(){},makeimmutable:function(){},__class__:o.dynamics.ZPP_SensorArbiter}),o.dynamics.ZPP_FluidArbiter=function(){this.pre_dt=0,this.mutable=!1,this.wrap_position=null,this.buoyy=0,this.buoyx=0,this.ny=0,this.nx=0,this.lgamma=0,this.dampy=0,this.dampx=0,this.vMassc=0,this.vMassb=0,this.vMassa=0,this.agamma=0,this.adamp=0,this.wMass=0,this.nodrag=!1,this.r2y=0,this.r2x=0,this.r1y=0,this.r1x=0,this.overlap=0,this.centroidy=0,this.centroidx=0,this.next=null,this.outer_zn=null,o.dynamics.ZPP_Arbiter.call(this),this.type=o.dynamics.ZPP_Arbiter.FLUID,this.fluidarb=this,this.buoyx=0,this.buoyy=0,this.pre_dt=-1},o.dynamics.ZPP_FluidArbiter.__name__=!0,o.dynamics.ZPP_FluidArbiter.__super__=o.dynamics.ZPP_Arbiter,o.dynamics.ZPP_FluidArbiter.prototype=t(o.dynamics.ZPP_Arbiter.prototype,{alloc:function(){},free:function(){},position_validate:function(){if(!this.active)throw"Error: Arbiter not currently in use";this.wrap_position.zpp_inner.x=this.centroidx,this.wrap_position.zpp_inner.y=this.centroidy},position_invalidate:function(t){this.centroidx=t.x,this.centroidy=t.y},getposition:function(){this.wrap_position=p.geom.Vec2.get(null,null,null),this.wrap_position.zpp_inner._inuse=!0,this.wrap_position.zpp_inner._immutable=!this.mutable,this.wrap_position.zpp_inner._validate=n(this,this.position_validate),this.wrap_position.zpp_inner._invalidate=n(this,this.position_invalidate)},assign:function(t,n,e,i){this.b1=t.body,this.ws1=t,this.b2=n.body,this.ws2=n,this.id=e,this.di=i,this.b1.arbiters.inlined_add(this),this.b2.arbiters.inlined_add(this),this.active=!0,this.present=0,this.cleared=!1,this.sleeping=!1,this.fresh=!1,this.presentable=!1,this.nx=0,this.ny=1,this.dampx=0,this.dampy=0,this.adamp=0},retire:function(){this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair.arb=null,this.pair=null)),this.b1=this.b2=null,this.active=!1,this.intchange=!1;var t=this;t.next=o.dynamics.ZPP_FluidArbiter.zpp_pool,o.dynamics.ZPP_FluidArbiter.zpp_pool=t,this.pre_dt=-1},makemutable:function(){this.mutable=!0,null!=this.wrap_position&&(this.wrap_position.zpp_inner._immutable=!1)},makeimmutable:function(){this.mutable=!1,null!=this.wrap_position&&(this.wrap_position.zpp_inner._immutable=!0)},inject:function(t,n,e){this.overlap=t,this.centroidx=n,this.centroidy=e},preStep:function(t,n){-1==this.pre_dt&&(this.pre_dt=n);var e=n/this.pre_dt;this.pre_dt=n,this.r1x=this.centroidx-this.b1.posx,this.r1y=this.centroidy-this.b1.posy,this.r2x=this.centroidx-this.b2.posx,this.r2y=this.centroidy-this.b2.posy;var i=0,r=0;this.ws1.fluidEnabled&&null!=this.ws1.fluidProperties.wrap_gravity?(i=this.ws1.fluidProperties.gravityx,r=this.ws1.fluidProperties.gravityy):(i=t.gravityx,r=t.gravityy);var s=0,l=0;this.ws2.fluidEnabled&&null!=this.ws2.fluidProperties.wrap_gravity?(s=this.ws2.fluidProperties.gravityx,l=this.ws2.fluidProperties.gravityy):(s=t.gravityx,l=t.gravityy);var a=0,_=0;if(this.ws1.fluidEnabled&&this.ws2.fluidEnabled){var h=this.overlap*this.ws1.fluidProperties.density,u=this.overlap*this.ws2.fluidProperties.density;if(h>u){var d=h+u;a-=i*d,_-=r*d}else if(h<u){var c=h+u;a+=s*c,_+=l*c}else{var P=0,f=0;P=i+s,f=r+l;if(P*=.5,f*=.5,this.ws1.worldCOMx*P+this.ws1.worldCOMy*f>this.ws2.worldCOMx*P+this.ws2.worldCOMy*f){var z=h+u;a-=P*z,_-=f*z}else{var v=h+u;a+=P*v,_+=f*v}}}else if(this.ws1.fluidEnabled){var m=this.overlap*this.ws1.fluidProperties.density,b=m;a-=i*b,_-=r*b}else if(this.ws2.fluidEnabled){var y=this.overlap*this.ws2.fluidProperties.density,g=y;a+=s*g,_+=l*g}var x=n;if(a*=x,_*=x,this.buoyx=a,this.buoyy=_,this.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var Z=this.b1.imass;this.b1.velx-=a*Z,this.b1.vely-=_*Z,this.b1.angvel-=(_*this.r1x-a*this.r1y)*this.b1.iinertia}if(this.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var w=this.b2.imass;this.b2.velx+=a*w,this.b2.vely+=_*w,this.b2.angvel+=(_*this.r2x-a*this.r2y)*this.b2.iinertia}if(this.ws1.fluidEnabled&&0!=this.ws1.fluidProperties.viscosity||this.ws2.fluidEnabled&&0!=this.ws2.fluidProperties.viscosity){this.nodrag=!1;var C=0;if(this.ws1.fluidEnabled&&(this.ws2.validate_angDrag(),C+=this.ws1.fluidProperties.viscosity*this.ws2.angDrag*this.overlap/this.ws2.area),this.ws2.fluidEnabled&&(this.ws1.validate_angDrag(),C+=this.ws2.fluidProperties.viscosity*this.ws1.angDrag*this.overlap/this.ws1.area),0!=C){var E=this.b1.sinertia+this.b2.sinertia;this.wMass=0!=E?1/E:0;C*=4e-4;var S=2*Math.PI*C;this.agamma=1/(n*S*(2+S*n));var N=1/(1+this.agamma);n*S*S*this.agamma,this.agamma*=N,this.wMass*=N}else this.wMass=0,this.agamma=0;var k=this.b2.velx+this.b2.kinvelx-this.r2y*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.r1y*(this.b2.angvel+this.b2.kinangvel)),M=this.b2.vely+this.b2.kinvely+this.r2x*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.r1x*(this.b1.angvel+this.b1.kinangvel));if(k*k+M*M<p.Config.epsilon*p.Config.epsilon);else{var I=k*k+M*M,F=1/Math.sqrt(I),A=F;k*=A,M*=A,this.nx=k,this.ny=M}var T=0;if(this.ws1.fluidEnabled){var V=-this.ws1.fluidProperties.viscosity*this.overlap/this.ws2.area;if(this.ws2.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE)T-=V*this.ws2.circle.radius*p.Config.fluidLinearDrag/(2*this.ws2.circle.radius*Math.PI);else{for(var L=this.ws2.polygon,B=0,O=0,G=L.edges.head;null!=G;){var R=G.elt;B+=R.length;var D=V*R.length*(R.gnormx*this.nx+R.gnormy*this.ny);D>0&&(D=D*=-p.Config.fluidVacuumDrag),O-=.5*D*p.Config.fluidLinearDrag,G=G.next}T+=O/B}}if(this.ws2.fluidEnabled){var j=-this.ws2.fluidProperties.viscosity*this.overlap/this.ws1.area;if(this.ws1.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE)T-=j*this.ws1.circle.radius*p.Config.fluidLinearDrag/(2*this.ws1.circle.radius*Math.PI);else{for(var q=this.ws1.polygon,Y=0,U=0,W=q.edges.head;null!=W;){var J=W.elt;Y+=J.length;var K=j*J.length*(J.gnormx*this.nx+J.gnormy*this.ny);K>0&&(K=K*=-p.Config.fluidVacuumDrag),U-=.5*K*p.Config.fluidLinearDrag,W=W.next}T+=U/Y}}if(0!=T){var H=this.b1.smass+this.b2.smass,X=0,Q=0,$=0;if(X=H,Q=0,$=H,0!=this.b1.sinertia){var tt=this.r1x*this.b1.sinertia,nt=this.r1y*this.b1.sinertia;X+=nt*this.r1y,Q+=-nt*this.r1x,$+=tt*this.r1x}if(0!=this.b2.sinertia){var et=this.r2x*this.b2.sinertia,it=this.r2y*this.b2.sinertia;X+=it*this.r2y,Q+=-it*this.r2x,$+=et*this.r2x}var rt=X*$-Q*Q;if(rt!=rt)X=Q=$=0;else if(0==rt){var st=0;0!=X?X=1/X:(X=0,st|=1),0!=$?$=1/$:($=0,st|=2),Q=0}else{rt=1/rt;var lt=$*rt;$=X*rt,X=lt,Q*=-rt}this.vMassa=X,this.vMassb=Q,this.vMassc=$;var at,pt=2*Math.PI*T;this.lgamma=1/(n*pt*(2+pt*n));var ot=1/(1+this.lgamma);n*pt*pt*this.lgamma,this.lgamma*=ot,at=ot,this.vMassa*=at,this.vMassb*=at,this.vMassc*=at}else this.vMassa=0,this.vMassb=0,this.vMassc=0,this.lgamma=0}else this.nodrag=!0,this.dampx=0,this.dampy=0,this.adamp=0;var _t=e;this.dampx*=_t,this.dampy*=_t,this.adamp*=e},warmStart:function(){var t=this.b1.imass;this.b1.velx-=this.dampx*t,this.b1.vely-=this.dampy*t;var n=this.b2.imass;this.b2.velx+=this.dampx*n,this.b2.vely+=this.dampy*n,this.b1.angvel-=this.b1.iinertia*(this.dampy*this.r1x-this.dampx*this.r1y),this.b2.angvel+=this.b2.iinertia*(this.dampy*this.r2x-this.dampx*this.r2y),this.b1.angvel-=this.adamp*this.b1.iinertia,this.b2.angvel+=this.adamp*this.b2.iinertia},applyImpulseVel:function(){if(!this.nodrag){var t=this.b1.angvel+this.b1.kinangvel,n=this.b2.angvel+this.b2.kinangvel,e=this.b1.velx+this.b1.kinvelx-this.r1y*t-(this.b2.velx+this.b2.kinvelx-this.r2y*n),i=this.b1.vely+this.b1.kinvely+this.r1x*t-(this.b2.vely+this.b2.kinvely+this.r2x*n),r=this.vMassa*e+this.vMassb*i;i=this.vMassb*e+this.vMassc*i,e=r;var s=this.lgamma;e-=this.dampx*s,i-=this.dampy*s;this.dampx+=1*e,this.dampy+=1*i;var l=this.b1.imass;this.b1.velx-=e*l,this.b1.vely-=i*l;var a=this.b2.imass;this.b2.velx+=e*a,this.b2.vely+=i*a,this.b1.angvel-=this.b1.iinertia*(i*this.r1x-e*this.r1y),this.b2.angvel+=this.b2.iinertia*(i*this.r2x-e*this.r2y);var p=(t-n)*this.wMass-this.adamp*this.agamma;this.adamp+=p,this.b1.angvel-=p*this.b1.iinertia,this.b2.angvel+=p*this.b2.iinertia}},__class__:o.dynamics.ZPP_FluidArbiter}),o.dynamics.ZPP_ColArbiter=function(){this.pre_dt=0,this.mutable=!1,this.stat=!1,this.next=null,this.hpc2=!1,this.hc2=!1,this.oc2=null,this.c2=null,this.oc1=null,this.c1=null,this.__ref_vertex=0,this.__ref_edge2=null,this.__ref_edge1=null,this.biasCoef=0,this.rev=!1,this.radius=0,this.lproj=0,this.lnormy=0,this.lnormx=0,this.surfacey=0,this.surfacex=0,this.k2y=0,this.k2x=0,this.k1y=0,this.k1x=0,this.rt2b=0,this.rn2b=0,this.rt2a=0,this.rn2a=0,this.rt1b=0,this.rn1b=0,this.rt1a=0,this.rn1a=0,this.jrAcc=0,this.rMass=0,this.Kc=0,this.Kb=0,this.Ka=0,this.kMassc=0,this.kMassb=0,this.kMassa=0,this.wrap_normal=null,this.ny=0,this.nx=0,this.innards=null,this.wrap_contacts=null,this.contacts=null,this.s2=null,this.s1=null,this.userdef_rfric=!1,this.userdef_restitution=!1,this.userdef_stat_fric=!1,this.userdef_dyn_fric=!1,this.rfric=0,this.restitution=0,this.stat_fric=0,this.dyn_fric=0,this.outer_zn=null,o.dynamics.ZPP_Arbiter.call(this),this.pre_dt=-1,this.contacts=new o.dynamics.ZPP_Contact,this.innards=new o.dynamics.ZPP_IContact,this.type=o.dynamics.ZPP_Arbiter.COL,this.colarb=this},o.dynamics.ZPP_ColArbiter.__name__=!0,o.dynamics.ZPP_ColArbiter.__super__=o.dynamics.ZPP_Arbiter,o.dynamics.ZPP_ColArbiter.prototype=t(o.dynamics.ZPP_Arbiter.prototype,{normal_validate:function(){if(this.cleared)throw"Error: Arbiter not currently in use";this.wrap_normal.zpp_inner.x=this.nx,this.wrap_normal.zpp_inner.y=this.ny,this.ws1.id>this.ws2.id&&(this.wrap_normal.zpp_inner.x=-this.wrap_normal.zpp_inner.x,this.wrap_normal.zpp_inner.y=-this.wrap_normal.zpp_inner.y)},getnormal:function(){this.wrap_normal=p.geom.Vec2.get(0,0,null),this.wrap_normal.zpp_inner._immutable=!0,this.wrap_normal.zpp_inner._inuse=!0,this.wrap_normal.zpp_inner._validate=n(this,this.normal_validate)},alloc:function(){},free:function(){this.userdef_dyn_fric=!1,this.userdef_stat_fric=!1,this.userdef_restitution=!1,this.userdef_rfric=!1,this.__ref_edge1=this.__ref_edge2=null},injectContact:function(t,n,e,i,r,s,l){null==l&&(l=!1);for(var a=null,p=this.contacts.next;null!=p;){var _=p;if(s==_.hash){a=_;break}p=p.next}if(null==a){null==o.dynamics.ZPP_Contact.zpp_pool?a=new o.dynamics.ZPP_Contact:(a=o.dynamics.ZPP_Contact.zpp_pool,o.dynamics.ZPP_Contact.zpp_pool=a.next,a.next=null);var h=a.inner;h.jnAcc=h.jtAcc=0,a.hash=s,a.fresh=!0,a.arbiter=this,this.jrAcc=0,this.contacts.inlined_add(a),this.innards.add(h)}else a.fresh=!1;return a.px=t,a.py=n,this.nx=e,this.ny=i,a.dist=r,a.stamp=this.stamp,a.posOnly=l,a},assign:function(t,n,e,i){this.b1=t.body,this.ws1=t,this.b2=n.body,this.ws2=n,this.id=e,this.di=i,this.b1.arbiters.inlined_add(this),this.b2.arbiters.inlined_add(this),this.active=!0,this.present=0,this.cleared=!1,this.sleeping=!1,this.fresh=!1,this.presentable=!1,this.s1=t,this.s2=n,this.userdef_restitution||(this.s1.material.elasticity<=Math.NEGATIVE_INFINITY||this.s2.material.elasticity<=Math.NEGATIVE_INFINITY?this.restitution=0:this.s1.material.elasticity>=Math.POSITIVE_INFINITY||this.s2.material.elasticity>=Math.POSITIVE_INFINITY?this.restitution=1:this.restitution=(this.s1.material.elasticity+this.s2.material.elasticity)/2,this.restitution<0&&(this.restitution=0),this.restitution>1&&(this.restitution=1)),this.userdef_dyn_fric||(this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)),this.userdef_stat_fric||(this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)),this.userdef_rfric||(this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction))},calcProperties:function(){this.userdef_restitution||(this.s1.material.elasticity<=Math.NEGATIVE_INFINITY||this.s2.material.elasticity<=Math.NEGATIVE_INFINITY?this.restitution=0:this.s1.material.elasticity>=Math.POSITIVE_INFINITY||this.s2.material.elasticity>=Math.POSITIVE_INFINITY?this.restitution=1:this.restitution=(this.s1.material.elasticity+this.s2.material.elasticity)/2,this.restitution<0&&(this.restitution=0),this.restitution>1&&(this.restitution=1)),this.userdef_dyn_fric||(this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)),this.userdef_stat_fric||(this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)),this.userdef_rfric||(this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction))},validate_props:function(){this.invalidated&&(this.invalidated=!1,this.userdef_restitution||(this.s1.material.elasticity<=Math.NEGATIVE_INFINITY||this.s2.material.elasticity<=Math.NEGATIVE_INFINITY?this.restitution=0:this.s1.material.elasticity>=Math.POSITIVE_INFINITY||this.s2.material.elasticity>=Math.POSITIVE_INFINITY?this.restitution=1:this.restitution=(this.s1.material.elasticity+this.s2.material.elasticity)/2,this.restitution<0&&(this.restitution=0),this.restitution>1&&(this.restitution=1)),this.userdef_dyn_fric||(this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)),this.userdef_stat_fric||(this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)),this.userdef_rfric||(this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction)))},retire:function(){for(this.cleared||(this.b1.arbiters.inlined_try_remove(this),this.b2.arbiters.inlined_try_remove(this),null!=this.pair&&(this.pair.arb=null,this.pair=null)),this.b1=this.b2=null,this.active=!1,this.intchange=!1;null!=this.contacts.next;){var t=this.contacts.inlined_pop_unsafe();t.arbiter=null,t.next=o.dynamics.ZPP_Contact.zpp_pool,o.dynamics.ZPP_Contact.zpp_pool=t,this.innards.inlined_pop()}var n=this;n.userdef_dyn_fric=!1,n.userdef_stat_fric=!1,n.userdef_restitution=!1,n.userdef_rfric=!1,n.__ref_edge1=n.__ref_edge2=null,n.next=o.dynamics.ZPP_ColArbiter.zpp_pool,o.dynamics.ZPP_ColArbiter.zpp_pool=n,this.pre_dt=-1},makemutable:function(){this.mutable=!0,null!=this.wrap_normal&&(this.wrap_normal.zpp_inner._immutable=!1),null!=this.wrap_contacts&&(this.wrap_contacts.zpp_inner.immutable=!1)},makeimmutable:function(){this.mutable=!1,null!=this.wrap_normal&&(this.wrap_normal.zpp_inner._immutable=!0),null!=this.wrap_contacts&&(this.wrap_contacts.zpp_inner.immutable=!0)},contacts_adder:function(t){throw"Error: Cannot add new contacts, information required is far too specific and detailed :)"},contacts_subber:function(t){for(var n=null,e=null,i=this.innards.next,r=this.contacts.next;null!=r;){var s=r;if(s==t.zpp_inner){this.contacts.erase(n),this.innards.erase(e);var l=s;l.arbiter=null,l.next=o.dynamics.ZPP_Contact.zpp_pool,o.dynamics.ZPP_Contact.zpp_pool=l;break}n=r,e=i,i=i.next,r=r.next}},setupcontacts:function(){this.wrap_contacts=o.util.ZPP_ContactList.get(this.contacts,!0),this.wrap_contacts.zpp_inner.immutable=!this.mutable,this.wrap_contacts.zpp_inner.adder=n(this,this.contacts_adder),this.wrap_contacts.zpp_inner.dontremove=!0,this.wrap_contacts.zpp_inner.subber=n(this,this.contacts_subber)},cleanupContacts:function(){var t=!0,n=null,e=null,i=this.innards.next;this.hc2=!1;for(var r=this.contacts.next;null!=r;){var s=r;if(s.stamp+p.Config.arbiterExpirationDelay<this.stamp){r=this.contacts.inlined_erase(n),i=this.innards.inlined_erase(e);var l=s;l.arbiter=null,l.next=o.dynamics.ZPP_Contact.zpp_pool,o.dynamics.ZPP_Contact.zpp_pool=l}else{var a=s.inner,_=s.active;s.active=s.stamp==this.stamp,s.active&&(t?(t=!1,this.c1=a,this.oc1=s):(this.hc2=!0,this.c2=a,this.oc2=s)),_!=s.active&&(this.contacts.modified=!0),n=r,e=i,i=i.next,r=r.next}}if(this.hc2){if(this.hpc2=!0,this.oc1.posOnly){var h=this.c1;this.c1=this.c2,this.c2=h;var u=this.oc1;this.oc1=this.oc2,this.oc2=u,this.hc2=!1}else this.oc2.posOnly&&(this.hc2=!1);this.oc1.posOnly&&(t=!0)}else this.hpc2=!1;return t},preStep:function(t){this.invalidated&&(this.invalidated=!1,this.userdef_restitution||(this.s1.material.elasticity<=Math.NEGATIVE_INFINITY||this.s2.material.elasticity<=Math.NEGATIVE_INFINITY?this.restitution=0:this.s1.material.elasticity>=Math.POSITIVE_INFINITY||this.s2.material.elasticity>=Math.POSITIVE_INFINITY?this.restitution=1:this.restitution=(this.s1.material.elasticity+this.s2.material.elasticity)/2,this.restitution<0&&(this.restitution=0),this.restitution>1&&(this.restitution=1)),this.userdef_dyn_fric||(this.dyn_fric=Math.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)),this.userdef_stat_fric||(this.stat_fric=Math.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)),this.userdef_rfric||(this.rfric=Math.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction))),-1==this.pre_dt&&(this.pre_dt=t);var n=t/this.pre_dt;this.pre_dt=t;var e=this.b1.smass+this.b2.smass;this.hc2=!1;var i,r=!0,s=!(this.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&this.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC);i=s?this.continuous?p.Config.contactContinuousStaticBiasCoef:p.Config.contactStaticBiasCoef:this.continuous?p.Config.contactContinuousBiasCoef:p.Config.contactBiasCoef,this.biasCoef=i,this.continuous=!1;for(var l=null,a=null,_=this.innards.next,h=this.contacts.next;null!=h;){var u=h;if(u.stamp+p.Config.arbiterExpirationDelay<this.stamp){h=this.contacts.inlined_erase(l),_=this.innards.inlined_erase(a);var d=u;d.arbiter=null,d.next=o.dynamics.ZPP_Contact.zpp_pool,o.dynamics.ZPP_Contact.zpp_pool=d}else{var c=u.inner,P=u.active;if(u.active=u.stamp==this.stamp,u.active){r?(r=!1,this.c1=c,this.oc1=u):(this.hc2=!0,this.c2=c,this.oc2=u),c.r2x=u.px-this.b2.posx,c.r2y=u.py-this.b2.posy,c.r1x=u.px-this.b1.posx,c.r1y=u.py-this.b1.posy;var f=e+this.b2.sinertia*o.util.ZPP_Math.sqr(c.r2x*this.nx+c.r2y*this.ny);f+=this.b1.sinertia*o.util.ZPP_Math.sqr(c.r1x*this.nx+c.r1y*this.ny),f<p.Config.epsilon*p.Config.epsilon?c.tMass=0:c.tMass=1/f;var z=e+this.b2.sinertia*o.util.ZPP_Math.sqr(this.ny*c.r2x-this.nx*c.r2y);z+=this.b1.sinertia*o.util.ZPP_Math.sqr(this.ny*c.r1x-this.nx*c.r1y),z<p.Config.epsilon*p.Config.epsilon?c.nMass=0:c.nMass=1/z;var v=0,m=0,b=this.b2.angvel+this.b2.kinangvel;v=this.b2.velx+this.b2.kinvelx-c.r2y*b,m=this.b2.vely+this.b2.kinvely+c.r2x*b,b=this.b1.angvel+this.b1.kinangvel,v-=this.b1.velx+this.b1.kinvelx-c.r1y*b,m-=this.b1.vely+this.b1.kinvely+c.r1x*b;var y=this.nx*v+this.ny*m;u.elasticity=this.restitution,c.bounce=y*u.elasticity,c.bounce>-p.Config.elasticThreshold&&(c.bounce=0),y=m*this.nx-v*this.ny;var g=p.Config.staticFrictionThreshold;c.friction=y*y>g*g?this.dyn_fric:this.stat_fric,c.jnAcc*=n,c.jtAcc*=n}P!=u.active&&(this.contacts.modified=!0),l=h,a=_,_=_.next,h=h.next}}if(this.hc2){if(this.hpc2=!0,this.oc1.posOnly){var x=this.c1;this.c1=this.c2,this.c2=x;var Z=this.oc1;this.oc1=this.oc2,this.oc2=Z,this.hc2=!1}else this.oc2.posOnly&&(this.hc2=!1);this.oc1.posOnly&&(r=!0)}else this.hpc2=!1;if(this.jrAcc*=n,r||(this.rn1a=this.ny*this.c1.r1x-this.nx*this.c1.r1y,this.rt1a=this.c1.r1x*this.nx+this.c1.r1y*this.ny,this.rn1b=this.ny*this.c1.r2x-this.nx*this.c1.r2y,this.rt1b=this.c1.r2x*this.nx+this.c1.r2y*this.ny,this.k1x=this.b2.kinvelx-this.c1.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c1.r1y*this.b1.kinangvel),this.k1y=this.b2.kinvely+this.c1.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c1.r1x*this.b1.kinangvel)),this.hc2){this.rn2a=this.ny*this.c2.r1x-this.nx*this.c2.r1y,this.rt2a=this.c2.r1x*this.nx+this.c2.r1y*this.ny,this.rn2b=this.ny*this.c2.r2x-this.nx*this.c2.r2y,this.rt2b=this.c2.r2x*this.nx+this.c2.r2y*this.ny,this.k2x=this.b2.kinvelx-this.c2.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c2.r1y*this.b1.kinangvel),this.k2y=this.b2.kinvely+this.c2.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c2.r1x*this.b1.kinangvel),this.kMassa=e+this.b1.sinertia*this.rn1a*this.rn1a+this.b2.sinertia*this.rn1b*this.rn1b,this.kMassb=e+this.b1.sinertia*this.rn1a*this.rn2a+this.b2.sinertia*this.rn1b*this.rn2b,this.kMassc=e+this.b1.sinertia*this.rn2a*this.rn2a+this.b2.sinertia*this.rn2b*this.rn2b;if(this.kMassa*this.kMassa+2*this.kMassb*this.kMassb+this.kMassc*this.kMassc<p.Config.illConditionedThreshold*(this.kMassa*this.kMassc-this.kMassb*this.kMassb)){this.Ka=this.kMassa,this.Kb=this.kMassb,this.Kc=this.kMassc;var w=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(w!=w)this.kMassa=this.kMassb=this.kMassc=0;else if(0==w){var C=0;0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,C|=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,C|=2),this.kMassb=0}else{w=1/w;var E=this.kMassc*w;this.kMassc=this.kMassa*w,this.kMassa=E,this.kMassb*=-w}}else{if(this.hc2=!1,this.oc2.dist<this.oc1.dist){var S=this.c1;this.c1=this.c2,this.c2=S}this.oc2.active=!1,this.contacts.modified=!0}}this.surfacex=this.b2.svelx,this.surfacey=this.b2.svely;return this.surfacex+=1*this.b1.svelx,this.surfacey+=1*this.b1.svely,this.surfacex=-this.surfacex,this.surfacey=-this.surfacey,this.rMass=this.b1.sinertia+this.b2.sinertia,0!=this.rMass&&(this.rMass=1/this.rMass),r},warmStart:function(){var t=this.nx*this.c1.jnAcc-this.ny*this.c1.jtAcc,n=this.ny*this.c1.jnAcc+this.nx*this.c1.jtAcc,e=this.b1.imass;this.b1.velx-=t*e,this.b1.vely-=n*e,this.b1.angvel-=this.b1.iinertia*(n*this.c1.r1x-t*this.c1.r1y);var i=this.b2.imass;if(this.b2.velx+=t*i,this.b2.vely+=n*i,this.b2.angvel+=this.b2.iinertia*(n*this.c1.r2x-t*this.c1.r2y),this.hc2){var r=this.nx*this.c2.jnAcc-this.ny*this.c2.jtAcc,s=this.ny*this.c2.jnAcc+this.nx*this.c2.jtAcc,l=this.b1.imass;this.b1.velx-=r*l,this.b1.vely-=s*l,this.b1.angvel-=this.b1.iinertia*(s*this.c2.r1x-r*this.c2.r1y);var a=this.b2.imass;this.b2.velx+=r*a,this.b2.vely+=s*a,this.b2.angvel+=this.b2.iinertia*(s*this.c2.r2x-r*this.c2.r2y)}this.b2.angvel+=this.jrAcc*this.b2.iinertia,this.b1.angvel-=this.jrAcc*this.b1.iinertia},applyImpulseVel:function(){var t,n,e,i,r,s,l=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),a=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel);if(e=(a*this.nx-l*this.ny+this.surfacex)*this.c1.tMass,i=this.c1.friction*this.c1.jnAcc,r=this.c1.jtAcc,s=r-e,s>i?s=i:s<-i&&(s=-i),e=s-r,this.c1.jtAcc=s,t=-this.ny*e,n=this.nx*e,this.b2.velx+=t*this.b2.imass,this.b2.vely+=n*this.b2.imass,this.b1.velx-=t*this.b1.imass,this.b1.vely-=n*this.b1.imass,this.b2.angvel+=this.rt1b*e*this.b2.iinertia,this.b1.angvel-=this.rt1a*e*this.b1.iinertia,this.hc2){var p=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),o=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel);e=(o*this.nx-p*this.ny+this.surfacex)*this.c2.tMass,i=this.c2.friction*this.c2.jnAcc,r=this.c2.jtAcc,s=r-e,s>i?s=i:s<-i&&(s=-i),e=s-r,this.c2.jtAcc=s,t=-this.ny*e,n=this.nx*e,this.b2.velx+=t*this.b2.imass,this.b2.vely+=n*this.b2.imass,this.b1.velx-=t*this.b1.imass,this.b1.vely-=n*this.b1.imass,this.b2.angvel+=this.rt2b*e*this.b2.iinertia,this.b1.angvel-=this.rt2a*e*this.b1.iinertia,l=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),a=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),p=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),o=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel);var _=this.c1.jnAcc,h=this.c2.jnAcc,u=l*this.nx+a*this.ny+this.surfacey+this.c1.bounce-(this.Ka*_+this.Kb*h),d=p*this.nx+o*this.ny+this.surfacey+this.c2.bounce-(this.Kb*_+this.Kc*h),c=-(this.kMassa*u+this.kMassb*d),P=-(this.kMassb*u+this.kMassc*d);c>=0&&P>=0?(u=c-_,d=P-h,this.c1.jnAcc=c,this.c2.jnAcc=P):(c=-this.c1.nMass*u,c>=0&&this.Kb*c+d>=0?(u=c-_,d=-h,this.c1.jnAcc=c,this.c2.jnAcc=0):(P=-this.c2.nMass*d,P>=0&&this.Kb*P+u>=0?(u=-_,d=P-h,this.c1.jnAcc=0,this.c2.jnAcc=P):u>=0&&d>=0?(u=-_,d=-h,this.c1.jnAcc=this.c2.jnAcc=0):(u=0,d=0))),e=u+d,t=this.nx*e,n=this.ny*e,this.b2.velx+=t*this.b2.imass,this.b2.vely+=n*this.b2.imass,this.b1.velx-=t*this.b1.imass,this.b1.vely-=n*this.b1.imass,this.b2.angvel+=(this.rn1b*u+this.rn2b*d)*this.b2.iinertia,this.b1.angvel-=(this.rn1a*u+this.rn2a*d)*this.b1.iinertia}else{if(0!=this.radius){e=(this.b2.angvel-this.b1.angvel)*this.rMass,i=this.rfric*this.c1.jnAcc,r=this.jrAcc,this.jrAcc-=e,this.jrAcc>i?this.jrAcc=i:this.jrAcc<-i&&(this.jrAcc=-i),e=this.jrAcc-r,this.b2.angvel+=e*this.b2.iinertia,this.b1.angvel-=e*this.b1.iinertia}l=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),a=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),e=(this.c1.bounce+(this.nx*l+this.ny*a)+this.surfacey)*this.c1.nMass,r=this.c1.jnAcc,s=r-e,s<0&&(s=0),e=s-r,this.c1.jnAcc=s,t=this.nx*e,n=this.ny*e,this.b2.velx+=t*this.b2.imass,this.b2.vely+=n*this.b2.imass,this.b1.velx-=t*this.b1.imass,this.b1.vely-=n*this.b1.imass,this.b2.angvel+=this.rn1b*e*this.b2.iinertia,this.b1.angvel-=this.rn1a*e*this.b1.iinertia}},applyImpulsePos:function(){if(2==this.ptype){var t=this.c1,n=0,e=0;n=this.b2.axisy*t.lr2x-this.b2.axisx*t.lr2y,e=t.lr2x*this.b2.axisx+t.lr2y*this.b2.axisy;n+=1*this.b2.posx,e+=1*this.b2.posy;var i=0,r=0;i=this.b1.axisy*t.lr1x-this.b1.axisx*t.lr1y,r=t.lr1x*this.b1.axisx+t.lr1y*this.b1.axisy;i+=1*this.b1.posx,r+=1*this.b1.posy;var s=0,l=0;s=n-i,l=e-r;var a=Math.sqrt(s*s+l*l),o=this.radius-p.Config.collisionSlop,_=a-o;if(s*this.nx+l*this.ny<0&&(s=-s,l=-l,_-=this.radius),_<0)if(a<p.Config.epsilon)0!=this.b1.smass?this.b1.posx+=10*p.Config.epsilon:this.b2.posx+=10*p.Config.epsilon;else{var h=1/a;s*=h,l*=h;var u=.5*(i+n),d=.5*(r+e),c=a-o;i=u-this.b1.posx,r=d-this.b1.posy,n=u-this.b2.posx,e=d-this.b2.posy;var P=l*i-s*r,f=l*n-s*e,z=this.b2.smass+f*f*this.b2.sinertia+this.b1.smass+P*P*this.b1.sinertia;if(0!=z){var v=-this.biasCoef*c/z,m=0,b=0,y=v;m=s*y,b=l*y;var g=this.b1.imass;this.b1.posx-=m*g,this.b1.posy-=b*g,this.b1.delta_rot(-P*this.b1.iinertia*v);var x=this.b2.imass;this.b2.posx+=m*x,this.b2.posy+=b*x,this.b2.delta_rot(f*this.b2.iinertia*v)}}}else{var Z,w=0,C=0,E=0,S=0,N=0,k=0;if(0==this.ptype){w=this.b1.axisy*this.lnormx-this.b1.axisx*this.lnormy,C=this.lnormx*this.b1.axisx+this.lnormy*this.b1.axisy,Z=this.lproj+(w*this.b1.posx+C*this.b1.posy),E=this.b2.axisy*this.c1.lr1x-this.b2.axisx*this.c1.lr1y,S=this.c1.lr1x*this.b2.axisx+this.c1.lr1y*this.b2.axisy;if(E+=1*this.b2.posx,S+=1*this.b2.posy,this.hpc2){N=this.b2.axisy*this.c2.lr1x-this.b2.axisx*this.c2.lr1y,k=this.c2.lr1x*this.b2.axisx+this.c2.lr1y*this.b2.axisy;N+=1*this.b2.posx,k+=1*this.b2.posy}}else{w=this.b2.axisy*this.lnormx-this.b2.axisx*this.lnormy,C=this.lnormx*this.b2.axisx+this.lnormy*this.b2.axisy,Z=this.lproj+(w*this.b2.posx+C*this.b2.posy),E=this.b1.axisy*this.c1.lr1x-this.b1.axisx*this.c1.lr1y,S=this.c1.lr1x*this.b1.axisx+this.c1.lr1y*this.b1.axisy;if(E+=1*this.b1.posx,S+=1*this.b1.posy,this.hpc2){N=this.b1.axisy*this.c2.lr1x-this.b1.axisx*this.c2.lr1y,k=this.c2.lr1x*this.b1.axisx+this.c2.lr1y*this.b1.axisy;N+=1*this.b1.posx,k+=1*this.b1.posy}}var M=E*w+S*C-Z-this.radius;M+=p.Config.collisionSlop;var I=0;if(this.hpc2&&(I=N*w+k*C-Z-this.radius,I+=p.Config.collisionSlop),M<0||I<0){this.rev&&(w=-w,C=-C);var F=0,A=0;F=E-this.b1.posx,A=S-this.b1.posy;var T=0,V=0;T=E-this.b2.posx,V=S-this.b2.posy;var L=0,B=0,O=0,G=0;if(this.hpc2){L=N-this.b1.posx,B=k-this.b1.posy,O=N-this.b2.posx,G=k-this.b2.posy;var R=C*F-w*A,D=C*T-w*V,j=C*L-w*B,q=C*O-w*G,Y=this.b1.smass+this.b2.smass;this.kMassa=Y+this.b1.sinertia*R*R+this.b2.sinertia*D*D,this.kMassb=Y+this.b1.sinertia*R*j+this.b2.sinertia*D*q,this.kMassc=Y+this.b1.sinertia*j*j+this.b2.sinertia*q*q;var U=0,W=0,J=0;U=this.kMassa,W=this.kMassb,J=this.kMassc;var K=M*this.biasCoef,H=I*this.biasCoef;do{var X=0,Q=0;X=K,Q=H,X=-X,Q=-Q;var $=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if($!=$)X=Q=0;else if(0==$)0!=this.kMassa?X/=this.kMassa:X=0,0!=this.kMassc?Q/=this.kMassc:Q=0;else{$=1/$;var tt=$*(this.kMassc*X-this.kMassb*Q);Q=$*(this.kMassa*Q-this.kMassb*X),X=tt}if(X>=0&&Q>=0){var nt=(X+Q)*this.b1.imass;this.b1.posx-=w*nt,this.b1.posy-=C*nt,this.b1.delta_rot(-this.b1.iinertia*(R*X+j*Q));var et=(X+Q)*this.b2.imass;this.b2.posx+=w*et,this.b2.posy+=C*et,this.b2.delta_rot(this.b2.iinertia*(D*X+q*Q));break}X=-K/U,Q=0;var it=W*X+H;if(X>=0&&it>=0){var rt=(X+Q)*this.b1.imass;this.b1.posx-=w*rt,this.b1.posy-=C*rt,this.b1.delta_rot(-this.b1.iinertia*(R*X+j*Q));var st=(X+Q)*this.b2.imass
;this.b2.posx+=w*st,this.b2.posy+=C*st,this.b2.delta_rot(this.b2.iinertia*(D*X+q*Q));break}X=0,Q=-H/J;var lt=W*Q+K;if(Q>=0&&lt>=0){var at=(X+Q)*this.b1.imass;this.b1.posx-=w*at,this.b1.posy-=C*at,this.b1.delta_rot(-this.b1.iinertia*(R*X+j*Q));var pt=(X+Q)*this.b2.imass;this.b2.posx+=w*pt,this.b2.posy+=C*pt,this.b2.delta_rot(this.b2.iinertia*(D*X+q*Q));break}}while(!1)}else{var ot=C*F-w*A,_t=C*T-w*V,ht=this.b2.smass+_t*_t*this.b2.sinertia+this.b1.smass+ot*ot*this.b1.sinertia;if(0!=ht){var ut=-this.biasCoef*M/ht,dt=0,ct=0,Pt=ut;dt=w*Pt,ct=C*Pt;var ft=this.b1.imass;this.b1.posx-=dt*ft,this.b1.posy-=ct*ft,this.b1.delta_rot(-ot*this.b1.iinertia*ut);var zt=this.b2.imass;this.b2.posx+=dt*zt,this.b2.posy+=ct*zt,this.b2.delta_rot(_t*this.b2.iinertia*ut)}}}}},__class__:o.dynamics.ZPP_ColArbiter}),o.dynamics.ZPP_Contact=function(){this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.elasticity=0,this.dist=0,this.fresh=!1,this.hash=0,this.stamp=0,this.posOnly=!1,this.active=!1,this.inner=null,this.arbiter=null,this.wrap_position=null,this.py=0,this.px=0,this.outer=null,this.inner=new o.dynamics.ZPP_IContact},o.dynamics.ZPP_Contact.__name__=!0,o.dynamics.ZPP_Contact.prototype={wrapper:function(){return null==this.outer&&(o.dynamics.ZPP_Contact.internal=!0,this.outer=new p.dynamics.Contact,o.dynamics.ZPP_Contact.internal=!1,this.outer.zpp_inner=this),this.outer},position_validate:function(){if(this.inactiveme())throw"Error: Contact not currently in use";this.wrap_position.zpp_inner.x=this.px,this.wrap_position.zpp_inner.y=this.py},getposition:function(){this.wrap_position=p.geom.Vec2.get(null,null,null),this.wrap_position.zpp_inner._inuse=!0,this.wrap_position.zpp_inner._immutable=!0,this.wrap_position.zpp_inner._validate=n(this,this.position_validate)},inactiveme:function(){return!(this.active&&null!=this.arbiter&&this.arbiter.active)},free:function(){this.arbiter=null},alloc:function(){},elem:function(){return this},begin:function(){return this.next},setbegin:function(t){this.next=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n;return t._inuse=!0,n=t,n.next=this.next,this.next=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.next;null!=n;){var e=n;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e;return n._inuse=!0,e=n,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.next;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.next,i=!1;null!=e;){if(e==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.next,i=!1;null!=e;){if(e==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;return null==t?(n=this.next,e=n.next,this.next=e,null==this.next&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0)),n._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){},inlined_clear:function(){},reverse:function(){for(var t=this.next,n=null;null!=t;){var e=t.next;t.next=n,this.next=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.next},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.next;null!=e;){if(e==t){n=!0;break}e=e.next}return n},front:function(){return this.next},back:function(){for(var t=this.next,n=t;null!=n;)t=n,n=n.next;return t},iterator_at:function(t){for(var n=this.next;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n:null},__class__:o.dynamics.ZPP_Contact},o.dynamics.ZPP_IContact=function(){this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.lr2y=0,this.lr2x=0,this.lr1y=0,this.lr1x=0,this.jtAcc=0,this.jnAcc=0,this.friction=0,this.bounce=0,this.tMass=0,this.nMass=0,this.r2y=0,this.r2x=0,this.r1y=0,this.r1x=0},o.dynamics.ZPP_IContact.__name__=!0,o.dynamics.ZPP_IContact.prototype={elem:function(){return this},begin:function(){return this.next},setbegin:function(t){this.next=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n;return t._inuse=!0,n=t,n.next=this.next,this.next=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.next;null!=n;){var e=n;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e;return n._inuse=!0,e=n,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.next;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.next,i=!1;null!=e;){if(e==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.next,i=!1;null!=e;){if(e==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;return null==t?(n=this.next,e=n.next,this.next=e,null==this.next&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0)),n._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){},inlined_clear:function(){},reverse:function(){for(var t=this.next,n=null;null!=t;){var e=t.next;t.next=n,this.next=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.next},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.next;null!=e;){if(e==t){n=!0;break}e=e.next}return n},front:function(){return this.next},back:function(){for(var t=this.next,n=t;null!=n;)t=n,n=n.next;return t},iterator_at:function(t){for(var n=this.next;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n:null},__class__:o.dynamics.ZPP_IContact},o.dynamics.ZPP_InteractionFilter=function(){this.fluidMask=0,this.fluidGroup=0,this.sensorMask=0,this.sensorGroup=0,this.collisionMask=0,this.collisionGroup=0,this.wrap_shapes=null,this.shapes=null,this.outer=null,this.userData=null,this.next=null,this.shapes=new o.util.ZNPList_ZPP_Shape,this.collisionGroup=this.sensorGroup=this.fluidGroup=1,this.collisionMask=this.sensorMask=this.fluidMask=-1},o.dynamics.ZPP_InteractionFilter.__name__=!0,o.dynamics.ZPP_InteractionFilter.prototype={wrapper:function(){if(null==this.outer){this.outer=new p.dynamics.InteractionFilter;var t=this.outer.zpp_inner;t.outer=null,t.next=o.dynamics.ZPP_InteractionFilter.zpp_pool,o.dynamics.ZPP_InteractionFilter.zpp_pool=t,this.outer.zpp_inner=this}return this.outer},free:function(){this.outer=null},alloc:function(){},feature_cons:function(){this.shapes=new o.util.ZNPList_ZPP_Shape},addShape:function(t){this.shapes.add(t)},remShape:function(t){this.shapes.remove(t)},copy:function(){var t;return null==o.dynamics.ZPP_InteractionFilter.zpp_pool?t=new o.dynamics.ZPP_InteractionFilter:(t=o.dynamics.ZPP_InteractionFilter.zpp_pool,o.dynamics.ZPP_InteractionFilter.zpp_pool=t.next,t.next=null),t.collisionGroup=this.collisionGroup,t.collisionMask=this.collisionMask,t.sensorGroup=this.sensorGroup,t.sensorMask=this.sensorMask,t.fluidGroup=this.fluidGroup,t.fluidMask=this.fluidMask,t},shouldCollide:function(t){return 0!=(this.collisionMask&t.collisionGroup)&&0!=(t.collisionMask&this.collisionGroup)},shouldSense:function(t){return 0!=(this.sensorMask&t.sensorGroup)&&0!=(t.sensorMask&this.sensorGroup)},shouldFlow:function(t){return 0!=(this.fluidMask&t.fluidGroup)&&0!=(t.fluidMask&this.fluidGroup)},invalidate:function(){for(var t=this.shapes.head;null!=t;){t.elt.invalidate_filter(),t=t.next}},__class__:o.dynamics.ZPP_InteractionFilter},o.dynamics.ZPP_InteractionGroup=function(){this.depth=0,this.wrap_interactors=null,this.interactors=null,this.wrap_groups=null,this.groups=null,this.group=null,this.ignore=!1,this.outer=null,this.depth=0,this.groups=new o.util.ZNPList_ZPP_InteractionGroup,this.interactors=new o.util.ZNPList_ZPP_Interactor},o.dynamics.ZPP_InteractionGroup.__name__=!0,o.dynamics.ZPP_InteractionGroup.prototype={setGroup:function(t){this.group!=t&&(null!=this.group&&(this.group.groups.remove(this),this.depth=0,this.group.invalidate(!0)),this.group=t,null!=t?(t.groups.add(this),this.depth=t.depth+1,t.invalidate(!0)):this.invalidate(!0))},invalidate:function(t){if(null==t&&(t=!1),t||this.ignore){for(var n=this.interactors.head;null!=n;){var e=n.elt;null!=e.ibody?e.ibody.wake():null!=e.ishape?e.ishape.body.wake():e.icompound.wake(),n=n.next}for(var i=this.groups.head;null!=i;){i.elt.invalidate(t),i=i.next}}},addGroup:function(t){this.groups.add(t),t.depth=this.depth+1},remGroup:function(t){this.groups.remove(t),t.depth=0},addInteractor:function(t){this.interactors.add(t)},remInteractor:function(t,n){null==n&&(n=-1),this.interactors.remove(t)},__class__:o.dynamics.ZPP_InteractionGroup},o.dynamics.ZPP_SpaceArbiterList=function(){this.at_index_3=0,this.at_index_2=0,this.at_index_1=0,this.at_index_0=0,this.ite_3=null,this.ite_2=null,this.ite_1=null,this.ite_0=null,this.lengths=null,this.zip_length=!1,this._length=0,this.space=null,p.dynamics.ArbiterList.call(this),this.at_index_0=0,this.at_index_1=0,this.at_index_2=0,this.at_index_3=0,this.zip_length=!0,this._length=0,this.lengths=new Array;for(var t=0;t<4;){t++;this.lengths.push(0)}},o.dynamics.ZPP_SpaceArbiterList.__name__=!0,o.dynamics.ZPP_SpaceArbiterList.__super__=p.dynamics.ArbiterList,o.dynamics.ZPP_SpaceArbiterList.prototype=t(p.dynamics.ArbiterList.prototype,{zpp_gl:function(){if(this.zpp_vm(),this.zip_length){this._length=0;for(var t=0,n=0,e=this.space.c_arbiters_true.head;null!=e;){e.elt.active&&n++,e=e.next}this.lengths[t++]=n,this._length+=n;for(var i=0,r=this.space.c_arbiters_false.head;null!=r;){r.elt.active&&i++,r=r.next}this.lengths[t++]=i,this._length+=i;for(var s=0,l=this.space.f_arbiters.head;null!=l;){l.elt.active&&s++,l=l.next}this.lengths[t++]=s,this._length+=s;for(var a=0,p=this.space.s_arbiters.head;null!=p;){p.elt.active&&a++,p=p.next}this.lengths[t++]=a,this._length+=a,this.zip_length=!1}return this._length},zpp_vm:function(){var t=!1;this.space.c_arbiters_true.modified&&(t=!0,this.space.c_arbiters_true.modified=!1),this.space.c_arbiters_false.modified&&(t=!0,this.space.c_arbiters_false.modified=!1),this.space.f_arbiters.modified&&(t=!0,this.space.f_arbiters.modified=!1),this.space.s_arbiters.modified&&(t=!0,this.space.s_arbiters.modified=!1),t&&(this.zip_length=!0,this._length=0,this.ite_0=null,this.ite_1=null,this.ite_2=null,this.ite_3=null)},push:function(t){throw"Error: ArbiterList is immutable"},pop:function(){throw"Error: ArbiterList is immutable"},unshift:function(t){throw"Error: ArbiterList is immutable"},shift:function(){throw"Error: ArbiterList is immutable"},remove:function(t){throw"Error: ArbiterList is immutable"},clear:function(){throw"Error: ArbiterList is immutable"},at:function(t){if(this.zpp_vm(),t<0||t>=this.zpp_gl())throw"Error: Index out of bounds 15";var n=null,e=0;if(null==n)if(t<e+this.lengths[0]){var i=t-e;if(i<this.at_index_0||null==this.ite_0)for(this.at_index_0=0,this.ite_0=this.space.c_arbiters_true.head;;){var r=this.ite_0.elt;if(r.active)break;this.ite_0=this.ite_0.next}for(;this.at_index_0!=i;)for(this.at_index_0++,this.ite_0=this.ite_0.next;;){var s=this.ite_0.elt;if(s.active)break;this.ite_0=this.ite_0.next}n=this.ite_0.elt.wrapper()}else e+=this.lengths[0];if(null==n)if(t<e+this.lengths[1]){var l=t-e;if(l<this.at_index_1||null==this.ite_1)for(this.at_index_1=0,this.ite_1=this.space.c_arbiters_false.head;;){var a=this.ite_1.elt;if(a.active)break;this.ite_1=this.ite_1.next}for(;this.at_index_1!=l;)for(this.at_index_1++,this.ite_1=this.ite_1.next;;){var p=this.ite_1.elt;if(p.active)break;this.ite_1=this.ite_1.next}n=this.ite_1.elt.wrapper()}else e+=this.lengths[1];if(null==n)if(t<e+this.lengths[2]){var o=t-e;if(o<this.at_index_2||null==this.ite_2)for(this.at_index_2=0,this.ite_2=this.space.f_arbiters.head;;){var _=this.ite_2.elt;if(_.active)break;this.ite_2=this.ite_2.next}for(;this.at_index_2!=o;)for(this.at_index_2++,this.ite_2=this.ite_2.next;;){var h=this.ite_2.elt;if(h.active)break;this.ite_2=this.ite_2.next}n=this.ite_2.elt.wrapper()}else e+=this.lengths[2];if(null==n)if(t<e+this.lengths[3]){var u=t-e;if(u<this.at_index_3||null==this.ite_3)for(this.at_index_3=0,this.ite_3=this.space.s_arbiters.head;;){var d=this.ite_3.elt;if(d.active)break;this.ite_3=this.ite_3.next}for(;this.at_index_3!=u;)for(this.at_index_3++,this.ite_3=this.ite_3.next;;){var c=this.ite_3.elt;if(c.active)break;this.ite_3=this.ite_3.next}n=this.ite_3.elt.wrapper()}else e+=this.lengths[3];return n},__class__:o.dynamics.ZPP_SpaceArbiterList}),o.geom={},o.geom.ZPP_AABB=function(){this.wrap_max=null,this.maxy=0,this.maxx=0,this.wrap_min=null,this.miny=0,this.minx=0,this.next=null,this.outer=null,this._immutable=!1,this._validate=null,this._invalidate=null},o.geom.ZPP_AABB.__name__=!0,o.geom.ZPP_AABB.get=function(t,n,e,i){var r;return null==o.geom.ZPP_AABB.zpp_pool?r=new o.geom.ZPP_AABB:(r=o.geom.ZPP_AABB.zpp_pool,o.geom.ZPP_AABB.zpp_pool=r.next,r.next=null),r.minx=t,r.miny=n,r.maxx=e,r.maxy=i,r},o.geom.ZPP_AABB.prototype={validate:function(){null!=this._validate&&this._validate()},invalidate:function(){null!=this._invalidate&&this._invalidate(this)},wrapper:function(){if(null==this.outer){this.outer=new p.geom.AABB;var t=this.outer.zpp_inner;null!=t.outer&&(t.outer.zpp_inner=null,t.outer=null),t.wrap_min=t.wrap_max=null,t._invalidate=null,t._validate=null,t.next=o.geom.ZPP_AABB.zpp_pool,o.geom.ZPP_AABB.zpp_pool=t,this.outer.zpp_inner=this}return this.outer},alloc:function(){},free:function(){null!=this.outer&&(this.outer.zpp_inner=null,this.outer=null),this.wrap_min=this.wrap_max=null,this._invalidate=null,this._validate=null},copy:function(){return o.geom.ZPP_AABB.get(this.minx,this.miny,this.maxx,this.maxy)},width:function(){return this.maxx-this.minx},height:function(){return this.maxy-this.miny},perimeter:function(){return 2*(this.maxx-this.minx+(this.maxy-this.miny))},getmin:function(){return null==this.wrap_min&&(this.wrap_min=p.geom.Vec2.get(this.minx,this.miny,null),this.wrap_min.zpp_inner._inuse=!0,this._immutable?this.wrap_min.zpp_inner._immutable=!0:this.wrap_min.zpp_inner._invalidate=n(this,this.mod_min),this.wrap_min.zpp_inner._validate=n(this,this.dom_min)),this.wrap_min},dom_min:function(){null!=this._validate&&this._validate(),this.wrap_min.zpp_inner.x=this.minx,this.wrap_min.zpp_inner.y=this.miny},mod_min:function(t){t.x==this.minx&&t.y==this.miny||(this.minx=t.x,this.miny=t.y,null!=this._invalidate&&this._invalidate(this))},getmax:function(){return null==this.wrap_max&&(this.wrap_max=p.geom.Vec2.get(this.maxx,this.maxy,null),this.wrap_max.zpp_inner._inuse=!0,this._immutable?this.wrap_max.zpp_inner._immutable=!0:this.wrap_max.zpp_inner._invalidate=n(this,this.mod_max),this.wrap_max.zpp_inner._validate=n(this,this.dom_max)),this.wrap_max},dom_max:function(){null!=this._validate&&this._validate(),this.wrap_max.zpp_inner.x=this.maxx,this.wrap_max.zpp_inner.y=this.maxy},mod_max:function(t){t.x==this.maxx&&t.y==this.maxy||(this.maxx=t.x,this.maxy=t.y,null!=this._invalidate&&this._invalidate(this))},intersectX:function(t){return!(t.minx>this.maxx||this.minx>t.maxx)},intersectY:function(t){return!(t.miny>this.maxy||this.miny>t.maxy)},intersect:function(t){return t.miny<=this.maxy&&this.miny<=t.maxy&&t.minx<=this.maxx&&this.minx<=t.maxx},combine:function(t){t.minx<this.minx&&(this.minx=t.minx),t.maxx>this.maxx&&(this.maxx=t.maxx),t.miny<this.miny&&(this.miny=t.miny),t.maxy>this.maxy&&(this.maxy=t.maxy)},contains:function(t){return t.minx>=this.minx&&t.miny>=this.miny&&t.maxx<=this.maxx&&t.maxy<=this.maxy},containsPoint:function(t){return t.x>=this.minx&&t.x<=this.maxx&&t.y>=this.miny&&t.y<=this.maxy},setCombine:function(t,n){t.minx<n.minx?this.minx=t.minx:this.minx=n.minx,t.miny<n.miny?this.miny=t.miny:this.miny=n.miny,t.maxx>n.maxx?this.maxx=t.maxx:this.maxx=n.maxx,t.maxy>n.maxy?this.maxy=t.maxy:this.maxy=n.maxy},setExpand:function(t,n){this.minx=t.minx-n,this.miny=t.miny-n,this.maxx=t.maxx+n,this.maxy=t.maxy+n},setExpandPoint:function(t,n){t<this.minx&&(this.minx=t),t>this.maxx&&(this.maxx=t),n<this.miny&&(this.miny=n),n>this.maxy&&(this.maxy=n)},toString:function(){return"{ x: "+this.minx+" y: "+this.miny+" w: "+(this.maxx-this.minx)+" h: "+(this.maxy-this.miny)+" }"},__class__:o.geom.ZPP_AABB},o.util.ZNPList_ZPP_Vec2=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_Vec2.__name__=!0,o.util.ZNPList_ZPP_Vec2.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_Vec2.zpp_pool?e=new o.util.ZNPNode_ZPP_Vec2:(e=o.util.ZNPNode_ZPP_Vec2.zpp_pool,o.util.ZNPNode_ZPP_Vec2.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_Vec2.zpp_pool?i=new o.util.ZNPNode_ZPP_Vec2:(i=o.util.ZNPNode_ZPP_Vec2.zpp_pool,o.util.ZNPNode_ZPP_Vec2.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_Vec2.zpp_pool,o.util.ZNPNode_ZPP_Vec2.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_Vec2.zpp_pool,o.util.ZNPNode_ZPP_Vec2.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_Vec2},o.geom.ZPP_Collide=function(){},o.geom.ZPP_Collide.__name__=!0,o.geom.ZPP_Collide.circleContains=function(t,n){var e=0,i=0;return e=n.x-t.worldCOMx,i=n.y-t.worldCOMy,e*e+i*i<t.radius*t.radius},o.geom.ZPP_Collide.polyContains=function(t,n){var e;e=!0;for(var i=t.edges.head;null!=i;){var r=i.elt;{if(!(r.gnormx*n.x+r.gnormy*n.y<=r.gprojection)){e=!1;break}i=i.next}}return e},o.geom.ZPP_Collide.shapeContains=function(t,n){return t.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?o.geom.ZPP_Collide.circleContains(t.circle,n):o.geom.ZPP_Collide.polyContains(t.polygon,n)},o.geom.ZPP_Collide.bodyContains=function(t,n){var e;e=!1;for(var i=t.shapes.head;null!=i;){var r=i.elt;if(o.geom.ZPP_Collide.shapeContains(r,n)){e=!0;break}i=i.next}return e},o.geom.ZPP_Collide.containTest=function(t,n){if(t.aabb.contains(n.aabb)){if(t.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE){if(n.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE){var e=t.circle.radius+-n.circle.radius,i=0,r=0;i=n.circle.worldCOMx-t.circle.worldCOMx,r=n.circle.worldCOMy-t.circle.worldCOMy;return i*i+r*r<=e*e}var s;s=!0;for(var l=n.polygon.gverts.next;null!=l;){var a=l;{if(!function(n){var e=t.circle.radius,i=0,r=0;return i=a.x-t.circle.worldCOMx,r=a.y-t.circle.worldCOMy,i*i+r*r<=e*e}()){s=!1;break}l=l.next}}return s}if(n.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE){var p;p=!0;for(var _=t.polygon.edges.head;null!=_;){var h=_.elt;{if(!(h.gnormx*n.circle.worldCOMx+h.gnormy*n.circle.worldCOMy+n.circle.radius<=h.gprojection)){p=!1;break}_=_.next}}return p}var u;u=!0;for(var d=t.polygon.edges.head;null!=d;){var c=d.elt;{if(!function(t){for(var e=-1e100,i=n.polygon.gverts.next;null!=i;){var r=i,s=c.gnormx*r.x+c.gnormy*r.y;s>e&&(e=s),i=i.next}return e<=c.gprojection}()){u=!1;break}d=d.next}}return u}return!1},o.geom.ZPP_Collide.contactCollide=function(t,n,e,i){if(n.type==o.util.ZPP_Flags.id_ShapeType_POLYGON){if(t.type==o.util.ZPP_Flags.id_ShapeType_POLYGON){for(var r=!0,s=-1e100,l=-1,a=null,_=null,h=t.polygon.edges.head;null!=h;){for(var u=h.elt,d=1e100,c=n.polygon.gverts.next;null!=c;){var P=c,f=u.gnormx*P.x+u.gnormy*P.y;if(f<d&&(d=f),d-u.gprojection<=s)break;c=c.next}if((d-=u.gprojection)>=0){r=!1;break}d>s&&(s=d,a=u,l=1),h=h.next}if(r){for(var z=n.polygon.edges.head;null!=z;){for(var v=z.elt,m=1e100,b=t.polygon.gverts.next;null!=b;){var y=b,g=v.gnormx*y.x+v.gnormy*y.y;if(g<m&&(m=g),m-v.gprojection<=s)break;b=b.next}if((m-=v.gprojection)>=0){r=!1;break}m>s&&(s=m,_=v,l=2),z=z.next}if(r){var x,Z,w;1==l?(t.polygon,x=n.polygon,Z=a,w=1):(n.polygon,x=t.polygon,Z=_,w=-1);for(var C=null,E=1e100,S=x.edges.head;null!=S;){var N=S.elt,k=Z.gnormx*N.gnormx+Z.gnormy*N.gnormy;k<E&&(E=k,C=N),S=S.next}var M=0,I=0;M=C.gp0.x,I=C.gp0.y;var F=0,A=0;F=C.gp1.x,A=C.gp1.y;var T=0,V=0;T=F-M,V=A-I;var L=Z.gnormy*M-Z.gnormx*I,B=Z.gnormy*F-Z.gnormx*A,O=1/(B-L),G=(-Z.tp1-L)*O;if(G>p.Config.epsilon){var R=G;M+=T*R,I+=V*R}var D=(-Z.tp0-B)*O;if(D<-p.Config.epsilon){var j=D;F+=T*j,A+=V*j}var q=0,Y=0,U=w;q=Z.gnormx*U,Y=Z.gnormy*U,e.lnormx=Z.lnormx,e.lnormy=Z.lnormy,e.lproj=Z.lprojection,e.radius=0,e.rev=i!=(-1==w),e.rev?e.ptype=1:e.ptype=0;var W=M*Z.gnormx+I*Z.gnormy-Z.gprojection,J=F*Z.gnormx+A*Z.gnormy-Z.gprojection;if(W>0&&J>0)return!1;i&&(q=-q,Y=-Y);var K=e.injectContact(M-Z.gnormx*W*.5,I-Z.gnormy*W*.5,q,Y,W,e.rev?1:0,W>0);M-=1*x.body.posx,I-=1*x.body.posy,K.inner.lr1x=M*x.body.axisy+I*x.body.axisx,K.inner.lr1y=I*x.body.axisy-M*x.body.axisx,K=e.injectContact(F-Z.gnormx*J*.5,A-Z.gnormy*J*.5,q,Y,J,e.rev?0:1,J>0);return F-=1*x.body.posx,A-=1*x.body.posy,K.inner.lr1x=F*x.body.axisy+A*x.body.axisx,K.inner.lr1y=A*x.body.axisy-F*x.body.axisx,1==l?(e.__ref_edge1=Z,e.__ref_edge2=C):(e.__ref_edge2=Z,e.__ref_edge1=C),!0}return!1}return!1}for(var H=-1e100,X=!0,Q=null,$=null,tt=n.polygon.gverts.next,nt=n.polygon.edges.head;null!=nt;){var et=nt.elt,it=et.gnormx*t.circle.worldCOMx+et.gnormy*t.circle.worldCOMy-et.gprojection-t.circle.radius;if(it>0){X=!1;break}it>H&&(H=it,Q=et,$=tt),tt=tt.next,nt=nt.next}if(X){var rt,st=$;rt=null==$.next?n.polygon.gverts.next:$.next;var lt=t.circle.worldCOMy*Q.gnormx-t.circle.worldCOMx*Q.gnormy;if(lt<=st.y*Q.gnormx-st.x*Q.gnormy){var at,pt=t.circle.radius,ot=0,_t=0;ot=st.x-t.circle.worldCOMx,_t=st.y-t.circle.worldCOMy;var ht=ot*ot+_t*_t;if(ht>pt*pt)at=null;else if(ht<p.Config.epsilon*p.Config.epsilon)at=e.injectContact(t.circle.worldCOMx,t.circle.worldCOMy,1,0,-pt,0,null);else{var ut,dt=1/Math.sqrt(ht);ut=dt<p.Config.epsilon?1e100:1/dt;var ct=.5+(t.circle.radius-.5*pt)*dt;at=i?e.injectContact(t.circle.worldCOMx+ot*ct,t.circle.worldCOMy+_t*ct,-ot*dt,-_t*dt,ut-pt,0,null):e.injectContact(t.circle.worldCOMx+ot*ct,t.circle.worldCOMy+_t*ct,ot*dt,_t*dt,ut-pt,0,null)}if(null!=at){var Pt=at.inner;e.ptype=2;var ft=0,zt=0;ft=st.x-n.polygon.body.posx,zt=st.y-n.polygon.body.posy,e.__ref_edge1=Q,e.__ref_vertex=-1,i?(Pt.lr1x=ft*n.polygon.body.axisy+zt*n.polygon.body.axisx,Pt.lr1y=zt*n.polygon.body.axisy-ft*n.polygon.body.axisx,Pt.lr2x=t.circle.localCOMx,Pt.lr2y=t.circle.localCOMy):(Pt.lr2x=ft*n.polygon.body.axisy+zt*n.polygon.body.axisx,Pt.lr2y=zt*n.polygon.body.axisy-ft*n.polygon.body.axisx,Pt.lr1x=t.circle.localCOMx,Pt.lr1y=t.circle.localCOMy),e.radius=t.circle.radius}return null!=at}if(lt>=rt.y*Q.gnormx-rt.x*Q.gnormy){var vt,mt=t.circle.radius,bt=0,yt=0;bt=rt.x-t.circle.worldCOMx,yt=rt.y-t.circle.worldCOMy;var gt=bt*bt+yt*yt;if(gt>mt*mt)vt=null;else if(gt<p.Config.epsilon*p.Config.epsilon)vt=e.injectContact(t.circle.worldCOMx,t.circle.worldCOMy,1,0,-mt,0,null);else{var xt,Zt=1/Math.sqrt(gt);xt=Zt<p.Config.epsilon?1e100:1/Zt;var wt=.5+(t.circle.radius-.5*mt)*Zt;vt=i?e.injectContact(t.circle.worldCOMx+bt*wt,t.circle.worldCOMy+yt*wt,-bt*Zt,-yt*Zt,xt-mt,0,null):e.injectContact(t.circle.worldCOMx+bt*wt,t.circle.worldCOMy+yt*wt,bt*Zt,yt*Zt,xt-mt,0,null)}if(null!=vt){var Ct=vt.inner;e.ptype=2;var Et=0,St=0;Et=rt.x-n.polygon.body.posx,St=rt.y-n.polygon.body.posy,e.__ref_edge1=Q,e.__ref_vertex=1,i?(Ct.lr1x=Et*n.polygon.body.axisy+St*n.polygon.body.axisx,Ct.lr1y=St*n.polygon.body.axisy-Et*n.polygon.body.axisx,Ct.lr2x=t.circle.localCOMx,Ct.lr2y=t.circle.localCOMy):(Ct.lr2x=Et*n.polygon.body.axisy+St*n.polygon.body.axisx,Ct.lr2y=St*n.polygon.body.axisy-Et*n.polygon.body.axisx,Ct.lr1x=t.circle.localCOMx,Ct.lr1y=t.circle.localCOMy),e.radius=t.circle.radius}return null!=vt}var Nt=0,kt=0,Mt=t.circle.radius+.5*H;Nt=Q.gnormx*Mt,kt=Q.gnormy*Mt;var It=0,Ft=0;It=t.circle.worldCOMx-Nt,Ft=t.circle.worldCOMy-kt;var At;return At=i?e.injectContact(It,Ft,Q.gnormx,Q.gnormy,H,0,null):e.injectContact(It,Ft,-Q.gnormx,-Q.gnormy,H,0,null),e.ptype=i?0:1,e.lnormx=Q.lnormx,e.lnormy=Q.lnormy,e.rev=!i,e.lproj=Q.lprojection,e.radius=t.circle.radius,At.inner.lr1x=t.circle.localCOMx,At.inner.lr1y=t.circle.localCOMy,e.__ref_edge1=Q,e.__ref_vertex=0,!0}return!1}var Tt,Vt=t.circle.radius+n.circle.radius,Lt=0,Bt=0;Lt=n.circle.worldCOMx-t.circle.worldCOMx,Bt=n.circle.worldCOMy-t.circle.worldCOMy;var Ot=Lt*Lt+Bt*Bt;if(Ot>Vt*Vt)Tt=null;else if(Ot<p.Config.epsilon*p.Config.epsilon)Tt=e.injectContact(t.circle.worldCOMx,t.circle.worldCOMy,1,0,-Vt,0,null);else{var Gt,Rt=1/Math.sqrt(Ot);Gt=Rt<p.Config.epsilon?1e100:1/Rt;var Dt=.5+(t.circle.radius-.5*Vt)*Rt;Tt=i?e.injectContact(t.circle.worldCOMx+Lt*Dt,t.circle.worldCOMy+Bt*Dt,-Lt*Rt,-Bt*Rt,Gt-Vt,0,null):e.injectContact(t.circle.worldCOMx+Lt*Dt,t.circle.worldCOMy+Bt*Dt,Lt*Rt,Bt*Rt,Gt-Vt,0,null)}if(null!=Tt){var jt=Tt.inner;return i?(jt.lr1x=n.circle.localCOMx,jt.lr1y=n.circle.localCOMy,jt.lr2x=t.circle.localCOMx,jt.lr2y=t.circle.localCOMy):(jt.lr1x=t.circle.localCOMx,jt.lr1y=t.circle.localCOMy,jt.lr2x=n.circle.localCOMx,jt.lr2y=n.circle.localCOMy),e.radius=t.circle.radius+n.circle.radius,e.ptype=2,!0}return!1},o.geom.ZPP_Collide.testCollide_safe=function(t,n){if(n.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE){var e=t;t=n,n=e}return o.geom.ZPP_Collide.testCollide(t,n)},o.geom.ZPP_Collide.testCollide=function(t,n){if(n.type==o.util.ZPP_Flags.id_ShapeType_POLYGON){if(t.type==o.util.ZPP_Flags.id_ShapeType_POLYGON){for(var e=!0,i=t.polygon.edges.head;null!=i;){for(var r=i.elt,s=1e100,l=n.polygon.gverts.next;null!=l;){var a=l,p=r.gnormx*a.x+r.gnormy*a.y;p<s&&(s=p),l=l.next}if((s-=r.gprojection)>0){e=!1;break}i=i.next}if(e){for(var _=n.polygon.edges.head;null!=_;){for(var h=_.elt,u=1e100,d=t.polygon.gverts.next;null!=d;){var c=d,P=h.gnormx*c.x+h.gnormy*c.y;P<u&&(u=P),d=d.next}if((u-=h.gprojection)>0){e=!1;break}_=_.next}return e}return!1}for(var f=null,z=null,v=!0,m=-1e100,b=n.polygon.gverts.next,y=n.polygon.edges.head;null!=y;){var g=y.elt,x=g.gnormx*t.circle.worldCOMx+g.gnormy*t.circle.worldCOMy-g.gprojection-t.circle.radius;if(x>0){v=!1;break}x>m&&(m=x,f=g,z=b),b=b.next,y=y.next}if(v){var Z,w=z;Z=null==z.next?n.polygon.gverts.next:z.next;var C=t.circle.worldCOMy*f.gnormx-t.circle.worldCOMx*f.gnormy;if(C<=w.y*f.gnormx-w.x*f.gnormy){var E=t.circle.radius,S=0,N=0;S=w.x-t.circle.worldCOMx,N=w.y-t.circle.worldCOMy;return S*S+N*N<=E*E}if(C>=Z.y*f.gnormx-Z.x*f.gnormy){var k=t.circle.radius,M=0,I=0;M=Z.x-t.circle.worldCOMx,I=Z.y-t.circle.worldCOMy;return M*M+I*I<=k*k}return!0}return!1}var F=t.circle.radius+n.circle.radius,A=0,T=0;return A=n.circle.worldCOMx-t.circle.worldCOMx,T=n.circle.worldCOMy-t.circle.worldCOMy,A*A+T*T<=F*F},o.geom.ZPP_Collide.flowCollide=function(t,n,e){if(n.type==o.util.ZPP_Flags.id_ShapeType_POLYGON){if(t.type==o.util.ZPP_Flags.id_ShapeType_POLYGON){for(var i=new Array,r=new Array,s=!0,l=!0,a=t.polygon.edges.head;null!=a;){for(var _=a.elt,h=1e100,u=0,d=n.polygon.gverts.next;null!=d;){var c=d,P=_.gnormx*c.x+_.gnormy*c.y;P<h&&(h=P),P>=_.gprojection+p.Config.epsilon&&(r[u]=!0,l=!1),u++,d=d.next}if((h-=_.gprojection)>0){s=!1;break}a=a.next}if(l)return n.polygon.validate_worldCOM(),e.overlap=n.polygon.area,e.centroidx=n.polygon.worldCOMx,e.centroidy=n.polygon.worldCOMy,!0;if(s){l=!0;for(var f=n.polygon.edges.head;null!=f;){for(var z=f.elt,v=1e100,m=0,b=t.polygon.gverts.next;null!=b;){var y=b,g=z.gnormx*y.x+z.gnormy*y.y;g<v&&(v=g),g>=z.gprojection+p.Config.epsilon&&(i[m]=!0,l=!1),m++,b=b.next}if((v-=z.gprojection)>0){s=!1;break}f=f.next}if(l)return t.polygon.validate_worldCOM(),e.overlap=t.polygon.area,e.centroidx=t.polygon.worldCOMx,e.centroidy=t.polygon.worldCOMy,!0;if(s){for(;null!=o.geom.ZPP_Collide.flowpoly.head;){var x=o.geom.ZPP_Collide.flowpoly.pop_unsafe();if(!x._inuse){var Z=x;null!=Z.outer&&(Z.outer.zpp_inner=null,Z.outer=null),Z._isimmutable=null,Z._validate=null,Z._invalidate=null,Z.next=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=Z}}for(var w=null,C=!1,E=t.polygon.gverts.next,S=0,N=n.polygon.gverts.next,k=0,M=0,I=n.polygon.edgeCnt;M<I;){var F=M++;if(!r[F]){k=F;break}N=N.next}if(null==N){N=n.polygon.gverts.next,C=!0;for(var A=0,T=t.polygon.edgeCnt;A<T;){var V=A++;if(!i[V]){S=V;break}E=E.next}null==E?E=t.polygon.gverts.next:(o.geom.ZPP_Collide.flowpoly.add(E),w=o.geom.ZPP_Collide.flowpoly.head.elt)}else o.geom.ZPP_Collide.flowpoly.add(N),w=o.geom.ZPP_Collide.flowpoly.head.elt;var L=1;if(null==o.geom.ZPP_Collide.flowpoly.head){for(var B=!0,O=t.polygon.gverts.next,G=O,R=O.next;null!=R;){for(var D=R,j=2,q=n.polygon.gverts.next,Y=q,U=q.next;null!=U;){var W=U,J=0;(function(t){var n=0,e=0;n=G.x-Y.x,e=G.y-Y.y;var i=0,r=0;i=D.x-G.x,r=D.y-G.y;var s=0,l=0;s=W.x-Y.x,l=W.y-Y.y;var a=r*s-i*l;return a*a>p.Config.epsilon*p.Config.epsilon&&function(t){a=1/a;var o=(l*n-s*e)*a;return o>p.Config.epsilon&&o<1-p.Config.epsilon&&function(t){var s=(r*n-i*e)*a;return s>p.Config.epsilon&&s<1-p.Config.epsilon&&function(t){return J=o,!0}()}()}()})()&&J<j&&(j=J,N=q),q=U,Y=W,U=U.next}
U=n.polygon.gverts.next;var K=U,H=0;if(function(t){var n=0,e=0;n=G.x-Y.x,e=G.y-Y.y;var i=0,r=0;i=D.x-G.x,r=D.y-G.y;var s=0,l=0;s=K.x-Y.x,l=K.y-Y.y;var a=r*s-i*l;return a*a>p.Config.epsilon*p.Config.epsilon&&function(t){a=1/a;var o=(l*n-s*e)*a;return o>p.Config.epsilon&&o<1-p.Config.epsilon&&function(t){var s=(r*n-i*e)*a;return s>p.Config.epsilon&&s<1-p.Config.epsilon&&function(t){return H=o,!0}()}()}()}()&&H<j&&(j=H,N=q),2!=j){var X=0,Q=0,$=j;X=G.x+(D.x-G.x)*$,Q=G.y+(D.y-G.y)*$,w=o.geom.ZPP_Vec2.get(X,Q,null),o.geom.ZPP_Collide.flowpoly.add(w),C=!0,E=O,B=!1;break}O=R,G=D,R=R.next}if(B)do{R=t.polygon.gverts.next;for(var tt=R,nt=2,et=n.polygon.gverts.next,it=et,rt=et.next;null!=rt;){var st=rt,lt=0;(function(t){var n=0,e=0;n=G.x-it.x,e=G.y-it.y;var i=0,r=0;i=tt.x-G.x,r=tt.y-G.y;var s=0,l=0;s=st.x-it.x,l=st.y-it.y;var a=r*s-i*l;return a*a>p.Config.epsilon*p.Config.epsilon&&function(t){a=1/a;var o=(l*n-s*e)*a;return o>p.Config.epsilon&&o<1-p.Config.epsilon&&function(t){var s=(r*n-i*e)*a;return s>p.Config.epsilon&&s<1-p.Config.epsilon&&function(t){return lt=o,!0}()}()}()})()&&lt<nt&&(nt=lt,N=et),et=rt,it=st,rt=rt.next}rt=n.polygon.gverts.next;var at=rt,pt=0;if(function(t){var n=0,e=0;n=G.x-it.x,e=G.y-it.y;var i=0,r=0;i=tt.x-G.x,r=tt.y-G.y;var s=0,l=0;s=at.x-it.x,l=at.y-it.y;var a=r*s-i*l;return a*a>p.Config.epsilon*p.Config.epsilon&&function(t){a=1/a;var o=(l*n-s*e)*a;return o>p.Config.epsilon&&o<1-p.Config.epsilon&&function(t){var s=(r*n-i*e)*a;return s>p.Config.epsilon&&s<1-p.Config.epsilon&&function(t){return pt=o,!0}()}()}()}()&&pt<nt&&(nt=pt,N=et),2!=nt){var ot=0,_t=0,ht=nt;ot=G.x+(tt.x-G.x)*ht,_t=G.y+(tt.y-G.y)*ht,w=o.geom.ZPP_Vec2.get(ot,_t,null),o.geom.ZPP_Collide.flowpoly.add(w),C=!0,E=O;break}}while(!1);L=2}for(;;)if(C)if(E=E.next,S++,null==E&&(E=t.polygon.gverts.next,S=0),i[S]){var ut=o.geom.ZPP_Collide.flowpoly.head.elt,dt=E,ct=N,Pt=N.next;null==Pt&&(Pt=n.polygon.gverts.next);var ft=-1,zt=null,vt=0,mt=0,bt=Pt,yt=Pt;do{var gt=yt,xt=0;if(function(t){var n=0,e=0;n=ct.x-ut.x,e=ct.y-ut.y;var i=0,r=0;i=gt.x-ct.x,r=gt.y-ct.y;var s=0,l=0;s=dt.x-ut.x,l=dt.y-ut.y;var a=r*s-i*l;return a*a>p.Config.epsilon*p.Config.epsilon&&function(t){a=1/a;var o=(l*n-s*e)*a;return o>p.Config.epsilon&&o<1-p.Config.epsilon&&function(t){var s=(r*n-i*e)*a;return s>p.Config.epsilon&&s<1-p.Config.epsilon&&function(t){return xt=o,!0}()}()}()}()&&xt>=ft){if(zt=N,vt=k,++mt==L){ft=xt,yt=bt;break}ft=xt}ct=gt,N=yt,k++,k>=n.polygon.edgeCnt&&(k=0),yt=yt.next,null==yt&&(yt=n.polygon.gverts.next)}while(!1);for(;yt!=bt;){var Zt=yt,wt=0;if(function(t){var n=0,e=0;n=ct.x-ut.x,e=ct.y-ut.y;var i=0,r=0;i=Zt.x-ct.x,r=Zt.y-ct.y;var s=0,l=0;s=dt.x-ut.x,l=dt.y-ut.y;var a=r*s-i*l;return a*a>p.Config.epsilon*p.Config.epsilon&&function(t){a=1/a;var o=(l*n-s*e)*a;return o>p.Config.epsilon&&o<1-p.Config.epsilon&&function(t){var s=(r*n-i*e)*a;return s>p.Config.epsilon&&s<1-p.Config.epsilon&&function(t){return wt=o,!0}()}()}()}()&&wt>=ft){if(zt=N,vt=k,++mt==L){ft=wt,yt=bt;break}ft=wt}ct=Zt,N=yt,k++,k>=n.polygon.edgeCnt&&(k=0),yt=yt.next,null==yt&&(yt=n.polygon.gverts.next)}if(null==zt)break;var Ct=zt,Et=zt.next;null==Et&&(Et=n.polygon.gverts.next);var St=Et,Nt=0,kt=0,Mt=ft;if(Nt=Ct.x+(St.x-Ct.x)*Mt,kt=Ct.y+(St.y-Ct.y)*Mt,null!=w&&o.geom.ZPP_VecMath.vec_dsq(Nt,kt,w.x,w.y)<p.Config.epsilon)break;o.geom.ZPP_Collide.flowpoly.add(o.geom.ZPP_Vec2.get(Nt,kt,null)),null==w&&(w=o.geom.ZPP_Collide.flowpoly.head.elt),N=zt,k=vt,C=!C,L=2}else{var It=E;if(null!=w&&o.geom.ZPP_VecMath.vec_dsq(It.x,It.y,w.x,w.y)<p.Config.epsilon)break;o.geom.ZPP_Collide.flowpoly.add(It),null==w&&(w=o.geom.ZPP_Collide.flowpoly.head.elt),L=1}else if(N=N.next,k++,null==N&&(N=n.polygon.gverts.next,k=0),r[k]){var Ft=o.geom.ZPP_Collide.flowpoly.head.elt,At=N,Tt=E,Vt=E.next;null==Vt&&(Vt=t.polygon.gverts.next);var Lt=-1,Bt=null,Ot=0,Gt=0,Rt=Vt,Dt=Vt;do{var jt=Dt,qt=0;if(function(t){var n=0,e=0;n=Tt.x-Ft.x,e=Tt.y-Ft.y;var i=0,r=0;i=jt.x-Tt.x,r=jt.y-Tt.y;var s=0,l=0;s=At.x-Ft.x,l=At.y-Ft.y;var a=r*s-i*l;return a*a>p.Config.epsilon*p.Config.epsilon&&function(t){a=1/a;var o=(l*n-s*e)*a;return o>p.Config.epsilon&&o<1-p.Config.epsilon&&function(t){var s=(r*n-i*e)*a;return s>p.Config.epsilon&&s<1-p.Config.epsilon&&function(t){return qt=o,!0}()}()}()}()&&qt>=Lt){if(Bt=E,Ot=S,++Gt==L){Lt=qt,Dt=Rt;break}Lt=qt}Tt=jt,E=Dt,S++,S>=t.polygon.edgeCnt&&(S=0),Dt=Dt.next,null==Dt&&(Dt=t.polygon.gverts.next)}while(!1);for(;Dt!=Rt;){var Yt=Dt,Ut=0;if(function(t){var n=0,e=0;n=Tt.x-Ft.x,e=Tt.y-Ft.y;var i=0,r=0;i=Yt.x-Tt.x,r=Yt.y-Tt.y;var s=0,l=0;s=At.x-Ft.x,l=At.y-Ft.y;var a=r*s-i*l;return a*a>p.Config.epsilon*p.Config.epsilon&&function(t){a=1/a;var o=(l*n-s*e)*a;return o>p.Config.epsilon&&o<1-p.Config.epsilon&&function(t){var s=(r*n-i*e)*a;return s>p.Config.epsilon&&s<1-p.Config.epsilon&&function(t){return Ut=o,!0}()}()}()}()&&Ut>=Lt){if(Bt=E,Ot=S,++Gt==L){Lt=Ut,Dt=Rt;break}Lt=Ut}Tt=Yt,E=Dt,S++,S>=t.polygon.edgeCnt&&(S=0),Dt=Dt.next,null==Dt&&(Dt=t.polygon.gverts.next)}if(null==Bt)break;var Wt=Bt,Jt=Bt.next;null==Jt&&(Jt=t.polygon.gverts.next);var Kt=Jt,Ht=0,Xt=0,Qt=Lt;if(Ht=Wt.x+(Kt.x-Wt.x)*Qt,Xt=Wt.y+(Kt.y-Wt.y)*Qt,null!=w&&o.geom.ZPP_VecMath.vec_dsq(Ht,Xt,w.x,w.y)<p.Config.epsilon)break;o.geom.ZPP_Collide.flowpoly.add(o.geom.ZPP_Vec2.get(Ht,Xt,null)),null==w&&(w=o.geom.ZPP_Collide.flowpoly.head.elt),E=Bt,S=Ot,C=!C,L=2}else{var $t=N;if(null!=w&&o.geom.ZPP_VecMath.vec_dsq($t.x,$t.y,w.x,w.y)<p.Config.epsilon)break;o.geom.ZPP_Collide.flowpoly.add($t),null==w&&(w=o.geom.ZPP_Collide.flowpoly.head.elt),L=1}if(null!=o.geom.ZPP_Collide.flowpoly.head&&null!=o.geom.ZPP_Collide.flowpoly.head.next&&null!=o.geom.ZPP_Collide.flowpoly.head.next.next){var tn=0,nn=0,en=0;nn=0,en=0,tn=0;var rn=o.geom.ZPP_Collide.flowpoly.head,sn=rn.elt;rn=rn.next;var ln=rn.elt;for(rn=rn.next;null!=rn;){var an=rn.elt;tn+=ln.x*(an.y-sn.y);var pn=an.y*ln.x-an.x*ln.y;nn+=(ln.x+an.x)*pn,en+=(ln.y+an.y)*pn,sn=ln,ln=an,rn=rn.next}rn=o.geom.ZPP_Collide.flowpoly.head;var on=rn.elt;tn+=ln.x*(on.y-sn.y);var _n=on.y*ln.x-on.x*ln.y;nn+=(ln.x+on.x)*_n,en+=(ln.y+on.y)*_n,sn=ln,ln=on,rn=rn.next;var hn=rn.elt;tn+=ln.x*(hn.y-sn.y);var un=hn.y*ln.x-hn.x*ln.y;nn+=(ln.x+hn.x)*un,en+=(ln.y+hn.y)*un,tn*=.5;var dn=1/(6*tn),cn=dn;return nn*=cn,en*=cn,e.overlap=-tn,e.centroidx=nn,e.centroidy=en,!0}return!1}return!1}return!1}for(var Pn=new Array,fn=!0,zn=null,vn=null,mn=-1e100,bn=!0,yn=n.polygon.gverts.next,gn=0,xn=n.polygon.edges.head;null!=xn;){var Zn=xn.elt,wn=Zn.gnormx*t.circle.worldCOMx+Zn.gnormy*t.circle.worldCOMy;if(wn>Zn.gprojection+t.circle.radius){bn=!1;break}wn+t.circle.radius>Zn.gprojection+p.Config.epsilon&&(fn=!1,Pn[gn]=!0),wn-=Zn.gprojection+t.circle.radius,wn>mn&&(mn=wn,zn=Zn,vn=yn),yn=yn.next,gn++,xn=xn.next}if(bn){if(fn)return e.overlap=t.circle.area,e.centroidx=t.circle.worldCOMx,e.centroidy=t.circle.worldCOMy,!0;var Cn,En=vn;Cn=null==vn.next?n.polygon.gverts.next:vn.next;var Sn=t.circle.worldCOMy*zn.gnormx-t.circle.worldCOMx*zn.gnormy;if(Sn<=En.y*zn.gnormx-En.x*zn.gnormy?!function(n){var e=t.circle.radius,i=0,r=0;return i=En.x-t.circle.worldCOMx,r=En.y-t.circle.worldCOMy,i*i+r*r<=e*e}():Sn>=Cn.y*zn.gnormx-Cn.x*zn.gnormy&&!function(n){var e=t.circle.radius,i=0,r=0;return i=Cn.x-t.circle.worldCOMx,r=Cn.y-t.circle.worldCOMy,i*i+r*r<=e*e}())return!1;for(var Nn=new Array,kn=0,Mn=!0,In=null,Fn=0,An=n.polygon.gverts.next;null!=An;){var Tn=An,Vn=o.geom.ZPP_VecMath.vec_dsq(Tn.x,Tn.y,t.circle.worldCOMx,t.circle.worldCOMy);(Nn[kn]=Vn<=t.circle.radius*t.circle.radius)?(Fn=kn,In=An):Mn=!1,kn++,An=An.next}if(Mn)return n.polygon.validate_worldCOM(),e.overlap=n.polygon.area,e.centroidx=n.polygon.worldCOMx,e.centroidy=n.polygon.worldCOMy,!0;for(;null!=o.geom.ZPP_Collide.flowpoly.head;){var Ln=o.geom.ZPP_Collide.flowpoly.pop_unsafe();if(!Ln._inuse){var Bn=Ln;null!=Bn.outer&&(Bn.outer.zpp_inner=null,Bn.outer=null),Bn._isimmutable=null,Bn._validate=null,Bn._invalidate=null,Bn.next=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=Bn}}o.geom.ZPP_Collide.flowsegs.clear();var On=null,Gn=1;for(null==In?(In=n.polygon.gverts.next,Gn=2):o.geom.ZPP_Collide.flowpoly.add(On=In);0!=Gn;)if(1==Gn)if(In=In.next,null==In&&(In=n.polygon.gverts.next),Fn++,Fn>=n.polygon.edgeCnt&&(Fn=0),Nn[Fn]){if(o.geom.ZPP_VecMath.vec_dsq(On.x,On.y,In.x,In.y)<p.Config.epsilon)break;o.geom.ZPP_Collide.flowpoly.add(In)}else{var Rn,Dn=o.geom.ZPP_Collide.flowpoly.head.elt,jn=In,qn=0,Yn=0;qn=jn.x-Dn.x,Yn=jn.y-Dn.y;var Un=0,Wn=0;Un=Dn.x-t.circle.worldCOMx,Wn=Dn.y-t.circle.worldCOMy;var Jn=qn*qn+Yn*Yn,Kn=2*(Un*qn+Wn*Yn),Hn=Un*Un+Wn*Wn-t.circle.radius*t.circle.radius,Xn=Math.sqrt(Kn*Kn-4*Jn*Hn);Jn=1/(2*Jn);var Qn=(-Kn-Xn)*Jn;Rn=Qn<p.Config.epsilon?(-Kn+Xn)*Jn:Qn;var $n=0,te=0,ne=Rn;if($n=Dn.x+(jn.x-Dn.x)*ne,te=Dn.y+(jn.y-Dn.y)*ne,o.geom.ZPP_VecMath.vec_dsq(On.x,On.y,$n,te)<p.Config.epsilon)break;o.geom.ZPP_Collide.flowpoly.add(o.geom.ZPP_Vec2.get($n,te,null)),Gn=2}else if(2==Gn){var ee=In.next;null==ee&&(ee=n.polygon.gverts.next);var ie=In;Gn=0;var re=ee,se=ee;do{var le=se,ae=Fn+1;if(ae==n.polygon.edgeCnt&&(ae=0),Pn[Fn]){if(Nn[ae]){var pe,oe=0,_e=0;oe=le.x-ie.x,_e=le.y-ie.y;var he=0,ue=0;he=ie.x-t.circle.worldCOMx,ue=ie.y-t.circle.worldCOMy;var de=oe*oe+_e*_e,ce=2*(he*oe+ue*_e),Pe=he*he+ue*ue-t.circle.radius*t.circle.radius,fe=Math.sqrt(ce*ce-4*de*Pe);de=1/(2*de);var ze=(-ce-fe)*de;pe=ze<p.Config.epsilon?(-ce+fe)*de:ze;var ve=0,me=0,be=pe;if(ve=ie.x+(le.x-ie.x)*be,me=ie.y+(le.y-ie.y)*be,o.geom.ZPP_VecMath.vec_dsq(On.x,On.y,ve,me)<p.Config.epsilon){Gn=0,se=re;break}var ye=o.geom.ZPP_Vec2.get(ve,me,null);o.geom.ZPP_Collide.flowsegs.add(o.geom.ZPP_Collide.flowpoly.head.elt),o.geom.ZPP_Collide.flowsegs.add(ye),o.geom.ZPP_Collide.flowpoly.add(ye),Gn=1,se=re;break}var ge,xe=0,Ze=0,we=0,Ce=0;we=le.x-ie.x,Ce=le.y-ie.y;var Ee=0,Se=0;Ee=ie.x-t.circle.worldCOMx,Se=ie.y-t.circle.worldCOMy;var Ne=we*we+Ce*Ce,ke=2*(Ee*we+Se*Ce),Me=Ee*Ee+Se*Se-t.circle.radius*t.circle.radius,Ie=ke*ke-4*Ne*Me;if(Ie*Ie<p.Config.epsilon?(xe=Ie<0?10:Ze=-ke/(2*Ne),ge=!1):(Ie=Math.sqrt(Ie),Ne=1/(2*Ne),xe=(-ke-Ie)*Ne,Ze=(-ke+Ie)*Ne,ge=!0),xe<1-p.Config.epsilon&&Ze>p.Config.epsilon){var Fe=0,Ae=0,Te=xe;if(Fe=ie.x+(le.x-ie.x)*Te,Ae=ie.y+(le.y-ie.y)*Te,null!=On&&o.geom.ZPP_VecMath.vec_dsq(On.x,On.y,Fe,Ae)<p.Config.epsilon){Gn=0,se=re;break}var Ve=o.geom.ZPP_Vec2.get(Fe,Ae,null);if(null!=o.geom.ZPP_Collide.flowpoly.head&&(o.geom.ZPP_Collide.flowsegs.add(o.geom.ZPP_Collide.flowpoly.head.elt),o.geom.ZPP_Collide.flowsegs.add(Ve)),o.geom.ZPP_Collide.flowpoly.add(Ve),null==On&&(On=o.geom.ZPP_Collide.flowpoly.head.elt),ge){var Le=0,Be=0,Oe=Ze;Le=ie.x+(le.x-ie.x)*Oe,Be=ie.y+(le.y-ie.y)*Oe,o.geom.ZPP_Collide.flowpoly.add(o.geom.ZPP_Vec2.get(Le,Be,null))}}}ie=le,In=se,Fn=ae,se=se.next,null==se&&(se=n.polygon.gverts.next)}while(!1);for(;se!=re;){var Ge=se,Re=Fn+1;if(Re==n.polygon.edgeCnt&&(Re=0),Pn[Fn]){if(Nn[Re]){var De,je=0,qe=0;je=Ge.x-ie.x,qe=Ge.y-ie.y;var Ye=0,Ue=0;Ye=ie.x-t.circle.worldCOMx,Ue=ie.y-t.circle.worldCOMy;var We=je*je+qe*qe,Je=2*(Ye*je+Ue*qe),Ke=Ye*Ye+Ue*Ue-t.circle.radius*t.circle.radius,He=Math.sqrt(Je*Je-4*We*Ke);We=1/(2*We);var Xe=(-Je-He)*We;De=Xe<p.Config.epsilon?(-Je+He)*We:Xe;var Qe=0,$e=0,ti=De;if(Qe=ie.x+(Ge.x-ie.x)*ti,$e=ie.y+(Ge.y-ie.y)*ti,o.geom.ZPP_VecMath.vec_dsq(On.x,On.y,Qe,$e)<p.Config.epsilon){Gn=0,se=re;break}var ni=o.geom.ZPP_Vec2.get(Qe,$e,null);o.geom.ZPP_Collide.flowsegs.add(o.geom.ZPP_Collide.flowpoly.head.elt),o.geom.ZPP_Collide.flowsegs.add(ni),o.geom.ZPP_Collide.flowpoly.add(ni),Gn=1,se=re;break}var ei,ii=0,ri=0,si=0,li=0;si=Ge.x-ie.x,li=Ge.y-ie.y;var ai=0,pi=0;ai=ie.x-t.circle.worldCOMx,pi=ie.y-t.circle.worldCOMy;var oi=si*si+li*li,_i=2*(ai*si+pi*li),hi=ai*ai+pi*pi-t.circle.radius*t.circle.radius,ui=_i*_i-4*oi*hi;if(ui*ui<p.Config.epsilon?(ii=ui<0?10:ri=-_i/(2*oi),ei=!1):(ui=Math.sqrt(ui),oi=1/(2*oi),ii=(-_i-ui)*oi,ri=(-_i+ui)*oi,ei=!0),ii<1-p.Config.epsilon&&ri>p.Config.epsilon){var di=0,ci=0,Pi=ii;if(di=ie.x+(Ge.x-ie.x)*Pi,ci=ie.y+(Ge.y-ie.y)*Pi,null!=On&&o.geom.ZPP_VecMath.vec_dsq(On.x,On.y,di,ci)<p.Config.epsilon){Gn=0,se=re;break}var fi=o.geom.ZPP_Vec2.get(di,ci,null);if(null!=o.geom.ZPP_Collide.flowpoly.head&&(o.geom.ZPP_Collide.flowsegs.add(o.geom.ZPP_Collide.flowpoly.head.elt),o.geom.ZPP_Collide.flowsegs.add(fi)),o.geom.ZPP_Collide.flowpoly.add(fi),null==On&&(On=o.geom.ZPP_Collide.flowpoly.head.elt),ei){var zi=0,vi=0,mi=ri;zi=ie.x+(Ge.x-ie.x)*mi,vi=ie.y+(Ge.y-ie.y)*mi,o.geom.ZPP_Collide.flowpoly.add(o.geom.ZPP_Vec2.get(zi,vi,null))}}}ie=Ge,In=se,Fn=Re,se=se.next,null==se&&(se=n.polygon.gverts.next)}}if(null==o.geom.ZPP_Collide.flowpoly.head)return!1;if(null==o.geom.ZPP_Collide.flowpoly.head.next){for(var bi=!0,yi=n.polygon.edges.head;null!=yi;){var gi=yi.elt;if(gi.gnormx*t.circle.worldCOMx+gi.gnormy*t.circle.worldCOMy>gi.gprojection){bi=!1;break}yi=yi.next}return!!bi&&(e.overlap=t.circle.area,e.centroidx=t.circle.worldCOMx,e.centroidy=t.circle.worldCOMy,!0)}var xi=0,Zi=0,wi=0;if(null!=o.geom.ZPP_Collide.flowpoly.head.next.next){var Ci=0,Ei=0,Si=0;Ei=0,Si=0,Ci=0;var Ni=o.geom.ZPP_Collide.flowpoly.head,ki=Ni.elt;Ni=Ni.next;var Mi=Ni.elt;for(Ni=Ni.next;null!=Ni;){var Ii=Ni.elt;Ci+=Mi.x*(Ii.y-ki.y);var Fi=Ii.y*Mi.x-Ii.x*Mi.y;Ei+=(Mi.x+Ii.x)*Fi,Si+=(Mi.y+Ii.y)*Fi,ki=Mi,Mi=Ii,Ni=Ni.next}Ni=o.geom.ZPP_Collide.flowpoly.head;var Ai=Ni.elt;Ci+=Mi.x*(Ai.y-ki.y);var Ti=Ai.y*Mi.x-Ai.x*Mi.y;Ei+=(Mi.x+Ai.x)*Ti,Si+=(Mi.y+Ai.y)*Ti,ki=Mi,Mi=Ai,Ni=Ni.next;var Vi=Ni.elt;Ci+=Mi.x*(Vi.y-ki.y);var Li=Vi.y*Mi.x-Vi.x*Mi.y;Ei+=(Mi.x+Vi.x)*Li,Si+=(Mi.y+Vi.y)*Li,Ci*=.5;var Bi=1/(6*Ci),Oi=Bi;Ei*=Oi,Si*=Oi;var Gi=-Ci;xi+=Ei*Gi,Zi+=Si*Gi,wi-=Ci}else o.geom.ZPP_Collide.flowsegs.add(o.geom.ZPP_Collide.flowpoly.head.elt),o.geom.ZPP_Collide.flowsegs.add(o.geom.ZPP_Collide.flowpoly.head.next.elt);for(;null!=o.geom.ZPP_Collide.flowsegs.head;){var Ri=o.geom.ZPP_Collide.flowsegs.pop_unsafe(),Di=o.geom.ZPP_Collide.flowsegs.pop_unsafe(),ji=0,qi=0;ji=Di.x-Ri.x,qi=Di.y-Ri.y;var Yi=0,Ui=0;Yi=ji,Ui=qi;var Wi=Yi*Yi+Ui*Ui,Ji=1/Math.sqrt(Wi),Ki=Ji;Yi*=Ki,Ui*=Ki;var Hi=Yi;Yi=-Ui,Ui=Hi;var Xi=0,Qi=0;Xi=Ri.x+Di.x,Qi=Ri.y+Di.y;Xi*=.5,Qi*=.5;Xi-=1*t.circle.worldCOMx,Qi-=1*t.circle.worldCOMy;var $i=Yi*Xi+Ui*Qi,tr=0,nr=0,er=$i,ir=er/t.circle.radius,rr=Math.sqrt(1-ir*ir),sr=Math.acos(ir);tr=t.circle.radius*(t.circle.radius*sr-er*rr),nr=.6666666666666666*t.circle.radius*rr*rr*rr/(sr-ir*rr),Xi=t.circle.worldCOMx,Qi=t.circle.worldCOMy;var lr=nr;Xi+=Yi*lr,Qi+=Ui*lr;var ar=tr;xi+=Xi*ar,Zi+=Qi*ar,wi+=tr}var pr=1/wi;return xi*=pr,Zi*=pr,e.overlap=wi,e.centroidx=xi,e.centroidy=Zi,!0}return!1}var or=t.circle,_r=n.circle,hr=0,ur=0;hr=_r.worldCOMx-or.worldCOMx,ur=_r.worldCOMy-or.worldCOMy;var dr=or.radius+_r.radius,cr=hr*hr+ur*ur;if(cr>dr*dr)return!1;if(cr<p.Config.epsilon*p.Config.epsilon)return or.radius<_r.radius?(e.overlap=or.area,e.centroidx=or.worldCOMx,e.centroidy=or.worldCOMy):(e.overlap=_r.area,e.centroidx=_r.worldCOMx,e.centroidy=_r.worldCOMy),!0;var Pr=Math.sqrt(cr),fr=1/Pr,zr=.5*(Pr-(_r.radius*_r.radius-or.radius*or.radius)*fr);if(zr<=-or.radius)e.overlap=or.area,e.centroidx=or.worldCOMx,e.centroidy=or.worldCOMy;else{var vr=Pr-zr;if(vr<=-_r.radius)e.overlap=_r.area,e.centroidx=_r.worldCOMx,e.centroidy=_r.worldCOMy;else{var mr=0,br=0,yr=0,gr=0,xr=zr,Zr=xr/or.radius,wr=Math.sqrt(1-Zr*Zr),Cr=Math.acos(Zr);mr=or.radius*(or.radius*Cr-xr*wr),br=.6666666666666666*or.radius*wr*wr*wr/(Cr-Zr*wr);var Er=vr,Sr=Er/_r.radius,Nr=Math.sqrt(1-Sr*Sr),kr=Math.acos(Sr);yr=_r.radius*(_r.radius*kr-Er*Nr),gr=.6666666666666666*_r.radius*Nr*Nr*Nr/(kr-Sr*Nr);var Mr=mr+yr,Ir=(br*mr+(Pr-gr)*yr)/Mr*fr;e.overlap=Mr,e.centroidx=or.worldCOMx+hr*Ir,e.centroidy=or.worldCOMy+ur*Ir}}return!0},o.geom.ZPP_Convex=function(){},o.geom.ZPP_Convex.__name__=!0,o.geom.ZPP_Convex.isinner=function(t,n,e){var i=0,r=0;i=t.x-n.x,r=t.y-n.y;var s=0;return s=e.x-n.x,(e.y-n.y)*i-s*r>=0},o.geom.ZPP_Convex.optimise=function(t){var n=t.vertices,e=t.vertices;if(null!=n){var i=n;do{i.sort(),i=i.next}while(i!=e)}var r=t.vertices,s=t.vertices;if(null!=r){var l=r;do{for(var a=l,p=a.prev,_=null,h=a.diagonals.head;null!=h;){var u,d=h.elt;if(u=null==h.next?a.next:h.next.elt,o.geom.ZPP_Convex.isinner(u,a,p)){for(var c=!0,P=d,f=P.prev,z=null,v=P.diagonals.head;null!=v;){var m=v.elt;if(m==a){var b;b=null==v.next?P.next:v.next.elt,c=o.geom.ZPP_Convex.isinner(b,P,f);break}f=m,z=v,v=v.next}c?(h=a.diagonals.erase(_),P.diagonals.erase(z)):(p=d,_=h,h=h.next)}else _=h,p=d,h=h.next}l=l.next}while(l!=s)}},o.geom.ZPP_ConvexRayResult=function(){this.toiDistance=0,this.next=null,this.inner=!1,this.ray=null,this.position=null,this.convex=null,this.shape=null,this.normal=null},o.geom.ZPP_ConvexRayResult.__name__=!0,o.geom.ZPP_ConvexRayResult.getRay=function(t,n,e,i){var r;null==o.geom.ZPP_ConvexRayResult.rayPool?(o.geom.ZPP_ConvexRayResult.internal=!0,r=new p.geom.RayResult,r.zpp_inner=new o.geom.ZPP_ConvexRayResult,r.zpp_inner.ray=r,o.geom.ZPP_ConvexRayResult.internal=!1):(r=o.geom.ZPP_ConvexRayResult.rayPool.ray,o.geom.ZPP_ConvexRayResult.rayPool=o.geom.ZPP_ConvexRayResult.rayPool.next,r.zpp_inner.next=null);var s=r.zpp_inner;return s.normal=t,t.zpp_inner._immutable=!0,s.toiDistance=n,s.inner=e,s.shape=i,r},o.geom.ZPP_ConvexRayResult.getConvex=function(t,n,e,i){var r;null==o.geom.ZPP_ConvexRayResult.convexPool?(o.geom.ZPP_ConvexRayResult.internal=!0,r=new p.geom.ConvexResult,r.zpp_inner=new o.geom.ZPP_ConvexRayResult,r.zpp_inner.convex=r,o.geom.ZPP_ConvexRayResult.internal=!1):(r=o.geom.ZPP_ConvexRayResult.convexPool.convex,o.geom.ZPP_ConvexRayResult.convexPool=o.geom.ZPP_ConvexRayResult.convexPool.next,r.zpp_inner.next=null);var s=r.zpp_inner;return s.normal=t,s.position=n,t.zpp_inner._immutable=!0,n.zpp_inner._immutable=!0,s.toiDistance=e,s.shape=i,r},o.geom.ZPP_ConvexRayResult.prototype={disposed:function(){if(null!=this.next)throw"Error: This object has been disposed of and cannot be used"},free:function(){this.normal.zpp_inner._immutable=!1,this.normal.dispose(),null!=this.position&&(this.position.zpp_inner._immutable=!1,this.position.dispose()),this.shape=null,this.toiDistance=0,null!=this.convex?(this.next=o.geom.ZPP_ConvexRayResult.convexPool,o.geom.ZPP_ConvexRayResult.convexPool=this):(this.next=o.geom.ZPP_ConvexRayResult.rayPool,o.geom.ZPP_ConvexRayResult.rayPool=this)},__class__:o.geom.ZPP_ConvexRayResult},o.geom.ZPP_CutVert=function(){this.used=!1,this.rank=0,this.parent=null,this.positive=!1,this.value=0,this.vert=null,this.posy=0,this.posx=0,this.next=null,this.prev=null},o.geom.ZPP_CutVert.__name__=!0,o.geom.ZPP_CutVert.path=function(t){var n;return null==o.geom.ZPP_CutVert.zpp_pool?n=new o.geom.ZPP_CutVert:(n=o.geom.ZPP_CutVert.zpp_pool,o.geom.ZPP_CutVert.zpp_pool=n.next,n.next=null),n.vert=t,n.parent=n,n.rank=0,n.used=!1,n},o.geom.ZPP_CutVert.prototype={alloc:function(){},free:function(){this.vert=null,this.parent=null},__class__:o.geom.ZPP_CutVert},o.geom.ZPP_CutInt=function(){this.path1=null,this.start=null,this.end=null,this.path0=null,this.vertex=!1,this.virtualint=!1,this.time=0,this.next=null},o.geom.ZPP_CutInt.__name__=!0,o.geom.ZPP_CutInt.get=function(t,n,e,i,r,s,l){null==l&&(l=!1),null==s&&(s=!1);var a;return null==o.geom.ZPP_CutInt.zpp_pool?a=new o.geom.ZPP_CutInt:(a=o.geom.ZPP_CutInt.zpp_pool,o.geom.ZPP_CutInt.zpp_pool=a.next,a.next=null),a.virtualint=s,a.end=n,a.start=e,a.path0=i,a.path1=r,a.time=t,a.vertex=l,a},o.geom.ZPP_CutInt.prototype={alloc:function(){},free:function(){this.end=this.start=null,this.path0=this.path1=null},__class__:o.geom.ZPP_CutInt},o.geom.ZPP_Cutter=function(){},o.geom.ZPP_Cutter.__name__=!0,o.geom.ZPP_Cutter.run=function(t,n,e,i,r,s){var l=0,a=0;if(null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";if(n.zpp_inner.validate(),l=n.zpp_inner.x,null!=n&&n.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";n.zpp_inner.validate(),a=n.zpp_inner.y;var _=0,h=0;_=function(t){if(null!=e&&e.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return e.zpp_inner.validate(),e.zpp_inner.x}()-l,h=function(t){if(null!=e&&e.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return e.zpp_inner.validate(),e.zpp_inner.y}()-a;var u;u=i?0:Math.NEGATIVE_INFINITY;var d;d=r?1:Math.POSITIVE_INFINITY;var c=-(a*_-l*h),P=null,f=!1,z=t;do{var v;null==o.geom.ZPP_CutVert.zpp_pool?v=new o.geom.ZPP_CutVert:(v=o.geom.ZPP_CutVert.zpp_pool,o.geom.ZPP_CutVert.zpp_pool=v.next,v.next=null),v.vert=z,v.posx=v.vert.x,v.posy=v.vert.y,v.value=v.posy*_-v.posx*h+c,v.positive=v.value>0,0==v.value&&(f=!0);var m=v;null==P?P=m.prev=m.next=m:(m.prev=P,m.next=P.next,P.next.prev=m,P.next=m),P=m,z=z.next}while(z!=t);if(f){var b=null,y=P,g=P;if(null!=y){var x=y;do{var Z=x;if(0!=Z.value){b=Z;break}x=x.next}while(x!=g)}var w=0,C=0;w=_,C=h;var E=w*w+C*C,S=1/Math.sqrt(E),N=S;w*=N,C*=N;var k=w;w=-C,C=k;var M=null,I=b;do{if(0==I.value||null!=M&&I!=M.next){var F=M.value*I.value;if(0!=F){var A,T=M.next;if(F>0)A=M.positive;else{var V=T.next,L=0,B=0;L=T.posx+V.posx,B=T.posy+V.posy;L*=.5,B*=.5;var O=L+1e-8*w,G=B+1e-8*C,R=!1,D=t,j=t;if(null!=D){var q=D;do{var Y=q,U=Y.prev;(Y.y<G&&U.y>=G||U.y<G&&Y.y>=G)&&(Y.x<=O||U.x<=O)&&Y.x+(G-Y.y)/(U.y-Y.y)*(U.x-Y.x)<O&&(R=!R),q=q.next}while(q!=j)}A=R}var W=T,J=I;if(null!=W){var K=W;do{var H=K;H.positive=A,K=K.next}while(K!=J)}M=I,I=I.next}else I=I.next}else M=I,I=I.next}while(I!=b);if(0==I.value||null!=M&&I!=M.next){var X=M.value*I.value;if(0!=X){var Q,$=M.next;if(X>0)Q=M.positive;else{var tt=$.next,nt=0,et=0;nt=$.posx+tt.posx,et=$.posy+tt.posy;nt*=.5,et*=.5;var it=nt+1e-8*w,rt=et+1e-8*C,st=!1,lt=t,at=t;if(null!=lt){var pt=lt;do{var ot=pt,_t=ot.prev;(ot.y<rt&&_t.y>=rt||_t.y<rt&&ot.y>=rt)&&(ot.x<=it||_t.x<=it)&&ot.x+(rt-ot.y)/(_t.y-ot.y)*(_t.x-ot.x)<it&&(st=!st),pt=pt.next}while(pt!=at)}Q=st}var ht=$,ut=I;if(null!=ht){var dt=ht;do{dt.positive=Q,dt=dt.next}while(dt!=ut)}M=I,I=I.next}else I=I.next}else M=I,I=I.next}null==o.geom.ZPP_Cutter.ints&&(o.geom.ZPP_Cutter.ints=new o.util.ZNPList_ZPP_CutInt),null==o.geom.ZPP_Cutter.paths&&(o.geom.ZPP_Cutter.paths=new o.util.ZNPList_ZPP_CutVert);var ct=null,Pt=o.geom.ZPP_GeomVert.get(P.posx,P.posy);null==ct?ct=Pt.prev=Pt.next=Pt:(Pt.next=ct,Pt.prev=ct.prev,ct.prev.next=Pt,ct.prev=Pt);var ft=ct,zt=o.geom.ZPP_CutVert.path(ct);o.geom.ZPP_Cutter.paths.add(zt);var vt=P;do{var mt=vt.next,bt=o.geom.ZPP_GeomVert.get(mt.posx,mt.posy);if(vt.positive==mt.positive){var yt=bt;null==ct?ct=yt.prev=yt.next=yt:(yt.next=ct,yt.prev=ct.prev,ct.prev.next=yt,ct.prev=yt)}else{var gt=0,xt=0;gt=mt.posx-vt.posx,xt=mt.posy-vt.posy;var Zt=h*gt-_*xt;Zt=1/Zt;var wt=0,Ct=0;wt=l-vt.posx,Ct=a-vt.posy;var Et=(xt*wt-gt*Ct)*Zt;if(Et<u||Et>d){o.geom.ZPP_Cutter.ints.add(o.geom.ZPP_CutInt.get(Et,null,null,null,null,!0,null));var St=bt;null==ct?ct=St.prev=St.next=St:(St.next=ct,St.prev=ct.prev,ct.prev.next=St,ct.prev=St)}else if(0==vt.value){var Nt=ct.prev;ct=null;var kt=o.geom.ZPP_GeomVert.get(Nt.x,Nt.y);null==ct?ct=kt.prev=kt.next=kt:(kt.next=ct,kt.prev=ct.prev,ct.prev.next=kt,ct.prev=kt);var Mt=bt;null==ct?ct=Mt.prev=Mt.next=Mt:(Mt.next=ct,Mt.prev=ct.prev,ct.prev.next=Mt,ct.prev=Mt);var It=o.geom.ZPP_Cutter.paths.head.elt;o.geom.ZPP_Cutter.paths.add(o.geom.ZPP_CutVert.path(ct));var Ft=o.geom.ZPP_Cutter.paths.head.elt;o.geom.ZPP_Cutter.ints.add(o.geom.ZPP_CutInt.get(Et,Nt,ct,It,Ft,!0,null))}else if(0==mt.value){var At=bt;null==ct?ct=At.prev=At.next=At:(At.next=ct,At.prev=ct.prev,ct.prev.next=At,ct.prev=At);var Tt=ct.prev;ct=null;var Vt=o.geom.ZPP_GeomVert.get(mt.posx,mt.posy);null==ct?ct=Vt.prev=Vt.next=Vt:(Vt.next=ct,Vt.prev=ct.prev,ct.prev.next=Vt,ct.prev=Vt);var Lt=o.geom.ZPP_Cutter.paths.head.elt;o.geom.ZPP_Cutter.paths.add(o.geom.ZPP_CutVert.path(ct));var Bt=o.geom.ZPP_Cutter.paths.head.elt;o.geom.ZPP_Cutter.ints.add(o.geom.ZPP_CutInt.get(Et,Tt,ct,Lt,Bt,!0,null))}else{var Ot=(h*wt-_*Ct)*Zt,Gt=0,Rt=0;Gt=vt.posx,Rt=vt.posy;var Dt=Ot;Gt+=gt*Dt,Rt+=xt*Dt;var jt=o.geom.ZPP_GeomVert.get(Gt,Rt);null==ct?ct=jt.prev=jt.next=jt:(jt.next=ct,jt.prev=ct.prev,ct.prev.next=jt,ct.prev=jt);var qt=ct.prev;ct=null;var Yt=o.geom.ZPP_GeomVert.get(Gt,Rt);null==ct?ct=Yt.prev=Yt.next=Yt:(Yt.next=ct,Yt.prev=ct.prev,ct.prev.next=Yt,ct.prev=Yt);var Ut=bt;null==ct?ct=Ut.prev=Ut.next=Ut:(Ut.next=ct,Ut.prev=ct.prev,ct.prev.next=Ut,ct.prev=Ut);var Wt=o.geom.ZPP_Cutter.paths.head.elt;o.geom.ZPP_Cutter.paths.add(o.geom.ZPP_CutVert.path(ct));var Jt=o.geom.ZPP_Cutter.paths.head.elt;o.geom.ZPP_Cutter.ints.add(o.geom.ZPP_CutInt.get(Et,qt,ct,Wt,Jt,!1,null))}}vt=vt.next}while(vt!=P);var Kt=ct.prev;Kt.next.prev=ft.prev,ft.prev.next=Kt.next,Kt.next=ft,ft.prev=Kt;var Ht,Xt=o.geom.ZPP_Cutter.paths.head.elt;if(zt==zt.parent)Ht=zt;else{for(var Qt=zt,$t=null;Qt!=Qt.parent;){var tn=Qt.parent;Qt.parent=$t,$t=Qt,Qt=tn}for(;null!=$t;){var nn=$t.parent;$t.parent=Qt,$t=nn}Ht=Qt}var en;if(Xt==Xt.parent)en=Xt;else{for(var rn=Xt,sn=null;rn!=rn.parent;){var ln=rn.parent;rn.parent=sn,sn=rn,rn=ln}for(;null!=sn;){var an=sn.parent;sn.parent=rn,sn=an}en=rn}Ht!=en&&(Ht.rank<en.rank?Ht.parent=en:Ht.rank>en.rank?en.parent=Ht:(en.parent=Ht,Ht.rank++));var pn=o.geom.ZPP_Cutter.ints;if(null!=pn.head&&null!=pn.head.next){var on,_n,hn,un=pn.head,dn=null,cn=null,Pn=null,fn=null,zn=1;do{for(on=0,cn=un,dn=un=null;null!=cn;){for(on++,Pn=cn,_n=0,hn=zn;null!=Pn&&_n<zn;)_n++,Pn=Pn.next;for(;_n>0||hn>0&&null!=Pn;)0==_n?(fn=Pn,Pn=Pn.next,hn--):0==hn||null==Pn?(fn=cn,cn=cn.next,_n--):cn.elt.time<Pn.elt.time?(fn=cn,cn=cn.next,_n--):(fn=Pn,Pn=Pn.next,hn--),null!=dn?dn.next=fn:un=fn,dn=fn;cn=Pn}dn.next=null,zn<<=1}while(on>1);pn.head=un,pn.modified=!0,pn.pushmod=!0}for(;null!=o.geom.ZPP_Cutter.ints.head;){var vn=o.geom.ZPP_Cutter.ints.pop_unsafe(),mn=o.geom.ZPP_Cutter.ints.pop_unsafe();if(vn.virtualint||mn.virtualint){if(vn.virtualint&&!mn.virtualint){if(null!=mn.end&&mn.end.prev==mn.end){mn.end.next=mn.end.prev=null;var bn=mn.end;null!=bn.wrap&&(bn.wrap.zpp_inner._inuse=!1,bn.wrap.dispose(),bn.wrap=null),bn.prev=bn.next=null,bn.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=bn,mn.end=null}else{var yn=mn.end.prev;mn.end.prev.next=mn.end.next,mn.end.next.prev=mn.end.prev,mn.end.next=mn.end.prev=null;var gn=mn.end;null!=gn.wrap&&(gn.wrap.zpp_inner._inuse=!1,gn.wrap.dispose(),gn.wrap=null),gn.prev=gn.next=null,gn.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=gn,mn.end=null,mn.end=yn}if(!mn.vertex)if(mn.end!=mn.path0.vert)if(mn.start.x=mn.end.x,mn.start.y=mn.end.y,null!=mn.end&&mn.end.prev==mn.end){mn.end.next=mn.end.prev=null;var xn=mn.end;null!=xn.wrap&&(xn.wrap.zpp_inner._inuse=!1,xn.wrap.dispose(),xn.wrap=null),xn.prev=xn.next=null,xn.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=xn,mn.end=null}else{var Zn=mn.end.prev;mn.end.prev.next=mn.end.next,mn.end.next.prev=mn.end.prev,mn.end.next=mn.end.prev=null;var wn=mn.end;null!=wn.wrap&&(wn.wrap.zpp_inner._inuse=!1,wn.wrap.dispose(),wn.wrap=null),wn.prev=wn.next=null,wn.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=wn,mn.end=null,mn.end=Zn}else{var Cn=mn.start.next;if(mn.start.x=Cn.x,mn.start.y=Cn.y,null!=Cn&&Cn.prev==Cn){Cn.next=Cn.prev=null;var En=Cn;null!=En.wrap&&(En.wrap.zpp_inner._inuse=!1,En.wrap.dispose(),En.wrap=null),En.prev=En.next=null,En.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=En,Cn=null}else{Cn.prev.next=Cn.next,Cn.next.prev=Cn.prev,Cn.next=Cn.prev=null;var Sn=Cn;null!=Sn.wrap&&(Sn.wrap.zpp_inner._inuse=!1,Sn.wrap.dispose(),Sn.wrap=null),Sn.prev=Sn.next=null,Sn.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=Sn}}mn.end.next.prev=mn.start.prev,mn.start.prev.next=mn.end.next,mn.end.next=mn.start,mn.start.prev=mn.end;var Nn;if(mn.path0==mn.path0.parent)Nn=mn.path0;else{for(var kn=mn.path0,Mn=null;kn!=kn.parent;){var In=kn.parent;kn.parent=Mn,Mn=kn,kn=In}for(;null!=Mn;){var Fn=Mn.parent;Mn.parent=kn,Mn=Fn}Nn=kn}var An;if(mn.path1==mn.path1.parent)An=mn.path1;else{for(var Tn=mn.path1,Vn=null;Tn!=Tn.parent;){var Ln=Tn.parent;Tn.parent=Vn,Vn=Tn,Tn=Ln}for(;null!=Vn;){var Bn=Vn.parent;Vn.parent=Tn,Vn=Bn}An=Tn}Nn!=An&&(Nn.rank<An.rank?Nn.parent=An:Nn.rank>An.rank?An.parent=Nn:(An.parent=Nn,Nn.rank++))}else if(mn.virtualint&&!vn.virtualint){if(null!=vn.end&&vn.end.prev==vn.end){vn.end.next=vn.end.prev=null;var On=vn.end;null!=On.wrap&&(On.wrap.zpp_inner._inuse=!1,On.wrap.dispose(),On.wrap=null),On.prev=On.next=null,On.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=On,vn.end=null}else{var Gn=vn.end.prev;vn.end.prev.next=vn.end.next,vn.end.next.prev=vn.end.prev,vn.end.next=vn.end.prev=null;var Rn=vn.end;null!=Rn.wrap&&(Rn.wrap.zpp_inner._inuse=!1,Rn.wrap.dispose(),Rn.wrap=null),Rn.prev=Rn.next=null,Rn.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=Rn,vn.end=null,vn.end=Gn}if(!vn.vertex)if(vn.end!=vn.path0.vert)if(vn.start.x=vn.end.x,vn.start.y=vn.end.y,null!=vn.end&&vn.end.prev==vn.end){vn.end.next=vn.end.prev=null;var Dn=vn.end;null!=Dn.wrap&&(Dn.wrap.zpp_inner._inuse=!1,Dn.wrap.dispose(),Dn.wrap=null),Dn.prev=Dn.next=null,Dn.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=Dn,vn.end=null}else{var jn=vn.end.prev;vn.end.prev.next=vn.end.next,vn.end.next.prev=vn.end.prev,vn.end.next=vn.end.prev=null;var qn=vn.end;null!=qn.wrap&&(qn.wrap.zpp_inner._inuse=!1,qn.wrap.dispose(),qn.wrap=null),qn.prev=qn.next=null,qn.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=qn,vn.end=null,vn.end=jn}else{var Yn=vn.start.next;if(vn.start.x=Yn.x,vn.start.y=Yn.y,null!=Yn&&Yn.prev==Yn){Yn.next=Yn.prev=null;var Un=Yn;null!=Un.wrap&&(Un.wrap.zpp_inner._inuse=!1,Un.wrap.dispose(),Un.wrap=null),Un.prev=Un.next=null,Un.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=Un,Yn=null}else{Yn.prev.next=Yn.next,Yn.next.prev=Yn.prev,Yn.next=Yn.prev=null;var Wn=Yn;null!=Wn.wrap&&(Wn.wrap.zpp_inner._inuse=!1,Wn.wrap.dispose(),Wn.wrap=null),Wn.prev=Wn.next=null,Wn.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=Wn}}vn.end.next.prev=vn.start.prev,vn.start.prev.next=vn.end.next,vn.end.next=vn.start,vn.start.prev=vn.end;var Jn;if(vn.path0==vn.path0.parent)Jn=vn.path0;else{for(var Kn=vn.path0,Hn=null;Kn!=Kn.parent;){var Xn=Kn.parent;Kn.parent=Hn,Hn=Kn,Kn=Xn}for(;null!=Hn;){var Qn=Hn.parent;Hn.parent=Kn,Hn=Qn}Jn=Kn}var $n;if(vn.path1==vn.path1.parent)$n=vn.path1;else{for(var te=vn.path1,ne=null;te!=te.parent;){var ee=te.parent;te.parent=ne,ne=te,te=ee}for(;null!=ne;){var ie=ne.parent;ne.parent=te,ne=ie}$n=te}Jn!=$n&&(Jn.rank<$n.rank?Jn.parent=$n:Jn.rank>$n.rank?$n.parent=Jn:($n.parent=Jn,Jn.rank++))}}else{vn.end.next.prev=mn.start.prev,mn.start.prev.next=vn.end.next,vn.end.next=mn.start,mn.start.prev=vn.end,mn.end.next.prev=vn.start.prev,vn.start.prev.next=mn.end.next,mn.end.next=vn.start,vn.start.prev=mn.end;var re;if(vn.path0==vn.path0.parent)re=vn.path0;else{for(var se=vn.path0,le=null;se!=se.parent;){var ae=se.parent;se.parent=le,le=se,se=ae}for(;null!=le;){var pe=le.parent;le.parent=se,le=pe}re=se}var oe;if(mn.path1==mn.path1.parent)oe=mn.path1;else{for(var _e=mn.path1,he=null;_e!=_e.parent;){var ue=_e.parent;_e.parent=he,he=_e,_e=ue}for(;null!=he;){var de=he.parent;he.parent=_e,he=de}oe=_e}re!=oe&&(re.rank<oe.rank?re.parent=oe:re.rank>oe.rank?oe.parent=re:(oe.parent=re,re.rank++));var ce;if(vn.path1==vn.path1.parent)ce=vn.path1;else{for(var Pe=vn.path1,fe=null;Pe!=Pe.parent;){var ze=Pe.parent;Pe.parent=fe,fe=Pe,Pe=ze}for(;null!=fe;){var ve=fe.parent;fe.parent=Pe,fe=ve}ce=Pe}var me;if(mn.path0==mn.path0.parent)me=mn.path0;else{for(var be=mn.path0,ye=null;be!=be.parent;){var ge=be.parent;be.parent=ye,ye=be,be=ge}for(;null!=ye;){var xe=ye.parent;ye.parent=be,ye=xe}me=be}ce!=me&&(ce.rank<me.rank?ce.parent=me:ce.rank>me.rank?me.parent=ce:(me.parent=ce,ce.rank++))}var Ze=vn;Ze.end=Ze.start=null,Ze.path0=Ze.path1=null,Ze.next=o.geom.ZPP_CutInt.zpp_pool,o.geom.ZPP_CutInt.zpp_pool=Ze;var we=mn;we.end=we.start=null,we.path0=we.path1=null,we.next=o.geom.ZPP_CutInt.zpp_pool,o.geom.ZPP_CutInt.zpp_pool=we}var Ce;Ce=null==s?new p.geom.GeomPolyList:s;for(var Ee=o.geom.ZPP_Cutter.paths.head;null!=Ee;){var Se,Ne=Ee.elt;if(Ne==Ne.parent)Se=Ne;else{for(var ke=Ne,Me=null;ke!=ke.parent;){var Ie=ke.parent;ke.parent=Me,Me=ke,ke=Ie}for(;null!=Me;){var Fe=Me.parent;Me.parent=ke,Me=Fe}Se=ke}if(Se.used)Ee=Ee.next;else{Se.used=!0
;for(var Ae=Se.vert,Te=!0;null!=Se.vert&&(Te||Ae!=Se.vert);)if(Te=!1,Ae.x==Ae.next.x&&Ae.y==Ae.next.y)if(Ae==Se.vert&&(Ae.next==Ae?Se.vert=null:Se.vert=Ae.next,Te=!0),null!=Ae&&Ae.prev==Ae)Ae.next=Ae.prev=null,Ae=Ae=null;else{var Ve=Ae.next;Ae.prev.next=Ae.next,Ae.next.prev=Ae.prev,Ae.next=Ae.prev=null,Ae=null,Ae=Ve}else Ae=Ae.next;if(null!=Se.vert){var Le=p.geom.GeomPoly.get();Le.zpp_inner.vertices=Se.vert,Ce.zpp_inner.reverse_flag?Ce.push(Le):Ce.unshift(Le)}Ee=Ee.next}}for(;null!=o.geom.ZPP_Cutter.paths.head;){var Be=o.geom.ZPP_Cutter.paths.pop_unsafe(),Oe=Be;Oe.vert=null,Oe.parent=null,Oe.next=o.geom.ZPP_CutVert.zpp_pool,o.geom.ZPP_CutVert.zpp_pool=Oe}for(;null!=P;)if(null!=P&&P.prev==P){P.next=P.prev=null;var Ge=P;Ge.vert=null,Ge.parent=null,Ge.next=o.geom.ZPP_CutVert.zpp_pool,o.geom.ZPP_CutVert.zpp_pool=Ge,P=P=null}else{var Re=P.next;P.prev.next=P.next,P.next.prev=P.prev,P.next=P.prev=null;var De=P;De.vert=null,De.parent=null,De.next=o.geom.ZPP_CutVert.zpp_pool,o.geom.ZPP_CutVert.zpp_pool=De,P=null,P=Re}return Ce},o.geom.ZPP_Geom=function(){},o.geom.ZPP_Geom.__name__=!0,o.geom.ZPP_Geom.validateShape=function(t){t.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&t.polygon.validate_gaxi(),t.zip_aabb&&null!=t.body&&(t.zip_aabb=!1,t.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.circle.__validate_aabb():t.polygon.__validate_aabb()),t.zip_worldCOM&&null!=t.body&&(t.zip_worldCOM=!1,t.zip_localCOM&&(t.zip_localCOM=!1,t.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&t.polygon.__validate_localCOM(),null!=t.wrap_localCOM&&(t.wrap_localCOM.zpp_inner.x=t.localCOMx,t.wrap_localCOM.zpp_inner.y=t.localCOMy)),t.body.validate_axis(),t.worldCOMx=t.body.posx+(t.body.axisy*t.localCOMx-t.body.axisx*t.localCOMy),t.worldCOMy=t.body.posy+(t.localCOMx*t.body.axisx+t.localCOMy*t.body.axisy))},o.geom.ZPP_GeomVert=function(){this.forced=!1,this.wrap=null,this.next=null,this.prev=null,this.y=0,this.x=0};o.geom.ZPP_GeomVert.__name__=!0,o.geom.ZPP_GeomVert.get=function(t,n){var e;return null==o.geom.ZPP_GeomVert.zpp_pool?e=new o.geom.ZPP_GeomVert:(e=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=e.next,e.next=null),e.forced=!1,e.x=t,e.y=n,e},o.geom.ZPP_GeomVert.prototype={free:function(){null!=this.wrap&&(this.wrap.zpp_inner._inuse=!1,this.wrap.dispose(),this.wrap=null),this.prev=this.next=null},alloc:function(){this.forced=!1},wrapper:function(){return null==this.wrap&&(this.wrap=p.geom.Vec2.get(this.x,this.y,null),this.wrap.zpp_inner._inuse=!0,this.wrap.zpp_inner._invalidate=n(this,this.modwrap),this.wrap.zpp_inner._validate=n(this,this.getwrap)),this.wrap},modwrap:function(t){this.x=t.x,this.y=t.y},getwrap:function(){this.wrap.zpp_inner.x=this.x,this.wrap.zpp_inner.y=this.y},__class__:o.geom.ZPP_GeomVert},o.geom.ZPP_GeomPoly=function(t){this.vertices=null,this.outer=null,this.outer=t},o.geom.ZPP_GeomPoly.__name__=!0,o.geom.ZPP_GeomPoly.prototype={__class__:o.geom.ZPP_GeomPoly},o.geom.ZPP_GeomVertexIterator=function(){this.next=null,this.outer=null,this.forward=!1,this.first=!1,this.start=null,this.ptr=null,o.geom.ZPP_GeomVertexIterator.internal=!0,this.outer=new p.geom.GeomVertexIterator,o.geom.ZPP_GeomVertexIterator.internal=!1},o.geom.ZPP_GeomVertexIterator.__name__=!0,o.geom.ZPP_GeomVertexIterator.get=function(t,n){var e;return null==o.geom.ZPP_GeomVertexIterator.zpp_pool?e=new o.geom.ZPP_GeomVertexIterator:(e=o.geom.ZPP_GeomVertexIterator.zpp_pool,o.geom.ZPP_GeomVertexIterator.zpp_pool=e.next,e.next=null),e.outer.zpp_inner=e,e.ptr=t,e.forward=n,e.start=t,e.first=null!=t,e.outer},o.geom.ZPP_GeomVertexIterator.prototype={free:function(){this.outer.zpp_inner=null,this.ptr=this.start=null},alloc:function(){},__class__:o.geom.ZPP_GeomVertexIterator},o.geom.ZPP_MarchSpan=function(){this.next=null,this.out=!1,this.rank=0,this.parent=null,this.parent=this},o.geom.ZPP_MarchSpan.__name__=!0,o.geom.ZPP_MarchSpan.prototype={free:function(){this.parent=this},alloc:function(){this.out=!1,this.rank=0},__class__:o.geom.ZPP_MarchSpan},o.geom.ZPP_MarchPair=function(){this.next=null,this.spanr=null,this.span2=null,this.span1=null,this.pd=null,this.okeyr=0,this.keyr=0,this.pr=null,this.okey2=0,this.key2=0,this.p2=null,this.okey1=0,this.key1=0,this.p1=null},o.geom.ZPP_MarchPair.__name__=!0,o.geom.ZPP_MarchPair.prototype={free:function(){this.p1=this.p2=this.pr=this.pd=null,this.span1=this.span2=this.spanr=null},alloc:function(){},__class__:o.geom.ZPP_MarchPair},o.geom.ZPP_MarchingSquares=function(){},o.geom.ZPP_MarchingSquares.__name__=!0,o.geom.ZPP_MarchingSquares.run=function(t,n,e,i,r,s,l,a,p){var _;_=(i-n)/function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.x}();var h,u=0|_;h=(r-e)/function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.y}();var d=0|h;_!=u&&u++,h!=d&&d++,a&&(null==o.geom.ZPP_MarchingSquares.map?o.geom.ZPP_MarchingSquares.map=new o.util.ZNPArray2_ZPP_MarchPair(u,d):o.geom.ZPP_MarchingSquares.map.resize(u,d,null)),null==o.geom.ZPP_MarchingSquares.isos?o.geom.ZPP_MarchingSquares.isos=new o.util.ZNPArray2_Float(u+1,d+1):o.geom.ZPP_MarchingSquares.isos.resize(u+1,d+1,0);for(var c=0,P=d+1;c<P;){var f,z=c++;f=0==z?e:z<=d?e+function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.y}()*z:r;for(var v=0,m=u+1;v<m;){var b,y=v++;b=0==y?n:y<=u?n+function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.x}()*y:i,o.geom.ZPP_MarchingSquares.isos.set(y,z,t(b,f))}}null==o.geom.ZPP_MarchingSquares.ints?o.geom.ZPP_MarchingSquares.ints=new o.util.ZNPArray2_ZPP_GeomVert(u+1,1+(d<<1)):o.geom.ZPP_MarchingSquares.ints.resize(u+1,1+(d<<1),null);var g=null;a&&(null==o.geom.ZPP_MarchSpan.zpp_pool?g=new o.geom.ZPP_MarchSpan:(g=o.geom.ZPP_MarchSpan.zpp_pool,o.geom.ZPP_MarchSpan.zpp_pool=g.next,g.next=null),g.out=!1,g.rank=0);for(var x=e,Z=0;Z<d;){var w,C=Z++,E=x;w=C==d-1?r:e+function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.y}()*(C+1),x=w;for(var S=n,N=null,k=0;k<u;){var M,I=k++,F=S;M=I==u-1?i:n+function(t){if(null!=s&&s.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return s.zpp_inner.validate(),s.zpp_inner.x}()*(I+1),S=M;var A=0==I||!a,T=0==C||!a,V=I==u-1||!a,L=C==d-1||!a,B=o.geom.ZPP_MarchingSquares.me.marchSquare(t,o.geom.ZPP_MarchingSquares.isos,o.geom.ZPP_MarchingSquares.ints,F,E,M,w,I,C,A,T,V,L,l);if(null!=B)if(a){var O;O=null!=B.p2&&14!=B.okey2?B.p2:B.p1,0==(128&(O==B.p2?B.okey2:B.okey1))?B.pd=O.prev:B.pd=O.prev.prev,o.geom.ZPP_MarchingSquares.map.set(I,C,B),null!=N&&o.geom.ZPP_MarchingSquares.me.combLeft(B.key1)?(o.geom.ZPP_MarchingSquares.me.combLR(N,B),B.span1=N.spanr):(null==o.geom.ZPP_MarchSpan.zpp_pool?B.span1=new o.geom.ZPP_MarchSpan:(B.span1=o.geom.ZPP_MarchSpan.zpp_pool,o.geom.ZPP_MarchSpan.zpp_pool=B.span1.next,B.span1.next=null),B.span1.alloc(),B.span1.next=g,g=B.span1),null!=B.p2?(null==o.geom.ZPP_MarchSpan.zpp_pool?B.span2=new o.geom.ZPP_MarchSpan:(B.span2=o.geom.ZPP_MarchSpan.zpp_pool,o.geom.ZPP_MarchSpan.zpp_pool=B.span2.next,B.span2.next=null),B.span2.alloc(),B.span2.next=g,g=B.span2,B.spanr=B.span2):B.spanr=B.span1,N=o.geom.ZPP_MarchingSquares.me.combRight(B.keyr)?B:null}else{o.geom.ZPP_MarchingSquares.me.output(p,B.p1),null!=B.p2&&o.geom.ZPP_MarchingSquares.me.output(p,B.p2);var G=B;G.p1=G.p2=G.pr=G.pd=null,G.span1=G.span2=G.spanr=null,G.next=o.geom.ZPP_MarchPair.zpp_pool,o.geom.ZPP_MarchPair.zpp_pool=G}else N=null}}if(a){for(var R=1;R<d;)for(var D=R++,j=null,q=0;q<u;){var Y=q++,U=o.geom.ZPP_MarchingSquares.map.get(Y,D);if(null!=U){var W;if(W=null!=U.p2&&14==U.okey2?U.okey2:U.okey1,o.geom.ZPP_MarchingSquares.me.combUp(W)){var J=o.geom.ZPP_MarchingSquares.map.get(Y,D-1);if(null!=J){var K;if(K=null!=J.p2&&56==J.okey2?J.okey2:J.okey1,o.geom.ZPP_MarchingSquares.me.combDown(K)){var H;H=null!=J.p2&&56==J.okey2?J.span2:J.span1;var X;if(X=null!=U.p2&&14==U.okey2?U.span2:U.span1,(H==H.parent?H:function(t){for(var n=H,e=null;n!=n.parent;){var i=n.parent;n.parent=e,e=n,n=i}for(;null!=e;){var r=e.parent;e.parent=n,e=r}return n}())==(X==X.parent?X:function(t){for(var n=X,e=null;n!=n.parent;){var i=n.parent;n.parent=e,e=n,n=i}for(;null!=e;){var r=e.parent;e.parent=n,e=r}return n}()))j!=X&&o.geom.ZPP_MarchingSquares.me.combUD_virtual(J,U);else{var Q;if(H==H.parent)Q=H;else{for(var $=H,tt=null;$!=$.parent;){var nt=$.parent;$.parent=tt,tt=$,$=nt}for(;null!=tt;){var et=tt.parent;tt.parent=$,tt=et}Q=$}var it;if(X==X.parent)it=X;else{for(var rt=X,st=null;rt!=rt.parent;){var lt=rt.parent;rt.parent=st,st=rt,rt=lt}for(;null!=st;){var at=st.parent;st.parent=rt,st=at}it=rt}Q!=it&&(Q.rank<it.rank?Q.parent=it:Q.rank>it.rank?it.parent=Q:(it.parent=Q,Q.rank++)),o.geom.ZPP_MarchingSquares.me.combUD(J,U)}var pt;pt=X==U.span2?U.okey2:U.okey1,j=0!=(4&pt)?X:null}else j=null}else j=null}else j=null}else j=null}for(var ot=0;ot<d;)for(var _t=ot++,ht=0;ht<u;){var ut=ht++,dt=o.geom.ZPP_MarchingSquares.map.get(ut,_t);if(null!=dt){var ct;if(dt.span1==dt.span1.parent)ct=dt.span1;else{for(var Pt=dt.span1,ft=null;Pt!=Pt.parent;){var zt=Pt.parent;Pt.parent=ft,ft=Pt,Pt=zt}for(;null!=ft;){var vt=ft.parent;ft.parent=Pt,ft=vt}ct=Pt}if(ct.out||(ct.out=!0,o.geom.ZPP_MarchingSquares.me.output(p,dt.p1)),null!=dt.p2){if(dt.span2==dt.span2.parent)ct=dt.span2;else{for(var mt=dt.span2,bt=null;mt!=mt.parent;){var yt=mt.parent;mt.parent=bt,bt=mt,mt=yt}for(;null!=bt;){var gt=bt.parent;bt.parent=mt,bt=gt}ct=mt}ct.out||(ct.out=!0,o.geom.ZPP_MarchingSquares.me.output(p,dt.p2))}var xt=dt;xt.p1=xt.p2=xt.pr=xt.pd=null,xt.span1=xt.span2=xt.spanr=null,xt.next=o.geom.ZPP_MarchPair.zpp_pool,o.geom.ZPP_MarchPair.zpp_pool=xt,o.geom.ZPP_MarchingSquares.map.set(ut,_t,null)}}for(;null!=g;){var Zt=g;g=Zt.next;var wt=Zt;wt.parent=wt,wt.next=o.geom.ZPP_MarchSpan.zpp_pool,o.geom.ZPP_MarchSpan.zpp_pool=wt}}},o.geom.ZPP_MarchingSquares.ISO=function(t,n,e){return t(n,e)},o.geom.ZPP_MarchingSquares.prototype={output:function(t,n){if(null==n||n.next==n||n.next==n.prev||function(t){var e,i=0,r=n,s=n;if(null!=r){var l=r;do{var a=l;i+=a.x*(a.next.y-a.prev.y),l=l.next}while(l!=s)}return e=.5*i,e*e<p.Config.epsilon*p.Config.epsilon}())for(;null!=n;)if(null!=n&&n.prev==n)n.next=n.prev=null,n=n=null;else{var e=n.next;n.prev.next=n.next,n.next.prev=n.prev,n.next=n.prev=null,n=null,n=e}else{var i=p.geom.GeomPoly.get();i.zpp_inner.vertices=n,t.zpp_inner.reverse_flag?t.push(i):t.unshift(i)}},linkright:function(t,n){var e=7&n;return 0==e?t:3==e?t.next.next:t.next},linkleft:function(t,n){return 0==(1&n)?t.prev:t},linkdown:function(t,n){return 0==(128&n)?t.prev:t.prev.prev},linkup:function(t,n){return t},combLR:function(t,n){var e=this.linkright(t.pr,t.okeyr),i=this.linkleft(n.p1,n.okey1),r=e.next,s=i.prev;if(0!=(4&t.keyr)){n.pr==n.p1&&(n.pr=e.prev),n.p1=e.prev,e.prev.next=i.next,i.next.prev=e.prev;var l=e;null!=l.wrap&&(l.wrap.zpp_inner._inuse=!1,l.wrap.dispose(),l.wrap=null),l.prev=l.next=null,l.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=l}else e.next=i.next,i.next.prev=e;var a=i;if(null!=a.wrap&&(a.wrap.zpp_inner._inuse=!1,a.wrap.dispose(),a.wrap=null),a.prev=a.next=null,a.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=a,0!=(16&t.keyr)){n.pd=r.next,r.next.prev=s.prev,s.prev.next=r.next;var p=r;null!=p.wrap&&(p.wrap.zpp_inner._inuse=!1,p.wrap.dispose(),p.wrap=null),p.prev=p.next=null,p.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=p}else r.prev=s.prev,s.prev.next=r;var _=s;null!=_.wrap&&(_.wrap.zpp_inner._inuse=!1,_.wrap.dispose(),_.wrap=null),_.prev=_.next=null,_.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=_},combUD:function(t,n){null!=t.p2&&56==t.key2?t.p2:t.p1;var e;e=null!=n.p2&&14==n.key2?n.p2:n.p1;var i=t.pd,r=e,s=i.prev,l=r.next;r.next=i.next,i.next.prev=r;var a=i;null!=a.wrap&&(a.wrap.zpp_inner._inuse=!1,a.wrap.dispose(),a.wrap=null),a.prev=a.next=null,a.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=a,l.prev=s.prev,s.prev.next=l,s==t.p1&&(t.p1=l);var p=s;null!=p.wrap&&(p.wrap.zpp_inner._inuse=!1,p.wrap.dispose(),p.wrap=null),p.prev=p.next=null,p.next=o.geom.ZPP_GeomVert.zpp_pool,o.geom.ZPP_GeomVert.zpp_pool=p},combUD_virtual:function(t,n){null!=t.p2&&56==t.key2?t.p2:t.p1;var e;e=null!=n.p2&&14==n.key2?n.p2:n.p1;var i=t.pd,r=e,s=i.prev,l=r.next;i.forced=r.forced=s.forced=l.forced=!0},combLeft:function(t){var n=1&t|(192&t)>>5;return this.comb(n)},combRight:function(t){var n=(28&t)>>2;return this.comb(n)},combUp:function(t){var n=7&t;return this.comb(n)},combDown:function(t){var n=(112&t)>>4;return this.comb(n)},comb:function(t){var n=0;return 0!=(1&t)&&n++,0!=(2&t)&&n++,0!=(4&t)&&n++,n>=2},marchSquare:function(t,n,e,i,r,s,l,a,p,_,h,u,d,c){var P=0,f=n.list[p*n.width+a];f<0&&(P|=8);var z=n.list[p*n.width+(a+1)];z<0&&(P|=4);var v=n.list[(p+1)*n.width+(a+1)];v<0&&(P|=2);var m=n.list[(p+1)*n.width+a];if(m<0&&(P|=1),0==P)return null;var b;if(null==o.geom.ZPP_MarchPair.zpp_pool?b=new o.geom.ZPP_MarchPair:(b=o.geom.ZPP_MarchPair.zpp_pool,o.geom.ZPP_MarchPair.zpp_pool=b.next,b.next=null),10!=P&&5!=P){var y=o.geom.ZPP_MarchingSquares.look_march[P];b.okey1=y;for(var g=0;g<8;){var x=g++;if(0!=(y&1<<x)){var Z=null;0==x?(Z=o.geom.ZPP_GeomVert.get(i,r),(_||h)&&(Z.forced=!0)):2==x?(Z=o.geom.ZPP_GeomVert.get(s,r),(u||h)&&(Z.forced=!0)):4==x?(Z=o.geom.ZPP_GeomVert.get(s,l),(u||d)&&(Z.forced=!0)):6==x?(Z=o.geom.ZPP_GeomVert.get(i,l),(_||d)&&(Z.forced=!0)):1==x?(Z=e.list[(p<<1)*e.width+a],null==Z?(Z=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,r,f,z,t,c),r),e.list[(p<<1)*e.width+a]=Z):Z=o.geom.ZPP_GeomVert.get(Z.x,Z.y),h&&(Z.forced=!0),Z.x!=i&&Z.x!=s||(Z.x==i&&0!=(1&y)||Z.x==s&&0!=(4&y))&&(y^=2)):5==x?(Z=e.list[(2+(p<<1))*e.width+a],null==Z?(Z=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,l,m,v,t,c),l),e.list[(2+(p<<1))*e.width+a]=Z):Z=o.geom.ZPP_GeomVert.get(Z.x,Z.y),d&&(Z.forced=!0),Z.x!=i&&Z.x!=s||(Z.x==i&&0!=(64&y)||Z.x==s&&0!=(16&y))&&(y^=32)):3==x?(Z=e.list[(1+(p<<1))*e.width+(a+1)],null==Z?(Z=o.geom.ZPP_GeomVert.get(s,this.ylerp(r,l,s,z,v,t,c)),e.list[(1+(p<<1))*e.width+(a+1)]=Z):Z=o.geom.ZPP_GeomVert.get(Z.x,Z.y),u&&(Z.forced=!0),Z.y!=r&&Z.y!=l||(Z.y==r&&0!=(4&y)||Z.y==l&&0!=(16&y))&&(y^=8)):(Z=e.list[(1+(p<<1))*e.width+a],null==Z?(Z=o.geom.ZPP_GeomVert.get(i,this.ylerp(r,l,i,f,m,t,c)),e.list[(1+(p<<1))*e.width+a]=Z):Z=o.geom.ZPP_GeomVert.get(Z.x,Z.y),_&&(Z.forced=!0),Z.y!=r&&Z.y!=l||(Z.y==r&&0!=(1&y)||Z.y==l&&0!=(64&y))&&(y^=128));var w=Z;null==b.p1?b.p1=w.prev=w.next=w:(w.prev=b.p1,w.next=b.p1.next,b.p1.next.prev=w,b.p1.next=w),b.p1=w}}b.p1=b.p1.next,b.key1=y,1!=y&&4!=y&&16!=y&&64!=y&&3!=y&&12!=y&&48!=y&&192!=y&&129!=y&&6!=y&&24!=y&&96!=y&&5!=y&&20!=y&&80!=y&&65!=y&&17!=y&&68!=y||(y=0,b.key1=0,b.p1=null),0==y?b=null:(b.pr=b.p1,b.okeyr=b.okey1,b.keyr=b.key1)}else{var C=t(.5*(i+s),.5*(r+l))<0;if(10==P)if(C){var E=187;b.okey1=E;for(var S=0;S<8;){var N=S++;if(0!=(E&1<<N)){var k=null;0==N?(k=o.geom.ZPP_GeomVert.get(i,r),(_||h)&&(k.forced=!0)):2==N?(k=o.geom.ZPP_GeomVert.get(s,r),(u||h)&&(k.forced=!0)):4==N?(k=o.geom.ZPP_GeomVert.get(s,l),(u||d)&&(k.forced=!0)):6==N?(k=o.geom.ZPP_GeomVert.get(i,l),(_||d)&&(k.forced=!0)):1==N?(k=e.list[(p<<1)*e.width+a],null==k?(k=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,r,f,z,t,c),r),e.list[(p<<1)*e.width+a]=k):k=o.geom.ZPP_GeomVert.get(k.x,k.y),h&&(k.forced=!0),k.x!=i&&k.x!=s||(k.x==i&&0!=(1&E)||k.x==s&&0!=(4&E))&&(E^=2)):5==N?(k=e.list[(2+(p<<1))*e.width+a],null==k?(k=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,l,m,v,t,c),l),e.list[(2+(p<<1))*e.width+a]=k):k=o.geom.ZPP_GeomVert.get(k.x,k.y),d&&(k.forced=!0),k.x!=i&&k.x!=s||(k.x==i&&0!=(64&E)||k.x==s&&0!=(16&E))&&(E^=32)):3==N?(k=e.list[(1+(p<<1))*e.width+(a+1)],null==k?(k=o.geom.ZPP_GeomVert.get(s,this.ylerp(r,l,s,z,v,t,c)),e.list[(1+(p<<1))*e.width+(a+1)]=k):k=o.geom.ZPP_GeomVert.get(k.x,k.y),u&&(k.forced=!0),k.y!=r&&k.y!=l||(k.y==r&&0!=(4&E)||k.y==l&&0!=(16&E))&&(E^=8)):(k=e.list[(1+(p<<1))*e.width+a],null==k?(k=o.geom.ZPP_GeomVert.get(i,this.ylerp(r,l,i,f,m,t,c)),e.list[(1+(p<<1))*e.width+a]=k):k=o.geom.ZPP_GeomVert.get(k.x,k.y),_&&(k.forced=!0),k.y!=r&&k.y!=l||(k.y==r&&0!=(1&E)||k.y==l&&0!=(64&E))&&(E^=128));var M=k;null==b.p1?b.p1=M.prev=M.next=M:(M.prev=b.p1,M.next=b.p1.next,b.p1.next.prev=M,b.p1.next=M),b.p1=M}}b.p1=b.p1.next,b.key1=E,1!=E&&4!=E&&16!=E&&64!=E&&3!=E&&12!=E&&48!=E&&192!=E&&129!=E&&6!=E&&24!=E&&96!=E&&5!=E&&20!=E&&80!=E&&65!=E&&17!=E&&68!=E||(E=0,b.key1=0,b.p1=null),0==E?b=null:(b.pr=b.p1,b.okeyr=b.okey1,b.keyr=b.key1)}else{var I=131;b.okey1=I;for(var F=0;F<8;){var A=F++;if(0!=(I&1<<A)){var T=null;0==A?(T=o.geom.ZPP_GeomVert.get(i,r),(_||h)&&(T.forced=!0)):2==A?(T=o.geom.ZPP_GeomVert.get(s,r),(u||h)&&(T.forced=!0)):4==A?(T=o.geom.ZPP_GeomVert.get(s,l),(u||d)&&(T.forced=!0)):6==A?(T=o.geom.ZPP_GeomVert.get(i,l),(_||d)&&(T.forced=!0)):1==A?(T=e.list[(p<<1)*e.width+a],null==T?(T=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,r,f,z,t,c),r),e.list[(p<<1)*e.width+a]=T):T=o.geom.ZPP_GeomVert.get(T.x,T.y),h&&(T.forced=!0),T.x!=i&&T.x!=s||(T.x==i&&0!=(1&I)||T.x==s&&0!=(4&I))&&(I^=2)):5==A?(T=e.list[(2+(p<<1))*e.width+a],null==T?(T=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,l,m,v,t,c),l),e.list[(2+(p<<1))*e.width+a]=T):T=o.geom.ZPP_GeomVert.get(T.x,T.y),d&&(T.forced=!0),T.x!=i&&T.x!=s||(T.x==i&&0!=(64&I)||T.x==s&&0!=(16&I))&&(I^=32)):3==A?(T=e.list[(1+(p<<1))*e.width+(a+1)],null==T?(T=o.geom.ZPP_GeomVert.get(s,this.ylerp(r,l,s,z,v,t,c)),e.list[(1+(p<<1))*e.width+(a+1)]=T):T=o.geom.ZPP_GeomVert.get(T.x,T.y),u&&(T.forced=!0),T.y!=r&&T.y!=l||(T.y==r&&0!=(4&I)||T.y==l&&0!=(16&I))&&(I^=8)):(T=e.list[(1+(p<<1))*e.width+a],null==T?(T=o.geom.ZPP_GeomVert.get(i,this.ylerp(r,l,i,f,m,t,c)),e.list[(1+(p<<1))*e.width+a]=T):T=o.geom.ZPP_GeomVert.get(T.x,T.y),_&&(T.forced=!0),T.y!=r&&T.y!=l||(T.y==r&&0!=(1&I)||T.y==l&&0!=(64&I))&&(I^=128));var V=T;null==b.p1?b.p1=V.prev=V.next=V:(V.prev=b.p1,V.next=b.p1.next,b.p1.next.prev=V,b.p1.next=V),b.p1=V}}if(b.p1=b.p1.next,b.key1=I,1!=I&&4!=I&&16!=I&&64!=I&&3!=I&&12!=I&&48!=I&&192!=I&&129!=I&&6!=I&&24!=I&&96!=I&&5!=I&&20!=I&&80!=I&&65!=I&&17!=I&&68!=I||(I=0,b.key1=0,b.p1=null),0!=I){var L=56;b.okey2=L;for(var B=0;B<8;){var O=B++;if(0!=(L&1<<O)){var G=null;0==O?(G=o.geom.ZPP_GeomVert.get(i,r),(_||h)&&(G.forced=!0)):2==O?(G=o.geom.ZPP_GeomVert.get(s,r),(u||h)&&(G.forced=!0)):4==O?(G=o.geom.ZPP_GeomVert.get(s,l),(u||d)&&(G.forced=!0)):6==O?(G=o.geom.ZPP_GeomVert.get(i,l),(_||d)&&(G.forced=!0)):1==O?(G=e.list[(p<<1)*e.width+a],null==G?(G=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,r,f,z,t,c),r),e.list[(p<<1)*e.width+a]=G):G=o.geom.ZPP_GeomVert.get(G.x,G.y),h&&(G.forced=!0),G.x!=i&&G.x!=s||(G.x==i&&0!=(1&L)||G.x==s&&0!=(4&L))&&(L^=2)):5==O?(G=e.list[(2+(p<<1))*e.width+a],null==G?(G=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,l,m,v,t,c),l),e.list[(2+(p<<1))*e.width+a]=G):G=o.geom.ZPP_GeomVert.get(G.x,G.y),d&&(G.forced=!0),G.x!=i&&G.x!=s||(G.x==i&&0!=(64&L)||G.x==s&&0!=(16&L))&&(L^=32)):3==O?(G=e.list[(1+(p<<1))*e.width+(a+1)],null==G?(G=o.geom.ZPP_GeomVert.get(s,this.ylerp(r,l,s,z,v,t,c)),e.list[(1+(p<<1))*e.width+(a+1)]=G):G=o.geom.ZPP_GeomVert.get(G.x,G.y),u&&(G.forced=!0),G.y!=r&&G.y!=l||(G.y==r&&0!=(4&L)||G.y==l&&0!=(16&L))&&(L^=8)):(G=e.list[(1+(p<<1))*e.width+a],null==G?(G=o.geom.ZPP_GeomVert.get(i,this.ylerp(r,l,i,f,m,t,c)),e.list[(1+(p<<1))*e.width+a]=G):G=o.geom.ZPP_GeomVert.get(G.x,G.y),_&&(G.forced=!0),G.y!=r&&G.y!=l||(G.y==r&&0!=(1&L)||G.y==l&&0!=(64&L))&&(L^=128));var R=G;null==b.p2?b.p2=R.prev=R.next=R:(R.prev=b.p2,R.next=b.p2.next,b.p2.next.prev=R,b.p2.next=R),b.p2=R}}b.p2=b.p2.next,b.key2=L,1!=L&&4!=L&&16!=L&&64!=L&&3!=L&&12!=L&&48!=L&&192!=L&&129!=L&&6!=L&&24!=L&&96!=L&&5!=L&&20!=L&&80!=L&&65!=L&&17!=L&&68!=L||(L=0,b.key2=0,b.p2=null),0==L?(b.pr=b.p1,b.okeyr=b.okey1,b.keyr=b.key1):(b.pr=b.p2,b.okeyr=b.okey2,b.keyr=b.key2)}else{var D=56;b.okey1=D;for(var j=0;j<8;){var q=j++;if(0!=(D&1<<q)){var Y=null;0==q?(Y=o.geom.ZPP_GeomVert.get(i,r),(_||h)&&(Y.forced=!0)):2==q?(Y=o.geom.ZPP_GeomVert.get(s,r),(u||h)&&(Y.forced=!0)):4==q?(Y=o.geom.ZPP_GeomVert.get(s,l),(u||d)&&(Y.forced=!0)):6==q?(Y=o.geom.ZPP_GeomVert.get(i,l),(_||d)&&(Y.forced=!0)):1==q?(Y=e.list[(p<<1)*e.width+a],null==Y?(Y=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,r,f,z,t,c),r),e.list[(p<<1)*e.width+a]=Y):Y=o.geom.ZPP_GeomVert.get(Y.x,Y.y),h&&(Y.forced=!0),Y.x!=i&&Y.x!=s||(Y.x==i&&0!=(1&D)||Y.x==s&&0!=(4&D))&&(D^=2)):5==q?(Y=e.list[(2+(p<<1))*e.width+a],null==Y?(Y=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,l,m,v,t,c),l),e.list[(2+(p<<1))*e.width+a]=Y):Y=o.geom.ZPP_GeomVert.get(Y.x,Y.y),d&&(Y.forced=!0),Y.x!=i&&Y.x!=s||(Y.x==i&&0!=(64&D)||Y.x==s&&0!=(16&D))&&(D^=32)):3==q?(Y=e.list[(1+(p<<1))*e.width+(a+1)],null==Y?(Y=o.geom.ZPP_GeomVert.get(s,this.ylerp(r,l,s,z,v,t,c)),e.list[(1+(p<<1))*e.width+(a+1)]=Y):Y=o.geom.ZPP_GeomVert.get(Y.x,Y.y),u&&(Y.forced=!0),Y.y!=r&&Y.y!=l||(Y.y==r&&0!=(4&D)||Y.y==l&&0!=(16&D))&&(D^=8)):(Y=e.list[(1+(p<<1))*e.width+a],null==Y?(Y=o.geom.ZPP_GeomVert.get(i,this.ylerp(r,l,i,f,m,t,c)),e.list[(1+(p<<1))*e.width+a]=Y):Y=o.geom.ZPP_GeomVert.get(Y.x,Y.y),_&&(Y.forced=!0),Y.y!=r&&Y.y!=l||(Y.y==r&&0!=(1&D)||Y.y==l&&0!=(64&D))&&(D^=128));var U=Y;null==b.p1?b.p1=U.prev=U.next=U:(U.prev=b.p1,U.next=b.p1.next,b.p1.next.prev=U,b.p1.next=U),b.p1=U}}b.p1=b.p1.next,b.key1=D,1!=D&&4!=D&&16!=D&&64!=D&&3!=D&&12!=D&&48!=D&&192!=D&&129!=D&&6!=D&&24!=D&&96!=D&&5!=D&&20!=D&&80!=D&&65!=D&&17!=D&&68!=D||(D=0,b.key1=0,b.p1=null),0==D?b=null:(b.pr=b.p1,b.okeyr=b.okey1,b.keyr=b.key1)}}else if(C){var W=238;b.okey1=W;for(var J=0;J<8;){var K=J++;if(0!=(W&1<<K)){var H=null;0==K?(H=o.geom.ZPP_GeomVert.get(i,r),(_||h)&&(H.forced=!0)):2==K?(H=o.geom.ZPP_GeomVert.get(s,r),(u||h)&&(H.forced=!0)):4==K?(H=o.geom.ZPP_GeomVert.get(s,l),(u||d)&&(H.forced=!0)):6==K?(H=o.geom.ZPP_GeomVert.get(i,l),(_||d)&&(H.forced=!0)):1==K?(H=e.list[(p<<1)*e.width+a],null==H?(H=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,r,f,z,t,c),r),e.list[(p<<1)*e.width+a]=H):H=o.geom.ZPP_GeomVert.get(H.x,H.y),h&&(H.forced=!0),H.x!=i&&H.x!=s||(H.x==i&&0!=(1&W)||H.x==s&&0!=(4&W))&&(W^=2)):5==K?(H=e.list[(2+(p<<1))*e.width+a],null==H?(H=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,l,m,v,t,c),l),e.list[(2+(p<<1))*e.width+a]=H):H=o.geom.ZPP_GeomVert.get(H.x,H.y),d&&(H.forced=!0),H.x!=i&&H.x!=s||(H.x==i&&0!=(64&W)||H.x==s&&0!=(16&W))&&(W^=32)):3==K?(H=e.list[(1+(p<<1))*e.width+(a+1)],null==H?(H=o.geom.ZPP_GeomVert.get(s,this.ylerp(r,l,s,z,v,t,c)),e.list[(1+(p<<1))*e.width+(a+1)]=H):H=o.geom.ZPP_GeomVert.get(H.x,H.y),u&&(H.forced=!0),H.y!=r&&H.y!=l||(H.y==r&&0!=(4&W)||H.y==l&&0!=(16&W))&&(W^=8)):(H=e.list[(1+(p<<1))*e.width+a],null==H?(H=o.geom.ZPP_GeomVert.get(i,this.ylerp(r,l,i,f,m,t,c)),e.list[(1+(p<<1))*e.width+a]=H):H=o.geom.ZPP_GeomVert.get(H.x,H.y),_&&(H.forced=!0),H.y!=r&&H.y!=l||(H.y==r&&0!=(1&W)||H.y==l&&0!=(64&W))&&(W^=128));var X=H;null==b.p1?b.p1=X.prev=X.next=X:(X.prev=b.p1,X.next=b.p1.next,b.p1.next.prev=X,b.p1.next=X),b.p1=X}}b.p1=b.p1.next,b.key1=W,1!=W&&4!=W&&16!=W&&64!=W&&3!=W&&12!=W&&48!=W&&192!=W&&129!=W&&6!=W&&24!=W&&96!=W&&5!=W&&20!=W&&80!=W&&65!=W&&17!=W&&68!=W||(W=0,b.key1=0,b.p1=null),0==W?b=null:(b.pr=b.p1,b.okeyr=b.okey1,b.keyr=b.key1)}else{var Q=224;b.okey1=Q;for(var $=0;$<8;){var tt=$++;if(0!=(Q&1<<tt)){var nt=null;0==tt?(nt=o.geom.ZPP_GeomVert.get(i,r),(_||h)&&(nt.forced=!0)):2==tt?(nt=o.geom.ZPP_GeomVert.get(s,r),(u||h)&&(nt.forced=!0)):4==tt?(nt=o.geom.ZPP_GeomVert.get(s,l),(u||d)&&(nt.forced=!0)):6==tt?(nt=o.geom.ZPP_GeomVert.get(i,l),(_||d)&&(nt.forced=!0)):1==tt?(nt=e.list[(p<<1)*e.width+a],null==nt?(nt=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,r,f,z,t,c),r),e.list[(p<<1)*e.width+a]=nt):nt=o.geom.ZPP_GeomVert.get(nt.x,nt.y),h&&(nt.forced=!0),nt.x!=i&&nt.x!=s||(nt.x==i&&0!=(1&Q)||nt.x==s&&0!=(4&Q))&&(Q^=2)):5==tt?(nt=e.list[(2+(p<<1))*e.width+a],null==nt?(nt=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,l,m,v,t,c),l),e.list[(2+(p<<1))*e.width+a]=nt):nt=o.geom.ZPP_GeomVert.get(nt.x,nt.y),d&&(nt.forced=!0),nt.x!=i&&nt.x!=s||(nt.x==i&&0!=(64&Q)||nt.x==s&&0!=(16&Q))&&(Q^=32)):3==tt?(nt=e.list[(1+(p<<1))*e.width+(a+1)],null==nt?(nt=o.geom.ZPP_GeomVert.get(s,this.ylerp(r,l,s,z,v,t,c)),e.list[(1+(p<<1))*e.width+(a+1)]=nt):nt=o.geom.ZPP_GeomVert.get(nt.x,nt.y),u&&(nt.forced=!0),nt.y!=r&&nt.y!=l||(nt.y==r&&0!=(4&Q)||nt.y==l&&0!=(16&Q))&&(Q^=8)):(nt=e.list[(1+(p<<1))*e.width+a],null==nt?(nt=o.geom.ZPP_GeomVert.get(i,this.ylerp(r,l,i,f,m,t,c)),e.list[(1+(p<<1))*e.width+a]=nt):nt=o.geom.ZPP_GeomVert.get(nt.x,nt.y),_&&(nt.forced=!0),nt.y!=r&&nt.y!=l||(nt.y==r&&0!=(1&Q)||nt.y==l&&0!=(64&Q))&&(Q^=128));var et=nt;null==b.p1?b.p1=et.prev=et.next=et:(et.prev=b.p1,et.next=b.p1.next,b.p1.next.prev=et,b.p1.next=et),b.p1=et}}if(b.p1=b.p1.next,b.key1=Q,1!=Q&&4!=Q&&16!=Q&&64!=Q&&3!=Q&&12!=Q&&48!=Q&&192!=Q&&129!=Q&&6!=Q&&24!=Q&&96!=Q&&5!=Q&&20!=Q&&80!=Q&&65!=Q&&17!=Q&&68!=Q||(Q=0,b.key1=0,b.p1=null),0!=Q){var it=14;b.okey2=it;for(var rt=0;rt<8;){var st=rt++;if(0!=(it&1<<st)){var lt=null;0==st?(lt=o.geom.ZPP_GeomVert.get(i,r),(_||h)&&(lt.forced=!0)):2==st?(lt=o.geom.ZPP_GeomVert.get(s,r),(u||h)&&(lt.forced=!0)):4==st?(lt=o.geom.ZPP_GeomVert.get(s,l),(u||d)&&(lt.forced=!0)):6==st?(lt=o.geom.ZPP_GeomVert.get(i,l),(_||d)&&(lt.forced=!0)):1==st?(lt=e.list[(p<<1)*e.width+a],null==lt?(lt=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,r,f,z,t,c),r),e.list[(p<<1)*e.width+a]=lt):lt=o.geom.ZPP_GeomVert.get(lt.x,lt.y),h&&(lt.forced=!0),lt.x!=i&&lt.x!=s||(lt.x==i&&0!=(1&it)||lt.x==s&&0!=(4&it))&&(it^=2)):5==st?(lt=e.list[(2+(p<<1))*e.width+a],null==lt?(lt=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,l,m,v,t,c),l),e.list[(2+(p<<1))*e.width+a]=lt):lt=o.geom.ZPP_GeomVert.get(lt.x,lt.y),d&&(lt.forced=!0),lt.x!=i&&lt.x!=s||(lt.x==i&&0!=(64&it)||lt.x==s&&0!=(16&it))&&(it^=32)):3==st?(lt=e.list[(1+(p<<1))*e.width+(a+1)],null==lt?(lt=o.geom.ZPP_GeomVert.get(s,this.ylerp(r,l,s,z,v,t,c)),e.list[(1+(p<<1))*e.width+(a+1)]=lt):lt=o.geom.ZPP_GeomVert.get(lt.x,lt.y),u&&(lt.forced=!0),lt.y!=r&&lt.y!=l||(lt.y==r&&0!=(4&it)||lt.y==l&&0!=(16&it))&&(it^=8)):(lt=e.list[(1+(p<<1))*e.width+a],null==lt?(lt=o.geom.ZPP_GeomVert.get(i,this.ylerp(r,l,i,f,m,t,c)),e.list[(1+(p<<1))*e.width+a]=lt):lt=o.geom.ZPP_GeomVert.get(lt.x,lt.y),_&&(lt.forced=!0),lt.y!=r&&lt.y!=l||(lt.y==r&&0!=(1&it)||lt.y==l&&0!=(64&it))&&(it^=128));var at=lt;null==b.p2?b.p2=at.prev=at.next=at:(at.prev=b.p2,at.next=b.p2.next,b.p2.next.prev=at,b.p2.next=at),b.p2=at}}b.p2=b.p2.next,b.key2=it,1!=it&&4!=it&&16!=it&&64!=it&&3!=it&&12!=it&&48!=it&&192!=it&&129!=it&&6!=it&&24!=it&&96!=it&&5!=it&&20!=it&&80!=it&&65!=it&&17!=it&&68!=it||(it=0,b.key2=0,b.p2=null),0==it?(b.pr=b.p1,b.okeyr=b.okey1,b.keyr=b.key1):(b.pr=b.p2,b.okeyr=b.okey2,b.keyr=b.key2)}else{var pt=14;b.okey1=pt;for(var ot=0;ot<8;){var _t=ot++;if(0!=(pt&1<<_t)){var ht=null;0==_t?(ht=o.geom.ZPP_GeomVert.get(i,r),(_||h)&&(ht.forced=!0)):2==_t?(ht=o.geom.ZPP_GeomVert.get(s,r),(u||h)&&(ht.forced=!0)):4==_t?(ht=o.geom.ZPP_GeomVert.get(s,l),(u||d)&&(ht.forced=!0)):6==_t?(ht=o.geom.ZPP_GeomVert.get(i,l),(_||d)&&(ht.forced=!0)):1==_t?(ht=e.list[(p<<1)*e.width+a],null==ht?(ht=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,r,f,z,t,c),r),e.list[(p<<1)*e.width+a]=ht):ht=o.geom.ZPP_GeomVert.get(ht.x,ht.y),h&&(ht.forced=!0),ht.x!=i&&ht.x!=s||(ht.x==i&&0!=(1&pt)||ht.x==s&&0!=(4&pt))&&(pt^=2)):5==_t?(ht=e.list[(2+(p<<1))*e.width+a],null==ht?(ht=o.geom.ZPP_GeomVert.get(this.xlerp(i,s,l,m,v,t,c),l),e.list[(2+(p<<1))*e.width+a]=ht):ht=o.geom.ZPP_GeomVert.get(ht.x,ht.y),d&&(ht.forced=!0),ht.x!=i&&ht.x!=s||(ht.x==i&&0!=(64&pt)||ht.x==s&&0!=(16&pt))&&(pt^=32)):3==_t?(ht=e.list[(1+(p<<1))*e.width+(a+1)],null==ht?(ht=o.geom.ZPP_GeomVert.get(s,this.ylerp(r,l,s,z,v,t,c)),e.list[(1+(p<<1))*e.width+(a+1)]=ht):ht=o.geom.ZPP_GeomVert.get(ht.x,ht.y),u&&(ht.forced=!0),ht.y!=r&&ht.y!=l||(ht.y==r&&0!=(4&pt)||ht.y==l&&0!=(16&pt))&&(pt^=8)):(ht=e.list[(1+(p<<1))*e.width+a],null==ht?(ht=o.geom.ZPP_GeomVert.get(i,this.ylerp(r,l,i,f,m,t,c)),e.list[(1+(p<<1))*e.width+a]=ht):ht=o.geom.ZPP_GeomVert.get(ht.x,ht.y),_&&(ht.forced=!0),ht.y!=r&&ht.y!=l||(ht.y==r&&0!=(1&pt)||ht.y==l&&0!=(64&pt))&&(pt^=128));var ut=ht;null==b.p1?b.p1=ut.prev=ut.next=ut:(ut.prev=b.p1,ut.next=b.p1.next,b.p1.next.prev=ut,b.p1.next=ut),b.p1=ut}}b.p1=b.p1.next,b.key1=pt,1!=pt&&4!=pt&&16!=pt&&64!=pt&&3!=pt&&12!=pt&&48!=pt&&192!=pt&&129!=pt&&6!=pt&&24!=pt&&96!=pt&&5!=pt&&20!=pt&&80!=pt&&65!=pt&&17!=pt&&68!=pt||(pt=0,b.key1=0,b.p1=null),0==pt?b=null:(b.pr=b.p1,b.okeyr=b.okey1,b.keyr=b.key1)}}}return b},lerp:function(t,n,e,i){if(0==e)return t;if(0==i)return n;var r,s=e-i;return r=s*s<p.Config.epsilon*p.Config.epsilon?.5:e/s,r<0?r=0:r>1&&(r=1),t+r*(n-t)},xlerp:function(t,n,e,i,r,s,l){for(var a=this.lerp(t,n,i,r);0!=l--&&t<a&&a<n;){var p=s(a,e);if(0==p)break;i*p<0?(n=a,r=p):(t=a,i=p),a=this.lerp(t,n,i,r)}return a},ylerp:function(t,n,e,i,r,s,l){for(var a=this.lerp(t,n,i,r);0!=l--&&t<a&&a<n;){var p=s(e,a);if(0==p)break;i*p<0?(n=a,r=p):(t=a,i=p),a=this.lerp(t,n,i,r)}return a},__class__:o.geom.ZPP_MarchingSquares},o.geom.ZPP_Mat23=function(){this.next=null,this._invalidate=null,this.ty=0,this.tx=0,this.d=0,this.c=0,this.b=0,this.a=0,this.outer=null},o.geom.ZPP_Mat23.__name__=!0,o.geom.ZPP_Mat23.get=function(){var t;return null==o.geom.ZPP_Mat23.zpp_pool?t=new o.geom.ZPP_Mat23:(t=o.geom.ZPP_Mat23.zpp_pool,o.geom.ZPP_Mat23.zpp_pool=t.next,t.next=null),t},o.geom.ZPP_Mat23.identity=function(){var t=o.geom.ZPP_Mat23.get();return t.setas(1,0,0,1,0,0),t},o.geom.ZPP_Mat23.prototype={wrapper:function(){if(null==this.outer){this.outer=new p.geom.Mat23;var t=this.outer.zpp_inner;t.next=o.geom.ZPP_Mat23.zpp_pool,o.geom.ZPP_Mat23.zpp_pool=t,this.outer.zpp_inner=this}return this.outer},invalidate:function(){null!=this._invalidate&&this._invalidate()},set:function(t){this.setas(t.a,t.b,t.c,t.d,t.tx,t.ty)},setas:function(t,n,e,i,r,s){this.tx=r,this.ty=s,this.a=t,this.b=n,this.c=e,this.d=i},free:function(){},alloc:function(){},__class__:o.geom.ZPP_Mat23},o.geom.ZPP_MatMN=function(t,n){this.x=null,this.n=0,this.m=0,this.outer=null,this.m=t,this.n=n,this.x=new Array;for(var e=0,i=t*n;e<i;){e++;this.x.push(0)}},o.geom.ZPP_MatMN.__name__=!0,o.geom.ZPP_MatMN.prototype={__class__:o.geom.ZPP_MatMN},o.geom.ZPP_Monotone=function(){},o.geom.ZPP_Monotone.__name__=!0,o.geom.ZPP_Monotone.bisector=function(t){var n=t.prev,e=t.next,i=0,r=0;i=t.x-n.x,r=t.y-n.y;var s=0,l=0;s=e.x-t.x,l=e.y-t.y;var a=o.geom.ZPP_Vec2.get(-r-l,i+s,null),p=a.x*a.x+a.y*a.y,_=1/Math.sqrt(p),h=_;return a.x*=h,a.y*=h,l*i-s*r<0&&(a.x=-a.x,a.y=-a.y),a},o.geom.ZPP_Monotone.below=function(t,n){if(t.y<n.y)return!0;if(t.y>n.y)return!1;if(t.x<n.x)return!0;if(t.x>n.x)return!1;var e=o.geom.ZPP_Monotone.bisector(t),i=o.geom.ZPP_Monotone.bisector(n);e.x+=1*t.x,e.y+=1*t.y;i.x+=1*n.x,i.y+=1*n.y;var r=e.x<i.x||e.x==i.x&&e.y<i.y,s=e;null!=s.outer&&(s.outer.zpp_inner=null,s.outer=null),s._isimmutable=null,s._validate=null,s._invalidate=null,s.next=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=s;var l=i;return null!=l.outer&&(l.outer.zpp_inner=null,l.outer=null),l._isimmutable=null,l._validate=null,l._invalidate=null,l.next=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=l,r},o.geom.ZPP_Monotone.above=function(t,n){return o.geom.ZPP_Monotone.below(n,t)},o.geom.ZPP_Monotone.left_vertex=function(t){var n=t.prev;return n.y>t.y||n.y==t.y&&t.next.y<t.y},o.geom.ZPP_Monotone.isMonotone=function(t){var n=t,e=t,i=t.next,r=t;if(null!=i){var s=i;do{var l=s;l.y<n.y&&(n=l),l.y>e.y&&(e=l),s=s.next}while(s!=r)}var a=!0,p=n;if(e!=n.next){var o=n.next,_=e;if(null!=o){var h=o;do{var u=h;if(u.y<p.y){a=!1;break}p=u,h=h.next}while(h!=_)}}if(!a)return!1;if(p=n,e!=n.prev){var d=n.prev,c=e;if(null!=d){var P=d;do{var f=P;if(f.y<p.y){a=!1;break}p=f,P=P.prev}while(P!=c)}}return a},o.geom.ZPP_Monotone.getShared=function(){return null==o.geom.ZPP_Monotone.sharedPPoly&&(o.geom.ZPP_Monotone.sharedPPoly=new o.geom.ZPP_PartitionedPoly),o.geom.ZPP_Monotone.sharedPPoly},o.geom.ZPP_Monotone.decompose=function(t,n){if(null==n?n=new o.geom.ZPP_PartitionedPoly(t):n.init(t),null==n.vertices)return n
;null==o.geom.ZPP_Monotone.queue&&(o.geom.ZPP_Monotone.queue=new o.util.ZNPList_ZPP_PartitionVertex);var e=n.vertices,i=n.vertices;if(null!=e){var r=e;do{var s=r;o.geom.ZPP_Monotone.queue.add(s);var l=0,a=0;l=s.next.x-s.x,a=s.next.y-s.y;var p=0,_=0;p=s.prev.x-s.x,_=s.prev.y-s.y;var h=_*l-p*a>0;o.geom.ZPP_Monotone.below(s.prev,s)?o.geom.ZPP_Monotone.below(s.next,s)?s.type=h?0:3:s.type=4:o.geom.ZPP_Monotone.below(s,s.next)?s.type=h?1:2:s.type=4,r=r.next}while(r!=i)}var u=o.geom.ZPP_Monotone.queue;if(null!=u.head&&null!=u.head.next){var d,c,P,f=u.head,z=null,v=null,m=null,b=null,y=1;do{for(d=0,v=f,z=f=null;null!=v;){for(d++,m=v,c=0,P=y;null!=m&&c<y;)c++,m=m.next;for(;c>0||P>0&&null!=m;)0==c?(b=m,m=m.next,P--):0==P||null==m?(b=v,v=v.next,c--):o.geom.ZPP_Monotone.above(v.elt,m.elt)?(b=v,v=v.next,c--):(b=m,m=m.next,P--),null!=z?z.next=b:f=b,z=b;v=m}z.next=null,y<<=1}while(d>1);u.head=f,u.modified=!0,u.pushmod=!0}for(null==o.geom.ZPP_Monotone.edges&&(null==o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool?o.geom.ZPP_Monotone.edges=new o.util.ZPP_Set_ZPP_PartitionVertex:(o.geom.ZPP_Monotone.edges=o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool,o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool=o.geom.ZPP_Monotone.edges.next,o.geom.ZPP_Monotone.edges.next=null),o.geom.ZPP_Monotone.edges.lt=o.geom.ZPP_PartitionVertex.edge_lt,o.geom.ZPP_Monotone.edges.swapped=o.geom.ZPP_PartitionVertex.edge_swap);null!=o.geom.ZPP_Monotone.queue.head;){var g=o.geom.ZPP_Monotone.queue.pop_unsafe();switch(g.type){case 0:g.helper=g,g.node=o.geom.ZPP_Monotone.edges.insert(g);break;case 1:var x=g.prev;if(null==x.helper)throw"Fatal error (1): Polygon is not weakly-simple and clockwise";2==x.helper.type&&n.add_diagonal(g,x.helper),o.geom.ZPP_Monotone.edges.remove_node(x.node),x.helper=null;break;case 3:var Z,w=null;if(!o.geom.ZPP_Monotone.edges.empty()){for(var C=o.geom.ZPP_Monotone.edges.parent;null!=C.prev;)C=C.prev;for(;null!=C;){var E=C.data;if(!o.geom.ZPP_PartitionVertex.vert_lt(E,g)){w=E;break}if(null!=C.next)for(C=C.next;null!=C.prev;)C=C.prev;else{for(;null!=C.parent&&C==C.parent.next;)C=C.parent;C=C.parent}}}if(null!=(Z=w)){if(null==Z.helper)throw"Fatal error (2): Polygon is not weakly-simple and clockwise";n.add_diagonal(g,Z.helper),Z.helper=g}g.node=o.geom.ZPP_Monotone.edges.insert(g),g.helper=g;break;case 2:var S=g.prev;if(null==S.helper)throw"Fatal error (3): Polygon is not weakly-simple and clockwise";2==S.helper.type&&n.add_diagonal(g,S.helper),o.geom.ZPP_Monotone.edges.remove_node(S.node),S.helper=null;var N,k=null;if(!o.geom.ZPP_Monotone.edges.empty()){for(var M=o.geom.ZPP_Monotone.edges.parent;null!=M.prev;)M=M.prev;for(;null!=M;){var I=M.data;if(!o.geom.ZPP_PartitionVertex.vert_lt(I,g)){k=I;break}if(null!=M.next)for(M=M.next;null!=M.prev;)M=M.prev;else{for(;null!=M.parent&&M==M.parent.next;)M=M.parent;M=M.parent}}}if(null!=(N=k)){if(null==N.helper)throw"Fatal error (4): Polygon is not weakly-simple and clockwise";2==N.helper.type&&n.add_diagonal(g,N.helper),N.helper=g}break;case 4:var F=g.prev;if(o.geom.ZPP_Monotone.left_vertex(g)){if(null==F.helper)throw"Fatal error (5): Polygon is not weakly-simple and clockwise";2==F.helper.type&&n.add_diagonal(g,F.helper),o.geom.ZPP_Monotone.edges.remove_node(F.node),F.helper=null,g.node=o.geom.ZPP_Monotone.edges.insert(g),g.helper=g}else{var A,T=null;if(!o.geom.ZPP_Monotone.edges.empty()){for(var V=o.geom.ZPP_Monotone.edges.parent;null!=V.prev;)V=V.prev;for(;null!=V;){var L=V.data;if(!o.geom.ZPP_PartitionVertex.vert_lt(L,g)){T=L;break}if(null!=V.next)for(V=V.next;null!=V.prev;)V=V.prev;else{for(;null!=V.parent&&V==V.parent.next;)V=V.parent;V=V.parent}}}if(null==(A=T)||null==A.helper)throw"Fatal error (6): Polygon is not weakly-simple and clockwise";2==A.helper.type&&n.add_diagonal(g,A.helper),A.helper=g}}}return n},o.geom.ZPP_PartitionVertex=function(){this.node=null,this.prev=null,this.next=null,this.rightchain=!1,this.helper=null,this.type=0,this.diagonals=null,this.forced=!1,this.y=0,this.x=0,this.mag=0,this.id=0,this.id=o.geom.ZPP_PartitionVertex.nextId++,this.diagonals=new o.util.ZNPList_ZPP_PartitionVertex},o.geom.ZPP_PartitionVertex.__name__=!0,o.geom.ZPP_PartitionVertex.get=function(t){var n;return null==o.geom.ZPP_PartitionVertex.zpp_pool?n=new o.geom.ZPP_PartitionVertex:(n=o.geom.ZPP_PartitionVertex.zpp_pool,o.geom.ZPP_PartitionVertex.zpp_pool=n.next,n.next=null),n.x=t.x,n.y=t.y,n},o.geom.ZPP_PartitionVertex.rightdistance=function(t,n){var e=t.next.y>t.y,i=0,r=0;i=t.next.x-t.x,r=t.next.y-t.y;var s=0,l=0;return s=n.x-t.x,l=n.y-t.y,(e?-1:1)*(l*i-s*r)},o.geom.ZPP_PartitionVertex.vert_lt=function(t,n){return n==t||n==t.next||(t.y==t.next.y?function(n){var e=t.x,i=t.next.x;return e<i?e:i}()<=n.x:o.geom.ZPP_PartitionVertex.rightdistance(t,n)<=0)},o.geom.ZPP_PartitionVertex.edge_swap=function(t,n){var e=t.node;t.node=n.node,n.node=e},o.geom.ZPP_PartitionVertex.edge_lt=function(t,n){if(t==n&&t.next==n.next)return!1;if(t==n.next)return!o.geom.ZPP_PartitionVertex.vert_lt(t,n);if(n==t.next)return o.geom.ZPP_PartitionVertex.vert_lt(n,t);if(t.y==t.next.y)return n.y==n.next.y?function(n){var e=t.x,i=t.next.x;return e>i?e:i}()>function(t){var e=n.x,i=n.next.x;return e>i?e:i}():o.geom.ZPP_PartitionVertex.rightdistance(n,t)>0||o.geom.ZPP_PartitionVertex.rightdistance(n,t.next)>0;var e=o.geom.ZPP_PartitionVertex.rightdistance(t,n),i=o.geom.ZPP_PartitionVertex.rightdistance(t,n.next);if(0==e&&0==i)return function(n){var e=t.x,i=t.next.x;return e>i?e:i}()>function(t){var e=n.x,i=n.next.x;return e>i?e:i}();if(e*i>=0)return e<0||i<0;var r=o.geom.ZPP_PartitionVertex.rightdistance(n,t),s=o.geom.ZPP_PartitionVertex.rightdistance(n,t.next);return r*s>=0&&(r>0||s>0)},o.geom.ZPP_PartitionVertex.prototype={alloc:function(){},free:function(){this.helper=null},copy:function(){var t;return null==o.geom.ZPP_PartitionVertex.zpp_pool?t=new o.geom.ZPP_PartitionVertex:(t=o.geom.ZPP_PartitionVertex.zpp_pool,o.geom.ZPP_PartitionVertex.zpp_pool=t.next,t.next=null),t.x=this.x,t.y=this.y,t.forced=this.forced,t},sort:function(){var t,n=0,e=0,i=0,r=0;n=this.prev.x-this.x,e=this.prev.y-this.y,i=this.next.x-this.x,r=this.next.y-this.y;var s=r*n-i*e;t=s>0?-1:0==s?0:1;var l=this.diagonals;if(null!=l.head&&null!=l.head.next){var a,p,o,_=l.head,h=null,u=null,d=null,c=null,P=1;do{for(a=0,u=_,h=_=null;null!=u;){for(a++,d=u,p=0,o=P;null!=d&&p<P;)p++,d=d.next;for(;p>0||o>0&&null!=d;)0==p?(c=d,d=d.next,o--):0==o||null==d?(c=u,u=u.next,p--):(1==t?1==function(t){n=u.elt.x-t.x,e=u.elt.y-t.y,i=d.elt.x-t.x,r=d.elt.y-t.y;var s=r*n-i*e;return s>0?-1:0==s?0:1}(this):function(t){var s;n=t.prev.x-t.x,e=t.prev.y-t.y,i=u.elt.x-t.x,r=u.elt.y-t.y;var l=r*n-i*e;s=l>0?-1:0==l?0:1;var a;n=t.prev.x-t.x,e=t.prev.y-t.y,i=d.elt.x-t.x,r=d.elt.y-t.y;var p=r*n-i*e;return a=p>0?-1:0==p?0:1,s*a==1||s*a==0&&(1==s||1==a)?1==function(t){n=u.elt.x-t.x,e=u.elt.y-t.y,i=d.elt.x-t.x,r=d.elt.y-t.y;var s=r*n-i*e;return s>0?-1:0==s?0:1}(t):-1==s||-1==a?-1==a:0!=s||0!=a||function(t){n=t.x-t.prev.x,e=t.y-t.prev.y,i=u.elt.x-t.x,r=u.elt.y-t.y;var s=n*i+e*r;i=d.elt.x-t.x,r=d.elt.y-t.y;var l=n*i+e*r;return s<0&&l>0||!(l<0&&s>0)}(t)}(this))?(c=u,u=u.next,p--):(c=d,d=d.next,o--),null!=h?h.next=c:_=c,h=c;u=d}h.next=null,P<<=1}while(a>1);l.head=_,l.modified=!0,l.pushmod=!0}},__class__:o.geom.ZPP_PartitionVertex},o.geom.ZPP_PartitionedPoly=function(t){this.next=null,this.vertices=null,this.init(t)},o.geom.ZPP_PartitionedPoly.__name__=!0,o.geom.ZPP_PartitionedPoly.getSharedPP=function(){return null==o.geom.ZPP_PartitionedPoly.sharedPPList&&(o.geom.ZPP_PartitionedPoly.sharedPPList=new o.util.ZNPList_ZPP_PartitionedPoly),o.geom.ZPP_PartitionedPoly.sharedPPList},o.geom.ZPP_PartitionedPoly.getShared=function(){return null==o.geom.ZPP_PartitionedPoly.sharedGVList&&(o.geom.ZPP_PartitionedPoly.sharedGVList=new o.util.ZNPList_ZPP_GeomVert),o.geom.ZPP_PartitionedPoly.sharedGVList},o.geom.ZPP_PartitionedPoly.prototype={eq:function(t,n){return o.geom.ZPP_VecMath.vec_dsq(t.x,t.y,n.x,n.y)<p.Config.epsilon*p.Config.epsilon},alloc:function(){},free:function(){},init:function(t){if(null!=t){var n;n=function(n){var e=0,i=t,r=t;if(null!=i){var s=i;do{var l=s;e+=l.x*(l.next.y-l.prev.y),s=s.next}while(s!=r)}return.5*e}()>0;var e=t;do{if(n){var i=o.geom.ZPP_PartitionVertex.get(e);null==this.vertices?this.vertices=i.prev=i.next=i:(i.prev=this.vertices,i.next=this.vertices.next,this.vertices.next.prev=i,this.vertices.next=i),this.vertices=i}else{var r=o.geom.ZPP_PartitionVertex.get(e);null==this.vertices?this.vertices=r.prev=r.next=r:(r.next=this.vertices,r.prev=this.vertices.prev,this.vertices.prev.next=r,this.vertices.prev=r),this.vertices=r}this.vertices.forced=e.forced,e=e.next}while(e!=t);this.remove_collinear_vertices()}},remove_collinear_vertices:function(){for(var t=this.vertices,n=!0;n||t!=this.vertices;)if(n=!1,this.eq(t,t.next)){if(t==this.vertices&&(this.vertices=t.next,n=!0),t.forced&&(t.next.forced=!0),null!=t&&t.prev==t){t.next=t.prev=null;var e=t;e.helper=null,e.next=o.geom.ZPP_PartitionVertex.zpp_pool,o.geom.ZPP_PartitionVertex.zpp_pool=e,t=t=null}else{var i=t.next;t.prev.next=t.next,t.next.prev=t.prev,t.next=t.prev=null;var r=t;r.helper=null,r.next=o.geom.ZPP_PartitionVertex.zpp_pool,o.geom.ZPP_PartitionVertex.zpp_pool=r,t=null,t=i}if(null==t){this.vertices=null;break}}else t=t.next;if(null==this.vertices)return!0;var s;do{for(s=!1,t=this.vertices,n=!0;n||t!=this.vertices;){n=!1;var l=t.prev,a=0,_=0;a=t.x-l.x,_=t.y-l.y;var h=0,u=0;h=t.next.x-t.x,u=t.next.y-t.y;var d=u*a-h*_;if(d*d>=p.Config.epsilon*p.Config.epsilon)t=t.next;else{if(t==this.vertices&&(this.vertices=t.next,n=!0),null!=t&&t.prev==t){t.next=t.prev=null;var c=t;c.helper=null,c.next=o.geom.ZPP_PartitionVertex.zpp_pool,o.geom.ZPP_PartitionVertex.zpp_pool=c,t=t=null}else{var P=t.next;t.prev.next=t.next,t.next.prev=t.prev,t.next=t.prev=null;var f=t;f.helper=null,f.next=o.geom.ZPP_PartitionVertex.zpp_pool,o.geom.ZPP_PartitionVertex.zpp_pool=f,t=null,t=P}if(s=!0,null==t){s=!1,this.vertices=null;break}}}}while(s);return null==this.vertices},add_diagonal:function(t,n){t.diagonals.add(n),n.diagonals.add(t),t.forced=n.forced=!0},extract_partitions:function(t){if(null==t&&(t=new o.util.ZNPList_ZPP_PartitionedPoly),null!=this.vertices){var n=this.vertices,e=this.vertices;if(null!=n){var i=n;do{i.sort(),i=i.next}while(i!=e)}for(this.pull_partitions(this.vertices,t);null!=this.vertices;)if(null!=this.vertices&&this.vertices.prev==this.vertices){this.vertices.next=this.vertices.prev=null;var r=this.vertices;r.helper=null,r.next=o.geom.ZPP_PartitionVertex.zpp_pool,o.geom.ZPP_PartitionVertex.zpp_pool=r,this.vertices=this.vertices=null}else{var s=this.vertices.next;this.vertices.prev.next=this.vertices.next,this.vertices.next.prev=this.vertices.prev,this.vertices.next=this.vertices.prev=null;var l=this.vertices;l.helper=null,l.next=o.geom.ZPP_PartitionVertex.zpp_pool,o.geom.ZPP_PartitionVertex.zpp_pool=l,this.vertices=null,this.vertices=s}for(var a=null,p=t.head;null!=p;){p.elt.remove_collinear_vertices()?t.erase(a):(a=p,p=p.next)}}return t},pull_partitions:function(t,n){var e;null==o.geom.ZPP_PartitionedPoly.zpp_pool?e=new o.geom.ZPP_PartitionedPoly:(e=o.geom.ZPP_PartitionedPoly.zpp_pool,o.geom.ZPP_PartitionedPoly.zpp_pool=e.next,e.next=null);var i=t;do{var r=i.copy();if(null==e.vertices?e.vertices=r.prev=r.next=r:(r.prev=e.vertices,r.next=e.vertices.next,e.vertices.next.prev=r,e.vertices.next=r),e.vertices=r,e.vertices.forced=i.forced,null!=i.diagonals.head){if(i.diagonals.inlined_pop_unsafe()==t)break;i=this.pull_partitions(i,n)}else i=i.next}while(i!=t);return 0!=function(t){var n=0,i=e.vertices,r=e.vertices;if(null!=i){var s=i;do{var l=s;n+=l.x*(l.next.y-l.prev.y),s=s.next}while(s!=r)}return.5*n}()&&n.add(e),i},extract:function(t){if(null==t&&(t=new o.util.ZNPList_ZPP_GeomVert),null!=this.vertices){var n=this.vertices,e=this.vertices;if(null!=n){var i=n;do{i.sort(),i=i.next}while(i!=e)}for(this.pull(this.vertices,t);null!=this.vertices;)if(null!=this.vertices&&this.vertices.prev==this.vertices){this.vertices.next=this.vertices.prev=null;var r=this.vertices;r.helper=null,r.next=o.geom.ZPP_PartitionVertex.zpp_pool,o.geom.ZPP_PartitionVertex.zpp_pool=r,this.vertices=this.vertices=null}else{var s=this.vertices.next;this.vertices.prev.next=this.vertices.next,this.vertices.next.prev=this.vertices.prev,this.vertices.next=this.vertices.prev=null;var l=this.vertices;l.helper=null,l.next=o.geom.ZPP_PartitionVertex.zpp_pool,o.geom.ZPP_PartitionVertex.zpp_pool=l,this.vertices=null,this.vertices=s}}return t},pull:function(t,n){var e=null,i=t;do{var r=o.geom.ZPP_GeomVert.get(i.x,i.y);if(null==e?e=r.prev=r.next=r:(r.prev=e,r.next=e.next,e.next.prev=r,e.next=r),e=r,e.forced=i.forced,null!=i.diagonals.head){if(i.diagonals.inlined_pop_unsafe()==t)break;i=this.pull(i,n)}else i=i.next}while(i!=t);var s,l=0,a=e,_=e;if(null!=a){var h=a;do{var u=h;l+=u.x*(u.next.y-u.prev.y),h=h.next}while(h!=_)}return s=.5*l,s*s>=p.Config.epsilon*p.Config.epsilon&&(function(t){for(var n=e,i=!0;i||n!=e;)if(i=!1,o.geom.ZPP_VecMath.vec_dsq(n.x,n.y,n.next.x,n.next.y)<p.Config.epsilon*p.Config.epsilon){if(n==e&&(e=n.next,i=!0),n.forced&&(n.next.forced=!0),null!=n&&n.prev==n)n.next=n.prev=null,n=n=null;else{var r=n.next;n.prev.next=n.next,n.next.prev=n.prev,n.next=n.prev=null,n=null,n=r}if(null==n){e=null;break}}else n=n.next;if(null!=e){var s;do{for(s=!1,n=e,i=!0;i||n!=e;){i=!1;var l=n.prev,a=0,_=0;a=n.x-l.x,_=n.y-l.y;var h=0,u=0;h=n.next.x-n.x,u=n.next.y-n.y;var d=u*a-h*_;if(d*d>=p.Config.epsilon*p.Config.epsilon)n=n.next;else{if(n==e&&(e=n.next,i=!0),null!=n&&n.prev==n)n.next=n.prev=null,n=n=null;else{var c=n.next;n.prev.next=n.next,n.next.prev=n.prev,n.next=n.prev=null,n=null,n=c}if(s=!0,null==n){s=!1,e=null;break}}}}while(s)}return null==e}()||n.add(e)),i},__class__:o.geom.ZPP_PartitionedPoly},o.geom.ZPP_Ray=function(){this.zip_dir=!1,this.absnormaly=0,this.absnormalx=0,this.normaly=0,this.normalx=0,this.idiry=0,this.idirx=0,this.diry=0,this.dirx=0,this.originy=0,this.originx=0,this.userData=null,this.maxdist=0,this.direction=null,this.origin=null,this.origin=p.geom.Vec2.get(null,null,null),this.origin.zpp_inner._invalidate=n(this,this.origin_invalidate),this.direction=p.geom.Vec2.get(null,null,null),this.direction.zpp_inner._invalidate=n(this,this.direction_invalidate),this.originx=0,this.originy=0,this.dirx=0,this.diry=0,this.zip_dir=!1},o.geom.ZPP_Ray.__name__=!0,o.geom.ZPP_Ray.prototype={origin_invalidate:function(t){this.originx=t.x,this.originy=t.y},direction_invalidate:function(t){this.dirx=t.x,this.diry=t.y,this.zip_dir=!0},invalidate_dir:function(){this.zip_dir=!0},validate_dir:function(){if(this.zip_dir){if(this.zip_dir=!1,this.dirx*this.dirx+this.diry*this.diry<p.Config.epsilon)throw"Error: Ray::direction is degenerate";var t=this.dirx*this.dirx+this.diry*this.diry,n=1/Math.sqrt(t),e=n;this.dirx*=e,this.diry*=e,this.idirx=1/this.dirx,this.idiry=1/this.diry,this.normalx=-this.diry,this.normaly=this.dirx;var i=this.normalx;this.absnormalx=i<0?-i:i;var r=this.normaly;this.absnormaly=r<0?-r:r}},rayAABB:function(){var t=this.originx,n=t,e=this.originy,i=e;if(this.maxdist>=Math.POSITIVE_INFINITY?(this.dirx>0?n=Math.POSITIVE_INFINITY:this.dirx<0&&(n=Math.NEGATIVE_INFINITY),this.diry>0?i=Math.POSITIVE_INFINITY:this.diry<0&&(i=Math.NEGATIVE_INFINITY)):(n+=this.maxdist*this.dirx,i+=this.maxdist*this.diry),n<t){var r=t;t=n,n=r}if(i<e){var s=e;e=i,i=s}return o.geom.ZPP_AABB.get(t,e,n,i)},aabbtest:function(t){var n=this.normalx*(this.originx-.5*(t.minx+t.maxx))+this.normaly*(this.originy-.5*(t.miny+t.maxy)),e=.5*this.absnormalx*(t.maxx-t.minx)+.5*this.absnormaly*(t.maxy-t.miny);return function(t){var e=n;return e<0?-e:e}()<e},aabbsect:function(t){var n=this.originx>=t.minx&&this.originx<=t.maxx,e=this.originy>=t.miny&&this.originy<=t.maxy;if(n&&e)return 0;var i=-1;do{if(this.dirx>=0&&this.originx>=t.maxx)break;if(this.dirx<=0&&this.originx<=t.minx)break;if(this.diry>=0&&this.originy>=t.maxy)break;if(this.diry<=0&&this.originy<=t.miny)break;if(this.dirx>0){var r=(t.minx-this.originx)*this.idirx;if(r>=0&&r<=this.maxdist){var s=this.originy+r*this.diry;if(s>=t.miny&&s<=t.maxy){i=r;break}}}else if(this.dirx<0){var l=(t.maxx-this.originx)*this.idirx;if(l>=0&&l<=this.maxdist){var a=this.originy+l*this.diry;if(a>=t.miny&&a<=t.maxy){i=l;break}}}if(this.diry>0){var p=(t.miny-this.originy)*this.idiry;if(p>=0&&p<=this.maxdist){var o=this.originx+p*this.dirx;if(o>=t.minx&&o<=t.maxx){i=p;break}}}else if(this.diry<0){var _=(t.maxy-this.originy)*this.idiry;if(_>=0&&_<=this.maxdist){var h=this.originx+_*this.dirx;if(h>=t.minx&&h<=t.maxx){i=_;break}}}}while(!1);return i},circlesect:function(t,n,e){t.zip_worldCOM&&null!=t.body&&(t.zip_worldCOM=!1,t.zip_localCOM&&(t.zip_localCOM=!1,t.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&t.polygon.__validate_localCOM(),null!=t.wrap_localCOM&&(t.wrap_localCOM.zpp_inner.x=t.localCOMx,t.wrap_localCOM.zpp_inner.y=t.localCOMy)),t.body.validate_axis(),t.worldCOMx=t.body.posx+(t.body.axisy*t.localCOMx-t.body.axisx*t.localCOMy),t.worldCOMy=t.body.posy+(t.localCOMx*t.body.axisx+t.localCOMy*t.body.axisy));var i=0,r=0;i=this.originx-t.worldCOMx,r=this.originy-t.worldCOMy;var s=this.dirx*this.dirx+this.diry*this.diry,l=2*(i*this.dirx+r*this.diry),a=i*i+r*r-t.radius*t.radius,_=l*l-4*s*a;if(0==_){var h=-l/2*s;if((!n||a>0)&&h>0&&h<e&&h<=this.maxdist){var u=0,d=0;u=this.originx,d=this.originy;var c=h;u+=this.dirx*c,d+=this.diry*c;u-=1*t.worldCOMx,d-=1*t.worldCOMy;var P=u*u+d*d,f=1/Math.sqrt(P),z=f;return u*=z,d*=z,a<=0&&(u=-u,d=-d),o.geom.ZPP_ConvexRayResult.getRay(p.geom.Vec2.get(u,d,null),h,a<=0,t.outer)}return null}_=Math.sqrt(_),s=1/(2*s);var v=(-l-_)*s,m=(-l+_)*s;if(v>0){if(v<e&&v<=this.maxdist){var b=0,y=0;b=this.originx,y=this.originy;var g=v;b+=this.dirx*g,y+=this.diry*g;b-=1*t.worldCOMx,y-=1*t.worldCOMy;var x=b*b+y*y,Z=1/Math.sqrt(x),w=Z;return b*=w,y*=w,o.geom.ZPP_ConvexRayResult.getRay(p.geom.Vec2.get(b,y,null),v,!1,t.outer)}return null}if(m>0&&n){if(m<e&&m<=this.maxdist){var C=0,E=0;C=this.originx,E=this.originy;var S=m;C+=this.dirx*S,E+=this.diry*S;C-=1*t.worldCOMx,E-=1*t.worldCOMy;var N=C*C+E*E,k=1/Math.sqrt(N),M=k;return C*=M,E*=M,C=-C,E=-E,o.geom.ZPP_ConvexRayResult.getRay(p.geom.Vec2.get(C,E,null),m,!0,t.outer)}return null}return null},circlesect2:function(t,n,e){t.zip_worldCOM&&null!=t.body&&(t.zip_worldCOM=!1,t.zip_localCOM&&(t.zip_localCOM=!1,t.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&t.polygon.__validate_localCOM(),null!=t.wrap_localCOM&&(t.wrap_localCOM.zpp_inner.x=t.localCOMx,t.wrap_localCOM.zpp_inner.y=t.localCOMy)),t.body.validate_axis(),t.worldCOMx=t.body.posx+(t.body.axisy*t.localCOMx-t.body.axisx*t.localCOMy),t.worldCOMy=t.body.posy+(t.localCOMx*t.body.axisx+t.localCOMy*t.body.axisy));var i=0,r=0;i=this.originx-t.worldCOMx,r=this.originy-t.worldCOMy;var s=this.dirx*this.dirx+this.diry*this.diry,l=2*(i*this.dirx+r*this.diry),a=i*i+r*r-t.radius*t.radius,_=l*l-4*s*a;if(0==_){var h=-l/2*s;if((!n||a>0)&&h>0&&h<=this.maxdist){var u=0,d=0;u=this.originx,d=this.originy;var c=h;u+=this.dirx*c,d+=this.diry*c;u-=1*t.worldCOMx,d-=1*t.worldCOMy;var P=u*u+d*d,f=1/Math.sqrt(P),z=f;u*=z,d*=z,a<=0&&(u=-u,d=-d);for(var v=o.geom.ZPP_ConvexRayResult.getRay(p.geom.Vec2.get(u,d,null),h,a<=0,t.outer),m=null,b=e.zpp_inner.inner.head;null!=b;){var y=b.elt;if(function(t){if(null!=v.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return v.zpp_inner.toiDistance}()<function(t){if(null!=y.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return y.zpp_inner.toiDistance}())break;m=b,b=b.next}e.zpp_inner.inner.inlined_insert(m,v)}}else{_=Math.sqrt(_),s=1/(2*s);var g=(-l-_)*s,x=(-l+_)*s;if(g>0&&g<=this.maxdist){var Z=0,w=0;Z=this.originx,w=this.originy;var C=g;Z+=this.dirx*C,w+=this.diry*C;Z-=1*t.worldCOMx,w-=1*t.worldCOMy;var E=Z*Z+w*w,S=1/Math.sqrt(E),N=S;Z*=N,w*=N;for(var k=o.geom.ZPP_ConvexRayResult.getRay(p.geom.Vec2.get(Z,w,null),g,!1,t.outer),M=null,I=e.zpp_inner.inner.head;null!=I;){var F=I.elt;if(function(t){if(null!=k.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return k.zpp_inner.toiDistance}()<function(t){if(null!=F.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return F.zpp_inner.toiDistance}())break;M=I,I=I.next}e.zpp_inner.inner.inlined_insert(M,k)}if(x>0&&x<=this.maxdist&&n){var A=0,T=0;A=this.originx,T=this.originy;var V=x;A+=this.dirx*V,T+=this.diry*V;A-=1*t.worldCOMx,T-=1*t.worldCOMy;var L=A*A+T*T,B=1/Math.sqrt(L),O=B;A*=O,T*=O,A=-A,T=-T;for(var G=o.geom.ZPP_ConvexRayResult.getRay(p.geom.Vec2.get(A,T,null),x,!0,t.outer),R=null,D=e.zpp_inner.inner.head;null!=D;){var j=D.elt;if(function(t){if(null!=G.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return G.zpp_inner.toiDistance}()<function(t){if(null!=j.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return j.zpp_inner.toiDistance}())break;R=D,D=D.next}e.zpp_inner.inner.inlined_insert(R,G)}}},polysect:function(t,n,e){for(var i=e,r=null,s=t.edges.head,l=t.gverts.next,a=l,_=l.next;null!=_;){var h=_,u=s.elt;if(n||u.gnormx*this.dirx+u.gnormy*this.diry<0){var d=0,c=0;d=h.x-a.x,c=h.y-a.y;var P=0,f=0;P=a.x-this.originx,f=a.y-this.originy;var z=c*this.dirx-d*this.diry;if(z*z>p.Config.epsilon){z=1/z;var v=(c*P-d*f)*z;if(v>0&&v<i&&v<=this.maxdist){var m=(this.diry*P-this.dirx*f)*z;m>-p.Config.epsilon&&m<1+p.Config.epsilon&&(i=v,r=s.elt)}}}s=s.next,l=_,a=h,_=_.next}_=t.gverts.next;var b=_,y=s.elt;if(n||y.gnormx*this.dirx+y.gnormy*this.diry<0){var g=0,x=0;g=b.x-a.x,x=b.y-a.y;var Z=0,w=0;Z=a.x-this.originx,w=a.y-this.originy;var C=x*this.dirx-g*this.diry;if(C*C>p.Config.epsilon){C=1/C;var E=(x*Z-g*w)*C;if(E>0&&E<i&&E<=this.maxdist){var S=(this.diry*Z-this.dirx*w)*C;S>-p.Config.epsilon&&S<1+p.Config.epsilon&&(i=E,r=s.elt)}}}if(s=s.next,null!=r){var N=0,k=0;N=r.gnormx,k=r.gnormy;var M=N*this.dirx+k*this.diry>0;return M&&(N=-N,k=-k),o.geom.ZPP_ConvexRayResult.getRay(p.geom.Vec2.get(N,k,null),i,M,t.outer)}return null},polysect2:function(t,n,e){for(var i=Math.POSITIVE_INFINITY,r=-1,s=null,l=null,a=t.edges.head,_=t.gverts.next,h=_,u=_.next;null!=u;){var d=u,c=a.elt;if(n||c.gnormx*this.dirx+c.gnormy*this.diry<0){var P=0,f=0;P=d.x-h.x,f=d.y-h.y;var z=0,v=0;z=h.x-this.originx,v=h.y-this.originy;var m=f*this.dirx-P*this.diry;if(m*m>p.Config.epsilon){m=1/m;var b=(f*z-P*v)*m;if(b>0&&b<=this.maxdist&&(b<i||b>r)){var y=(this.diry*z-this.dirx*v)*m;y>-p.Config.epsilon&&y<1+p.Config.epsilon&&(b<i&&(i=b,s=a.elt),b>r&&(r=b,l=a.elt))}}}a=a.next,_=u,h=d,u=u.next}u=t.gverts.next;var g=u,x=a.elt;if(n||x.gnormx*this.dirx+x.gnormy*this.diry<0){var Z=0,w=0;Z=g.x-h.x,w=g.y-h.y;var C=0,E=0;C=h.x-this.originx,E=h.y-this.originy;var S=w*this.dirx-Z*this.diry;if(S*S>p.Config.epsilon){S=1/S;var N=(w*C-Z*E)*S;if(N>0&&N<=this.maxdist&&(N<i||N>r)){var k=(this.diry*C-this.dirx*E)*S;k>-p.Config.epsilon&&k<1+p.Config.epsilon&&(N<i&&(i=N,s=a.elt),N>r&&(r=N,l=a.elt))}}}if(a=a.next,null!=s){var M=0,I=0;M=s.gnormx,I=s.gnormy;var F=M*this.dirx+I*this.diry>0;F&&(M=-M,I=-I);for(var A=o.geom.ZPP_ConvexRayResult.getRay(p.geom.Vec2.get(M,I,null),i,F,t.outer),T=null,V=e.zpp_inner.inner.head;null!=V;){var L=V.elt;if(function(t){if(null!=A.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return A.zpp_inner.toiDistance}()<function(t){if(null!=L.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return L.zpp_inner.toiDistance}())break;T=V,V=V.next}e.zpp_inner.inner.inlined_insert(T,A)}if(null!=l&&s!=l){var B=0,O=0;B=l.gnormx,O=l.gnormy;var G=B*this.dirx+O*this.diry>0;G&&(B=-B,O=-O);for(var R=o.geom.ZPP_ConvexRayResult.getRay(p.geom.Vec2.get(B,O,null),r,G,t.outer),D=null,j=e.zpp_inner.inner.head;null!=j;){var q=j.elt;if(function(t){if(null!=R.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return R.zpp_inner.toiDistance}()<function(t){if(null!=q.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return q.zpp_inner.toiDistance}())break;D=j,j=j.next}e.zpp_inner.inner.inlined_insert(D,R)}},__class__:o.geom.ZPP_Ray},o.geom.ZPP_SimpleVert=function(){this.node=null,this.next=null,this.id=0,this.links=null,this.y=0,this.x=0,this.forced=!1,this.id=o.ZPP_ID.ZPP_SimpleVert(),null==o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool?this.links=new o.util.ZPP_Set_ZPP_SimpleVert:(this.links=o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool,o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool=this.links.next,this.links.next=null),this.links.lt=o.geom.ZPP_SimpleVert.less_xy},o.geom.ZPP_SimpleVert.__name__=!0,o.geom.ZPP_SimpleVert.less_xy=function(t,n){return t.y<n.y||t.y==n.y&&t.x<n.x},o.geom.ZPP_SimpleVert.swap_nodes=function(t,n){var e=t.node;t.node=n.node,n.node=e},o.geom.ZPP_SimpleVert.get=function(t,n){var e;return null==o.geom.ZPP_SimpleVert.zpp_pool?e=new o.geom.ZPP_SimpleVert:(e=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=e.next,e.next=null),e.x=t,e.y=n,e},o.geom.ZPP_SimpleVert.prototype={free:function(){this.links.clear(),this.node=null,this.forced=!1},alloc:function(){},__class__:o.geom.ZPP_SimpleVert},o.geom.ZPP_SimpleSeg=function(){this.node=null,this.prev=null,this.next=null,this.id=0,this.vertices=null,this.right=null,this.left=null,this.id=o.ZPP_ID.ZPP_SimpleSeg(),null==o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool?this.vertices=new o.util.ZPP_Set_ZPP_SimpleVert:(this.vertices=o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool,o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool=this.vertices.next,this.vertices.next=null),this.vertices.lt=n(this,this.less_xy)},o.geom.ZPP_SimpleSeg.__name__=!0,o.geom.ZPP_SimpleSeg.get=function(t,n){var e;return null==o.geom.ZPP_SimpleSeg.zpp_pool?e=new o.geom.ZPP_SimpleSeg:(e=o.geom.ZPP_SimpleSeg.zpp_pool,o.geom.ZPP_SimpleSeg.zpp_pool=e.next,e.next=null),e.left=t,e.right=n,e.vertices.insert(t),e.vertices.insert(n),e},o.geom.ZPP_SimpleSeg.prototype={free:function(){this.left=this.right=null,this.prev=null,this.node=null,this.vertices.clear()},alloc:function(){},less_xy:function(t,n){return t.x<n.x||t.x==n.x&&t.y<n.y},__class__:o.geom.ZPP_SimpleSeg},o.geom.ZPP_SimpleEvent=function(){this.next=null,this.node=null,this.segment2=null,this.segment=null,this.vertex=null,this.type=0},o.geom.ZPP_SimpleEvent.__name__=!0,o.geom.ZPP_SimpleEvent.swap_nodes=function(t,n){var e=t.node;t.node=n.node,n.node=e},o.geom.ZPP_SimpleEvent.less_xy=function(t,n){return t.vertex.x<n.vertex.x||!(t.vertex.x>n.vertex.x)&&(t.vertex.y<n.vertex.y||!(t.vertex.y>n.vertex.y)&&t.type<n.type)},o.geom.ZPP_SimpleEvent.get=function(t){var n;return null==o.geom.ZPP_SimpleEvent.zpp_pool?n=new o.geom.ZPP_SimpleEvent:(n=o.geom.ZPP_SimpleEvent.zpp_pool,o.geom.ZPP_SimpleEvent.zpp_pool=n.next,n.next=null),n.vertex=t,n},o.geom.ZPP_SimpleEvent.prototype={free:function(){this.vertex=null,this.segment=this.segment2=null,this.node=null},alloc:function(){},__class__:o.geom.ZPP_SimpleEvent},o.geom.ZPP_SimpleSweep=function(){this.tree=null,this.sweepx=0,null==o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool?this.tree=new o.util.ZPP_Set_ZPP_SimpleSeg:(this.tree=o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool,o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool=this.tree.next,this.tree.next=null),this.tree.lt=n(this,this.edge_lt),this.tree.swapped=n(this,this.swap_nodes)},o.geom.ZPP_SimpleSweep.__name__=!0,o.geom.ZPP_SimpleSweep.prototype={swap_nodes:function(t,n){var e=t.node;t.node=n.node,n.node=e},edge_lt:function(t,n){var e,i=0,r=0,s=0,l=0;if(t.left==n.left&&t.right==n.right)return!1;if(t.left==n.right)return t.left.x==t.right.x?t.left.y<t.right.y?t.left.y>n.left.y:t.right.y>n.left.y:function(a){return e=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,s=n.left.x-t.left.x,l=n.left.y-t.left.y,e?r*s-i*l:l*i-s*r}()<0;if(t.right==n.left)return!(n.left.x==n.right.x?n.left.y<n.right.y?n.left.y>t.left.y:n.right.y>t.left.y:function(a){return e=n.right.x<n.left.x,i=n.right.x-n.left.x,r=n.right.y-n.left.y,s=t.left.x-n.left.x,l=t.left.y-n.left.y,e?r*s-i*l:l*i-s*r}()<0);if(t.left==n.left)return t.left.x==t.right.x?t.left.y<t.right.y?t.left.y>n.right.y:t.right.y>n.right.y:function(a){return e=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,s=n.right.x-t.left.x,l=n.right.y-t.left.y,e?r*s-i*l:l*i-s*r}()<0;if(t.right==n.right)return t.left.x==t.right.x?t.left.y<t.right.y?t.left.y>n.left.y:t.right.y>n.left.y:function(a){return e=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,s=n.left.x-t.left.x,l=n.left.y-t.left.y,e?r*s-i*l:l*i-s*r}()<0;if(t.left.x==t.right.x){if(n.left.x==n.right.x){var a;a=t.left.y<t.right.y?t.right:t.left;var p;return p=n.left.y<n.right.y?n.right:n.left,a.y>p.y}var o;e=n.right.x<n.left.x,i=n.right.x-n.left.x,r=n.right.y-n.left.y,s=t.left.x-n.left.x,l=t.left.y-n.left.y,o=e?r*s-i*l:l*i-s*r;var _;return e=n.right.x<n.left.x,i=n.right.x-n.left.x,r=n.right.y-n.left.y,s=t.right.x-n.left.x,l=t.right.y-n.left.y,_=e?r*s-i*l:l*i-s*r,o*_>=0?o>=0:this.sweepx>=t.left.x}if(n.left.x==n.right.x){var h;e=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,s=n.left.x-t.left.x,l=n.left.y-t.left.y,h=e?r*s-i*l:l*i-s*r;var u;return e=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,s=n.right.x-t.left.x,l=n.right.y-t.left.y,u=e?r*s-i*l:l*i-s*r,h*u>=0?h<0:this.sweepx<n.left.x}var d;d=function(a){return e=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,s=n.left.x-t.left.x,l=n.left.y-t.left.y,e?r*s-i*l:l*i-s*r}()<0;var c;if(c=function(a){return e=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,s=n.right.x-t.left.x,l=n.right.y-t.left.y,e?r*s-i*l:l*i-s*r}()<0,d==c)return d;var P;P=function(a){return e=n.right.x<n.left.x,i=n.right.x-n.left.x,r=n.right.y-n.left.y,s=t.left.x-n.left.x,l=t.left.y-n.left.y,e?r*s-i*l:l*i-s*r}()>=0;var f;return f=function(a){return e=n.right.x<n.left.x,i=n.right.x-n.left.x,r=n.right.y-n.left.y,s=t.right.x-n.left.x,l=t.right.y-n.left.y,e?r*s-i*l:l*i-s*r}()>=0,P==f?P:(this.sweepx-t.left.x)/(t.right.x-t.left.x)*(t.right.y-t.left.y)+t.left.y>(this.sweepx-n.left.x)/(n.right.x-n.left.x)*(n.right.y-n.left.y)+n.left.y},clear:function(){this.tree.clear()},add:function(t){t.node=this.tree.insert(t);var n=this.tree.successor_node(t.node),e=this.tree.predecessor_node(t.node);return null!=n&&(t.next=n.data,n.data.prev=t),null!=e&&(t.prev=e.data,e.data.next=t),t},remove:function(t){var n=this.tree.successor_node(t.node),e=this.tree.predecessor_node(t.node);null!=n&&(n.data.prev=t.prev),null!=e&&(e.data.next=t.next),this.tree.remove_node(t.node),t.node=null},intersect:function(t,n){if(null==t||null==n)return!1;if(t.left==n.left||t.left==n.right||t.right==n.left||t.right==n.right)return!1;var e=(n.left.x-t.left.x)*(t.right.y-t.left.y)-(t.right.x-t.left.x)*(n.left.y-t.left.y),i=(n.right.x-t.left.x)*(t.right.y-t.left.y)-(t.right.x-t.left.x)*(n.right.y-t.left.y);if(e*i>0)return!1;var r=(t.left.x-n.left.x)*(n.right.y-n.left.y)-(n.right.x-n.left.x)*(t.left.y-n.left.y),s=(t.right.x-n.left.x)*(n.right.y-n.left.y)-(n.right.x-n.left.x)*(t.right.y-n.left.y);return!(r*s>0)},intersection:function(t,n){if(null==t||null==n)return null;if(t.left==n.left||t.left==n.right||t.right==n.left||t.right==n.right)return null;var e=0,i=0;e=t.right.x-t.left.x,i=t.right.y-t.left.y;var r=0,s=0;r=n.right.x-n.left.x,s=n.right.y-n.left.y;var l=s*e-r*i;if(0==l)return null;l=1/l;var a=0,p=0;a=n.left.x-t.left.x,p=n.left.y-t.left.y;var _=(s*a-r*p)*l;if(_<0||_>1)return null;var h=(i*a-e*p)*l;if(h<0||h>1)return null;var u;if(0==h||1==h||0==_||1==_){var d=0==h;if(1==h&&d)throw"corner case 1a";if(1==h&&(d=!0),0==_&&d)throw"corner case 1b";if(0==_&&(d=!0),1==_&&d)throw"corner case 1c";u=0==h?n.left:1==h?n.right:0==_?t.left:t.right}else u=o.geom.ZPP_SimpleVert.get(.5*(t.left.x+e*_+n.left.x+r*h),.5*(t.left.y+i*_+n.left.y+s*h));var c=o.geom.ZPP_SimpleEvent.get(u);return c.type=0,c.segment=t,c.segment2=n,c},__class__:o.geom.ZPP_SimpleSweep},o.geom.ZPP_Simple=function(){},o.geom.ZPP_Simple.__name__=!0,o.geom.ZPP_Simple.decompose=function(t,n){
null==o.geom.ZPP_Simple.sweep&&(o.geom.ZPP_Simple.sweep=new o.geom.ZPP_SimpleSweep,o.geom.ZPP_Simple.inthash=new o.util.FastHash2_Hashable2_Boolfalse),null==o.geom.ZPP_Simple.vertices&&(null==o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool?o.geom.ZPP_Simple.vertices=new o.util.ZPP_Set_ZPP_SimpleVert:(o.geom.ZPP_Simple.vertices=o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool,o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool=o.geom.ZPP_Simple.vertices.next,o.geom.ZPP_Simple.vertices.next=null),o.geom.ZPP_Simple.vertices.lt=o.geom.ZPP_SimpleVert.less_xy,o.geom.ZPP_Simple.vertices.swapped=o.geom.ZPP_SimpleVert.swap_nodes),null==o.geom.ZPP_Simple.queue&&(null==o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool?o.geom.ZPP_Simple.queue=new o.util.ZPP_Set_ZPP_SimpleEvent:(o.geom.ZPP_Simple.queue=o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool,o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool=o.geom.ZPP_Simple.queue.next,o.geom.ZPP_Simple.queue.next=null),o.geom.ZPP_Simple.queue.lt=o.geom.ZPP_SimpleEvent.less_xy,o.geom.ZPP_Simple.queue.swapped=o.geom.ZPP_SimpleEvent.swap_nodes);var e=null,i=null,r=t,s=t;if(null!=r){var l=r;do{for(var a,p=l,_=o.geom.ZPP_SimpleVert.get(p.x,p.y),h=o.geom.ZPP_Simple.vertices.parent;null!=h;)if(o.geom.ZPP_Simple.vertices.lt(_,h.data))h=h.prev;else{if(!o.geom.ZPP_Simple.vertices.lt(h.data,_))break;h=h.next}if(null!=(a=h)){var u=_;u.links.clear(),u.node=null,u.forced=!1,u.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=u,_=a.data}else _.node=o.geom.ZPP_Simple.vertices.insert(_);if(null!=i){var d,c=o.geom.ZPP_SimpleEvent.get(i),P=o.geom.ZPP_SimpleEvent.get(_);o.geom.ZPP_SimpleEvent.less_xy(c,P)?(c.type=1,P.type=2,d=o.geom.ZPP_SimpleSeg.get(i,_)):(c.type=2,P.type=1,d=o.geom.ZPP_SimpleSeg.get(_,i)),c.segment=P.segment=d,o.geom.ZPP_Simple.queue.insert(c),o.geom.ZPP_Simple.queue.insert(P),i.links.insert(_),_.links.insert(i)}i=_,null==e&&(e=_),l=l.next}while(l!=s)}var f,z=o.geom.ZPP_SimpleEvent.get(i),v=o.geom.ZPP_SimpleEvent.get(e);for(o.geom.ZPP_SimpleEvent.less_xy(z,v)?(z.type=1,v.type=2,f=o.geom.ZPP_SimpleSeg.get(i,e)):(z.type=2,v.type=1,f=o.geom.ZPP_SimpleSeg.get(e,i)),z.segment=v.segment=f,o.geom.ZPP_Simple.queue.insert(z),o.geom.ZPP_Simple.queue.insert(v),i.links.insert(e),e.links.insert(i),null==o.geom.ZPP_Simple.ints&&(null==o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool?o.geom.ZPP_Simple.ints=new o.util.ZPP_Set_ZPP_SimpleEvent:(o.geom.ZPP_Simple.ints=o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool,o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool=o.geom.ZPP_Simple.ints.next,o.geom.ZPP_Simple.ints.next=null),o.geom.ZPP_Simple.ints.lt=o.geom.ZPP_SimpleEvent.less_xy);!o.geom.ZPP_Simple.queue.empty();){var m=o.geom.ZPP_Simple.queue.pop_front();if(o.geom.ZPP_Simple.sweep.sweepx=m.vertex.x,1==m.type){var b=m.segment;if(o.geom.ZPP_Simple.sweep.add(b),null!=b.next&&null!=b&&!(b.next.id<b.id?o.geom.ZPP_Simple.inthash.has(b.next.id,b.id):o.geom.ZPP_Simple.inthash.has(b.id,b.next.id))){var y=o.geom.ZPP_Simple.sweep.intersection(b.next,b);if(null!=y)if(y.vertex.x>=o.geom.ZPP_Simple.sweep.sweepx){for(var g,x=o.geom.ZPP_Simple.queue.parent;null!=x;)if(o.geom.ZPP_Simple.queue.lt(y,x.data))x=x.prev;else{if(!o.geom.ZPP_Simple.queue.lt(x.data,y))break;x=x.next}if(null==(g=x)){for(var Z,w=o.geom.ZPP_Simple.ints.parent;null!=w;)if(o.geom.ZPP_Simple.ints.lt(y,w.data))w=w.prev;else{if(!o.geom.ZPP_Simple.ints.lt(w.data,y))break;w=w.next}if(null!=(Z=w)){var C=y.vertex;C.links.clear(),C.node=null,C.forced=!1,C.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=C,y.vertex=Z.data.vertex,Z.data=y,o.geom.ZPP_Simple.queue.insert(y)}else o.geom.ZPP_Simple.queue.insert(y),o.geom.ZPP_Simple.ints.insert(y);b.next.id<b.id?o.geom.ZPP_Simple.inthash.add(o.util.Hashable2_Boolfalse.get(b.next.id,b.id,!0)):o.geom.ZPP_Simple.inthash.add(o.util.Hashable2_Boolfalse.get(b.id,b.next.id,!0))}else{var E=g.data;if(E.segment!=y.segment||y.segment2!=E.segment2)throw"corner case 2, shiiiit.";var S=y.vertex;S.links.clear(),S.node=null,S.forced=!1,S.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=S;var N=y;N.vertex=null,N.segment=N.segment2=null,N.node=null,N.next=o.geom.ZPP_SimpleEvent.zpp_pool,o.geom.ZPP_SimpleEvent.zpp_pool=N}}else{var k=y.vertex;k.links.clear(),k.node=null,k.forced=!1,k.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=k;var M=y;M.vertex=null,M.segment=M.segment2=null,M.node=null,M.next=o.geom.ZPP_SimpleEvent.zpp_pool,o.geom.ZPP_SimpleEvent.zpp_pool=M}}if(null!=b&&null!=b.prev&&!(b.id<b.prev.id?o.geom.ZPP_Simple.inthash.has(b.id,b.prev.id):o.geom.ZPP_Simple.inthash.has(b.prev.id,b.id))){var I=o.geom.ZPP_Simple.sweep.intersection(b,b.prev);if(null!=I)if(I.vertex.x>=o.geom.ZPP_Simple.sweep.sweepx){for(var F,A=o.geom.ZPP_Simple.queue.parent;null!=A;)if(o.geom.ZPP_Simple.queue.lt(I,A.data))A=A.prev;else{if(!o.geom.ZPP_Simple.queue.lt(A.data,I))break;A=A.next}if(null==(F=A)){for(var T,V=o.geom.ZPP_Simple.ints.parent;null!=V;)if(o.geom.ZPP_Simple.ints.lt(I,V.data))V=V.prev;else{if(!o.geom.ZPP_Simple.ints.lt(V.data,I))break;V=V.next}if(null!=(T=V)){var L=I.vertex;L.links.clear(),L.node=null,L.forced=!1,L.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=L,I.vertex=T.data.vertex,T.data=I,o.geom.ZPP_Simple.queue.insert(I)}else o.geom.ZPP_Simple.queue.insert(I),o.geom.ZPP_Simple.ints.insert(I);b.id<b.prev.id?o.geom.ZPP_Simple.inthash.add(o.util.Hashable2_Boolfalse.get(b.id,b.prev.id,!0)):o.geom.ZPP_Simple.inthash.add(o.util.Hashable2_Boolfalse.get(b.prev.id,b.id,!0))}else{var B=F.data;if(B.segment!=I.segment||I.segment2!=B.segment2)throw"corner case 2, shiiiit.";var O=I.vertex;O.links.clear(),O.node=null,O.forced=!1,O.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=O;var G=I;G.vertex=null,G.segment=G.segment2=null,G.node=null,G.next=o.geom.ZPP_SimpleEvent.zpp_pool,o.geom.ZPP_SimpleEvent.zpp_pool=G}}else{var R=I.vertex;R.links.clear(),R.node=null,R.forced=!1,R.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=R;var D=I;D.vertex=null,D.segment=D.segment2=null,D.node=null,D.next=o.geom.ZPP_SimpleEvent.zpp_pool,o.geom.ZPP_SimpleEvent.zpp_pool=D}}}else if(2==m.type){var j=m.segment;if(null!=j.node){var q=j.next,Y=j.prev;o.geom.ZPP_Simple.sweep.remove(j);var U=j;if(U.left=U.right=null,U.prev=null,U.node=null,U.vertices.clear(),U.next=o.geom.ZPP_SimpleSeg.zpp_pool,o.geom.ZPP_SimpleSeg.zpp_pool=U,null!=q&&null!=Y&&!(q.id<Y.id?o.geom.ZPP_Simple.inthash.has(q.id,Y.id):o.geom.ZPP_Simple.inthash.has(Y.id,q.id))){var W=o.geom.ZPP_Simple.sweep.intersection(q,Y);if(null!=W)if(W.vertex.x>=o.geom.ZPP_Simple.sweep.sweepx){for(var J,K=o.geom.ZPP_Simple.queue.parent;null!=K;)if(o.geom.ZPP_Simple.queue.lt(W,K.data))K=K.prev;else{if(!o.geom.ZPP_Simple.queue.lt(K.data,W))break;K=K.next}if(null==(J=K)){for(var H,X=o.geom.ZPP_Simple.ints.parent;null!=X;)if(o.geom.ZPP_Simple.ints.lt(W,X.data))X=X.prev;else{if(!o.geom.ZPP_Simple.ints.lt(X.data,W))break;X=X.next}if(null!=(H=X)){var Q=W.vertex;Q.links.clear(),Q.node=null,Q.forced=!1,Q.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=Q,W.vertex=H.data.vertex,H.data=W,o.geom.ZPP_Simple.queue.insert(W)}else o.geom.ZPP_Simple.queue.insert(W),o.geom.ZPP_Simple.ints.insert(W);q.id<Y.id?o.geom.ZPP_Simple.inthash.add(o.util.Hashable2_Boolfalse.get(q.id,Y.id,!0)):o.geom.ZPP_Simple.inthash.add(o.util.Hashable2_Boolfalse.get(Y.id,q.id,!0))}else{var $=J.data;if($.segment!=W.segment||W.segment2!=$.segment2)throw"corner case 2, shiiiit.";var tt=W.vertex;tt.links.clear(),tt.node=null,tt.forced=!1,tt.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=tt;var nt=W;nt.vertex=null,nt.segment=nt.segment2=null,nt.node=null,nt.next=o.geom.ZPP_SimpleEvent.zpp_pool,o.geom.ZPP_SimpleEvent.zpp_pool=nt}}else{var et=W.vertex;et.links.clear(),et.node=null,et.forced=!1,et.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=et;var it=W;it.vertex=null,it.segment=it.segment2=null,it.node=null,it.next=o.geom.ZPP_SimpleEvent.zpp_pool,o.geom.ZPP_SimpleEvent.zpp_pool=it}}}}else{var rt=m.vertex,st=null==rt.node,lt=m.segment,at=m.segment2;if(at.next!=lt){var pt=lt;lt=at,at=pt}var ot;ot=null==function(t){for(var n=lt.vertices.parent;null!=n;)if(lt.vertices.lt(rt,n.data))n=n.prev;else{if(!lt.vertices.lt(n.data,rt))break;n=n.next}return n}();var _t;if(_t=null==function(t){for(var n=at.vertices.parent;null!=n;)if(at.vertices.lt(rt,n.data))n=n.prev;else{if(!at.vertices.lt(n.data,rt))break;n=n.next}return n}(),ot){var ht,ut=lt.vertices.insert(rt);ht=rt==lt.left?rt:lt.vertices.predecessor_node(ut).data;var dt;dt=rt==lt.right?rt:lt.vertices.successor_node(ut).data,ht.links.remove(dt),rt!=ht&&ht.links.insert(rt),dt.links.remove(ht),rt!=dt&&dt.links.insert(rt),rt!=ht&&rt.links.insert(ht),rt!=dt&&rt.links.insert(dt)}if(_t){var ct,Pt=at.vertices.insert(rt);ct=rt==at.left?rt:at.vertices.predecessor_node(Pt).data;var ft;ft=rt==at.right?rt:at.vertices.successor_node(Pt).data,ct.links.remove(ft),rt!=ct&&ct.links.insert(rt),ft.links.remove(ct),rt!=ft&&ft.links.insert(rt),rt!=ct&&rt.links.insert(ct),rt!=ft&&rt.links.insert(ft)}if(st&&(rt.node=o.geom.ZPP_Simple.vertices.insert(rt)),rt.forced=!0,st){var zt=lt.node,vt=at.node;zt.data=at,vt.data=lt,lt.node=vt,at.node=zt,at.next=lt.next,lt.next=at,lt.prev=at.prev,at.prev=lt,null!=lt.prev&&(lt.prev.next=lt),null!=at.next&&(at.next.prev=at)}if(null!=at.next&&null!=at&&!(at.next.id<at.id?o.geom.ZPP_Simple.inthash.has(at.next.id,at.id):o.geom.ZPP_Simple.inthash.has(at.id,at.next.id))){var mt=o.geom.ZPP_Simple.sweep.intersection(at.next,at);if(null!=mt)if(mt.vertex.x>=o.geom.ZPP_Simple.sweep.sweepx){for(var bt,yt=o.geom.ZPP_Simple.queue.parent;null!=yt;)if(o.geom.ZPP_Simple.queue.lt(mt,yt.data))yt=yt.prev;else{if(!o.geom.ZPP_Simple.queue.lt(yt.data,mt))break;yt=yt.next}if(null==(bt=yt)){for(var gt,xt=o.geom.ZPP_Simple.ints.parent;null!=xt;)if(o.geom.ZPP_Simple.ints.lt(mt,xt.data))xt=xt.prev;else{if(!o.geom.ZPP_Simple.ints.lt(xt.data,mt))break;xt=xt.next}if(null!=(gt=xt)){var Zt=mt.vertex;Zt.links.clear(),Zt.node=null,Zt.forced=!1,Zt.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=Zt,mt.vertex=gt.data.vertex,gt.data=mt,o.geom.ZPP_Simple.queue.insert(mt)}else o.geom.ZPP_Simple.queue.insert(mt),o.geom.ZPP_Simple.ints.insert(mt);at.next.id<at.id?o.geom.ZPP_Simple.inthash.add(o.util.Hashable2_Boolfalse.get(at.next.id,at.id,!0)):o.geom.ZPP_Simple.inthash.add(o.util.Hashable2_Boolfalse.get(at.id,at.next.id,!0))}else{var wt=bt.data;if(wt.segment!=mt.segment||mt.segment2!=wt.segment2)throw"corner case 2, shiiiit.";var Ct=mt.vertex;Ct.links.clear(),Ct.node=null,Ct.forced=!1,Ct.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=Ct;var Et=mt;Et.vertex=null,Et.segment=Et.segment2=null,Et.node=null,Et.next=o.geom.ZPP_SimpleEvent.zpp_pool,o.geom.ZPP_SimpleEvent.zpp_pool=Et}}else{var St=mt.vertex;St.links.clear(),St.node=null,St.forced=!1,St.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=St;var Nt=mt;Nt.vertex=null,Nt.segment=Nt.segment2=null,Nt.node=null,Nt.next=o.geom.ZPP_SimpleEvent.zpp_pool,o.geom.ZPP_SimpleEvent.zpp_pool=Nt}}if(null!=lt&&null!=lt.prev&&!(lt.id<lt.prev.id?o.geom.ZPP_Simple.inthash.has(lt.id,lt.prev.id):o.geom.ZPP_Simple.inthash.has(lt.prev.id,lt.id))){var kt=o.geom.ZPP_Simple.sweep.intersection(lt,lt.prev);if(null!=kt)if(kt.vertex.x>=o.geom.ZPP_Simple.sweep.sweepx){for(var Mt,It=o.geom.ZPP_Simple.queue.parent;null!=It;)if(o.geom.ZPP_Simple.queue.lt(kt,It.data))It=It.prev;else{if(!o.geom.ZPP_Simple.queue.lt(It.data,kt))break;It=It.next}if(null==(Mt=It)){for(var Ft,At=o.geom.ZPP_Simple.ints.parent;null!=At;)if(o.geom.ZPP_Simple.ints.lt(kt,At.data))At=At.prev;else{if(!o.geom.ZPP_Simple.ints.lt(At.data,kt))break;At=At.next}if(null!=(Ft=At)){var Tt=kt.vertex;Tt.links.clear(),Tt.node=null,Tt.forced=!1,Tt.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=Tt,kt.vertex=Ft.data.vertex,Ft.data=kt,o.geom.ZPP_Simple.queue.insert(kt)}else o.geom.ZPP_Simple.queue.insert(kt),o.geom.ZPP_Simple.ints.insert(kt);lt.id<lt.prev.id?o.geom.ZPP_Simple.inthash.add(o.util.Hashable2_Boolfalse.get(lt.id,lt.prev.id,!0)):o.geom.ZPP_Simple.inthash.add(o.util.Hashable2_Boolfalse.get(lt.prev.id,lt.id,!0))}else{var Vt=Mt.data;if(Vt.segment!=kt.segment||kt.segment2!=Vt.segment2)throw"corner case 2, shiiiit.";var Lt=kt.vertex;Lt.links.clear(),Lt.node=null,Lt.forced=!1,Lt.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=Lt;var Bt=kt;Bt.vertex=null,Bt.segment=Bt.segment2=null,Bt.node=null,Bt.next=o.geom.ZPP_SimpleEvent.zpp_pool,o.geom.ZPP_SimpleEvent.zpp_pool=Bt}}else{var Ot=kt.vertex;Ot.links.clear(),Ot.node=null,Ot.forced=!1,Ot.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=Ot;var Gt=kt;Gt.vertex=null,Gt.segment=Gt.segment2=null,Gt.node=null,Gt.next=o.geom.ZPP_SimpleEvent.zpp_pool,o.geom.ZPP_SimpleEvent.zpp_pool=Gt}}o.geom.ZPP_Simple.ints.remove(m)}var Rt=m;Rt.vertex=null,Rt.segment=Rt.segment2=null,Rt.node=null,Rt.next=o.geom.ZPP_SimpleEvent.zpp_pool,o.geom.ZPP_SimpleEvent.zpp_pool=Rt}for(var Dt=0,jt=o.geom.ZPP_Simple.inthash.table.length;Dt<jt;){var qt=Dt++,Yt=o.geom.ZPP_Simple.inthash.table[qt];if(null!=Yt){for(;null!=Yt;){var Ut=Yt.hnext;Yt.hnext=null;var Wt=Yt;Wt.next=o.util.Hashable2_Boolfalse.zpp_pool,o.util.Hashable2_Boolfalse.zpp_pool=Wt,Yt=Ut}o.geom.ZPP_Simple.inthash.table[qt]=null}}for(null==n&&(n=new o.util.ZNPList_ZPP_GeomVert);!o.geom.ZPP_Simple.vertices.empty();)o.geom.ZPP_Simple.clip_polygon(o.geom.ZPP_Simple.vertices,n);return n},o.geom.ZPP_Simple.clip_polygon=function(t,n){var e,i=null,r=t.first(),s=r,l=r.links.parent;e=null==l.prev?l.next:l.prev;var a=l.data,p=e.data;(function(t){var n=0,e=0;n=r.x-a.x,e=r.y-a.y;var i=0,s=0;return i=p.x-r.x,s=p.y-r.y,s*n-i*e})()<0&&(p=a);var _=o.geom.ZPP_GeomVert.get(r.x,r.y);for(null==i?i=_.prev=_.next=_:(_.prev=i,_.next=i.next,i.next.prev=_,i.next=_),i=_,i.forced=r.forced;;){if(r.links.remove(p),p.links.remove(r),p==s){if(r.links.empty()){t.remove(r);var h=r;h.links.clear(),h.node=null,h.forced=!1,h.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=h}break}var u=o.geom.ZPP_GeomVert.get(p.x,p.y);if(null==i?i=u.prev=u.next=u:(u.prev=i,u.next=i.next,i.next.prev=u,i.next=u),i=u,i.forced=p.forced,p.links.singular()){if(r.links.empty()){t.remove(r);var d=r;d.links.clear(),d.node=null,d.forced=!1,d.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=d}r=p,p=p.links.parent.data}else{var c=null,P=0;if(!p.links.empty()){for(var f=p.links.parent;null!=f.prev;)f=f.prev;for(;null!=f;){var z=f.data;if(null==c){c=z;var v=0,m=0;v=p.x-r.x,m=p.y-r.y;var b=0,y=0;b=z.x-p.x,y=z.y-p.y,P=y*v-b*m}else{var g,x=0,Z=0;x=p.x-r.x,Z=p.y-r.y;var w=0,C=0;if(w=z.x-p.x,C=z.y-p.y,(g=C*x-w*Z)>0&&P<=0)c=z,P=g;else if(P*g>=0){var E,S=0,N=0;S=p.x-z.x,N=p.y-z.y;var k=0,M=0;k=c.x-p.x,M=c.y-p.y,E=M*S-k*N,E>0&&(c=z,P=g)}}if(null!=f.next)for(f=f.next;null!=f.prev;)f=f.prev;else{for(;null!=f.parent&&f==f.parent.next;)f=f.parent;f=f.parent}}}if(r.links.empty()){t.remove(r);var I=r;I.links.clear(),I.node=null,I.forced=!1,I.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=I}r=p,p=c}}t.remove(s);var F=s;F.links.clear(),F.node=null,F.forced=!1,F.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=F,n.add(i)},o.geom.ZPP_Simple.isSimple=function(t){null==o.geom.ZPP_Simple.sweep&&(o.geom.ZPP_Simple.sweep=new o.geom.ZPP_SimpleSweep,o.geom.ZPP_Simple.inthash=new o.util.FastHash2_Hashable2_Boolfalse);var n=o.geom.ZPP_Simple.list_vertices;null==n&&(n=o.geom.ZPP_Simple.list_vertices=new o.util.ZNPList_ZPP_SimpleVert);var e=t,i=t;if(null!=e){var r=e;do{var s=r;n.add(o.geom.ZPP_SimpleVert.get(s.x,s.y)),r=r.next}while(r!=i)}var l=o.geom.ZPP_Simple.list_queue;null==l&&(l=o.geom.ZPP_Simple.list_queue=new o.util.ZNPList_ZPP_SimpleEvent);var a=n.head,p=a.elt;for(a=a.next;null!=a;){var _=a.elt,h=l.add(o.geom.ZPP_SimpleEvent.get(p)),u=l.add(o.geom.ZPP_SimpleEvent.get(_));h.segment=o.geom.ZPP_SimpleEvent.less_xy(h,u)?function(t){return h.type=1,u.type=2,u.segment=o.geom.ZPP_SimpleSeg.get(p,_)}():function(t){return h.type=2,u.type=1,u.segment=o.geom.ZPP_SimpleSeg.get(_,p)}(),p=_,a=a.next}var d=n.head.elt,c=l.add(o.geom.ZPP_SimpleEvent.get(p)),P=l.add(o.geom.ZPP_SimpleEvent.get(d));c.segment=o.geom.ZPP_SimpleEvent.less_xy(c,P)?function(t){return c.type=1,P.type=2,P.segment=o.geom.ZPP_SimpleSeg.get(p,d)}():function(t){return c.type=2,P.type=1,P.segment=o.geom.ZPP_SimpleSeg.get(d,p)}();var f=l;if(null!=f.head&&null!=f.head.next){var z,v,m,b=f.head,y=null,g=null,x=null,Z=null,w=1;do{for(z=0,g=b,y=b=null;null!=g;){for(z++,x=g,v=0,m=w;null!=x&&v<w;)v++,x=x.next;for(;v>0||m>0&&null!=x;)0==v?(Z=x,x=x.next,m--):0==m||null==x?(Z=g,g=g.next,v--):o.geom.ZPP_SimpleEvent.less_xy(g.elt,x.elt)?(Z=g,g=g.next,v--):(Z=x,x=x.next,m--),null!=y?y.next=Z:b=Z,y=Z;g=x}y.next=null,w<<=1}while(z>1);f.head=b,f.modified=!0,f.pushmod=!0}for(var C=!0;null!=l.head;){var E=l.pop_unsafe(),S=E.segment;if(1==E.type){if(o.geom.ZPP_Simple.sweep.add(S),o.geom.ZPP_Simple.sweep.intersect(S,S.next)||o.geom.ZPP_Simple.sweep.intersect(S,S.prev)){C=!1;break}}else if(2==E.type){if(o.geom.ZPP_Simple.sweep.intersect(S.prev,S.next)){C=!1;break}o.geom.ZPP_Simple.sweep.remove(S);var N=S;N.left=N.right=null,N.prev=null,N.node=null,N.vertices.clear(),N.next=o.geom.ZPP_SimpleSeg.zpp_pool,o.geom.ZPP_SimpleSeg.zpp_pool=N}var k=E;k.vertex=null,k.segment=k.segment2=null,k.node=null,k.next=o.geom.ZPP_SimpleEvent.zpp_pool,o.geom.ZPP_SimpleEvent.zpp_pool=k}for(;null!=l.head;){var M=l.pop_unsafe();if(2==M.type){var I=M.segment;I.left=I.right=null,I.prev=null,I.node=null,I.vertices.clear(),I.next=o.geom.ZPP_SimpleSeg.zpp_pool,o.geom.ZPP_SimpleSeg.zpp_pool=I}var F=M;F.vertex=null,F.segment=F.segment2=null,F.node=null,F.next=o.geom.ZPP_SimpleEvent.zpp_pool,o.geom.ZPP_SimpleEvent.zpp_pool=F}for(o.geom.ZPP_Simple.sweep.clear();null!=n.head;){var A=n.pop_unsafe();A.links.clear(),A.node=null,A.forced=!1,A.next=o.geom.ZPP_SimpleVert.zpp_pool,o.geom.ZPP_SimpleVert.zpp_pool=A}return C},o.geom.ZPP_SimplifyV=function(){this.forced=!1,this.flag=!1,this.prev=null,this.next=null,this.y=0,this.x=0},o.geom.ZPP_SimplifyV.__name__=!0,o.geom.ZPP_SimplifyV.get=function(t){var n;return null==o.geom.ZPP_SimplifyV.zpp_pool?n=new o.geom.ZPP_SimplifyV:(n=o.geom.ZPP_SimplifyV.zpp_pool,o.geom.ZPP_SimplifyV.zpp_pool=n.next,n.next=null),n.x=t.x,n.y=t.y,n.flag=!1,n},o.geom.ZPP_SimplifyV.prototype={free:function(){},alloc:function(){},__class__:o.geom.ZPP_SimplifyV},o.geom.ZPP_SimplifyP=function(){this.max=null,this.min=null,this.next=null},o.geom.ZPP_SimplifyP.__name__=!0,o.geom.ZPP_SimplifyP.get=function(t,n){var e;return null==o.geom.ZPP_SimplifyP.zpp_pool?e=new o.geom.ZPP_SimplifyP:(e=o.geom.ZPP_SimplifyP.zpp_pool,o.geom.ZPP_SimplifyP.zpp_pool=e.next,e.next=null),e.min=t,e.max=n,e},o.geom.ZPP_SimplifyP.prototype={free:function(){this.min=this.max=null},alloc:function(){},__class__:o.geom.ZPP_SimplifyP},o.geom.ZPP_Simplify=function(){},o.geom.ZPP_Simplify.__name__=!0,o.geom.ZPP_Simplify.lessval=function(t,n){return t.x-n.x+(t.y-n.y)},o.geom.ZPP_Simplify.less=function(t,n){return t.x-n.x+(t.y-n.y)<0},o.geom.ZPP_Simplify.distance=function(t,n,e){var i=0,r=0;i=e.x-n.x,r=e.y-n.y;var s=0,l=0;if(s=t.x-n.x,l=t.y-n.y,0==i*i+r*r)return s*s+l*l;var a=(s*i+l*r)/(i*i+r*r);if(a<=0)return s*s+l*l;if(a>=1)return o.geom.ZPP_VecMath.vec_dsq(t.x,t.y,e.x,e.y);var p=a;return s-=i*p,l-=r*p,s*s+l*l},o.geom.ZPP_Simplify.simplify=function(t,n){var e=null,i=null,r=null;n*=n,null==o.geom.ZPP_Simplify.stack&&(o.geom.ZPP_Simplify.stack=new o.util.ZNPList_ZPP_SimplifyP);var s=null,l=null,a=t;do{var p=o.geom.ZPP_SimplifyV.get(a);p.forced=a.forced,p.forced&&(p.flag=!0,null!=s?o.geom.ZPP_Simplify.stack.add(o.geom.ZPP_SimplifyP.get(s,p)):l=p,s=p);var _=p;null==e?e=_.prev=_.next=_:(_.prev=e,_.next=e.next,e.next.prev=_,e.next=_),e=_,null==i?(i=e,r=e):(e.x-i.x+(e.y-i.y)<0&&(i=e),r.x-e.x+(r.y-e.y)<0&&(r=e)),a=a.next}while(a!=t);if(null==o.geom.ZPP_Simplify.stack.head)if(null==l)i.flag=r.flag=!0,o.geom.ZPP_Simplify.stack.add(o.geom.ZPP_SimplifyP.get(i,r)),o.geom.ZPP_Simplify.stack.add(o.geom.ZPP_SimplifyP.get(r,i));else{var h=i.x-l.x+(i.y-l.y);h<0&&(h=-h);var u=r.x-l.x+(r.y-l.y);u<0&&(u=-u),h>u?(i.flag=l.flag=!0,o.geom.ZPP_Simplify.stack.add(o.geom.ZPP_SimplifyP.get(i,l)),o.geom.ZPP_Simplify.stack.add(o.geom.ZPP_SimplifyP.get(l,i))):(r.flag=l.flag=!0,o.geom.ZPP_Simplify.stack.add(o.geom.ZPP_SimplifyP.get(r,l)),o.geom.ZPP_Simplify.stack.add(o.geom.ZPP_SimplifyP.get(l,r)))}else o.geom.ZPP_Simplify.stack.add(o.geom.ZPP_SimplifyP.get(s,l));for(;null!=o.geom.ZPP_Simplify.stack.head;){var d=o.geom.ZPP_Simplify.stack.pop_unsafe(),c=d.min,P=d.max,f=d;f.min=f.max=null,f.next=o.geom.ZPP_SimplifyP.zpp_pool,o.geom.ZPP_SimplifyP.zpp_pool=f;for(var z=n,v=null,m=c.next;m!=P;){var b=o.geom.ZPP_Simplify.distance(m,c,P);b>z&&(z=b,v=m),m=m.next}null!=v&&(v.flag=!0,o.geom.ZPP_Simplify.stack.add(o.geom.ZPP_SimplifyP.get(c,v)),o.geom.ZPP_Simplify.stack.add(o.geom.ZPP_SimplifyP.get(v,P)))}for(var y=null;null!=e;){if(e.flag){var g=o.geom.ZPP_GeomVert.get(e.x,e.y);null==y?y=g.prev=g.next=g:(g.prev=y,g.next=y.next,y.next.prev=g,y.next=g),y=g,y.forced=e.forced}if(null!=e&&e.prev==e){e.next=e.prev=null;var x=e;x.next=o.geom.ZPP_SimplifyV.zpp_pool,o.geom.ZPP_SimplifyV.zpp_pool=x,e=e=null}else{var Z=e.next;e.prev.next=e.next,e.next.prev=e.prev,e.next=e.prev=null;var w=e;w.next=o.geom.ZPP_SimplifyV.zpp_pool,o.geom.ZPP_SimplifyV.zpp_pool=w,e=null,e=Z}}return y},o.geom.ZPP_ToiEvent=function(){this.kinematic=!1,this.failed=!1,this.slipped=!1,this.axis=null,this.c2=null,this.c1=null,this.frozen2=!1,this.frozen1=!1,this.arbiter=null,this.s2=null,this.s1=null,this.toi=0,this.next=null,this.c1=new o.geom.ZPP_Vec2,this.c2=new o.geom.ZPP_Vec2,this.axis=new o.geom.ZPP_Vec2},o.geom.ZPP_ToiEvent.__name__=!0,o.geom.ZPP_ToiEvent.prototype={alloc:function(){this.failed=!1,this.s1=this.s2=null,this.arbiter=null},free:function(){},__class__:o.geom.ZPP_ToiEvent},o.geom.ZPP_SweepDistance=function(){},o.geom.ZPP_SweepDistance.__name__=!0,o.geom.ZPP_SweepDistance.dynamicSweep=function(t,n,e,i,r){null==r&&(r=!1);var s=t.s1,l=t.s2,a=s.body,_=l.body,h=0,u=0;h=_.velx-a.velx,u=_.vely-a.vely;var d=a.angvel;d<0&&(d=-d);var c=_.angvel;c<0&&(c=-c);var P=s.sweepCoef*d+l.sweepCoef*c;if(!r&&!t.kinematic&&h*h+u*u<p.Config.dynamicSweepLinearThreshold*p.Config.dynamicSweepLinearThreshold&&P<p.Config.dynamicSweepAngularThreshold)return t.toi=-1,void(t.failed=!0);for(var f=t.c1,z=t.c2,v=t.axis,m=e,b=0;;){a.sweepIntegrate(m*n),a.sweepValidate(s),_.sweepIntegrate(m*n),_.sweepValidate(l);var y=o.geom.ZPP_SweepDistance.distance(s,l,f,z,v,null)+i,g=h*v.x+u*v.y;if(y<p.Config.distanceThresholdCCD){if(r)break;var x=0,Z=0;x=f.x-a.posx,Z=f.y-a.posy;var w=0,C=0;w=z.x-_.posx,C=z.y-_.posy;var E=g-a.sweep_angvel*(v.y*x-v.x*Z)+_.sweep_angvel*(v.y*w-v.x*C);if(E>0&&(t.slipped=!0),E<=0||y<.5*p.Config.distanceThresholdCCD)break}var S=(P-g)*n;if(S<=0){m=-1;break}var N=y/S;if(N<1e-6&&(N=1e-6),(m+=N)>=1){m=1,a.sweepIntegrate(m*n),a.sweepValidate(s),_.sweepIntegrate(m*n),_.sweepValidate(l);var k=o.geom.ZPP_SweepDistance.distance(s,l,f,z,v,null)+i,M=h*v.x+u*v.y;if(k<p.Config.distanceThresholdCCD){if(r)break;var I=0,F=0;I=f.x-a.posx,F=f.y-a.posy;var A=0,T=0;A=z.x-_.posx,T=z.y-_.posy;var V=M-a.sweep_angvel*(v.y*I-v.x*F)+_.sweep_angvel*(v.y*A-v.x*T);if(V>0&&(t.slipped=!0),V<=0||k<.5*p.Config.distanceThresholdCCD)break}m=-1;break}if(++b>=40){y>i&&(t.failed=!0);break}}t.toi=m},o.geom.ZPP_SweepDistance.staticSweep=function(t,n,e,i){var r=t.s1,s=t.s2,l=r.body,a=(s.body,0),_=0;a=-l.velx,_=-l.vely;var h=l.sweep_angvel;h<0&&(h=-h);for(var u=r.sweepCoef*h,d=t.c1,c=t.c2,P=t.axis,f=e,z=0;;){l.sweepIntegrate(f*n),l.sweepValidate(r);var v=o.geom.ZPP_SweepDistance.distance(r,s,d,c,P,null)+i,m=a*P.x+_*P.y;if(v<p.Config.distanceThresholdCCD){var b=0,y=0;b=d.x-l.posx,y=d.y-l.posy;var g=m-l.sweep_angvel*(P.y*b-P.x*y);if(g>0&&(t.slipped=!0),g<=0||v<.5*p.Config.distanceThresholdCCD)break}var x=(u-m)*n;if(x<=0){f=-1;break}var Z=v/x;if(Z<1e-6&&(Z=1e-6),(f+=Z)>=1){f=1,l.sweepIntegrate(f*n),l.sweepValidate(r);var w=o.geom.ZPP_SweepDistance.distance(r,s,d,c,P,null)+i,C=a*P.x+_*P.y;if(w<p.Config.distanceThresholdCCD){var E=0,S=0;E=d.x-l.posx,S=d.y-l.posy;var N=C-l.sweep_angvel*(P.y*E-P.x*S);if(N>0&&(t.slipped=!0),N<=0||w<.5*p.Config.distanceThresholdCCD)break}f=-1;break}if(++z>=40){v>i&&(t.failed=!0);break}}t.toi=f},o.geom.ZPP_SweepDistance.distanceBody=function(t,n,e,i){var r;null==o.geom.ZPP_Vec2.zpp_pool?r=new o.geom.ZPP_Vec2:(r=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=r.next,r.next=null),r.weak=!1;var s;null==o.geom.ZPP_Vec2.zpp_pool?s=new o.geom.ZPP_Vec2:(s=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=s.next,s.next=null),s.weak=!1;var l;null==o.geom.ZPP_Vec2.zpp_pool?l=new o.geom.ZPP_Vec2:(l=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=l.next,l.next=null),l.weak=!1;for(var a=1e100,p=t.shapes.head;null!=p;){for(var _=p.elt,h=n.shapes.head;null!=h;){var u=h.elt,d=o.geom.ZPP_SweepDistance.distance(_,u,r,s,l,a);d<a&&(a=d,e.x=r.x,e.y=r.y,i.x=s.x,i.y=s.y),h=h.next}p=p.next}var c=r;null!=c.outer&&(c.outer.zpp_inner=null,c.outer=null),c._isimmutable=null,c._validate=null,c._invalidate=null,c.next=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=c;var P=s;null!=P.outer&&(P.outer.zpp_inner=null,P.outer=null),P._isimmutable=null,P._validate=null,P._invalidate=null,P.next=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=P;var f=l;return null!=f.outer&&(f.outer.zpp_inner=null,f.outer=null),f._isimmutable=null,f._validate=null,f._invalidate=null,f.next=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=f,a},o.geom.ZPP_SweepDistance.distance=function(t,n,e,i,r,s){if(null==s&&(s=1e100),t.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE&&n.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE){var l,a=t.circle,_=n.circle,h=0,u=0;h=_.worldCOMx-a.worldCOMx,u=_.worldCOMy-a.worldCOMy;var d=Math.sqrt(h*h+u*u);if((l=d-(a.radius+_.radius))<s){if(0==d)h=1,u=0;else{var c=1/d;h*=c,u*=c}var P=a.radius;e.x=a.worldCOMx+h*P,e.y=a.worldCOMy+u*P;var f=-_.radius;i.x=_.worldCOMx+h*f,i.y=_.worldCOMy+u*f,r.x=h,r.y=u}return l}var z=!1;if(t.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE&&n.type==o.util.ZPP_Flags.id_ShapeType_POLYGON){var v=t;t=n,n=v;var m=e;e=i,i=m,z=!0}if(t.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&n.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE){for(var b=t.polygon,y=n.circle,g=-1e100,x=null,Z=b.edges.head;null!=Z;){var w=Z.elt,C=w.gnormx*y.worldCOMx+w.gnormy*y.worldCOMy-w.gprojection-y.radius;if(C>s){g=C;break}C>0?C>g&&(g=C,x=w):g<0&&C>g&&(g=C,x=w),Z=Z.next}if(g<s){var E=x.gp0,S=x.gp1,N=y.worldCOMy*x.gnormx-y.worldCOMx*x.gnormy;if(N<=E.y*x.gnormx-E.x*x.gnormy){var k=0,M=0;k=y.worldCOMx-E.x,M=y.worldCOMy-E.y;var I=Math.sqrt(k*k+M*M);if((g=I-y.radius)<s){if(0==I)k=1,M=0;else{var F=1/I;k*=F,M*=F}e.x=E.x+0*k,e.y=E.y+0*M;var A=-y.radius;i.x=y.worldCOMx+k*A,i.y=y.worldCOMy+M*A,r.x=k,r.y=M}}else if(N>=S.y*x.gnormx-S.x*x.gnormy){var T=0,V=0;T=y.worldCOMx-S.x,V=y.worldCOMy-S.y;var L=Math.sqrt(T*T+V*V);if((g=L-y.radius)<s){if(0==L)T=1,V=0;else{var B=1/L;T*=B,V*=B}e.x=S.x+0*T,e.y=S.y+0*V;var O=-y.radius;i.x=y.worldCOMx+T*O,i.y=y.worldCOMy+V*O,r.x=T,r.y=V}}else{var G=-y.radius;i.x=y.worldCOMx+x.gnormx*G,i.y=y.worldCOMy+x.gnormy*G;var R=-g;e.x=i.x+x.gnormx*R,e.y=i.y+x.gnormy*R,r.x=x.gnormx,r.y=x.gnormy}}return z&&(r.x=-r.x,r.y=-r.y),g}for(var D=t.polygon,j=n.polygon,q=-1e100,Y=null,U=null,W=0,J=D.edges.head;null!=J;){for(var K=J.elt,H=1e100,X=j.gverts.next;null!=X;){var Q=X,$=K.gnormx*Q.x+K.gnormy*Q.y;$<H&&(H=$),X=X.next}if((H-=K.gprojection)>s){q=H;break}H>0?H>q&&(q=H,Y=K,W=1):q<0&&H>q&&(q=H,Y=K,W=1),J=J.next}if(q<s){for(var tt=j.edges.head;null!=tt;){for(var nt=tt.elt,et=1e100,it=D.gverts.next;null!=it;){var rt=it,st=nt.gnormx*rt.x+nt.gnormy*rt.y;st<et&&(et=st),it=it.next}if((et-=nt.gprojection)>s){q=et;break}et>0?et>q&&(q=et,U=nt,W=2):q<0&&et>q&&(q=et,U=nt,W=2),tt=tt.next}if(q<s){var lt,at;if(1==W)D,lt=j,at=Y;else{j,lt=D,at=U;var pt=e;e=i,i=pt,z=!z}for(var ot=null,_t=1e100,ht=lt.edges.head;null!=ht;){var ut=ht.elt,dt=at.gnormx*ut.gnormx+at.gnormy*ut.gnormy;dt<_t&&(_t=dt,ot=ut),ht=ht.next}if(z?(r.x=-at.gnormx,r.y=-at.gnormy):(r.x=at.gnormx,r.y=at.gnormy),q>=0){var ct=at.gp0,Pt=at.gp1,ft=ot.gp0,zt=ot.gp1,vt=0,mt=0,bt=0,yt=0;vt=Pt.x-ct.x,mt=Pt.y-ct.y,bt=zt.x-ft.x,yt=zt.y-ft.y;var gt=1/(vt*vt+mt*mt),xt=1/(bt*bt+yt*yt),Zt=-(vt*(ct.x-ft.x)+mt*(ct.y-ft.y))*gt,wt=-(vt*(ct.x-zt.x)+mt*(ct.y-zt.y))*gt,Ct=-(bt*(ft.x-ct.x)+yt*(ft.y-ct.y))*xt,Et=-(bt*(ft.x-Pt.x)+yt*(ft.y-Pt.y))*xt;Zt<0?Zt=0:Zt>1&&(Zt=1),wt<0?wt=0:wt>1&&(wt=1),Ct<0?Ct=0:Ct>1&&(Ct=1),Et<0?Et=0:Et>1&&(Et=1);var St=0,Nt=0,kt=Zt;St=ct.x+vt*kt,Nt=ct.y+mt*kt;var Mt=0,It=0,Ft=wt;Mt=ct.x+vt*Ft,It=ct.y+mt*Ft;var At=0,Tt=0,Vt=Ct;At=ft.x+bt*Vt,Tt=ft.y+yt*Vt;var Lt=0,Bt=0,Ot=Et;Lt=ft.x+bt*Ot,Bt=ft.y+yt*Ot;var Gt=o.geom.ZPP_VecMath.vec_dsq(St,Nt,ft.x,ft.y),Rt=o.geom.ZPP_VecMath.vec_dsq(Mt,It,zt.x,zt.y),Dt=o.geom.ZPP_VecMath.vec_dsq(At,Tt,ct.x,ct.y),jt=o.geom.ZPP_VecMath.vec_dsq(Lt,Bt,Pt.x,Pt.y),qt=0,Yt=0,Ut=null;Gt<Rt?(qt=St,Yt=Nt,Ut=ft):(qt=Mt,Yt=It,Ut=zt,Gt=Rt);var Wt=0,Jt=0,Kt=null;if(Dt<jt?(Wt=At,Jt=Tt,Kt=ct):(Wt=Lt,Jt=Bt,Kt=Pt,Dt=jt),Gt<Dt?(e.x=qt,e.y=Yt,i.x=Ut.x,i.y=Ut.y,q=Math.sqrt(Gt)):(i.x=Wt,i.y=Jt,e.x=Kt.x,e.y=Kt.y,q=Math.sqrt(Dt)),0!=q){r.x=i.x-e.x,r.y=i.y-e.y;var Ht=1/q;r.x*=Ht,r.y*=Ht,z&&(r.x=-r.x,r.y=-r.y)}return q}var Xt=0,Qt=0;Xt=ot.gp0.x,Qt=ot.gp0.y;var $t=0,tn=0;$t=ot.gp1.x,tn=ot.gp1.y;var nn=0,en=0;nn=$t-Xt,en=tn-Qt;var rn=at.gnormy*Xt-at.gnormx*Qt,sn=at.gnormy*$t-at.gnormx*tn,ln=1/(sn-rn),an=(-at.tp1-rn)*ln;if(an>p.Config.epsilon){var pn=an;Xt+=nn*pn,Qt+=en*pn}var on=(-at.tp0-sn)*ln;if(on<-p.Config.epsilon){var _n=on;$t+=nn*_n,tn+=en*_n}var hn=Xt*at.gnormx+Qt*at.gnormy-at.gprojection,un=$t*at.gnormx+tn*at.gnormy-at.gprojection;if(hn<un){i.x=Xt,i.y=Qt;var dn=-hn;return e.x=i.x+at.gnormx*dn,e.y=i.y+at.gnormy*dn,hn}i.x=$t,i.y=tn;var cn=-un;return e.x=i.x+at.gnormx*cn,e.y=i.y+at.gnormy*cn,un}return s}return s},o.geom.ZPP_PartitionPair=function(){this.node=null,this.di=0,this.id=0,this.b=null,this.a=null,this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null},o.geom.ZPP_PartitionPair.__name__=!0,o.geom.ZPP_PartitionPair.get=function(t,n){var e;return null==o.geom.ZPP_PartitionPair.zpp_pool?e=new o.geom.ZPP_PartitionPair:(e=o.geom.ZPP_PartitionPair.zpp_pool,o.geom.ZPP_PartitionPair.zpp_pool=e.next,e.next=null),e.a=t,e.b=n,t.id<n.id?(e.id=t.id,e.di=n.id):(e.id=n.id,e.di=t.id),e},o.geom.ZPP_PartitionPair.edge_swap=function(t,n){var e=t.node;t.node=n.node,n.node=e},o.geom.ZPP_PartitionPair.edge_lt=function(t,n){return t.id<n.id||t.id==n.id&&t.di<n.di},o.geom.ZPP_PartitionPair.prototype={elem:function(){return this},begin:function(){return this.next},setbegin:function(t){this.next=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n;return t._inuse=!0,n=t,n.next=this.next,this.next=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.next;null!=n;){var e=n;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e;return n._inuse=!0,e=n,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.next;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.next,i=!1;null!=e;){if(e==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.next,i=!1;null!=e;){if(e==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;return null==t?(n=this.next,e=n.next,this.next=e,
null==this.next&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0)),n._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){},inlined_clear:function(){},reverse:function(){for(var t=this.next,n=null;null!=t;){var e=t.next;t.next=n,this.next=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.next},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.next;null!=e;){if(e==t){n=!0;break}e=e.next}return n},front:function(){return this.next},back:function(){for(var t=this.next,n=t;null!=n;)t=n,n=n.next;return t},iterator_at:function(t){for(var n=this.next;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n:null},free:function(){this.a=this.b=null,this.node=null},alloc:function(){},__class__:o.geom.ZPP_PartitionPair},o.geom.ZPP_Triangular=function(){},o.geom.ZPP_Triangular.__name__=!0,o.geom.ZPP_Triangular.lt=function(t,n){return t.y<n.y||t.y==n.y&&t.x<n.x},o.geom.ZPP_Triangular.right_turn=function(t,n,e){var i=0,r=0;i=e.x-n.x,r=e.y-n.y;var s=0;return s=n.x-t.x,(n.y-t.y)*i-s*r},o.geom.ZPP_Triangular.delaunay=function(t,n,e,i){var r=0,s=0,l=0,a=0;return!!(function(i){return r=e.x-n.x,s=e.y-n.y,l=n.x-t.x,a=n.y-t.y,a*r-l*s>=0}()||function(t){return r=i.x-e.x,s=i.y-e.y,l=e.x-n.x,a=e.y-n.y,a*r-l*s>=0}()||function(n){return r=t.x-i.x,s=t.y-i.y,l=i.x-e.x,a=i.y-e.y,a*r-l*s>=0}()||function(e){return r=n.x-t.x,s=n.y-t.y,l=t.x-i.x,a=t.y-i.y,a*r-l*s>=0}())||n.x*(e.y*i.mag-e.mag*i.y)-e.x*(n.y*i.mag-n.mag*i.y)+i.x*(n.y*e.mag-n.mag*e.y)-(t.x*(e.y*i.mag-e.mag*i.y)-e.x*(t.y*i.mag-t.mag*i.y)+i.x*(t.y*e.mag-t.mag*e.y))+(t.x*(n.y*i.mag-n.mag*i.y)-n.x*(t.y*i.mag-t.mag*i.y)+i.x*(t.y*n.mag-t.mag*n.y))-(t.x*(n.y*e.mag-n.mag*e.y)-n.x*(t.y*e.mag-t.mag*e.y)+e.x*(t.y*n.mag-t.mag*n.y))>0},o.geom.ZPP_Triangular.optimise=function(t){var n=t.vertices,e=t.vertices;if(null!=n){var i=n;do{var r=i;r.sort(),r.mag=r.x*r.x+r.y*r.y,i=i.next}while(i!=e)}null==o.geom.ZPP_Triangular.edgeSet&&(null==o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool?o.geom.ZPP_Triangular.edgeSet=new o.util.ZPP_Set_ZPP_PartitionPair:(o.geom.ZPP_Triangular.edgeSet=o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool,o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool=o.geom.ZPP_Triangular.edgeSet.next,o.geom.ZPP_Triangular.edgeSet.next=null),o.geom.ZPP_Triangular.edgeSet.lt=o.geom.ZPP_PartitionPair.edge_lt,o.geom.ZPP_Triangular.edgeSet.swapped=o.geom.ZPP_PartitionPair.edge_swap);var s;null==o.geom.ZPP_PartitionPair.zpp_pool?s=new o.geom.ZPP_PartitionPair:(s=o.geom.ZPP_PartitionPair.zpp_pool,o.geom.ZPP_PartitionPair.zpp_pool=s.next,s.next=null);var l=t.vertices,a=t.vertices;if(null!=l){var p=l;do{var _=p,h=_.next;_.diagonals.reverse();for(var u=_.diagonals.head;null!=u;){var d=u.elt;if(d.id<_.id)h=d,u=u.next;else{var c;if(c=null==u.next?_.prev:u.next.elt,!o.geom.ZPP_Triangular.delaunay(_,h,d,c)){var P=o.geom.ZPP_PartitionPair.get(_,d);s.add(P),P.node=o.geom.ZPP_Triangular.edgeSet.insert(P)}h=d,u=u.next}}p=p.next}while(p!=a)}for(;null!=s.next;){for(var f=s.pop_unsafe(),z=f.a,v=f.b,m=z.next,b=null,y=z.diagonals.head;null!=y;){var g=y.elt;if(g==v){y=y.next,b=null==y?z.prev:y.elt;break}m=g,y=y.next}if(z.diagonals.remove(v),v.diagonals.remove(z),v==m.next)m.diagonals.add(b);else for(var x=m.diagonals.head;null!=x;){var Z=x.elt;if(Z==v){m.diagonals.insert(x,b);break}x=x.next}if(z==b.next)b.diagonals.add(m);else for(var w=b.diagonals.head;null!=w;){var C=w.elt;if(C==z){b.diagonals.insert(w,m);break}w=w.next}o.geom.ZPP_Triangular.edgeSet.remove_node(f.node);var E=f;E.a=E.b=null,E.node=null,E.next=o.geom.ZPP_PartitionPair.zpp_pool,o.geom.ZPP_PartitionPair.zpp_pool=E}var S=s;S.a=S.b=null,S.node=null,S.next=o.geom.ZPP_PartitionPair.zpp_pool,o.geom.ZPP_PartitionPair.zpp_pool=S},o.geom.ZPP_Triangular.triangulate=function(t){var n=t.vertices,e=t.vertices,i=t.vertices.next,r=t.vertices;if(null!=i){var s=i;do{var l=s;(l.y<n.y||l.y==n.y&&l.x<n.x)&&(n=l),(e.y<l.y||e.y==l.y&&e.x<l.x)&&(e=l),s=s.next}while(s!=r)}null==o.geom.ZPP_Triangular.queue&&(o.geom.ZPP_Triangular.queue=new o.util.ZNPList_ZPP_PartitionVertex);var a=e.prev,p=e.next;for(o.geom.ZPP_Triangular.queue.add(e);a!=n||p!=n;)a==n||p!=n&&(a.y<p.y||a.y==p.y&&a.x<p.x)?(o.geom.ZPP_Triangular.queue.add(p),p.rightchain=!1,p=p.next):(o.geom.ZPP_Triangular.queue.add(a),a.rightchain=!0,a=a.prev);o.geom.ZPP_Triangular.queue.add(n),null==o.geom.ZPP_Triangular.stack&&(o.geom.ZPP_Triangular.stack=new o.util.ZNPList_ZPP_PartitionVertex),o.geom.ZPP_Triangular.stack.add(o.geom.ZPP_Triangular.queue.pop_unsafe());var _=o.geom.ZPP_Triangular.queue.pop_unsafe();for(o.geom.ZPP_Triangular.stack.add(_);;){var h=o.geom.ZPP_Triangular.queue.pop_unsafe();if(null==o.geom.ZPP_Triangular.queue.head)break;if(h.rightchain!=o.geom.ZPP_Triangular.stack.head.elt.rightchain){for(;;){var u=o.geom.ZPP_Triangular.stack.pop_unsafe();if(null==o.geom.ZPP_Triangular.stack.head)break;t.add_diagonal(u,h)}o.geom.ZPP_Triangular.stack.add(_)}else{for(var d=o.geom.ZPP_Triangular.stack.pop_unsafe();null!=o.geom.ZPP_Triangular.stack.head;){var c=o.geom.ZPP_Triangular.stack.head.elt,P=o.geom.ZPP_Triangular.right_turn(c,d,h);if(h.rightchain&&P>=0||!h.rightchain&&P<=0)break;t.add_diagonal(c,h),d=c,o.geom.ZPP_Triangular.stack.pop()}o.geom.ZPP_Triangular.stack.add(d)}o.geom.ZPP_Triangular.stack.add(h),_=h}if(null!=o.geom.ZPP_Triangular.stack.head)for(o.geom.ZPP_Triangular.stack.pop();null!=o.geom.ZPP_Triangular.stack.head;){var f=o.geom.ZPP_Triangular.stack.pop_unsafe();if(null==o.geom.ZPP_Triangular.stack.head)break;t.add_diagonal(e,f)}return t},o.geom.ZPP_Vec2=function(){this.y=0,this.x=0,this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.weak=!1,this.outer=null,this._isimmutable=null,this._immutable=!1,this._validate=null,this._invalidate=null},o.geom.ZPP_Vec2.__name__=!0,o.geom.ZPP_Vec2.get=function(t,n,e){null==e&&(e=!1);var i;return null==o.geom.ZPP_Vec2.zpp_pool?i=new o.geom.ZPP_Vec2:(i=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=i.next,i.next=null),i.weak=!1,i._immutable=e,i.x=t,i.y=n,i},o.geom.ZPP_Vec2.prototype={validate:function(){null!=this._validate&&this._validate()},invalidate:function(){null!=this._invalidate&&this._invalidate(this)},immutable:function(){if(this._immutable)throw"Error: Vec2 is immutable";null!=this._isimmutable&&this._isimmutable()},wrapper:function(){if(null==this.outer){this.outer=new p.geom.Vec2;var t=this.outer.zpp_inner;null!=t.outer&&(t.outer.zpp_inner=null,t.outer=null),t._isimmutable=null,t._validate=null,t._invalidate=null,t.next=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=t,this.outer.zpp_inner=this}return this.outer},free:function(){null!=this.outer&&(this.outer.zpp_inner=null,this.outer=null),this._isimmutable=null,this._validate=null,this._invalidate=null},alloc:function(){this.weak=!1},elem:function(){return this},begin:function(){return this.next},setbegin:function(t){this.next=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n;return t._inuse=!0,n=t,n.next=this.next,this.next=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.next;null!=n;){var e=n;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e;return n._inuse=!0,e=n,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.next;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.next,i=!1;null!=e;){if(e==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.next,i=!1;null!=e;){if(e==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;return null==t?(n=this.next,e=n.next,this.next=e,null==this.next&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0)),n._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){},inlined_clear:function(){},reverse:function(){for(var t=this.next,n=null;null!=t;){var e=t.next;t.next=n,this.next=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.next},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.next;null!=e;){if(e==t){n=!0;break}e=e.next}return n},front:function(){return this.next},back:function(){for(var t=this.next,n=t;null!=n;)t=n,n=n.next;return t},iterator_at:function(t){for(var n=this.next;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n:null},copy:function(){return o.geom.ZPP_Vec2.get(this.x,this.y,null)},toString:function(){return"{ x: "+this.x+" y: "+this.y+" }"},__class__:o.geom.ZPP_Vec2},o.geom.ZPP_Vec3=function(){this._validate=null,this.immutable=!1,this.z=0,this.y=0,this.x=0,this.outer=null,this.immutable=!1,this._validate=null},o.geom.ZPP_Vec3.__name__=!0,o.geom.ZPP_Vec3.prototype={validate:function(){null!=this._validate&&this._validate()},__class__:o.geom.ZPP_Vec3},o.geom.ZPP_VecMath=function(){},o.geom.ZPP_VecMath.__name__=!0,o.geom.ZPP_VecMath.vec_dsq=function(t,n,e,i){var r=0,s=0;return r=t-e,s=n-i,r*r+s*s},o.geom.ZPP_VecMath.vec_distance=function(t,n,e,i){var r=0,s=0;return r=t-e,s=n-i,Math.sqrt(r*r+s*s)},o.phys={},o.phys.ZPP_Interactor=function(){this.wrap_cbTypes=null,this.cbSet=null,this.cbTypes=null,this.group=null,this.cbsets=null,this.icompound=null,this.ibody=null,this.ishape=null,this.userData=null,this.id=0,this.outer_i=null,this.id=o.ZPP_ID.Interactor(),this.cbsets=new o.util.ZNPList_ZPP_CallbackSet,this.cbTypes=new o.util.ZNPList_ZPP_CbType},o.phys.ZPP_Interactor.__name__=!0,o.phys.ZPP_Interactor.get=function(t,n){var e;e=t.id<n.id?t.id:n.id;var i;i=t.id<n.id?n.id:t.id;var r;r=t.cbsets.length<n.cbsets.length?t.cbsets:n.cbsets;for(var s=null,l=r.head;null!=l;){var a=l.elt;if(a.id==e&&a.di==i){s=a;break}l=l.next}return s},o.phys.ZPP_Interactor.int_callback=function(t,n,e){var i=t.int1,r=t.int2;n.options1.compatible(i.cbTypes)&&n.options2.compatible(r.cbTypes)?(e.int1=i,e.int2=r):(e.int1=r,e.int2=i)},o.phys.ZPP_Interactor.prototype={isShape:function(){return null!=this.ishape},isBody:function(){return null!=this.ibody},isCompound:function(){return null!=this.icompound},__iaddedToSpace:function(){null!=this.group&&this.group.interactors.add(this);for(var t=this.cbTypes.head;null!=t;){t.elt.interactors.add(this),t=t.next}this.alloc_cbSet()},__iremovedFromSpace:function(){null!=this.group&&this.group.interactors.remove(this);for(var t=this.cbTypes.head;null!=t;){t.elt.interactors.remove(this),t=t.next}this.dealloc_cbSet()},wake:function(){if(null!=this.ishape){var t=this.ishape.body;null!=t&&null!=t.space&&t.space.non_inlined_wake(t)}else null!=this.ibody?null!=this.ibody.space&&this.ibody.space.non_inlined_wake(this.ibody):null!=this.icompound.space&&this.icompound.space.wakeCompound(this.icompound)},getSpace:function(){return null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space},setupcbTypes:function(){this.wrap_cbTypes=o.util.ZPP_CbTypeList.get(this.cbTypes),this.wrap_cbTypes.zpp_inner.adder=n(this,this.wrap_cbTypes_adder),this.wrap_cbTypes.zpp_inner.subber=n(this,this.wrap_cbTypes_subber),this.wrap_cbTypes.zpp_inner.dontremove=!0,this.wrap_cbTypes.zpp_inner._modifiable=n(this,this.immutable_cbTypes)},immutable_cbTypes:function(){this.immutable_midstep("Interactor::cbTypes")},wrap_cbTypes_subber:function(t){var n=t.zpp_inner;if(this.cbTypes.has(n)){var e;e=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space,null!=e&&(this.dealloc_cbSet(),n.interactors.remove(this)),this.cbTypes.remove(n),null!=e&&(this.alloc_cbSet(),this.wake())}},wrap_cbTypes_adder:function(t){return this.insert_cbtype(t.zpp_inner),!1},insert_cbtype:function(t){if(!this.cbTypes.has(t)){var n;n=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space,null!=n&&(this.dealloc_cbSet(),t.interactors.add(this));for(var e=null,i=this.cbTypes.head;null!=i;){var r=i.elt;if(t.id<r.id)break;e=i,i=i.next}this.cbTypes.inlined_insert(e,t),null!=n&&(this.alloc_cbSet(),this.wake())}},alloc_cbSet:function(){var t;t=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space,null!=(this.cbSet=t.cbsets.get(this.cbTypes))&&(this.cbSet.count++,this.cbSet.interactors.add(this),this.cbSet.validate(),t.freshInteractorType(this))},dealloc_cbSet:function(){var t;if(t=null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space,null!=this.cbSet){if(this.cbSet.interactors.remove(this),t.nullInteractorType(this),0==--this.cbSet.count){t.cbsets.remove(this.cbSet);var n=this.cbSet;n.free(),n.next=o.callbacks.ZPP_CbSet.zpp_pool,o.callbacks.ZPP_CbSet.zpp_pool=n}this.cbSet=null}},setGroup:function(t){if(this.group!=t){var n;n=null!=(null!=this.ishape?null==this.ishape.body?null:this.ishape.body.space:null!=this.ibody?this.ibody.space:this.icompound.space),n&&null!=this.group&&this.group.interactors.remove(this),this.group=t,n&&null!=t&&t.interactors.add(this),n&&(null!=this.ishape?this.ishape.body.wake():null!=this.ibody?this.ibody.wake():this.icompound.wake())}},immutable_midstep:function(t){null!=this.ibody?this.ibody.__immutable_midstep(t):null!=this.ishape?this.ishape.__immutable_midstep(t):this.icompound.__imutable_midstep(t)},lookup_group:function(){for(var t=this;null!=t&&null==t.group;)t=null!=t.ishape?t.ishape.body:null!=t.icompound?t.icompound.compound:t.ibody.compound;return null==t?null:t.group},copyto:function(t){t.zpp_inner_i.group=this.group;for(var n=this.outer_i.get_cbTypes().iterator();n.hasNext();){var e;n.zpp_critical=!1,e=n.zpp_inner.at(n.zpp_i++),function(n){return null==t.zpp_inner_i.wrap_cbTypes&&t.zpp_inner_i.setupcbTypes(),t.zpp_inner_i.wrap_cbTypes}().add(e)}null!=this.userData&&(t.zpp_inner_i.userData=i.copy(this.userData))},__class__:o.phys.ZPP_Interactor},o.phys.ZPP_Body=function(){this.wrap_worldCOM=null,this.wrap_localCOM=null,this.zip_worldCOM=!1,this.worldCOMy=0,this.worldCOMx=0,this.zip_localCOM=!1,this.localCOMy=0,this.localCOMx=0,this.zip_aabb=!1,this.aabb=null,this.norotate=!1,this.sinertia=0,this.iinertia=0,this.cinertia=0,this.zip_inertia=!1,this.inertia=0,this.inertiaMode=0,this.zip_gravMassScale=!1,this.gravMassScale=0,this.gravMassMode=0,this.zip_gravMass=!1,this.gravMass=0,this.nomove=!1,this.cmass=0,this.smass=0,this.imass=0,this.massMode=0,this.zip_mass=!1,this.mass=0,this.zip_axis=!1,this.axisy=0,this.axisx=0,this.rot=0,this.pre_rot=0,this.kinangvel=0,this.torque=0,this.angvel=0,this.wrapcvel=null,this.wrap_svel=null,this.svely=0,this.svelx=0,this.wrap_kinvel=null,this.kinvely=0,this.kinvelx=0,this.wrap_force=null,this.forcey=0,this.forcex=0,this.wrap_vel=null,this.vely=0,this.velx=0,this.wrap_pos=null,this.posy=0,this.posx=0,this.pre_posy=0,this.pre_posx=0,this.disableCCD=!1,this.bulletEnabled=!1,this.bullet=!1,this.sweepRadius=0,this.sweepFrozen=!1,this.sweep_angvel=0,this.sweepTime=0,this.graph_depth=0,this.component=null,this.wrap_constraints=null,this.constraints=null,this.wrap_arbiters=null,this.arbiters=null,this.space=null,this.wrap_shapes=null,this.shapes=null,this.compound=null,this.type=0,this.world=!1,this.outer=null,o.phys.ZPP_Interactor.call(this),this.ibody=this,this.world=!1,this.bulletEnabled=!1,this.sweepTime=0,this.sweep_angvel=0,this.norotate=this.nomove=!1,this.disableCCD=!1,this.posx=0,this.posy=0,this.rot=0,this.axisx=0,this.axisy=1,this.svelx=0,this.svely=0,this.velx=0,this.vely=0,this.kinvelx=0,this.kinvely=0,this.forcex=0,this.forcey=0,this.torque=this.angvel=this.kinangvel=0,this.pre_posx=Math.POSITIVE_INFINITY,this.pre_posy=Math.POSITIVE_INFINITY,this.pre_rot=Math.POSITIVE_INFINITY,this.localCOMx=0,this.localCOMy=0,this.worldCOMx=0,this.worldCOMy=0,this.zip_aabb=!0,this.aabb=o.geom.ZPP_AABB.get(0,0,0,0),this.aabb._immutable=!0;this.aabb._validate=n(this,this.aabb_validate),this.massMode=o.util.ZPP_Flags.id_MassMode_DEFAULT,this.gravMassMode=o.util.ZPP_Flags.id_GravMassMode_DEFAULT,this.gravMassScale=1,this.inertiaMode=o.util.ZPP_Flags.id_InertiaMode_DEFAULT,this.arbiters=new o.util.ZNPList_ZPP_Arbiter,this.constraints=new o.util.ZNPList_ZPP_Constraint,this.shapes=new o.util.ZNPList_ZPP_Shape,this.wrap_shapes=o.util.ZPP_ShapeList.get(this.shapes),this.wrap_shapes.zpp_inner.adder=n(this,this.shapes_adder),this.wrap_shapes.zpp_inner.subber=n(this,this.shapes_subber),this.wrap_shapes.zpp_inner._invalidate=n(this,this.shapes_invalidate),this.wrap_shapes.zpp_inner._modifiable=n(this,this.shapes_modifiable),this.kinematicDelaySleep=!1},o.phys.ZPP_Body.__name__=!0,o.phys.ZPP_Body.bodysetlt=function(t,n){return t.id<n.id},o.phys.ZPP_Body.__static=function(){var t=new p.phys.Body(function(t){return null==o.util.ZPP_Flags.BodyType_STATIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_STATIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_STATIC}()),n=t.zpp_inner;return n.world=!0,n.wrap_shapes.zpp_inner.immutable=!0,n.smass=n.imass=n.cmass=n.mass=n.gravMass=0,n.sinertia=n.iinertia=n.cinertia=n.inertia=0,n.cbTypes.clear(),t},o.phys.ZPP_Body.__super__=o.phys.ZPP_Interactor,o.phys.ZPP_Body.prototype=t(o.phys.ZPP_Interactor.prototype,{isStatic:function(){return this.type==o.util.ZPP_Flags.id_BodyType_STATIC},isDynamic:function(){return this.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC},isKinematic:function(){return this.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC},invalidate_type:function(){this.invalidate_mass(),this.invalidate_inertia()},invalidate_shapes:function(){this.zip_aabb=!0,this.zip_localCOM=!0,this.zip_worldCOM=!0,this.invalidate_mass(),this.invalidate_inertia()},init_bodysetlist:function(){null==o.phys.ZPP_Body.bodyset&&(o.phys.ZPP_Body.bodyset=new o.util.ZPP_Set_ZPP_Body,o.phys.ZPP_Body.bodyset.lt=o.phys.ZPP_Body.bodysetlt,o.phys.ZPP_Body.bodystack=new o.util.ZNPList_ZPP_Body)},connectedBodies_cont:function(t){t!=t.zpp_inner.space.__static&&o.phys.ZPP_Body.bodyset.try_insert_bool(t.zpp_inner)&&(o.phys.ZPP_Body.bodystack.add(t.zpp_inner),t.zpp_inner.graph_depth=o.phys.ZPP_Body.cur_graph_depth+1)},connectedBodies:function(t,e){var i=this;null==o.phys.ZPP_Body.bodyset&&(o.phys.ZPP_Body.bodyset=new o.util.ZPP_Set_ZPP_Body,o.phys.ZPP_Body.bodyset.lt=o.phys.ZPP_Body.bodysetlt,o.phys.ZPP_Body.bodystack=new o.util.ZNPList_ZPP_Body);var r;for(r=null==e?new p.phys.BodyList:e,o.phys.ZPP_Body.bodystack.add(this),o.phys.ZPP_Body.bodyset.insert(this),this.graph_depth=0;null!=o.phys.ZPP_Body.bodystack.head;){var s=o.phys.ZPP_Body.bodystack.pop_unsafe();if(s.graph_depth!=t){o.phys.ZPP_Body.cur_graph_depth=s.graph_depth;for(var l=s.constraints.head;null!=l;){l.elt.outer.visitBodies(n(this,this.connectedBodies_cont)),l=l.next}}}return o.phys.ZPP_Body.bodyset.clear_with(function(t){t!=i&&r.add(t.outer)}),r},interactingBodies:function(t,n,e){var i=this;null==o.phys.ZPP_Body.bodyset&&(o.phys.ZPP_Body.bodyset=new o.util.ZPP_Set_ZPP_Body,o.phys.ZPP_Body.bodyset.lt=o.phys.ZPP_Body.bodysetlt,o.phys.ZPP_Body.bodystack=new o.util.ZNPList_ZPP_Body);var r;for(r=null==e?new p.phys.BodyList:e,o.phys.ZPP_Body.bodyset.insert(this),o.phys.ZPP_Body.bodystack.add(this),this.graph_depth=0;null!=o.phys.ZPP_Body.bodystack.head;){var s=o.phys.ZPP_Body.bodystack.pop_unsafe();if(s.graph_depth!=n)for(var l=s.arbiters.head;null!=l;){var a=l.elt;if(0!=(a.type&t)){var _;_=a.b1==s?a.b2:a.b1,o.phys.ZPP_Body.bodyset.try_insert_bool(_)&&(o.phys.ZPP_Body.bodystack.add(_),_.graph_depth=s.graph_depth+1)}l=l.next}}return o.phys.ZPP_Body.bodyset.clear_with(function(t){t!=i&&r.add(t.outer)}),r},atRest:function(t){if(this.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC)return this.component.sleeping;var n=p.Config.linearSleepThreshold;n*=n;var e;if(this.velx*this.velx+this.vely*this.vely>n)e=!1;else if(o.geom.ZPP_VecMath.vec_dsq(this.posx,this.posy,this.pre_posx,this.pre_posy)>.25*n*t*t)e=!1;else{var i=0,r=0;i=this.aabb.maxx-this.aabb.minx,r=this.aabb.maxy-this.aabb.miny;var s=i*i+r*r,l=p.Config.angularSleepThreshold;if(l*=l,4*this.angvel*this.angvel*s>l)e=!1;else{var a=this.rot-this.pre_rot;e=!(a*a*s>l*t*t)}}return e||(this.component.waket=this.space.stamp),this.component.waket+p.Config.sleepDelay<this.space.stamp},refreshArbiters:function(){for(var t=this.arbiters.head;null!=t;){t.elt.invalidated=!0,t=t.next}},sweepIntegrate:function(t){var n=t-this.sweepTime;if(0!=n){this.sweepTime=t;var e=n;this.posx+=this.velx*e,this.posy+=this.vely*e,0!=this.angvel&&this.delta_rot(this.sweep_angvel*n)}},sweepValidate:function(t){if(t.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE)t.worldCOMx=this.posx+(this.axisy*t.localCOMx-this.axisx*t.localCOMy),t.worldCOMy=this.posy+(t.localCOMx*this.axisx+t.localCOMy*this.axisy);else{for(var n=t.polygon,e=n.lverts.next,i=n.gverts.next;null!=i;){var r=i,s=e;e=e.next,r.x=this.posx+(this.axisy*s.x-this.axisx*s.y),r.y=this.posy+(s.x*this.axisx+s.y*this.axisy),i=i.next}var l=n.edges.head,a=n.gverts.next,p=a;for(a=a.next;null!=a;){var _=a,h=l.elt;l=l.next,h.gnormx=this.axisy*h.lnormx-this.axisx*h.lnormy,h.gnormy=h.lnormx*this.axisx+h.lnormy*this.axisy,h.gprojection=this.posx*h.gnormx+this.posy*h.gnormy+h.lprojection,h.tp0=p.y*h.gnormx-p.x*h.gnormy,h.tp1=_.y*h.gnormx-_.x*h.gnormy,p=_,a=a.next}var u=n.gverts.next,d=l.elt;l=l.next,d.gnormx=this.axisy*d.lnormx-this.axisx*d.lnormy,d.gnormy=d.lnormx*this.axisx+d.lnormy*this.axisy,d.gprojection=this.posx*d.gnormx+this.posy*d.gnormy+d.lprojection,d.tp0=p.y*d.gnormx-p.x*d.gnormy,d.tp1=u.y*d.gnormx-u.x*d.gnormy}},invalidate_pos:function(){for(var t=this.shapes.head;null!=t;){var n=t.elt;n.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&(n.polygon.invalidate_gverts(),n.polygon.invalidate_gaxi()),n.invalidate_worldCOM(),t=t.next}this.zip_worldCOM=!0},pos_invalidate:function(t){if(this.immutable_midstep("Body::position"),this.type==o.util.ZPP_Flags.id_BodyType_STATIC&&null!=this.space)throw"Error: Cannot move a static object once inside a Space";this.posx==t.x&&this.posy==t.y||(this.posx=t.x,this.posy=t.y,this.invalidate_pos(),this.wake())},pos_validate:function(){this.wrap_pos.zpp_inner.x=this.posx,this.wrap_pos.zpp_inner.y=this.posy},vel_invalidate:function(t){if(this.type==o.util.ZPP_Flags.id_BodyType_STATIC)throw"Error: Static body cannot have its velocity set.";this.velx=t.x,this.vely=t.y,this.wake()},vel_validate:function(){this.wrap_vel.zpp_inner.x=this.velx,this.wrap_vel.zpp_inner.y=this.vely},kinvel_invalidate:function(t){this.kinvelx=t.x,this.kinvely=t.y,this.wake()},kinvel_validate:function(){this.wrap_kinvel.zpp_inner.x=this.kinvelx,this.wrap_kinvel.zpp_inner.y=this.kinvely},svel_invalidate:function(t){this.svelx=t.x,this.svely=t.y,this.wake()},svel_validate:function(){this.wrap_svel.zpp_inner.x=this.svelx,this.wrap_svel.zpp_inner.y=this.svely},force_invalidate:function(t){if(this.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC)throw"Error: Non-dynamic body cannot have force applied.";this.forcex=t.x,this.forcey=t.y,this.wake()},force_validate:function(){this.wrap_force.zpp_inner.x=this.forcex,this.wrap_force.zpp_inner.y=this.forcey},setupPosition:function(){this.wrap_pos=p.geom.Vec2.get(this.posx,this.posy,null),this.wrap_pos.zpp_inner._inuse=!0,this.world?this.wrap_pos.zpp_inner._immutable=!0:(this.wrap_pos.zpp_inner._invalidate=n(this,this.pos_invalidate),this.wrap_pos.zpp_inner._validate=n(this,this.pos_validate))},setupVelocity:function(){this.wrap_vel=p.geom.Vec2.get(this.velx,this.vely,null),this.wrap_vel.zpp_inner._inuse=!0,this.world?this.wrap_vel.zpp_inner._immutable=!0:(this.wrap_vel.zpp_inner._invalidate=n(this,this.vel_invalidate),this.wrap_vel.zpp_inner._validate=n(this,this.vel_validate))},setupkinvel:function(){this.wrap_kinvel=p.geom.Vec2.get(this.kinvelx,this.kinvely,null),this.wrap_kinvel.zpp_inner._inuse=!0,this.world?this.wrap_kinvel.zpp_inner._immutable=!0:(this.wrap_kinvel.zpp_inner._invalidate=n(this,this.kinvel_invalidate),this.wrap_kinvel.zpp_inner._validate=n(this,this.kinvel_validate))},setupsvel:function(){this.wrap_svel=p.geom.Vec2.get(this.svelx,this.svely,null),this.wrap_svel.zpp_inner._inuse=!0,this.world?this.wrap_svel.zpp_inner._immutable=!0:(this.wrap_svel.zpp_inner._invalidate=n(this,this.svel_invalidate),this.wrap_svel.zpp_inner._validate=n(this,this.svel_validate))},setupForce:function(){this.wrap_force=p.geom.Vec2.get(this.forcex,this.forcey,null),this.wrap_force.zpp_inner._inuse=!0,this.world?this.wrap_force.zpp_inner._immutable=!0:(this.wrap_force.zpp_inner._invalidate=n(this,this.force_invalidate),this.wrap_force.zpp_inner._validate=n(this,this.force_validate))},cvel_validate:function(){this.wrapcvel.zpp_inner.x=this.velx+this.kinvelx,this.wrapcvel.zpp_inner.y=this.vely+this.kinvely,this.wrapcvel.zpp_inner.z=this.angvel+this.kinangvel},setup_cvel:function(){this.wrapcvel=p.geom.Vec3.get(),this.wrapcvel.zpp_inner.immutable=!0,this.wrapcvel.zpp_inner._validate=n(this,this.cvel_validate)},invalidate_rot:function(){this.zip_axis=!0;for(var t=this.shapes.head;null!=t;){var n=t.elt;n.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&(n.polygon.invalidate_gverts(),n.polygon.invalidate_gaxi()),n.invalidate_worldCOM(),t=t.next}this.zip_worldCOM=!0},validate_axis:function(){this.zip_axis&&(this.zip_axis=!1,this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot))},quick_validate_axis:function(){this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot)},delta_rot:function(t){if(this.rot+=t,t*t>1e-4)this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot);else{var n=t*t,e=1-.5*n,i=1-n*n/8,r=(e*this.axisx+t*this.axisy)*i;this.axisy=(e*this.axisy-t*this.axisx)*i,this.axisx=r}},invalidate_mass:function(){this.zip_mass=!0,this.invalidate_gravMass()},validate_mass:function(){if(this.zip_mass||(this.massMode,o.util.ZPP_Flags.id_MassMode_DEFAULT,!1)){if(this.zip_mass=!1,this.massMode==o.util.ZPP_Flags.id_MassMode_DEFAULT){this.cmass=0;for(var t=this.shapes.head;null!=t;){var n=t.elt;n.refmaterial.density=n.material.density,n.validate_area_inertia(),this.cmass+=n.area*n.material.density,t=t.next}}this.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC||this.nomove?(this.mass=Math.POSITIVE_INFINITY,this.imass=this.smass=0):(this.mass=this.cmass,this.imass=this.smass=1/this.mass)}},invalidate_gravMass:function(){this.gravMassMode!=o.util.ZPP_Flags.id_GravMassMode_FIXED&&(this.zip_gravMass=!0),this.gravMassMode!=o.util.ZPP_Flags.id_GravMassMode_SCALED&&(this.zip_gravMassScale=!0),this.wake()},validate_gravMass:function(){this.zip_gravMass&&(this.zip_gravMass=!1,this.validate_mass(),this.gravMassMode==o.util.ZPP_Flags.id_GravMassMode_DEFAULT?(this.validate_mass(),this.gravMass=this.cmass):this.gravMassMode==o.util.ZPP_Flags.id_GravMassMode_SCALED&&(this.validate_mass(),this.gravMass=this.cmass*this.gravMassScale))},invalidate_gravMassScale:function(){this.gravMassMode!=o.util.ZPP_Flags.id_GravMassMode_SCALED?this.zip_gravMassScale=!0:this.invalidate_gravMass()},validate_gravMassScale:function(){this.zip_gravMassScale&&(this.zip_gravMassScale=!1,this.gravMassMode==o.util.ZPP_Flags.id_GravMassMode_DEFAULT?this.gravMassScale=1:this.gravMassMode==o.util.ZPP_Flags.id_GravMassMode_FIXED&&(this.validate_mass(),this.gravMassScale=this.gravMass/this.cmass))},invalidate_inertia:function(){this.zip_inertia=!0,this.wake()},validate_inertia:function(){if(this.zip_inertia||(this.inertiaMode,o.util.ZPP_Flags.id_InertiaMode_DEFAULT,!1)){if(this.zip_inertia=!1,this.inertiaMode==o.util.ZPP_Flags.id_InertiaMode_DEFAULT){this.cinertia=0;for(var t=this.shapes.head;null!=t;){var n=t.elt;n.refmaterial.density=n.material.density,n.validate_area_inertia(),this.cinertia+=n.inertia*n.area*n.material.density,t=t.next}}this.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC||this.norotate?(this.inertia=Math.POSITIVE_INFINITY,this.sinertia=this.iinertia=0):(this.inertia=this.cinertia,this.sinertia=this.iinertia=1/this.inertia)}},invalidate_wake:function(){this.wake()},validate_aabb:function(){if(null==this.shapes.head)throw"Error: Body bounds only makes sense if it contains shapes";if(this.zip_aabb){this.zip_aabb=!1,this.aabb.minx=Math.POSITIVE_INFINITY,this.aabb.miny=Math.POSITIVE_INFINITY,this.aabb.maxx=Math.NEGATIVE_INFINITY,this.aabb.maxy=Math.NEGATIVE_INFINITY;for(var t=this.shapes.head;null!=t;){var n=t.elt;n.zip_aabb&&null!=n.body&&(n.zip_aabb=!1,n.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?n.circle.__validate_aabb():n.polygon.__validate_aabb()),this.aabb.combine(n.aabb),t=t.next}}},invalidate_aabb:function(){this.zip_aabb=!0},invalidate_localCOM:function(){this.zip_localCOM=!0,this.zip_worldCOM=!0},invalidate_worldCOM:function(){this.zip_worldCOM=!0},validate_localCOM:function(){if(this.zip_localCOM){this.zip_localCOM=!1;for(var t=0,n=0,e=0,i=this.shapes.head;null!=i;){var r=i.elt;r.zip_localCOM&&(r.zip_localCOM=!1,r.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&r.polygon.__validate_localCOM(),null!=r.wrap_localCOM&&(r.wrap_localCOM.zpp_inner.x=r.localCOMx,r.wrap_localCOM.zpp_inner.y=r.localCOMy)),r.validate_area_inertia();var s=r.area*r.material.density;t+=r.localCOMx*s,n+=r.localCOMy*s,e+=r.area*r.material.density,i=i.next}if(0!=e){var l=1/e;this.localCOMx=t*l,this.localCOMy=n*l}null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy),this.zip_mass&&this.massMode==o.util.ZPP_Flags.id_MassMode_DEFAULT&&(this.zip_mass=!1,this.cmass=e,this.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC?(this.mass=this.cmass,this.imass=this.smass=1/this.mass):(this.mass=Math.POSITIVE_INFINITY,this.imass=this.smass=0))}},validate_worldCOM:function(){this.zip_worldCOM&&(this.zip_worldCOM=!1,this.validate_localCOM(),this.zip_axis&&(this.zip_axis=!1,this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot)),this.worldCOMx=this.posx+(this.axisy*this.localCOMx-this.axisx*this.localCOMy),this.worldCOMy=this.posy+(this.localCOMx*this.axisx+this.localCOMy*this.axisy),null!=this.wrap_worldCOM&&(this.wrap_worldCOM.zpp_inner.x=this.worldCOMx,this.wrap_worldCOM.zpp_inner.y=this.worldCOMy))},getlocalCOM:function(){if(null==this.shapes.head)throw"Error: localCOM only makes sense when Body has Shapes";this.validate_localCOM()},getworldCOM:function(){if(null==this.shapes.head)throw"Error: worldCOM only makes sense when Body has Shapes";this.validate_worldCOM()},__immutable_midstep:function(t){if(null!=this.space&&this.space.midstep)throw"Error: "+t+" cannot be set during a space step()"},clear:function(){if(null!=this.space)throw"Error: Cannot clear a Body if it is currently being used by a Space!";if(null!=this.constraints.head)throw"Error: Cannot clear a Body if it is currently being used by a constraint!";for(;null!=this.shapes.head;){var t=this.shapes.pop_unsafe();t.removedFromBody(),t.body=null}this.invalidate_shapes(),this.pre_posx=0,this.pre_posy=0,this.posx=0,this.posy=0,this.velx=0,this.vely=0,this.forcex=0,this.forcey=0,this.kinvelx=0,this.kinvely=0,this.svelx=0,this.svely=0,this.angvel=this.torque=this.kinangvel=this.pre_rot=this.rot=0,this.invalidate_pos(),this.invalidate_rot(),this.axisx=0,this.axisy=1,this.zip_axis=!1,this.massMode=o.util.ZPP_Flags.id_MassMode_DEFAULT,this.gravMassMode=o.util.ZPP_Flags.id_GravMassMode_DEFAULT,this.gravMassScale=1,
this.inertiaMode=o.util.ZPP_Flags.id_InertiaMode_DEFAULT,this.norotate=!1,this.nomove=!1},aabb_validate:function(){if(null==this.shapes.head)throw"Error: bounds only makes sense when Body has shapes";this.validate_aabb()},shapes_adder:function(t){return t.zpp_inner.body!=this&&(null!=t.zpp_inner.body&&t.zpp_inner.body.wrap_shapes.remove(t),t.zpp_inner.body=this,t.zpp_inner.addedToBody(),null!=this.space&&this.space.added_shape(t.zpp_inner,null),t.zpp_inner.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&(t.zpp_inner.polygon.invalidate_gaxi(),t.zpp_inner.polygon.invalidate_gverts()),!0)},shapes_subber:function(t){null!=this.space&&this.space.removed_shape(t.zpp_inner),t.zpp_inner.body=null,t.zpp_inner.removedFromBody()},shapes_invalidate:function(t){this.invalidate_shapes()},shapes_modifiable:function(){if(this.immutable_midstep("Body::shapes"),this.type==o.util.ZPP_Flags.id_BodyType_STATIC&&null!=this.space)throw"Error: Cannot modifiy shapes of static object once added to Space"},addedToSpace:function(){null==o.space.ZPP_Component.zpp_pool?this.component=new o.space.ZPP_Component:(this.component=o.space.ZPP_Component.zpp_pool,o.space.ZPP_Component.zpp_pool=this.component.next,this.component.next=null),this.component.isBody=!0,this.component.body=this,this.__iaddedToSpace()},removedFromSpace:function(){for(;null!=this.arbiters.head;){var t=this.arbiters.pop_unsafe();t.cleared=!0,t.b2==this&&t.b1.arbiters.inlined_try_remove(t),t.b1==this&&t.b2.arbiters.inlined_try_remove(t),null!=t.pair&&(t.pair.arb=null,t.pair=null),t.active=!1,this.space.f_arbiters.modified=!0}var n=this.component;n.body=null,n.constraint=null,n.next=o.space.ZPP_Component.zpp_pool,o.space.ZPP_Component.zpp_pool=n,this.component=null,this.__iremovedFromSpace()},copy:function(){var t=(new p.phys.Body).zpp_inner;t.type=this.type,t.bulletEnabled=this.bulletEnabled,t.disableCCD=this.disableCCD;for(var n=this.shapes.head;null!=n;){var e=n.elt;t.outer.zpp_inner.wrap_shapes.add(e.outer.copy()),n=n.next}return t.posx=this.posx,t.posy=this.posy,t.velx=this.velx,t.vely=this.vely,t.forcex=this.forcex,t.forcey=this.forcey,t.rot=this.rot,t.angvel=this.angvel,t.torque=this.torque,t.kinvelx=this.kinvelx,t.kinvely=this.kinvely,t.kinangvel=this.kinangvel,t.svelx=this.svelx,t.svely=this.svely,this.zip_axis?t.invalidate_rot():(t.axisx=this.axisx,t.axisy=this.axisy),t.rot=this.rot,t.massMode=this.massMode,t.gravMassMode=this.gravMassMode,t.inertiaMode=this.inertiaMode,t.norotate=this.norotate,t.nomove=this.nomove,t.cmass=this.cmass,t.cinertia=this.cinertia,this.zip_mass?t.invalidate_mass():t.mass=this.mass,this.zip_gravMass?t.invalidate_gravMass():t.gravMass=this.gravMass,this.zip_gravMassScale?t.invalidate_gravMassScale():t.gravMassScale=this.gravMassScale,this.zip_inertia?t.invalidate_inertia():t.inertia=this.inertia,this.zip_aabb?t.zip_aabb=!0:(t.aabb.minx=this.aabb.minx,t.aabb.miny=this.aabb.miny,t.aabb.maxx=this.aabb.maxx,t.aabb.maxy=this.aabb.maxy),this.zip_localCOM?(t.zip_localCOM=!0,t.zip_worldCOM=!0):(t.localCOMx=this.localCOMx,t.localCOMy=this.localCOMy),this.zip_worldCOM?t.zip_worldCOM=!0:(t.worldCOMx=this.worldCOMx,t.worldCOMy=this.worldCOMy),this.copyto(t.outer),t.outer},__class__:o.phys.ZPP_Body}),o.phys.ZPP_Compound=function(){this.space=null,this.compound=null,this.depth=0,this.wrap_compounds=null,this.wrap_constraints=null,this.wrap_bodies=null,this.compounds=null,this.constraints=null,this.bodies=null,this.outer=null,o.phys.ZPP_Interactor.call(this),this.icompound=this,this.depth=1;this.bodies=new o.util.ZNPList_ZPP_Body,this.wrap_bodies=o.util.ZPP_BodyList.get(this.bodies),this.wrap_bodies.zpp_inner.adder=n(this,this.bodies_adder),this.wrap_bodies.zpp_inner.subber=n(this,this.bodies_subber),this.wrap_bodies.zpp_inner._modifiable=n(this,this.bodies_modifiable),this.constraints=new o.util.ZNPList_ZPP_Constraint,this.wrap_constraints=o.util.ZPP_ConstraintList.get(this.constraints),this.wrap_constraints.zpp_inner.adder=n(this,this.constraints_adder),this.wrap_constraints.zpp_inner.subber=n(this,this.constraints_subber),this.wrap_constraints.zpp_inner._modifiable=n(this,this.constraints_modifiable),this.compounds=new o.util.ZNPList_ZPP_Compound,this.wrap_compounds=o.util.ZPP_CompoundList.get(this.compounds),this.wrap_compounds.zpp_inner.adder=n(this,this.compounds_adder),this.wrap_compounds.zpp_inner.subber=n(this,this.compounds_subber),this.wrap_compounds.zpp_inner._modifiable=n(this,this.compounds_modifiable)},o.phys.ZPP_Compound.__name__=!0,o.phys.ZPP_Compound.__super__=o.phys.ZPP_Interactor,o.phys.ZPP_Compound.prototype=t(o.phys.ZPP_Interactor.prototype,{__imutable_midstep:function(t){if(null!=this.space&&this.space.midstep)throw"Error: "+t+" cannot be set during space step()"},addedToSpace:function(){this.__iaddedToSpace()},removedFromSpace:function(){this.__iremovedFromSpace()},breakApart:function(){for(null!=this.space&&(this.__iremovedFromSpace(),this.space.nullInteractorType(this)),null!=this.compound?this.compound.compounds.remove(this):null!=this.space&&this.space.compounds.remove(this);null!=this.bodies.head;){var t=this.bodies.pop_unsafe();null!=(t.compound=this.compound)?this.compound.bodies.add(t):null!=this.space&&this.space.bodies.add(t),null!=this.space&&this.space.freshInteractorType(t)}for(;null!=this.constraints.head;){var n=this.constraints.pop_unsafe();null!=(n.compound=this.compound)?this.compound.constraints.add(n):null!=this.space&&this.space.constraints.add(n)}for(;null!=this.compounds.head;){var e=this.compounds.pop_unsafe();null!=(e.compound=this.compound)?this.compound.compounds.add(e):null!=this.space&&this.space.compounds.add(e),null!=this.space&&this.space.freshInteractorType(e)}this.compound=null,this.space=null},bodies_adder:function(t){return t.zpp_inner.compound!=this&&(null!=t.zpp_inner.compound?t.zpp_inner.compound.wrap_bodies.remove(t):null!=t.zpp_inner.space&&t.zpp_inner.space.wrap_bodies.remove(t),t.zpp_inner.compound=this,null!=this.space&&this.space.addBody(t.zpp_inner),!0)},bodies_subber:function(t){t.zpp_inner.compound=null,null!=this.space&&this.space.remBody(t.zpp_inner)},bodies_modifiable:function(){this.immutable_midstep("Compound::bodies")},constraints_adder:function(t){return t.zpp_inner.compound!=this&&(null!=t.zpp_inner.compound?t.zpp_inner.compound.wrap_constraints.remove(t):null!=t.zpp_inner.space&&t.zpp_inner.space.wrap_constraints.remove(t),t.zpp_inner.compound=this,null!=this.space&&this.space.addConstraint(t.zpp_inner),!0)},constraints_subber:function(t){t.zpp_inner.compound=null,null!=this.space&&this.space.remConstraint(t.zpp_inner)},constraints_modifiable:function(){this.immutable_midstep("Compound::constraints")},compounds_adder:function(t){for(var n=this;null!=n&&n!=t.zpp_inner;)n=n.compound;if(n==t.zpp_inner)throw"Error: Assignment would cause a cycle in the Compound tree: assigning "+t.toString()+".compound = "+this.outer.toString();return t.zpp_inner.compound!=this&&(null!=t.zpp_inner.compound?t.zpp_inner.compound.wrap_compounds.remove(t):null!=t.zpp_inner.space&&t.zpp_inner.space.wrap_compounds.remove(t),t.zpp_inner.compound=this,t.zpp_inner.depth=this.depth+1,null!=this.space&&this.space.addCompound(t.zpp_inner),!0)},compounds_subber:function(t){t.zpp_inner.compound=null,t.zpp_inner.depth=1,null!=this.space&&this.space.remCompound(t.zpp_inner)},compounds_modifiable:function(){this.immutable_midstep("Compound::compounds")},copy:function(t,n){var e=null==t;null==t&&(t=new Array),null==n&&(n=new Array);for(var i=new p.phys.Compound,r=this.compounds.head;null!=r;){var s=r.elt,l=s.copy(t,n);l.zpp_inner.immutable_midstep("Compound::compound"),(null==l.zpp_inner.compound?null:l.zpp_inner.compound.outer)!=i&&(null!=(null==l.zpp_inner.compound?null:l.zpp_inner.compound.outer)&&(null==l.zpp_inner.compound?null:l.zpp_inner.compound.outer).zpp_inner.wrap_compounds.remove(l),null!=i&&i.zpp_inner.wrap_compounds.add(l)),null==l.zpp_inner.compound||l.zpp_inner.compound.outer,r=r.next}for(var a=this.bodies.head;null!=a;){var _=a.elt,h=_.outer.copy();t.push(o.constraint.ZPP_CopyHelper.dict(_.id,h)),(null==h.zpp_inner.compound?null:h.zpp_inner.compound.outer)!=i&&(null!=(null==h.zpp_inner.compound?null:h.zpp_inner.compound.outer)&&(null==h.zpp_inner.compound?null:h.zpp_inner.compound.outer).zpp_inner.wrap_bodies.remove(h),null!=i&&i.zpp_inner.wrap_bodies.add(h)),null==h.zpp_inner.compound||h.zpp_inner.compound.outer,a=a.next}for(var u=this.constraints.head;null!=u;){var d=u.elt,c=d.copy(t,n);(null==c.zpp_inner.compound?null:c.zpp_inner.compound.outer)!=i&&(null!=(null==c.zpp_inner.compound?null:c.zpp_inner.compound.outer)&&(null==c.zpp_inner.compound?null:c.zpp_inner.compound.outer).zpp_inner.wrap_constraints.remove(c),null!=i&&i.zpp_inner.wrap_constraints.add(c)),null==c.zpp_inner.compound||c.zpp_inner.compound.outer,u=u.next}if(e)for(;n.length>0;)for(var P=n.pop(),f=0;f<t.length;){var z=t[f];if(++f,z.id==P.id){P.cb(z.bc);break}}return this.copyto(i),i},__class__:o.phys.ZPP_Compound}),o.phys.ZPP_FluidProperties=function(){this.wrap_gravity=null,this.gravityy=0,this.gravityx=0,this.density=0,this.viscosity=0,this.wrap_shapes=null,this.shapes=null,this.outer=null,this.userData=null,this.next=null,this.shapes=new o.util.ZNPList_ZPP_Shape,this.density=this.viscosity=1,this.wrap_gravity=null,this.gravityx=0,this.gravityy=0},o.phys.ZPP_FluidProperties.__name__=!0,o.phys.ZPP_FluidProperties.prototype={wrapper:function(){if(null==this.outer){this.outer=new p.phys.FluidProperties;var t=this.outer.zpp_inner;t.outer=null,t.next=o.phys.ZPP_FluidProperties.zpp_pool,o.phys.ZPP_FluidProperties.zpp_pool=t,this.outer.zpp_inner=this}return this.outer},free:function(){this.outer=null},alloc:function(){},feature_cons:function(){this.shapes=new o.util.ZNPList_ZPP_Shape},addShape:function(t){this.shapes.add(t)},remShape:function(t){this.shapes.remove(t)},copy:function(){var t;return null==o.phys.ZPP_FluidProperties.zpp_pool?t=new o.phys.ZPP_FluidProperties:(t=o.phys.ZPP_FluidProperties.zpp_pool,o.phys.ZPP_FluidProperties.zpp_pool=t.next,t.next=null),t.viscosity=this.viscosity,t.density=this.density,t},gravity_invalidate:function(t){this.gravityx=t.x,this.gravityy=t.y,this.invalidate()},gravity_validate:function(){this.wrap_gravity.zpp_inner.x=this.gravityx,this.wrap_gravity.zpp_inner.y=this.gravityy},getgravity:function(){this.wrap_gravity=p.geom.Vec2.get(this.gravityx,this.gravityy,null),this.wrap_gravity.zpp_inner._inuse=!0,this.wrap_gravity.zpp_inner._invalidate=n(this,this.gravity_invalidate),this.wrap_gravity.zpp_inner._validate=n(this,this.gravity_validate)},invalidate:function(){for(var t=this.shapes.head;null!=t;){t.elt.invalidate_fluidprops(),t=t.next}},__class__:o.phys.ZPP_FluidProperties},o.phys.ZPP_Material=function(){this.rollingFriction=0,this.elasticity=0,this.density=0,this.staticFriction=0,this.dynamicFriction=0,this.wrap_shapes=null,this.shapes=null,this.outer=null,this.userData=null,this.next=null,this.shapes=new o.util.ZNPList_ZPP_Shape,this.elasticity=0,this.dynamicFriction=1,this.staticFriction=2,this.density=.001,this.rollingFriction=.01},o.phys.ZPP_Material.__name__=!0,o.phys.ZPP_Material.prototype={wrapper:function(){if(null==this.outer){this.outer=new p.phys.Material;var t=this.outer.zpp_inner;t.outer=null,t.next=o.phys.ZPP_Material.zpp_pool,o.phys.ZPP_Material.zpp_pool=t,this.outer.zpp_inner=this}return this.outer},free:function(){this.outer=null},alloc:function(){},feature_cons:function(){this.shapes=new o.util.ZNPList_ZPP_Shape},addShape:function(t){this.shapes.add(t)},remShape:function(t){this.shapes.remove(t)},copy:function(){var t=new o.phys.ZPP_Material;return t.dynamicFriction=this.dynamicFriction,t.staticFriction=this.staticFriction,t.density=this.density,t.elasticity=this.elasticity,t.rollingFriction=this.rollingFriction,t},set:function(t){this.dynamicFriction=t.dynamicFriction,this.staticFriction=t.staticFriction,this.density=t.density,this.elasticity=t.elasticity,this.rollingFriction=t.rollingFriction},invalidate:function(t){for(var n=this.shapes.head;null!=n;){n.elt.invalidate_material(t),n=n.next}},__class__:o.phys.ZPP_Material},o.shape={},o.shape.ZPP_Shape=function(t){this.zip_aabb=!1,this.aabb=null,this.pairs=null,this.node=null,this.sweep=null,this.sensorEnabled=!1,this.fluidEnabled=!1,this.fluidProperties=null,this.filter=null,this.material=null,this.refmaterial=null,this.polygon=null,this.circle=null,this.sweepCoef=0,this.zip_sweepRadius=!1,this.sweepRadius=0,this.wrap_worldCOM=null,this.wrap_localCOM=null,this.zip_worldCOM=!1,this.worldCOMy=0,this.worldCOMx=0,this.zip_localCOM=!1,this.localCOMy=0,this.localCOMx=0,this.zip_angDrag=!1,this.angDrag=0,this.inertia=0,this.zip_area_inertia=!1,this.area=0,this.type=0,this.body=null,this.outer=null,o.phys.ZPP_Interactor.call(this),this.pairs=new o.util.ZNPList_ZPP_AABBPair,this.ishape=this,this.type=t,this.aabb=o.geom.ZPP_AABB.get(0,0,0,0),this.aabb._immutable=!0;this.aabb._validate=n(this,this.aabb_validate),this.zip_area_inertia=this.zip_angDrag=this.zip_localCOM=this.zip_sweepRadius=!0,this.localCOMx=0,this.localCOMy=0,this.worldCOMx=0,this.worldCOMy=0,this.fluidEnabled=!1,this.sensorEnabled=!1,this.fluidProperties=null,this.body=null,this.refmaterial=new o.phys.ZPP_Material,this.sweepRadius=this.sweepCoef=0},o.shape.ZPP_Shape.__name__=!0,o.shape.ZPP_Shape.__super__=o.phys.ZPP_Interactor,o.shape.ZPP_Shape.prototype=t(o.phys.ZPP_Interactor.prototype,{isCircle:function(){return this.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE},isPolygon:function(){return this.type==o.util.ZPP_Flags.id_ShapeType_POLYGON},invalidate_sweepRadius:function(){this.zip_sweepRadius=!0},validate_sweepRadius:function(){this.zip_sweepRadius&&(this.zip_sweepRadius=!1,this.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?this.circle.__validate_sweepRadius():this.polygon.__validate_sweepRadius())},clear:function(){this.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?this.circle.__clear():this.polygon.__clear()},validate_aabb:function(){this.zip_aabb&&null!=this.body&&(this.zip_aabb=!1,this.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?this.circle.__validate_aabb():this.polygon.__validate_aabb())},force_validate_aabb:function(){this.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?this.circle._force_validate_aabb():this.polygon._force_validate_aabb()},invalidate_aabb:function(){this.zip_aabb=!0,null!=this.body&&(this.body.zip_aabb=!0)},validate_area_inertia:function(){this.zip_area_inertia&&(this.zip_area_inertia=!1,this.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?this.circle.__validate_area_inertia():this.polygon.__validate_area_inertia())},validate_angDrag:function(){(this.zip_angDrag||this.refmaterial.dynamicFriction!=this.material.dynamicFriction)&&(this.zip_angDrag=!1,this.refmaterial.dynamicFriction=this.material.dynamicFriction,this.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?this.circle.__validate_angDrag():this.polygon.__validate_angDrag())},validate_localCOM:function(){this.zip_localCOM&&(this.zip_localCOM=!1,this.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy))},validate_worldCOM:function(){this.zip_worldCOM&&null!=this.body&&(this.zip_worldCOM=!1,this.zip_localCOM&&(this.zip_localCOM=!1,this.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)),this.body.validate_axis(),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy))},getworldCOM:function(){if(null==this.body)throw"Error: worldCOM only makes sense when Shape belongs to a Body";this.zip_worldCOM&&null!=this.body&&(this.zip_worldCOM=!1,this.zip_localCOM&&(this.zip_localCOM=!1,this.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)),this.body.validate_axis(),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy)),this.wrap_worldCOM.zpp_inner.x=this.worldCOMx,this.wrap_worldCOM.zpp_inner.y=this.worldCOMy},invalidate_area_inertia:function(){this.zip_area_inertia=!0,null!=this.body&&(this.body.invalidate_localCOM(),this.body.invalidate_mass(),this.body.invalidate_inertia())},invalidate_angDrag:function(){this.zip_angDrag=!0},invalidate_localCOM:function(){this.zip_localCOM=!0,this.invalidate_area_inertia(),this.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE&&(this.zip_sweepRadius=!0),this.invalidate_angDrag(),this.invalidate_worldCOM(),null!=this.body&&this.body.invalidate_localCOM()},invalidate_worldCOM:function(){this.zip_worldCOM=!0,this.zip_aabb=!0,null!=this.body&&(this.body.zip_aabb=!0)},invalidate_material:function(t){0!=(t&o.phys.ZPP_Material.WAKE)&&this.wake(),0!=(t&o.phys.ZPP_Material.ARBITERS)&&null!=this.body&&this.body.refreshArbiters(),0!=(t&o.phys.ZPP_Material.PROPS)&&null!=this.body&&(this.body.invalidate_localCOM(),this.body.invalidate_mass(),this.body.invalidate_inertia()),0!=(t&o.phys.ZPP_Material.ANGDRAG)&&this.invalidate_angDrag(),this.refmaterial.set(this.material)},invalidate_filter:function(){this.wake()},invalidate_fluidprops:function(){this.fluidEnabled&&this.wake()},aabb_validate:function(){if(null==this.body)throw"Error: bounds only makes sense when Shape belongs to a Body";this.zip_aabb&&null!=this.body&&(this.zip_aabb=!1,this.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?this.circle.__validate_aabb():this.polygon.__validate_aabb())},setMaterial:function(t){this.material!=t&&(null!=this.body&&null!=this.body.space&&null!=this.material&&this.material.shapes.remove(this),this.material=t,null!=this.body&&null!=this.body.space&&t.shapes.add(this),this.wake(),null!=this.body&&this.body.refreshArbiters())},setFilter:function(t){this.filter!=t&&(null!=this.body&&null!=this.body.space&&null!=this.filter&&this.filter.shapes.remove(this),this.filter=t,null!=this.body&&null!=this.body.space&&t.shapes.add(this),this.wake())},setFluid:function(t){this.fluidProperties!=t&&(null!=this.body&&null!=this.body.space&&null!=this.fluidProperties&&this.fluidProperties.shapes.remove(this),this.fluidProperties=t,null!=this.body&&null!=this.body.space&&t.shapes.add(this),this.fluidEnabled&&this.wake())},__immutable_midstep:function(t){if(null!=this.body&&null!=this.body.space&&this.body.space.midstep)throw"Error: "+t+" cannot be set during a space step()"},addedToBody:function(){this.invalidate_worldCOM(),this.zip_aabb=!0,null!=this.body&&(this.body.zip_aabb=!0)},removedFromBody:function(){},addedToSpace:function(){this.__iaddedToSpace(),this.material.shapes.add(this),this.filter.shapes.add(this),null!=this.fluidProperties&&this.fluidProperties.shapes.add(this)},removedFromSpace:function(){this.__iremovedFromSpace(),this.material.shapes.remove(this),this.filter.shapes.remove(this),null!=this.fluidProperties&&this.fluidProperties.shapes.remove(this)},copy:function(){var t=null;t=this.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?this.circle.__copy():this.polygon.__copy(),this.zip_area_inertia?t.invalidate_area_inertia():(t.area=this.area,t.inertia=this.inertia),this.zip_sweepRadius?t.zip_sweepRadius=!0:(t.sweepRadius=this.sweepRadius,t.sweepCoef=this.sweepCoef),this.zip_angDrag?t.invalidate_angDrag():t.angDrag=this.angDrag,this.zip_aabb?(t.zip_aabb=!0,null!=t.body&&(t.body.zip_aabb=!0)):(t.aabb.minx=this.aabb.minx,t.aabb.miny=this.aabb.miny,t.aabb.maxx=this.aabb.maxx,t.aabb.maxy=this.aabb.maxy);var n=t.material;n.outer=null,n.next=o.phys.ZPP_Material.zpp_pool,o.phys.ZPP_Material.zpp_pool=n;var e=t.filter;return e.outer=null,e.next=o.dynamics.ZPP_InteractionFilter.zpp_pool,o.dynamics.ZPP_InteractionFilter.zpp_pool=e,t.material=this.material,t.filter=this.filter,null!=this.fluidProperties&&(t.fluidProperties=this.fluidProperties),t.fluidEnabled=this.fluidEnabled,t.sensorEnabled=this.sensorEnabled,null!=this.userData&&(t.userData=i.copy(this.userData)),this.copyto(t.outer),t.outer},__class__:o.shape.ZPP_Shape}),o.shape.ZPP_Circle=function(){this.radius=0,this.outer_zn=null,o.shape.ZPP_Shape.call(this,o.util.ZPP_Flags.id_ShapeType_CIRCLE),this.circle=this,this.zip_localCOM=!1},o.shape.ZPP_Circle.__name__=!0,o.shape.ZPP_Circle.__super__=o.shape.ZPP_Shape,o.shape.ZPP_Circle.prototype=t(o.shape.ZPP_Shape.prototype,{__clear:function(){},invalidate_radius:function(){this.invalidate_area_inertia(),this.invalidate_angDrag(),this.zip_aabb=!0,null!=this.body&&(this.body.zip_aabb=!0),null!=this.body&&this.body.wake()},localCOM_validate:function(){this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy},localCOM_invalidate:function(t){this.localCOMx=t.x,this.localCOMy=t.y,this.invalidate_localCOM(),null!=this.body&&this.body.wake()},localCOM_immutable:function(){if(null!=this.body&&this.body.type==o.util.ZPP_Flags.id_BodyType_STATIC&&null!=this.body.space)throw"Error: Cannot modify localCOM of Circle added to a static Body whilst within a Space"},setupLocalCOM:function(){this.wrap_localCOM=p.geom.Vec2.get(this.localCOMx,this.localCOMy,null),this.wrap_localCOM.zpp_inner._inuse=!0,this.wrap_localCOM.zpp_inner._validate=n(this,this.localCOM_validate),this.wrap_localCOM.zpp_inner._invalidate=n(this,this.localCOM_invalidate),this.wrap_localCOM.zpp_inner._isimmutable=n(this,this.localCOM_immutable)},__validate_aabb:function(){this.zip_worldCOM&&null!=this.body&&(this.zip_worldCOM=!1,this.zip_localCOM&&(this.zip_localCOM=!1,this.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy)),this.body.validate_axis(),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy));var t=this.radius,n=this.radius;this.aabb.minx=this.worldCOMx-t,this.aabb.miny=this.worldCOMy-n,this.aabb.maxx=this.worldCOMx+t,this.aabb.maxy=this.worldCOMy+n},_force_validate_aabb:function(){this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy),this.aabb.minx=this.worldCOMx-this.radius,this.aabb.miny=this.worldCOMy-this.radius,this.aabb.maxx=this.worldCOMx+this.radius,this.aabb.maxy=this.worldCOMy+this.radius},__validate_sweepRadius:function(){this.sweepCoef=Math.sqrt(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy),this.sweepRadius=this.sweepCoef+this.radius},__validate_area_inertia:function(){var t=this.radius*this.radius;this.area=t*Math.PI,this.inertia=.5*t+(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy)},__validate_angDrag:function(){var t=this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy,n=this.radius*this.radius,e=this.material.dynamicFriction*p.Config.fluidAngularDragFriction;this.angDrag=(t+2*n)*e+.5*p.Config.fluidAngularDrag*(1+p.Config.fluidVacuumDrag)*t,this.angDrag/=2*(t+.5*n)},__scale:function(t,n){var e;e=((t<0?-t:t)+(n<0?-n:n))/2,this.radius*=e<0?-e:e,this.invalidate_radius(),this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy>0&&(this.localCOMx*=t,this.localCOMy*=n,this.invalidate_localCOM())},__translate:function(t,n){this.localCOMx+=1*t,this.localCOMy+=1*n,this.invalidate_localCOM()},__rotate:function(t,n){if(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy>0){var e=0,i=0;e=n*this.localCOMx-t*this.localCOMy,i=this.localCOMx*t+this.localCOMy*n,this.localCOMx=e,this.localCOMy=i,this.invalidate_localCOM()}},__transform:function(t){var n=t.zpp_inner.a*t.zpp_inner.d-t.zpp_inner.b*t.zpp_inner.c;n<0&&(n=-n),this.radius*=Math.sqrt(n);var e=t.zpp_inner.a*this.localCOMx+t.zpp_inner.b*this.localCOMy+t.zpp_inner.tx;this.localCOMy=t.zpp_inner.c*this.localCOMx+t.zpp_inner.d*this.localCOMy+t.zpp_inner.ty,this.localCOMx=e,this.invalidate_radius(),this.invalidate_localCOM()},__copy:function(){var t=new p.shape.Circle(this.radius).zpp_inner_zn;return t.localCOMx=this.localCOMx,t.localCOMy=this.localCOMy,t.zip_localCOM=!1,t},__class__:o.shape.ZPP_Circle}),o.shape.ZPP_Edge=function(){this.tp1=0,this.tp0=0,this.gp1=null,this.lp1=null,this.gp0=null,this.lp0=null,this.gprojection=0,this.lprojection=0,this.length=0,this.wrap_gnorm=null,this.gnormy=0,this.gnormx=0,this.wrap_lnorm=null,this.lnormy=0,this.lnormx=0,this.outer=null,this.polygon=null,this.next=null,this.lnormx=0,this.lnormy=0,this.gnormx=0,this.gnormy=0,this.length=0,this.lprojection=0,this.gprojection=0},o.shape.ZPP_Edge.__name__=!0,o.shape.ZPP_Edge.prototype={free:function(){this.polygon=null},alloc:function(){},wrapper:function(){return null==this.outer&&(o.shape.ZPP_Edge.internal=!0,this.outer=new p.shape.Edge,o.shape.ZPP_Edge.internal=!1,this.outer.zpp_inner=this),this.outer},lnorm_validate:function(){if(null==this.polygon)throw"Error: Edge not currently in use";this.polygon.validate_laxi(),this.wrap_lnorm.zpp_inner.x=this.lnormx,this.wrap_lnorm.zpp_inner.y=this.lnormy},gnorm_validate:function(){if(null==this.polygon)throw"Error: Edge not currently in use";if(null==this.polygon.body)throw"Error: Edge worldNormal only makes sense if the parent Polygon is contained within a rigid body";this.polygon.validate_gaxi(),this.wrap_gnorm.zpp_inner.x=this.gnormx,this.wrap_gnorm.zpp_inner.y=this.gnormy},getlnorm:function(){this.wrap_lnorm=p.geom.Vec2.get(this.lnormx,this.lnormy,null),this.wrap_lnorm.zpp_inner._immutable=!0,this.wrap_lnorm.zpp_inner._validate=n(this,this.lnorm_validate)},getgnorm:function(){this.wrap_gnorm=p.geom.Vec2.get(this.gnormx,this.gnormy,null),this.wrap_gnorm.zpp_inner._immutable=!0,this.wrap_gnorm.zpp_inner._validate=n(this,this.gnorm_validate)},__class__:o.shape.ZPP_Edge},o.shape.ZPP_Polygon=function(){this.zip_sanitation=!1,this.zip_valid=!1,this.zip_gaxi=!1,this.zip_gverts=!1,this.zip_laxi=!1,this.zip_lverts=!1,this.reverse_flag=!1,this.edgeCnt=0,this.wrap_edges=null,this.edges=null,this.wrap_gverts=null,this.gverts=null,this.wrap_lverts=null,this.lverts=null,this.outer_zn=null,o.shape.ZPP_Shape.call(this,o.util.ZPP_Flags.id_ShapeType_POLYGON),this.polygon=this,this.lverts=new o.geom.ZPP_Vec2,this.gverts=new o.geom.ZPP_Vec2,this.edges=new o.util.ZNPList_ZPP_Edge,this.edgeCnt=0},o.shape.ZPP_Polygon.__name__=!0,o.shape.ZPP_Polygon.__super__=o.shape.ZPP_Shape,o.shape.ZPP_Polygon.prototype=t(o.shape.ZPP_Shape.prototype,{__clear:function(){},lverts_pa_invalidate:function(t){this.invalidate_lverts()},lverts_pa_immutable:function(){if(null!=this.body&&this.body.type==o.util.ZPP_Flags.id_BodyType_STATIC&&null!=this.body.space)throw"Error: Cannot modify local vertex of Polygon added to a static body whilst within a Space"},gverts_pa_validate:function(){if(null==this.body)throw"Error: World vertex only makes sense when Polygon is contained in a rigid body";this.validate_gverts()},lverts_post_adder:function(t){t.zpp_inner._invalidate=n(this,this.lverts_pa_invalidate),t.zpp_inner._isimmutable=n(this,this.lverts_pa_immutable);for(var e=null,i=null,r=this.lverts.next;null!=r;){if(r==t.zpp_inner)break;e=null==e?this.gverts.next:e.next,i=null==i?this.edges.head:i.next,r=r.next}var s=o.geom.ZPP_Vec2.get(0,0,!0);if(this.gverts.insert(e,s),null!=this.lverts.next.next)if(null==this.lverts.next.next.next){var l;null==o.shape.ZPP_Edge.zpp_pool?l=new o.shape.ZPP_Edge:(l=o.shape.ZPP_Edge.zpp_pool,o.shape.ZPP_Edge.zpp_pool=l.next,l.next=null),l.polygon=this,this.edges.add(l);var a;null==o.shape.ZPP_Edge.zpp_pool?a=new o.shape.ZPP_Edge:(a=o.shape.ZPP_Edge.zpp_pool,o.shape.ZPP_Edge.zpp_pool=a.next,a.next=null),a.polygon=this,this.edges.add(a),this.edgeCnt+=2}else{var p;null==o.shape.ZPP_Edge.zpp_pool?p=new o.shape.ZPP_Edge:(p=o.shape.ZPP_Edge.zpp_pool,o.shape.ZPP_Edge.zpp_pool=p.next,p.next=null),p.polygon=this,this.edges.insert(i,p),this.edgeCnt++}s._validate=n(this,this.gverts_pa_validate)},lverts_subber:function(t){this.cleanup_lvert(t.zpp_inner)},lverts_invalidate:function(t){this.invalidate_lverts()},lverts_validate:function(){this.validate_lverts()},lverts_modifiable:function(){if(this.immutable_midstep("Polygon::localVerts"),null!=this.body&&this.body.type==o.util.ZPP_Flags.id_BodyType_STATIC&&null!=this.body.space)throw"Error: Cannot modifiy shapes of static object once added to Space"},gverts_validate:function(){this.validate_gverts()},edges_validate:function(){this.validate_lverts()},getlverts:function(){this.wrap_lverts=o.util.ZPP_MixVec2List.get(this.lverts),this.wrap_lverts.zpp_inner.post_adder=n(this,this.lverts_post_adder),this.wrap_lverts.zpp_inner.subber=n(this,this.lverts_subber),this.wrap_lverts.zpp_inner._invalidate=n(this,this.lverts_invalidate),this.wrap_lverts.zpp_inner._validate=n(this,this.lverts_validate),this.wrap_lverts.zpp_inner._modifiable=n(this,this.lverts_modifiable),this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag},getgverts:function(){this.wrap_gverts=o.util.ZPP_MixVec2List.get(this.gverts,!0),this.wrap_gverts.zpp_inner.reverse_flag=this.reverse_flag,this.wrap_gverts.zpp_inner._validate=n(this,this.gverts_validate)},getedges:function(){this.wrap_edges=o.util.ZPP_EdgeList.get(this.edges,!0),this.wrap_edges.zpp_inner.reverse_flag=this.reverse_flag,this.wrap_edges.zpp_inner._validate=n(this,this.edges_validate)},invalidate_lverts:function(){this.invalidate_laxi(),this.invalidate_area_inertia(),this.invalidate_angDrag(),this.invalidate_localCOM(),this.invalidate_gverts(),this.zip_lverts=!0,this.zip_valid=!0,this.zip_sanitation=!0,null!=this.body&&this.body.wake()},invalidate_laxi:function(){this.invalidate_gaxi(),this.zip_sweepRadius=!0,this.zip_laxi=!0},invalidate_gverts:function(){this.zip_aabb=!0,null!=this.body&&(this.body.zip_aabb=!0),this.zip_gverts=!0},invalidate_gaxi:function(){this.zip_gaxi=!0},valid:function(){if(this.zip_valid){if(this.zip_valid=!1,this.zip_sanitation&&(this.zip_sanitation=!1,this.splice_collinear_real()),this.lverts.length<3)return function(t){return null==o.util.ZPP_Flags.ValidationResult_DEGENERATE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_DEGENERATE=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),t.validation=o.util.ZPP_Flags.ValidationResult_DEGENERATE}(this);if(this.validate_lverts(),this.validate_area_inertia(),this.area<p.Config.epsilon)return function(t){return null==o.util.ZPP_Flags.ValidationResult_DEGENERATE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_DEGENERATE=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),t.validation=o.util.ZPP_Flags.ValidationResult_DEGENERATE}(this);var t=!1,n=!1,e=!0,i=this.lverts.next,r=i;i=i.next;var s=i;for(i=i.next;null!=i;){var l=i,a=0,_=0;a=l.x-s.x,_=l.y-s.y;var h=0,u=0;h=s.x-r.x,u=s.y-r.y;var d=u*a-h*_;if(d>p.Config.epsilon?n=!0:d<-p.Config.epsilon&&(t=!0),n&&t){e=!1;break}r=s,s=l,i=i.next}if(e){i=this.lverts.next;var c=i;do{var P=0,f=0;P=c.x-s.x,f=c.y-s.y;var z=0,v=0;z=s.x-r.x,v=s.y-r.y;var m=v*P-z*f;if(m>p.Config.epsilon?n=!0:m<-p.Config.epsilon&&(t=!0),n&&t){e=!1;break}}while(!1);if(e){r=s,s=c,i=i.next;var b=i;do{var y=0,g=0;y=b.x-s.x,g=b.y-s.y;var x=0,Z=0;x=s.x-r.x,Z=s.y-r.y;var w=Z*y-x*g;if(w>p.Config.epsilon?n=!0:w<-p.Config.epsilon&&(t=!0),n&&t)break}while(!1)}}if(n&&t)return function(t){return null==o.util.ZPP_Flags.ValidationResult_CONCAVE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_CONCAVE=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),t.validation=o.util.ZPP_Flags.ValidationResult_CONCAVE}(this);var C=!0,E=!0,S=this.lverts.next,N=S;for(S=S.next;null!=S;){var k=S;if(!C){E=!1;break}var M=!0,I=this.lverts.next,F=I;for(I=I.next;null!=I;){var A=I;if(N!=F&&N!=A&&k!=F&&k!=A){var T=0,V=0;T=N.x-F.x,V=N.y-F.y
;var L=0,B=0;L=k.x-N.x,B=k.y-N.y;var O=0,G=0;O=A.x-F.x,G=A.y-F.y;var R=B*O-L*G;if(R*R>p.Config.epsilon){R=1/R;var D=(G*T-O*V)*R;if(D>p.Config.epsilon&&D<1-p.Config.epsilon){var j=(B*T-L*V)*R;if(j>p.Config.epsilon&&j<1-p.Config.epsilon){C=!1,M=!1;break}}}F=A,I=I.next}else F=A,I=I.next}if(M)do{var q=this.lverts.next;if(N==F||N==q||k==F||k==q)break;var Y=0,U=0;Y=N.x-F.x,U=N.y-F.y;var W=0,J=0;W=k.x-N.x,J=k.y-N.y;var K=0,H=0;K=q.x-F.x,H=q.y-F.y;var X=J*K-W*H;if(X*X>p.Config.epsilon){X=1/X;var Q=(H*Y-K*U)*X;if(Q>p.Config.epsilon&&Q<1-p.Config.epsilon){var $=(J*Y-W*U)*X;if($>p.Config.epsilon&&$<1-p.Config.epsilon){C=!1;break}}}}while(!1);N=k,S=S.next}if(E)do{var tt=this.lverts.next;if(!C)break;var nt=!0,et=this.lverts.next,it=et;for(et=et.next;null!=et;){var rt=et;if(N!=it&&N!=rt&&tt!=it&&tt!=rt){var st=0,lt=0;st=N.x-it.x,lt=N.y-it.y;var at=0,pt=0;at=tt.x-N.x,pt=tt.y-N.y;var ot=0,_t=0;ot=rt.x-it.x,_t=rt.y-it.y;var ht=pt*ot-at*_t;if(ht*ht>p.Config.epsilon){ht=1/ht;var ut=(_t*st-ot*lt)*ht;if(ut>p.Config.epsilon&&ut<1-p.Config.epsilon){var dt=(pt*st-at*lt)*ht;if(dt>p.Config.epsilon&&dt<1-p.Config.epsilon){C=!1,nt=!1;break}}}it=rt,et=et.next}else it=rt,et=et.next}if(nt)do{var ct=this.lverts.next;if(N==it||N==ct||tt==it||tt==ct)break;var Pt=0,ft=0;Pt=N.x-it.x,ft=N.y-it.y;var zt=0,vt=0;zt=tt.x-N.x,vt=tt.y-N.y;var mt=0,bt=0;mt=ct.x-it.x,bt=ct.y-it.y;var yt=vt*mt-zt*bt;if(yt*yt>p.Config.epsilon){yt=1/yt;var gt=(bt*Pt-mt*ft)*yt;if(gt>p.Config.epsilon&&gt<1-p.Config.epsilon){var xt=(vt*Pt-zt*ft)*yt;if(xt>p.Config.epsilon&&xt<1-p.Config.epsilon){C=!1;break}}}}while(!1)}while(!1);return C?function(t){return null==o.util.ZPP_Flags.ValidationResult_VALID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_VALID=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),t.validation=o.util.ZPP_Flags.ValidationResult_VALID}(this):function(t){return null==o.util.ZPP_Flags.ValidationResult_SELF_INTERSECTING&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_SELF_INTERSECTING=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),t.validation=o.util.ZPP_Flags.ValidationResult_SELF_INTERSECTING}(this)}return this.validation},validate_lverts:function(){this.zip_lverts&&(this.zip_lverts=!1,this.lverts.length>2&&(this.validate_area_inertia(),this.area<0&&(this.reverse_vertices(),this.area=-this.area)))},cleanup_lvert:function(t){for(var n=null,e=null,i=this.lverts.next;null!=i;){if(i==t)break;n=null==n?this.gverts.next:n.next,e=null==e?this.edges.head:e.next,i=i.next}var r;r=null==n?this.gverts.next:n.next,this.gverts.erase(n);var s=r;if(null!=s.outer&&(s.outer.zpp_inner=null,s.outer=null),s._isimmutable=null,s._validate=null,s._invalidate=null,s.next=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=s,2==this.edgeCnt){var l=this.edges.pop_unsafe(),a=l;a.polygon=null,a.next=o.shape.ZPP_Edge.zpp_pool,o.shape.ZPP_Edge.zpp_pool=a,l=this.edges.pop_unsafe();var p=l;p.polygon=null,p.next=o.shape.ZPP_Edge.zpp_pool,o.shape.ZPP_Edge.zpp_pool=p,this.edgeCnt=0}else if(0!=this.edgeCnt){var _;_=null==e?this.edges.head.elt:e.next.elt,this.edges.erase(e);var h=_;h.polygon=null,h.next=o.shape.ZPP_Edge.zpp_pool,o.shape.ZPP_Edge.zpp_pool=h,this.edgeCnt--}},splice_collinear:function(){this.zip_sanitation&&(this.zip_sanitation=!1,this.splice_collinear_real())},splice_collinear_real:function(){if(null!=this.lverts.next&&null!=this.lverts.next.next&&null!=this.lverts.next.next.next){for(var t=null,n=this.lverts.next;null!=n;){var e;e=null==n.next?this.lverts.next:n.next;var i=n,r=e;o.geom.ZPP_VecMath.vec_dsq(i.x,i.y,r.x,r.y)<p.Config.epsilon*p.Config.epsilon?(this.cleanup_lvert(n),n=this.lverts.erase(t)):(t=n,n=n.next)}if(null!=this.lverts.next){var s;do{s=!1;for(var l=this.lverts.next;null!=l;){var a;a=null==l.next?this.lverts.next:l.next;var _;_=null==a.next?this.lverts.next:a.next;var h=l,u=a,d=_,c=0,P=0;c=u.x-h.x,P=u.y-h.y;var f=0,z=0;f=d.x-u.x,z=d.y-u.y;var v=z*c-f*P;v*v>=p.Config.epsilon*p.Config.epsilon?l=l.next:(this.cleanup_lvert(a),this.lverts.erase(null==l.next?null:l),s=!0,l=l.next)}}while(s)}}},reverse_vertices:function(){this.lverts.reverse(),this.gverts.reverse(),this.edges.reverse();var t=this.edges.iterator_at(this.edgeCnt-1),n=this.edges.pop_unsafe();this.edges.insert(t,n),this.reverse_flag=!this.reverse_flag,null!=this.wrap_lverts&&(this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag),null!=this.wrap_gverts&&(this.wrap_gverts.zpp_inner.reverse_flag=this.reverse_flag),null!=this.wrap_edges&&(this.wrap_edges.zpp_inner.reverse_flag=this.reverse_flag)},validate_laxi:function(){if(this.zip_laxi){this.zip_laxi=!1,this.validate_lverts();var t=this.edges.head,n=this.lverts.next,e=n;for(n=n.next;null!=n;){var i=n,r=t.elt;t=t.next,r.lp0=e,r.lp1=i;var s=0,l=0;s=e.x-i.x,l=e.y-i.y;var a=Math.sqrt(s*s+l*l);r.length=a;var p=1/a;s*=p,l*=p;var o=s;s=-l,l=o,r.lprojection=s*e.x+l*e.y,r.lnormx=s,r.lnormy=l,null!=r.wrap_lnorm&&(r.wrap_lnorm.zpp_inner.x=s,r.wrap_lnorm.zpp_inner.y=l),e=i,n=n.next}var _=this.lverts.next,h=t.elt;t=t.next,h.lp0=e,h.lp1=_;var u=0,d=0;u=e.x-_.x,d=e.y-_.y;var c=Math.sqrt(u*u+d*d);h.length=c;var P=1/c;u*=P,d*=P;var f=u;u=-d,d=f,h.lprojection=u*e.x+d*e.y,h.lnormx=u,h.lnormy=d,null!=h.wrap_lnorm&&(h.wrap_lnorm.zpp_inner.x=u,h.wrap_lnorm.zpp_inner.y=d)}},validate_gverts:function(){if(this.zip_gverts&&null!=this.body){this.zip_gverts=!1,this.validate_lverts(),this.body.validate_axis();for(var t=this.lverts.next,n=this.gverts.next;null!=n;){var e=n,i=t;t=t.next,e.x=this.body.posx+(this.body.axisy*i.x-this.body.axisx*i.y),e.y=this.body.posy+(i.x*this.body.axisx+i.y*this.body.axisy),n=n.next}}},validate_gaxi:function(){if(this.zip_gaxi&&null!=this.body){this.zip_gaxi=!1,this.validate_laxi(),this.body.validate_axis(),this.validate_gverts();var t=this.edges.head,n=this.gverts.next,e=n;for(n=n.next;null!=n;){var i=n,r=t.elt;t=t.next,r.gp0=e,r.gp1=i,r.gnormx=this.body.axisy*r.lnormx-this.body.axisx*r.lnormy,r.gnormy=r.lnormx*this.body.axisx+r.lnormy*this.body.axisy,r.gprojection=this.body.posx*r.gnormx+this.body.posy*r.gnormy+r.lprojection,null!=r.wrap_gnorm&&(r.wrap_gnorm.zpp_inner.x=r.gnormx,r.wrap_gnorm.zpp_inner.y=r.gnormy),r.tp0=r.gp0.y*r.gnormx-r.gp0.x*r.gnormy,r.tp1=r.gp1.y*r.gnormx-r.gp1.x*r.gnormy,e=i,n=n.next}var s=this.gverts.next,l=t.elt;t=t.next,l.gp0=e,l.gp1=s,l.gnormx=this.body.axisy*l.lnormx-this.body.axisx*l.lnormy,l.gnormy=l.lnormx*this.body.axisx+l.lnormy*this.body.axisy,l.gprojection=this.body.posx*l.gnormx+this.body.posy*l.gnormy+l.lprojection,null!=l.wrap_gnorm&&(l.wrap_gnorm.zpp_inner.x=l.gnormx,l.wrap_gnorm.zpp_inner.y=l.gnormy),l.tp0=l.gp0.y*l.gnormx-l.gp0.x*l.gnormy,l.tp1=l.gp1.y*l.gnormx-l.gp1.x*l.gnormy}},__validate_aabb:function(){if(this.validate_gverts(),null==this.lverts.next)throw"Error: An empty polygon has no meaningful bounds";var t=this.gverts.next;this.aabb.minx=t.x,this.aabb.miny=t.y,this.aabb.maxx=t.x,this.aabb.maxy=t.y;for(var n=this.gverts.next.next;null!=n;){var e=n;e.x<this.aabb.minx&&(this.aabb.minx=e.x),e.x>this.aabb.maxx&&(this.aabb.maxx=e.x),e.y<this.aabb.miny&&(this.aabb.miny=e.y),e.y>this.aabb.maxy&&(this.aabb.maxy=e.y),n=n.next}},_force_validate_aabb:function(){var t=this.lverts.next,n=this.gverts.next,e=t;t=t.next,n.x=this.body.posx+(this.body.axisy*e.x-this.body.axisx*e.y),n.y=this.body.posy+(e.x*this.body.axisx+e.y*this.body.axisy),this.aabb.minx=n.x,this.aabb.miny=n.y,this.aabb.maxx=n.x,this.aabb.maxy=n.y;for(var i=this.gverts.next.next;null!=i;){var r=i,s=t;t=t.next,r.x=this.body.posx+(this.body.axisy*s.x-this.body.axisx*s.y),r.y=this.body.posy+(s.x*this.body.axisx+s.y*this.body.axisy),r.x<this.aabb.minx&&(this.aabb.minx=r.x),r.x>this.aabb.maxx&&(this.aabb.maxx=r.x),r.y<this.aabb.miny&&(this.aabb.miny=r.y),r.y>this.aabb.maxy&&(this.aabb.maxy=r.y),i=i.next}},__validate_sweepRadius:function(){var t=0,n=0;this.validate_laxi();for(var e=this.lverts.next;null!=e;){var i=e,r=i.x*i.x+i.y*i.y;r>t&&(t=r),e=e.next}for(var s=this.edges.head;null!=s;){var l=s.elt;if(l.lprojection<n&&(n=l.lprojection)<0)break;s=s.next}n<0&&(n=0),this.sweepRadius=Math.sqrt(t),this.sweepCoef=this.sweepRadius-n},__validate_area_inertia:function(){if(null==this.lverts.next||null==this.lverts.next.next||null==this.lverts.next.next.next)this.area=0,this.inertia=0;else{this.area=0;var t=0,n=0,e=this.lverts.next,i=e;e=e.next;var r=e;for(e=e.next;null!=e;){var s=e,l=r.y*i.x-r.x*i.y;t+=l*(r.x*r.x+r.y*r.y+(r.x*i.x+r.y*i.y)+(i.x*i.x+i.y*i.y)),n+=l,this.area+=r.x*(s.y-i.y),i=r,r=s,e=e.next}e=this.lverts.next;var a=e,p=r.y*i.x-r.x*i.y;t+=p*(r.x*r.x+r.y*r.y+(r.x*i.x+r.y*i.y)+(i.x*i.x+i.y*i.y)),n+=p,this.area+=r.x*(a.y-i.y),i=r,r=a,e=e.next;var o=e,_=r.y*i.x-r.x*i.y;t+=_*(r.x*r.x+r.y*r.y+(r.x*i.x+r.y*i.y)+(i.x*i.x+i.y*i.y)),n+=_,this.area+=r.x*(o.y-i.y),this.inertia=t/(6*n),this.area*=.5,this.area<0&&(this.area=-this.area,this.reverse_vertices())}},__validate_angDrag:function(){if(this.lverts.length<3)throw"Error: Polygon's with less than 3 vertices have no meaningful angDrag";this.validate_area_inertia(),this.validate_laxi();for(var t=0,n=this.edges.head,e=0,i=this.lverts.next,r=i,s=i.next;null!=s;){var l=s,a=n.elt;n=n.next,e+=a.length;var o=0,_=0;o=l.x-r.x,_=l.y-r.y,t+=a.length*p.Config.fluidAngularDragFriction*this.material.dynamicFriction*a.lprojection*a.lprojection;var h=-(r.y*a.lnormx-r.x*a.lnormy)/(_*a.lnormx-o*a.lnormy);if(h>0){var u;u=h>1?1:h;var d=0,c=0;d=r.x,c=r.y;var P=u;d+=o*P,c+=_*P;var f=a.lnormy*r.x-a.lnormx*r.y,z=a.lnormy*d-a.lnormx*c;t+=(z*z*z-f*f*f)/(3*(z-f))*u*a.length*p.Config.fluidAngularDrag}if(h<1){var v;v=h<0?0:h;var m=0,b=0;m=r.x,b=r.y;var y=v;m+=o*y,b+=_*y;var g=a.lnormy*m-a.lnormx*b,x=a.lnormy*l.x-a.lnormx*l.y;t+=(x*x*x-g*g*g)/(3*(x-g))*p.Config.fluidVacuumDrag*(1-v)*a.length*p.Config.fluidAngularDrag}i=s,r=l,s=s.next}s=this.lverts.next;var Z=s,w=n.elt;n=n.next,e+=w.length;var C=0,E=0;C=Z.x-r.x,E=Z.y-r.y,t+=w.length*p.Config.fluidAngularDragFriction*this.material.dynamicFriction*w.lprojection*w.lprojection;var S=-(r.y*w.lnormx-r.x*w.lnormy)/(E*w.lnormx-C*w.lnormy);if(S>0){var N;N=S>1?1:S;var k=0,M=0;k=r.x,M=r.y;var I=N;k+=C*I,M+=E*I;var F=w.lnormy*r.x-w.lnormx*r.y,A=w.lnormy*k-w.lnormx*M;t+=(A*A*A-F*F*F)/(3*(A-F))*N*w.length*p.Config.fluidAngularDrag}if(S<1){var T;T=S<0?0:S;var V=0,L=0;V=r.x,L=r.y;var B=T;V+=C*B,L+=E*B;var O=w.lnormy*V-w.lnormx*L,G=w.lnormy*Z.x-w.lnormx*Z.y;t+=(G*G*G-O*O*O)/(3*(G-O))*p.Config.fluidVacuumDrag*(1-T)*w.length*p.Config.fluidAngularDrag}this.angDrag=t/(this.inertia*e)},__validate_localCOM:function(){if(null==this.lverts.next)throw"Error: An empty polygon has no meaningful localCOM";if(null==this.lverts.next.next)this.localCOMx=this.lverts.next.x,this.localCOMy=this.lverts.next.y;else if(null==this.lverts.next.next.next){this.localCOMx=this.lverts.next.x,this.localCOMy=this.lverts.next.y;this.localCOMx+=1*this.lverts.next.next.x,this.localCOMy+=1*this.lverts.next.next.y;this.localCOMx*=.5,this.localCOMy*=.5}else{this.localCOMx=0,this.localCOMy=0;var t=0,n=this.lverts.next,e=n;n=n.next;var i=n;for(n=n.next;null!=n;){var r=n;t+=i.x*(r.y-e.y);var s=r.y*i.x-r.x*i.y;this.localCOMx+=(i.x+r.x)*s,this.localCOMy+=(i.y+r.y)*s,e=i,i=r,n=n.next}n=this.lverts.next;var l=n;t+=i.x*(l.y-e.y);var a=l.y*i.x-l.x*i.y;this.localCOMx+=(i.x+l.x)*a,this.localCOMy+=(i.y+l.y)*a,e=i,i=l,n=n.next;var p=n;t+=i.x*(p.y-e.y);var o=p.y*i.x-p.x*i.y;this.localCOMx+=(i.x+p.x)*o,this.localCOMy+=(i.y+p.y)*o,t=1/(3*t);var _=t;this.localCOMx*=_,this.localCOMy*=_}},localCOM_validate:function(){if(null==this.lverts.next)throw"Error: An empty polygon does not have any meaningful localCOM";this.zip_localCOM&&(this.zip_localCOM=!1,this.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy))},localCOM_invalidate:function(t){this.zip_localCOM&&(this.zip_localCOM=!1,this.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy));var n=0,e=0;n=t.x-this.localCOMx,e=t.y-this.localCOMy;for(var i=this.lverts.next;null!=i;){var r=i;r.x+=1*n,r.y+=1*e,i=i.next}this.invalidate_lverts()},setupLocalCOM:function(){this.wrap_localCOM=p.geom.Vec2.get(this.localCOMx,this.localCOMy,null),this.wrap_localCOM.zpp_inner._inuse=!0,this.wrap_localCOM.zpp_inner._validate=n(this,this.localCOM_validate),this.wrap_localCOM.zpp_inner._invalidate=n(this,this.localCOM_invalidate)},__translate:function(t,n){for(var e=this.lverts.next;null!=e;){var i=e;i.x+=1*t,i.y+=1*n,e=e.next}this.invalidate_lverts()},__scale:function(t,n){for(var e=this.lverts.next;null!=e;){var i=e;i.x*=t,i.y*=n,e=e.next}this.invalidate_lverts()},__rotate:function(t,n){for(var e=this.lverts.next;null!=e;){var i=e,r=0,s=0;r=n*i.x-t*i.y,s=i.x*t+i.y*n,i.x=r,i.y=s,e=e.next}this.invalidate_lverts()},__transform:function(t){for(var n=this.lverts.next;null!=n;){var e=n,i=t.zpp_inner.a*e.x+t.zpp_inner.b*e.y+t.zpp_inner.tx;e.y=t.zpp_inner.c*e.x+t.zpp_inner.d*e.y+t.zpp_inner.ty,e.x=i,n=n.next}this.invalidate_lverts()},__copy:function(){return new p.shape.Polygon(this.outer_zn.get_localVerts()).zpp_inner_zn},__class__:o.shape.ZPP_Polygon}),o.space={},o.space.ZPP_Broadphase=function(){this.circShape=null,this.matrix=null,this.aabbShape=null,this.dynab=null,this.sweep=null,this.is_sweep=!1,this.space=null},o.space.ZPP_Broadphase.__name__=!0,o.space.ZPP_Broadphase.prototype={insert:function(t){this.is_sweep?this.sweep.__insert(t):this.dynab.__insert(t)},remove:function(t){this.is_sweep?this.sweep.__remove(t):this.dynab.__remove(t)},sync:function(t){this.is_sweep?this.sweep.space.continuous||t.zip_aabb&&null!=t.body&&(t.zip_aabb=!1,t.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.circle.__validate_aabb():t.polygon.__validate_aabb()):this.dynab.__sync(t)},broadphase:function(t,n){},clear:function(){},shapesUnderPoint:function(t,n,e,i){return null},bodiesUnderPoint:function(t,n,e,i){return null},updateAABBShape:function(t){if(null==this.aabbShape){new p.phys.Body(function(t){return null==o.util.ZPP_Flags.BodyType_STATIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_STATIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_STATIC}()).zpp_inner.wrap_shapes.add(this.aabbShape=new p.shape.Polygon(p.shape.Polygon.rect(t.minx,t.miny,t.maxx-t.minx,t.maxy-t.miny)))}else{var n=this.aabbShape.zpp_inner.aabb,e=(t.maxx-t.minx)/(n.maxx-n.minx),i=(t.maxy-t.miny)/(n.maxy-n.miny);null==this.matrix&&(this.matrix=new p.geom.Mat23),this.matrix.set_a(e),this.matrix.set_b(this.matrix.set_c(0)),this.matrix.set_d(i),this.matrix.set_tx(t.minx-e*n.minx),this.matrix.set_ty(t.miny-i*n.miny),this.aabbShape.transform(this.matrix)}this.aabbShape.zpp_inner.validate_aabb(),this.aabbShape.zpp_inner.polygon.validate_gaxi()},shapesInAABB:function(t,n,e,i,r){return null},bodiesInAABB:function(t,n,e,i,r){return null},updateCircShape:function(t,n,e){if(null==this.circShape){new p.phys.Body(function(t){return null==o.util.ZPP_Flags.BodyType_STATIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_STATIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_STATIC}()).zpp_inner.wrap_shapes.add(this.circShape=new p.shape.Circle(e,p.geom.Vec2.get(t,n,null)))}else{var i=this.circShape.zpp_inner.circle,r=e/i.radius;null==this.matrix&&(this.matrix=new p.geom.Mat23),this.matrix.set_a(this.matrix.set_d(r)),this.matrix.set_b(this.matrix.set_c(0)),this.matrix.set_tx(t-r*i.localCOMx),this.matrix.set_ty(n-r*i.localCOMy),this.circShape.transform(this.matrix)}this.circShape.zpp_inner.validate_aabb()},shapesInCircle:function(t,n,e,i,r,s){return null},bodiesInCircle:function(t,n,e,i,r,s){return null},validateShape:function(t){t.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&t.polygon.validate_gaxi(),t.zip_aabb&&null!=t.body&&(t.zip_aabb=!1,t.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.circle.__validate_aabb():t.polygon.__validate_aabb()),t.zip_worldCOM&&null!=t.body&&(t.zip_worldCOM=!1,t.zip_localCOM&&(t.zip_localCOM=!1,t.type==o.util.ZPP_Flags.id_ShapeType_POLYGON&&t.polygon.__validate_localCOM(),null!=t.wrap_localCOM&&(t.wrap_localCOM.zpp_inner.x=t.localCOMx,t.wrap_localCOM.zpp_inner.y=t.localCOMy)),t.body.validate_axis(),t.worldCOMx=t.body.posx+(t.body.axisy*t.localCOMx-t.body.axisx*t.localCOMy),t.worldCOMy=t.body.posy+(t.localCOMx*t.body.axisx+t.localCOMy*t.body.axisy))},shapesInShape:function(t,n,e,i){return null},bodiesInShape:function(t,n,e,i){return null},rayCast:function(t,n,e){return null},rayMultiCast:function(t,n,e,i){return null},__class__:o.space.ZPP_Broadphase},o.space.ZPP_AABBNode=function(){this.first_sync=!1,this.synced=!1,this.snext=null,this.moved=!1,this.mnext=null,this.next=null,this.rayt=0,this.height=0,this.child2=null,this.child1=null,this.parent=null,this.dyn=!1,this.shape=null,this.aabb=null,this.height=-1},o.space.ZPP_AABBNode.__name__=!0,o.space.ZPP_AABBNode.prototype={alloc:function(){null==o.geom.ZPP_AABB.zpp_pool?this.aabb=new o.geom.ZPP_AABB:(this.aabb=o.geom.ZPP_AABB.zpp_pool,o.geom.ZPP_AABB.zpp_pool=this.aabb.next,this.aabb.next=null),this.moved=!1,this.synced=!1,this.first_sync=!1},free:function(){this.height=-1;var t=this.aabb;null!=t.outer&&(t.outer.zpp_inner=null,t.outer=null),t.wrap_min=t.wrap_max=null,t._invalidate=null,t._validate=null,t.next=o.geom.ZPP_AABB.zpp_pool,o.geom.ZPP_AABB.zpp_pool=t,this.child1=this.child2=this.parent=null,this.next=null,this.snext=null,this.mnext=null},isLeaf:function(){return null==this.child1},__class__:o.space.ZPP_AABBNode},o.space.ZPP_AABBPair=function(){this.next=null,this.arb=null,this.di=0,this.id=0,this.sleeping=!1,this.first=!1,this.n2=null,this.n1=null},o.space.ZPP_AABBPair.__name__=!0,o.space.ZPP_AABBPair.prototype={alloc:function(){},free:function(){this.n1=this.n2=null,this.sleeping=!1},__class__:o.space.ZPP_AABBPair},o.space.ZPP_AABBTree=function(){this.root=null},o.space.ZPP_AABBTree.__name__=!0,o.space.ZPP_AABBTree.prototype={clear:function(){if(null!=this.root){var t=null;for(this.root.next=t,t=this.root;null!=t;){var n,e=t;t=e.next,e.next=null,n=e,null==n.child1?(n.shape.node=null,n.shape.removedFromSpace(),n.shape=null):(null!=n.child1&&(n.child1.next=t,t=n.child1),null!=n.child2&&(n.child2.next=t,t=n.child2));var i=n;i.free(),i.next=o.space.ZPP_AABBNode.zpp_pool,o.space.ZPP_AABBNode.zpp_pool=i}this.root=null}},insertLeaf:function(t){this.inlined_insertLeaf(t)},inlined_insertLeaf:function(t){if(null==this.root)this.root=t,this.root.parent=null;else{for(var n=t.aabb,e=this.root;null!=e.child1;){var i=e.child1,r=e.child2,s=e.aabb.perimeter();o.space.ZPP_AABBTree.tmpaabb.setCombine(e.aabb,n);var l,a=o.space.ZPP_AABBTree.tmpaabb.perimeter(),p=2*a,_=2*(a-s);if(o.space.ZPP_AABBTree.tmpaabb.setCombine(n,i.aabb),null==i.child1)l=o.space.ZPP_AABBTree.tmpaabb.perimeter()+_;else{var h=i.aabb.perimeter();l=o.space.ZPP_AABBTree.tmpaabb.perimeter()-h+_}var u;if(o.space.ZPP_AABBTree.tmpaabb.setCombine(n,r.aabb),null==r.child1)u=o.space.ZPP_AABBTree.tmpaabb.perimeter()+_;else{var d=r.aabb.perimeter();u=o.space.ZPP_AABBTree.tmpaabb.perimeter()-d+_}if(p<l&&p<u)break;e=l<u?i:r}var c,P=e,f=P.parent;for(null==o.space.ZPP_AABBNode.zpp_pool?c=new o.space.ZPP_AABBNode:(c=o.space.ZPP_AABBNode.zpp_pool,o.space.ZPP_AABBNode.zpp_pool=c.next,c.next=null),null==o.geom.ZPP_AABB.zpp_pool?c.aabb=new o.geom.ZPP_AABB:(c.aabb=o.geom.ZPP_AABB.zpp_pool,o.geom.ZPP_AABB.zpp_pool=c.aabb.next,c.aabb.next=null),c.moved=!1,c.synced=!1,c.first_sync=!1,c.parent=f,c.aabb.setCombine(n,P.aabb),c.height=P.height+1,null!=f?(f.child1==P?f.child1=c:f.child2=c,c.child1=P,c.child2=t,P.parent=c,t.parent=c):(c.child1=P,c.child2=t,P.parent=c,t.parent=c,this.root=c),e=t.parent;null!=e;){e=this.balance(e);var z=e.child1,v=e.child2;e.height=1+function(t){var n=z.height,e=v.height;return n>e?n:e}(),e.aabb.setCombine(z.aabb,v.aabb),e=e.parent}}},removeLeaf:function(t){this.inlined_removeLeaf(t)},inlined_removeLeaf:function(t){if(t==this.root)return void(this.root=null);var n,e=t.parent,i=e.parent;if(n=e.child1==t?e.child2:e.child1,null!=i){i.child1==e?i.child1=n:i.child2=n,n.parent=i;var r=e;r.free(),r.next=o.space.ZPP_AABBNode.zpp_pool,o.space.ZPP_AABBNode.zpp_pool=r;for(var s=i;null!=s;){s=this.balance(s);var l=s.child1,a=s.child2;s.aabb.setCombine(l.aabb,a.aabb),s.height=1+function(t){var n=l.height,e=a.height;return n>e?n:e}(),s=s.parent}}else{this.root=n,n.parent=null;var p=e;p.free(),p.next=o.space.ZPP_AABBNode.zpp_pool,o.space.ZPP_AABBNode.zpp_pool=p}},balance:function(t){if(null==t.child1||t.height<2)return t;var n=t.child1,e=t.child2,i=e.height-n.height;if(i>1){var r=e.child1,s=e.child2;return e.child1=t,e.parent=t.parent,t.parent=e,null!=e.parent?e.parent.child1==t?e.parent.child1=e:e.parent.child2=e:this.root=e,r.height>s.height?(e.child2=r,t.child2=s,s.parent=t,t.aabb.setCombine(n.aabb,s.aabb),e.aabb.setCombine(t.aabb,r.aabb),t.height=1+function(t){var e=n.height,i=s.height;return e>i?e:i}(),e.height=1+function(n){var e=t.height,i=r.height;return e>i?e:i}()):(e.child2=s,t.child2=r,r.parent=t,t.aabb.setCombine(n.aabb,r.aabb),e.aabb.setCombine(t.aabb,s.aabb),t.height=1+function(t){var e=n.height,i=r.height;return e>i?e:i}(),e.height=1+function(n){var e=t.height,i=s.height;return e>i?e:i}()),e}if(i<-1){var l=n.child1,a=n.child2;return n.child1=t,n.parent=t.parent,t.parent=n,null!=n.parent?n.parent.child1==t?n.parent.child1=n:n.parent.child2=n:this.root=n,l.height>a.height?(n.child2=l,t.child1=a,a.parent=t,t.aabb.setCombine(e.aabb,a.aabb),n.aabb.setCombine(t.aabb,l.aabb),t.height=1+function(t){var n=e.height,i=a.height;return n>i?n:i}(),n.height=1+function(n){var e=t.height,i=l.height;return e>i?e:i}()):(n.child2=a,t.child1=l,l.parent=t,t.aabb.setCombine(e.aabb,l.aabb),n.aabb.setCombine(t.aabb,a.aabb),t.height=1+function(t){var n=e.height,i=l.height;return n>i?n:i}(),n.height=1+function(n){var e=t.height,i=a.height;return e>i?e:i}()),n}return t},__class__:o.space.ZPP_AABBTree},o.space.ZPP_DynAABBPhase=function(t){this.openlist=null,this.failed=null,this.treeStack2=null,this.treeStack=null,this.moves=null,this.syncs=null,this.pairs=null,this.dtree=null,this.stree=null,this.space=t,this.is_sweep=!1,this.dynab=this,this.stree=new o.space.ZPP_AABBTree,this.dtree=new o.space.ZPP_AABBTree},o.space.ZPP_DynAABBPhase.__name__=!0,o.space.ZPP_DynAABBPhase.__super__=o.space.ZPP_Broadphase,o.space.ZPP_DynAABBPhase.prototype=t(o.space.ZPP_Broadphase.prototype,{dyn:function(t){return t.body.type!=o.util.ZPP_Flags.id_BodyType_STATIC&&!t.body.component.sleeping},__insert:function(t){var n;null==o.space.ZPP_AABBNode.zpp_pool?n=new o.space.ZPP_AABBNode:(n=o.space.ZPP_AABBNode.zpp_pool,o.space.ZPP_AABBNode.zpp_pool=n.next,n.next=null),null==o.geom.ZPP_AABB.zpp_pool?n.aabb=new o.geom.ZPP_AABB:(n.aabb=o.geom.ZPP_AABB.zpp_pool,o.geom.ZPP_AABB.zpp_pool=n.aabb.next,n.aabb.next=null),n.moved=!1,n.synced=!1,n.first_sync=!1,n.shape=t,t.node=n,n.synced=!0,n.first_sync=!0,n.snext=this.syncs,this.syncs=n},__remove:function(t){var n=t.node;if(n.first_sync||(n.dyn?this.dtree.removeLeaf(n):this.stree.removeLeaf(n)),t.node=null,n.synced){for(var e=null,i=this.syncs;null!=i&&i!=n;)e=i,i=i.snext;null==e?this.syncs=i.snext:e.snext=i.snext,i.snext=null,n.synced=!1}if(n.moved){for(var r=null,s=this.moves;null!=s&&s!=n;)r=s,s=s.mnext;null==r?this.moves=s.mnext:r.mnext=s.mnext,s.mnext=null,n.moved=!1}for(var l=null,a=this.pairs;null!=a;){var p=a.next;if(a.n1!=n&&a.n2!=n)l=a,a=p;else{null==l?this.pairs=p:l.next=p,null!=a.arb&&(a.arb.pair=null),a.arb=null,a.n1.shape.pairs.remove(a),a.n2.shape.pairs.remove(a);var _=a;_.n1=_.n2=null,_.sleeping=!1,_.next=o.space.ZPP_AABBPair.zpp_pool,o.space.ZPP_AABBPair.zpp_pool=_,a=p}}for(;null!=t.pairs.head;){var h=t.pairs.pop_unsafe();h.n1==n?h.n2.shape.pairs.remove(h):h.n1.shape.pairs.remove(h),null!=h.arb&&(h.arb.pair=null),h.arb=null;var u=h;u.n1=u.n2=null,u.sleeping=!1,u.next=o.space.ZPP_AABBPair.zpp_pool,o.space.ZPP_AABBPair.zpp_pool=u}var d=n;d.free(),d.next=o.space.ZPP_AABBNode.zpp_pool,o.space.ZPP_AABBNode.zpp_pool=d},__sync:function(t){var n=t.node;if(!n.synced){this.space.continuous||t.zip_aabb&&null!=t.body&&(t.zip_aabb=!1,t.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.circle.__validate_aabb():t.polygon.__validate_aabb());var e;e=n.dyn!=(t.body.type!=o.util.ZPP_Flags.id_BodyType_STATIC&&!t.body.component.sleeping)||!n.aabb.contains(t.aabb),e&&(n.synced=!0,n.snext=this.syncs,this.syncs=n)}},sync_broadphase:function(){if(this.space.validation(),null!=this.syncs)if(null==this.moves){for(var t=this.syncs;null!=t;){var n=t.shape;if(t.first_sync)t.first_sync=!1;else{var e;e=t.dyn?this.dtree:this.stree,e.inlined_removeLeaf(t)}var i=t.aabb;this.space.continuous||n.zip_aabb&&null!=n.body&&(n.zip_aabb=!1,n.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?n.circle.__validate_aabb():n.polygon.__validate_aabb()),i.setExpand(n.aabb,3);var r;r=(n.body.type==o.util.ZPP_Flags.id_BodyType_STATIC?t.dyn=!1:t.dyn=!n.body.component.sleeping)?this.dtree:this.stree,r.inlined_insertLeaf(t),t.synced=!1,t.moved=!0,t.mnext=t.snext,t.snext=null,t=t.mnext}var s=this.syncs;this.syncs=this.moves,this.moves=s}else for(;null!=this.syncs;){var l,a=this.syncs;this.syncs=a.snext,a.snext=null,l=a;var p=l.shape;if(l.first_sync)l.first_sync=!1;else{var _;_=l.dyn?this.dtree:this.stree,_.inlined_removeLeaf(l)}var h=l.aabb;this.space.continuous||p.zip_aabb&&null!=p.body&&(p.zip_aabb=!1,p.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?p.circle.__validate_aabb():p.polygon.__validate_aabb()),h.setExpand(p.aabb,3);var u;u=(p.body.type==o.util.ZPP_Flags.id_BodyType_STATIC?l.dyn=!1:l.dyn=!p.body.component.sleeping)?this.dtree:this.stree,u.inlined_insertLeaf(l),l.synced=!1,l.moved||(l.moved=!0,l.mnext=this.moves,this.moves=l)}},broadphase:function(t,n){for(var e=this.syncs;null!=e;){var i=e.shape;if(e.first_sync)e.first_sync=!1;else{var r;r=e.dyn?this.dtree:this.stree,r.inlined_removeLeaf(e)}var s=e.aabb;t.continuous||i.zip_aabb&&null!=i.body&&(i.zip_aabb=!1,i.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?i.circle.__validate_aabb():i.polygon.__validate_aabb()),s.setExpand(i.aabb,3);var l;l=(i.body.type==o.util.ZPP_Flags.id_BodyType_STATIC?e.dyn=!1:e.dyn=!i.body.component.sleeping)?this.dtree:this.stree,l.inlined_insertLeaf(e),e.synced=!1,e=e.snext}for(;null!=this.syncs;){var a,p=this.syncs;if(this.syncs=p.snext,p.snext=null,a=p,!a.moved){a.moved=!1;var _=a.shape;if(!_.body.component.sleeping){var h=a.aabb,u=null;for(null!=this.dtree.root&&(this.dtree.root.next=u,u=this.dtree.root);null!=u;){var d,c=u;if(u=c.next,c.next=null,(d=c)!=a)if(null==d.child1){var P=d.shape;if(P.body!=_.body&&(P.body.type!=o.util.ZPP_Flags.id_BodyType_STATIC||_.body.type!=o.util.ZPP_Flags.id_BodyType_STATIC)&&h.intersect(d.aabb)){var f,z;_.id<P.id?(f=_.id,z=P.id):(f=P.id,z=_.id);var v;v=_.pairs.length<P.pairs.length?_:P;for(var m=null,b=v.pairs.head;null!=b;){var y=b.elt;if(y.id==f&&y.di==z){m=y;break}b=b.next}if(null!=m){m.sleeping&&(m.sleeping=!1,m.next=this.pairs,this.pairs=m,m.first=!0);continue}null==o.space.ZPP_AABBPair.zpp_pool?m=new o.space.ZPP_AABBPair:(m=o.space.ZPP_AABBPair.zpp_pool,o.space.ZPP_AABBPair.zpp_pool=m.next,m.next=null),m.n1=a,m.n2=d,m.id=f,m.di=z,m.next=this.pairs,this.pairs=m,m.first=!0,_.pairs.inlined_add(m),P.pairs.inlined_add(m)}}else h.intersect(d.aabb)&&(null!=d.child1&&(d.child1.next=u,u=d.child1),null!=d.child2&&(d.child2.next=u,u=d.child2))}for(null!=this.stree.root&&(this.stree.root.next=u,u=this.stree.root);null!=u;){var g,x=u;if(u=x.next,x.next=null,(g=x)!=a)if(null==g.child1){var Z=g.shape;if(Z.body!=_.body&&(Z.body.type!=o.util.ZPP_Flags.id_BodyType_STATIC||_.body.type!=o.util.ZPP_Flags.id_BodyType_STATIC)&&h.intersect(g.aabb)){var w,C;_.id<Z.id?(w=_.id,C=Z.id):(w=Z.id,C=_.id);var E;E=_.pairs.length<Z.pairs.length?_:Z;for(var S=null,N=E.pairs.head;null!=N;){var k=N.elt;if(k.id==w&&k.di==C){S=k;break}N=N.next}if(null!=S){S.sleeping&&(S.sleeping=!1,S.next=this.pairs,this.pairs=S,S.first=!0);continue}null==o.space.ZPP_AABBPair.zpp_pool?S=new o.space.ZPP_AABBPair:(S=o.space.ZPP_AABBPair.zpp_pool,o.space.ZPP_AABBPair.zpp_pool=S.next,S.next=null),S.n1=a,S.n2=g,S.id=w,S.di=C,S.next=this.pairs,this.pairs=S,S.first=!0,_.pairs.inlined_add(S),Z.pairs.inlined_add(S)}}else h.intersect(g.aabb)&&(null!=g.child1&&(g.child1.next=u,u=g.child1),null!=g.child2&&(g.child2.next=u,u=g.child2))}}}}for(;null!=this.moves;){var M,I=this.moves;this.moves=I.mnext,I.mnext=null,M=I,M.moved=!1;var F=M.shape;if(!F.body.component.sleeping){var A=M.aabb,T=null;for(null!=this.dtree.root&&(this.dtree.root.next=T,T=this.dtree.root);null!=T;){var V,L=T;if(T=L.next,L.next=null,(V=L)!=M)if(null==V.child1){var B=V.shape;if(B.body!=F.body&&(B.body.type!=o.util.ZPP_Flags.id_BodyType_STATIC||F.body.type!=o.util.ZPP_Flags.id_BodyType_STATIC)&&A.intersect(V.aabb)){var O,G;F.id<B.id?(O=F.id,G=B.id):(O=B.id,G=F.id);var R;R=F.pairs.length<B.pairs.length?F:B;for(var D=null,j=R.pairs.head;null!=j;){var q=j.elt;if(q.id==O&&q.di==G){D=q;break}j=j.next}if(null!=D){D.sleeping&&(D.sleeping=!1,D.next=this.pairs,this.pairs=D,D.first=!0);continue}null==o.space.ZPP_AABBPair.zpp_pool?D=new o.space.ZPP_AABBPair:(D=o.space.ZPP_AABBPair.zpp_pool,o.space.ZPP_AABBPair.zpp_pool=D.next,D.next=null),D.n1=M,D.n2=V,D.id=O,D.di=G,D.next=this.pairs,this.pairs=D,D.first=!0,F.pairs.inlined_add(D),B.pairs.inlined_add(D)}}else A.intersect(V.aabb)&&(null!=V.child1&&(V.child1.next=T,T=V.child1),null!=V.child2&&(V.child2.next=T,T=V.child2))}for(null!=this.stree.root&&(this.stree.root.next=T,T=this.stree.root);null!=T;){var Y,U=T;if(T=U.next,U.next=null,(Y=U)!=M)if(null==Y.child1){var W=Y.shape;if(W.body!=F.body&&(W.body.type!=o.util.ZPP_Flags.id_BodyType_STATIC||F.body.type!=o.util.ZPP_Flags.id_BodyType_STATIC)&&A.intersect(Y.aabb)){var J,K;F.id<W.id?(J=F.id,K=W.id):(J=W.id,K=F.id);var H;H=F.pairs.length<W.pairs.length?F:W;for(var X=null,Q=H.pairs.head;null!=Q;){var $=Q.elt;if($.id==J&&$.di==K){X=$;break}Q=Q.next}if(null!=X){X.sleeping&&(X.sleeping=!1,X.next=this.pairs,this.pairs=X,X.first=!0);continue}null==o.space.ZPP_AABBPair.zpp_pool?X=new o.space.ZPP_AABBPair:(X=o.space.ZPP_AABBPair.zpp_pool,o.space.ZPP_AABBPair.zpp_pool=X.next,X.next=null),X.n1=M,X.n2=Y,X.id=J,X.di=K,X.next=this.pairs,this.pairs=X,X.first=!0,F.pairs.inlined_add(X),W.pairs.inlined_add(X)}}else A.intersect(Y.aabb)&&(null!=Y.child1&&(Y.child1.next=T,T=Y.child1),null!=Y.child2&&(Y.child2.next=T,T=Y.child2))}}}for(var tt=null,nt=this.pairs;null!=nt;)if(nt.first||nt.n1.aabb.intersect(nt.n2.aabb)){var et=nt.n1.shape,it=et.body,rt=nt.n2.shape,st=rt.body;if(nt.first||!it.component.sleeping&&it.type!=o.util.ZPP_Flags.id_BodyType_STATIC||!st.component.sleeping&&st.type!=o.util.ZPP_Flags.id_BodyType_STATIC){if(nt.first=!1,et.aabb.intersect(rt.aabb)){var lt=nt.arb;nt.arb=n?t.narrowPhase(et,rt,!(it.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&st.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC),nt.arb,!1):t.continuousEvent(et,rt,!(it.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&st.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC),nt.arb,!1),null==nt.arb?null!=lt&&(lt.pair=null):nt.arb.pair=nt}tt=nt,nt=nt.next}else nt.sleeping=!0,null==tt?this.pairs=nt.next:tt.next=nt.next,nt=nt.next}else{null==tt?this.pairs=nt.next:tt.next=nt.next,nt.n1.shape.pairs.inlined_try_remove(nt),nt.n2.shape.pairs.inlined_try_remove(nt);var at=nt.next;null!=nt.arb&&(nt.arb.pair=null),nt.arb=null;var pt=nt;pt.n1=pt.n2=null,pt.sleeping=!1,pt.next=o.space.ZPP_AABBPair.zpp_pool,o.space.ZPP_AABBPair.zpp_pool=pt,nt=at}},clear:function(){for(;null!=this.syncs;){var t=this.syncs.snext;this.syncs.snext=null,this.syncs.first_sync&&(this.syncs.shape.node=null,this.syncs.shape.removedFromSpace(),this.syncs.shape=null),this.syncs=t}for(;null!=this.moves;){var n=this.moves.mnext;this.moves.mnext=null,this.moves.first_sync&&(this.moves.shape.node=null,this.moves.shape.removedFromSpace(),this.moves.shape=null),this.moves=n}for(;null!=this.pairs;){var e=this.pairs.next;null!=this.pairs.arb&&(this.pairs.arb.pair=null),this.pairs.arb=null,
this.pairs.n1.shape.pairs.inlined_try_remove(this.pairs),this.pairs.n2.shape.pairs.inlined_try_remove(this.pairs);var i=this.pairs;i.n1=i.n2=null,i.sleeping=!1,i.next=o.space.ZPP_AABBPair.zpp_pool,o.space.ZPP_AABBPair.zpp_pool=i,this.pairs=e}this.dtree.clear(),this.stree.clear()},shapesUnderPoint:function(t,n,e,i){this.sync_broadphase();var r,s=o.geom.ZPP_Vec2.get(t,n,null);if(r=null==i?new p.shape.ShapeList:i,null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new o.util.ZNPList_ZPP_AABBNode),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var l=this.treeStack.pop_unsafe();l.aabb.containsPoint(s)&&(null==l.child1?(null==e||l.shape.filter.shouldCollide(e))&&(l.shape.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?o.geom.ZPP_Collide.circleContains(l.shape.circle,s)&&r.push(l.shape.outer):o.geom.ZPP_Collide.polyContains(l.shape.polygon,s)&&r.push(l.shape.outer)):(null!=l.child1&&this.treeStack.add(l.child1),null!=l.child2&&this.treeStack.add(l.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new o.util.ZNPList_ZPP_AABBNode),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;){var a=this.treeStack.pop_unsafe();a.aabb.containsPoint(s)&&(null==a.child1?(null==e||a.shape.filter.shouldCollide(e))&&(a.shape.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?o.geom.ZPP_Collide.circleContains(a.shape.circle,s)&&r.push(a.shape.outer):o.geom.ZPP_Collide.polyContains(a.shape.polygon,s)&&r.push(a.shape.outer)):(null!=a.child1&&this.treeStack.add(a.child1),null!=a.child2&&this.treeStack.add(a.child2)))}var _=s;return null!=_.outer&&(_.outer.zpp_inner=null,_.outer=null),_._isimmutable=null,_._validate=null,_._invalidate=null,_.next=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=_,r},bodiesUnderPoint:function(t,n,e,i){this.sync_broadphase();var r,s=o.geom.ZPP_Vec2.get(t,n,null);if(r=null==i?new p.phys.BodyList:i,null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new o.util.ZNPList_ZPP_AABBNode),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var l=this.treeStack.pop_unsafe();if(l.aabb.containsPoint(s))if(null==l.child1){var a=l.shape.body.outer;r.has(a)||(null==e||l.shape.filter.shouldCollide(e))&&(l.shape.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?o.geom.ZPP_Collide.circleContains(l.shape.circle,s)&&r.push(a):o.geom.ZPP_Collide.polyContains(l.shape.polygon,s)&&r.push(a))}else null!=l.child1&&this.treeStack.add(l.child1),null!=l.child2&&this.treeStack.add(l.child2)}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new o.util.ZNPList_ZPP_AABBNode),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;){var _=this.treeStack.pop_unsafe();if(_.aabb.containsPoint(s))if(null==_.child1){var h=_.shape.body.outer;r.has(h)||(null==e||_.shape.filter.shouldCollide(e))&&(_.shape.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?o.geom.ZPP_Collide.circleContains(_.shape.circle,s)&&r.push(h):o.geom.ZPP_Collide.polyContains(_.shape.polygon,s)&&r.push(h))}else null!=_.child1&&this.treeStack.add(_.child1),null!=_.child2&&this.treeStack.add(_.child2)}var u=s;return null!=u.outer&&(u.outer.zpp_inner=null,u.outer=null),u._isimmutable=null,u._validate=null,u._invalidate=null,u.next=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=u,r},shapesInAABB:function(t,n,e,i,r){this.sync_broadphase(),this.updateAABBShape(t);var s,l=this.aabbShape.zpp_inner.aabb;if(s=null==r?new p.shape.ShapeList:r,null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new o.util.ZNPList_ZPP_AABBNode),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var a=this.treeStack.pop_unsafe();if(l.contains(a.aabb))if(null==a.child1)(null==i||a.shape.filter.shouldCollide(i))&&s.push(a.shape.outer);else for(null==this.treeStack2&&(this.treeStack2=new o.util.ZNPList_ZPP_AABBNode),this.treeStack2.add(a);null!=this.treeStack2.head;){var _=this.treeStack2.pop_unsafe();null==_.child1?(null==i||_.shape.filter.shouldCollide(i))&&s.push(_.shape.outer):(null!=_.child1&&this.treeStack2.add(_.child1),null!=_.child2&&this.treeStack2.add(_.child2))}else a.aabb.intersect(l)&&(null==a.child1?(null==i||a.shape.filter.shouldCollide(i))&&(n?e?o.geom.ZPP_Collide.containTest(this.aabbShape.zpp_inner,a.shape)&&s.push(a.shape.outer):l.contains(a.shape.aabb)?s.push(a.shape.outer):o.geom.ZPP_Collide.testCollide_safe(a.shape,this.aabbShape.zpp_inner)&&s.push(a.shape.outer):e&&!l.contains(a.shape.aabb)||s.push(a.shape.outer)):(null!=a.child1&&this.treeStack.add(a.child1),null!=a.child2&&this.treeStack.add(a.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new o.util.ZNPList_ZPP_AABBNode),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;){var h=this.treeStack.pop_unsafe();if(l.contains(h.aabb))if(null==h.child1)(null==i||h.shape.filter.shouldCollide(i))&&s.push(h.shape.outer);else for(null==this.treeStack2&&(this.treeStack2=new o.util.ZNPList_ZPP_AABBNode),this.treeStack2.add(h);null!=this.treeStack2.head;){var u=this.treeStack2.pop_unsafe();null==u.child1?(null==i||u.shape.filter.shouldCollide(i))&&s.push(u.shape.outer):(null!=u.child1&&this.treeStack2.add(u.child1),null!=u.child2&&this.treeStack2.add(u.child2))}else h.aabb.intersect(l)&&(null==h.child1?(null==i||h.shape.filter.shouldCollide(i))&&(n?e?o.geom.ZPP_Collide.containTest(this.aabbShape.zpp_inner,h.shape)&&s.push(h.shape.outer):l.contains(h.shape.aabb)?s.push(h.shape.outer):o.geom.ZPP_Collide.testCollide_safe(h.shape,this.aabbShape.zpp_inner)&&s.push(h.shape.outer):e&&!l.contains(h.shape.aabb)||s.push(h.shape.outer)):(null!=h.child1&&this.treeStack.add(h.child1),null!=h.child2&&this.treeStack.add(h.child2)))}return s},bodiesInAABB:function(t,n,e,i,r){this.sync_broadphase(),this.updateAABBShape(t);var s,l=this.aabbShape.zpp_inner.aabb;if(s=null==r?new p.phys.BodyList:r,null==this.failed&&(this.failed=new p.phys.BodyList),null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new o.util.ZNPList_ZPP_AABBNode),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var a=this.treeStack.pop_unsafe();if(l.contains(a.aabb))if(null==a.child1){if(null==i||a.shape.filter.shouldCollide(i)){var _=a.shape.body.outer;s.has(_)||s.push(_)}}else for(null==this.treeStack2&&(this.treeStack2=new o.util.ZNPList_ZPP_AABBNode),this.treeStack2.add(a);null!=this.treeStack2.head;){var h=this.treeStack2.pop_unsafe();if(null==h.child1){if(null==i||h.shape.filter.shouldCollide(i)){var u=h.shape.body.outer;s.has(u)||s.push(u)}}else null!=h.child1&&this.treeStack2.add(h.child1),null!=h.child2&&this.treeStack2.add(h.child2)}else if(a.aabb.intersect(l))if(null==a.child1){var d=a.shape.body.outer;if(null==i||a.shape.filter.shouldCollide(i))if(n)if(e){if(!this.failed.has(d)){var c=o.geom.ZPP_Collide.containTest(this.aabbShape.zpp_inner,a.shape);!s.has(d)&&c?s.push(d):c||(s.remove(d),this.failed.push(d))}}else!s.has(d)&&o.geom.ZPP_Collide.testCollide_safe(a.shape,this.aabbShape.zpp_inner)&&s.push(d);else if(e){if(!this.failed.has(d)){var P=l.contains(a.shape.aabb);!s.has(d)&&P?s.push(d):P||(s.remove(d),this.failed.push(d))}}else!s.has(d)&&l.contains(a.shape.aabb)&&s.push(d)}else null!=a.child1&&this.treeStack.add(a.child1),null!=a.child2&&this.treeStack.add(a.child2)}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new o.util.ZNPList_ZPP_AABBNode),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;){var f=this.treeStack.pop_unsafe();if(l.contains(f.aabb))if(null==f.child1){if(null==i||f.shape.filter.shouldCollide(i)){var z=f.shape.body.outer;s.has(z)||s.push(z)}}else for(null==this.treeStack2&&(this.treeStack2=new o.util.ZNPList_ZPP_AABBNode),this.treeStack2.add(f);null!=this.treeStack2.head;){var v=this.treeStack2.pop_unsafe();if(null==v.child1){if(null==i||v.shape.filter.shouldCollide(i)){var m=v.shape.body.outer;s.has(m)||s.push(m)}}else null!=v.child1&&this.treeStack2.add(v.child1),null!=v.child2&&this.treeStack2.add(v.child2)}else if(f.aabb.intersect(l))if(null==f.child1){var b=f.shape.body.outer;if(null==i||f.shape.filter.shouldCollide(i))if(n)if(e){if(!this.failed.has(b)){var y=o.geom.ZPP_Collide.containTest(this.aabbShape.zpp_inner,f.shape);!s.has(b)&&y?s.push(b):y||(s.remove(b),this.failed.push(b))}}else!s.has(b)&&o.geom.ZPP_Collide.testCollide_safe(f.shape,this.aabbShape.zpp_inner)&&s.push(b);else if(e){if(!this.failed.has(b)){var g=l.contains(f.shape.aabb);!s.has(b)&&g?s.push(b):g||(s.remove(b),this.failed.push(b))}}else!s.has(b)&&l.contains(f.shape.aabb)&&s.push(b)}else null!=f.child1&&this.treeStack.add(f.child1),null!=f.child2&&this.treeStack.add(f.child2)}return this.failed.clear(),s},shapesInCircle:function(t,n,e,i,r,s){this.sync_broadphase(),this.updateCircShape(t,n,e);var l,a=this.circShape.zpp_inner.aabb;if(l=null==s?new p.shape.ShapeList:s,null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new o.util.ZNPList_ZPP_AABBNode),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var _=this.treeStack.pop_unsafe();_.aabb.intersect(a)&&(null==_.child1?(null==r||_.shape.filter.shouldCollide(r))&&(i?o.geom.ZPP_Collide.containTest(this.circShape.zpp_inner,_.shape)&&l.push(_.shape.outer):o.geom.ZPP_Collide.testCollide_safe(_.shape,this.circShape.zpp_inner)&&l.push(_.shape.outer)):(null!=_.child1&&this.treeStack.add(_.child1),null!=_.child2&&this.treeStack.add(_.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new o.util.ZNPList_ZPP_AABBNode),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;){var h=this.treeStack.pop_unsafe();h.aabb.intersect(a)&&(null==h.child1?(null==r||h.shape.filter.shouldCollide(r))&&(i?o.geom.ZPP_Collide.containTest(this.circShape.zpp_inner,h.shape)&&l.push(h.shape.outer):o.geom.ZPP_Collide.testCollide_safe(h.shape,this.circShape.zpp_inner)&&l.push(h.shape.outer)):(null!=h.child1&&this.treeStack.add(h.child1),null!=h.child2&&this.treeStack.add(h.child2)))}return l},bodiesInCircle:function(t,n,e,i,r,s){this.sync_broadphase(),this.updateCircShape(t,n,e);var l,a=this.circShape.zpp_inner.aabb;if(l=null==s?new p.phys.BodyList:s,null==this.failed&&(this.failed=new p.phys.BodyList),null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new o.util.ZNPList_ZPP_AABBNode),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var _=this.treeStack.pop_unsafe();if(_.aabb.intersect(a))if(null==_.child1){var h=_.shape.body.outer;if(null==r||_.shape.filter.shouldCollide(r))if(i){if(!this.failed.has(h)){var u=o.geom.ZPP_Collide.containTest(this.circShape.zpp_inner,_.shape);!l.has(h)&&u?l.push(h):u||(l.remove(h),this.failed.push(h))}}else!l.has(h)&&o.geom.ZPP_Collide.testCollide_safe(_.shape,this.circShape.zpp_inner)&&l.push(h)}else null!=_.child1&&this.treeStack.add(_.child1),null!=_.child2&&this.treeStack.add(_.child2)}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new o.util.ZNPList_ZPP_AABBNode),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;){var d=this.treeStack.pop_unsafe();if(d.aabb.intersect(a))if(null==d.child1){var c=d.shape.body.outer;if(null==r||d.shape.filter.shouldCollide(r))if(i){if(!this.failed.has(c)){var P=o.geom.ZPP_Collide.containTest(this.circShape.zpp_inner,d.shape);!l.has(c)&&P?l.push(c):P||(l.remove(c),this.failed.push(c))}}else!l.has(c)&&o.geom.ZPP_Collide.testCollide_safe(d.shape,this.circShape.zpp_inner)&&l.push(c)}else null!=d.child1&&this.treeStack.add(d.child1),null!=d.child2&&this.treeStack.add(d.child2)}return this.failed.clear(),l},shapesInShape:function(t,n,e,i){this.sync_broadphase(),this.validateShape(t);var r,s=t.aabb;if(r=null==i?new p.shape.ShapeList:i,null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new o.util.ZNPList_ZPP_AABBNode),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var l=this.treeStack.pop_unsafe();l.aabb.intersect(s)&&(null==l.child1?(null==e||l.shape.filter.shouldCollide(e))&&(n?o.geom.ZPP_Collide.containTest(t,l.shape)&&r.push(l.shape.outer):o.geom.ZPP_Collide.testCollide_safe(l.shape,t)&&r.push(l.shape.outer)):(null!=l.child1&&this.treeStack.add(l.child1),null!=l.child2&&this.treeStack.add(l.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new o.util.ZNPList_ZPP_AABBNode),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;){var a=this.treeStack.pop_unsafe();a.aabb.intersect(s)&&(null==a.child1?(null==e||a.shape.filter.shouldCollide(e))&&(n?o.geom.ZPP_Collide.containTest(t,a.shape)&&r.push(a.shape.outer):o.geom.ZPP_Collide.testCollide_safe(a.shape,t)&&r.push(a.shape.outer)):(null!=a.child1&&this.treeStack.add(a.child1),null!=a.child2&&this.treeStack.add(a.child2)))}return r},bodiesInShape:function(t,n,e,i){this.sync_broadphase(),this.validateShape(t);var r,s=t.aabb;if(r=null==i?new p.phys.BodyList:i,null==this.failed&&(this.failed=new p.phys.BodyList),null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new o.util.ZNPList_ZPP_AABBNode),this.treeStack.add(this.stree.root);null!=this.treeStack.head;){var l=this.treeStack.pop_unsafe();if(l.aabb.intersect(s))if(null==l.child1){var a=l.shape.body.outer;if(null==e||l.shape.filter.shouldCollide(e))if(n){if(!this.failed.has(a)){var _=o.geom.ZPP_Collide.containTest(t,l.shape);!r.has(a)&&_?r.push(a):_||(r.remove(a),this.failed.push(a))}}else!r.has(a)&&o.geom.ZPP_Collide.testCollide_safe(l.shape,t)&&r.push(a)}else null!=l.child1&&this.treeStack.add(l.child1),null!=l.child2&&this.treeStack.add(l.child2)}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new o.util.ZNPList_ZPP_AABBNode),this.treeStack.add(this.dtree.root);null!=this.treeStack.head;){var h=this.treeStack.pop_unsafe();if(h.aabb.intersect(s))if(null==h.child1){var u=h.shape.body.outer;if(null==e||h.shape.filter.shouldCollide(e))if(n){if(!this.failed.has(u)){var d=o.geom.ZPP_Collide.containTest(t,h.shape);!r.has(u)&&d?r.push(u):d||(r.remove(u),this.failed.push(u))}}else!r.has(u)&&o.geom.ZPP_Collide.testCollide_safe(h.shape,t)&&r.push(u)}else null!=h.child1&&this.treeStack.add(h.child1),null!=h.child2&&this.treeStack.add(h.child2)}return this.failed.clear(),r},rayCast:function(t,n,e){null==this.openlist&&(this.openlist=new o.util.ZNPList_ZPP_AABBNode),this.sync_broadphase(),t.validate_dir();var i=t.maxdist;if(null!=this.dtree.root&&t.aabbtest(this.dtree.root.aabb)){var r=t.aabbsect(this.dtree.root.aabb);if(r>=0&&r<i){this.dtree.root.rayt=r;for(var s=null,l=this.openlist.head;null!=l;){var a=l.elt;if(this.dtree.root.rayt<a.rayt)break;s=l,l=l.next}this.openlist.inlined_insert(s,this.dtree.root)}}if(null!=this.stree.root&&t.aabbtest(this.stree.root.aabb)){var p=t.aabbsect(this.stree.root.aabb);if(p>=0&&p<i){this.stree.root.rayt=p;for(var _=null,h=this.openlist.head;null!=h;){var u=h.elt;if(this.stree.root.rayt<u.rayt)break;_=h,h=h.next}this.openlist.inlined_insert(_,this.stree.root)}}for(var d=null;null!=this.openlist.head;){var c=this.openlist.pop_unsafe();if(c.rayt>=i)break;if(null==c.child1){var P=c.shape;if(null==e||P.filter.shouldCollide(e)){var f;if(null!=(f=P.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.circlesect(P.circle,n,i):t.aabbtest(P.aabb)?t.polysect(P.polygon,n,i):null)){if(null!=f.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";if(i=f.zpp_inner.toiDistance,null!=d){if(null!=d.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";d.zpp_inner.free()}d=f}}}else{if(null!=c.child1&&t.aabbtest(c.child1.aabb)){var z=t.aabbsect(c.child1.aabb);if(z>=0&&z<i){c.child1.rayt=z;for(var v=null,m=this.openlist.head;null!=m;){var b=m.elt;if(c.child1.rayt<b.rayt)break;v=m,m=m.next}this.openlist.inlined_insert(v,c.child1)}}if(null!=c.child2&&t.aabbtest(c.child2.aabb)){var y=t.aabbsect(c.child2.aabb);if(y>=0&&y<i){c.child2.rayt=y;for(var g=null,x=this.openlist.head;null!=x;){var Z=x.elt;if(c.child2.rayt<Z.rayt)break;g=x,x=x.next}this.openlist.inlined_insert(g,c.child2)}}}}return this.openlist.clear(),d},rayMultiCast:function(t,n,e,i){null==this.openlist&&(this.openlist=new o.util.ZNPList_ZPP_AABBNode),this.sync_broadphase(),t.validate_dir();var r,s=t.maxdist>=Math.POSITIVE_INFINITY;if(r=null==i?new p.geom.RayResultList:i,null!=this.dtree.root&&t.aabbtest(this.dtree.root.aabb))if(s)this.openlist.add(this.dtree.root);else{var l=t.aabbsect(this.dtree.root.aabb);l>=0&&l<t.maxdist&&this.openlist.add(this.dtree.root)}if(null!=this.stree.root&&t.aabbtest(this.stree.root.aabb))if(s)this.openlist.add(this.stree.root);else{var a=t.aabbsect(this.stree.root.aabb);a>=0&&a<t.maxdist&&this.openlist.add(this.stree.root)}for(;null!=this.openlist.head;){var _=this.openlist.pop_unsafe();if(null==_.child1){var h=_.shape;(null==e||h.filter.shouldCollide(e))&&(h.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.circlesect2(h.circle,n,r):t.aabbtest(h.aabb)&&t.polysect2(h.polygon,n,r))}else{if(null!=_.child1&&t.aabbtest(_.child1.aabb))if(s)this.openlist.add(_.child1);else{var u=t.aabbsect(_.child1.aabb);u>=0&&u<t.maxdist&&this.openlist.add(_.child1)}if(null!=_.child2&&t.aabbtest(_.child2.aabb))if(s)this.openlist.add(_.child2);else{var d=t.aabbsect(_.child2.aabb);d>=0&&d<t.maxdist&&this.openlist.add(_.child2)}}}return this.openlist.clear(),r},__class__:o.space.ZPP_DynAABBPhase}),o.space.ZPP_Island=function(){this.waket=0,this.sleep=!1,this.comps=null,this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.comps=new o.util.ZNPList_ZPP_Component},o.space.ZPP_Island.__name__=!0,o.space.ZPP_Island.prototype={elem:function(){return this},begin:function(){return this.next},setbegin:function(t){this.next=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n;return t._inuse=!0,n=t,n.next=this.next,this.next=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.next;null!=n;){var e=n;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e;return n._inuse=!0,e=n,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.next;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.next,i=!1;null!=e;){if(e==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.next,i=!1;null!=e;){if(e==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;return null==t?(n=this.next,e=n.next,this.next=e,null==this.next&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0)),n._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){},inlined_clear:function(){},reverse:function(){for(var t=this.next,n=null;null!=t;){var e=t.next;t.next=n,this.next=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.next},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.next;null!=e;){if(e==t){n=!0;break}e=e.next}return n},front:function(){return this.next},back:function(){for(var t=this.next,n=t;null!=n;)t=n,n=n.next;return t},iterator_at:function(t){for(var n=this.next;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n:null},free:function(){},alloc:function(){this.waket=0},__class__:o.space.ZPP_Island},o.space.ZPP_Component=function(){this.woken=!1,this.waket=0,this.sleeping=!1,this.island=null,this.constraint=null,this.body=null,this.isBody=!1,this.rank=0,this.parent=null,this.next=null,this.sleeping=!1,this.island=null,this.parent=this,this.rank=0,this.woken=!1},o.space.ZPP_Component.__name__=!0,o.space.ZPP_Component.prototype={free:function(){this.body=null,this.constraint=null},alloc:function(){},reset:function(){this.sleeping=!1,this.island=null,this.parent=this,this.rank=0},__class__:o.space.ZPP_Component},o.space.ZPP_CallbackSet=function(){this.lazydel=!1,this.freed=!1,this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.int2=null,this.int1=null,this.di=0,this.id=0,this.arbiters=new o.util.ZNPList_ZPP_Arbiter},o.space.ZPP_CallbackSet.__name__=!0,o.space.ZPP_CallbackSet.get=function(t,n){var e;return null==o.space.ZPP_CallbackSet.zpp_pool?e=new o.space.ZPP_CallbackSet:(e=o.space.ZPP_CallbackSet.zpp_pool,o.space.ZPP_CallbackSet.zpp_pool=e.next,e.next=null),e.freed=!1,e.lazydel=!1,e.COLLISIONstate=o.util.ZPP_Flags.id_PreFlag_ACCEPT,e.COLLISIONstamp=0,e.SENSORstate=o.util.ZPP_Flags.id_PreFlag_ACCEPT,e.SENSORstamp=0,e.FLUIDstate=o.util.ZPP_Flags.id_PreFlag_ACCEPT,e.FLUIDstamp=0,t.id<n.id?(e.int1=t,e.int2=n):(e.int1=n,e.int2=t),e.id=e.int1.id,e.di=e.int2.id,e},o.space.ZPP_CallbackSet.prototype={elem:function(){return this},begin:function(){return this.next},setbegin:function(t){this.next=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n;return t._inuse=!0,n=t,n.next=this.next,this.next=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.next;null!=n;){var e=n;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e;return n._inuse=!0,e=n,null==t?(e.next=this.next,this.next=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.next;this.next=t.next,t._inuse=!1,null==this.next&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.next;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.next,i=!1;null!=e;){if(e==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.next,i=!1;null!=e;){if(e==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;return null==t?(n=this.next,e=n.next,this.next=e,null==this.next&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0)),n._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){},inlined_clear:function(){},reverse:function(){for(var t=this.next,n=null;null!=t;){var e=t.next;t.next=n,this.next=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.next},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.next;null!=e;){if(e==t){n=!0;break}e=e.next}return n},front:function(){return this.next},back:function(){for(var t=this.next,n=t;null!=n;)t=n,n=n.next;return t},iterator_at:function(t){for(var n=this.next;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n:null},free:function(){this.int1=this.int2=null,this.id=this.di=-1,this.freed=!0},alloc:function(){this.freed=!1,this.lazydel=!1,this.COLLISIONstate=o.util.ZPP_Flags.id_PreFlag_ACCEPT,this.COLLISIONstamp=0,this.SENSORstate=o.util.ZPP_Flags.id_PreFlag_ACCEPT,this.SENSORstamp=0,this.FLUIDstate=o.util.ZPP_Flags.id_PreFlag_ACCEPT,this.FLUIDstamp=0},add_arb:function(t){return!this.arbiters.inlined_has(t)&&(this.arbiters.inlined_add(t),!0)},try_remove_arb:function(t){return this.arbiters.inlined_try_remove(t)},remove_arb:function(t){this.arbiters.inlined_try_remove(t)},empty_arb:function(t){var n;n=!0;for(var e=this.arbiters.head;null!=e;){{if(0!=(e.elt.type&t)){n=!1;break}e=e.next}}return n},really_empty:function(){return null==this.arbiters.head},sleeping:function(){var t;t=!0;for(var n=this.arbiters.head;null!=n;){{if(!n.elt.sleeping){t=!1;break}n=n.next}}return t},__class__:o.space.ZPP_CallbackSet},o.space.ZPP_CbSetManager=function(t){this.space=null,this.cbsets=null,null==o.util.ZPP_Set_ZPP_CbSet.zpp_pool?this.cbsets=new o.util.ZPP_Set_ZPP_CbSet:(this.cbsets=o.util.ZPP_Set_ZPP_CbSet.zpp_pool,o.util.ZPP_Set_ZPP_CbSet.zpp_pool=this.cbsets.next,this.cbsets.next=null),this.cbsets.lt=o.callbacks.ZPP_CbSet.setlt,this.space=t},o.space.ZPP_CbSetManager.__name__=!0,o.space.ZPP_CbSetManager.prototype={get:function(t){if(null==t.head)return null;var n;null==o.callbacks.ZPP_CbSet.zpp_pool?n=new o.callbacks.ZPP_CbSet:(n=o.callbacks.ZPP_CbSet.zpp_pool,o.callbacks.ZPP_CbSet.zpp_pool=n.next,n.next=null);var e=n.cbTypes;n.cbTypes=t;var i,r=this.cbsets.find_weak(n);if(null!=r)i=r.data;else{var s=o.callbacks.ZPP_CbSet.get(t);this.cbsets.insert(s),s.manager=this,i=s}n.cbTypes=e;var l=n;return l.free(),l.next=o.callbacks.ZPP_CbSet.zpp_pool,o.callbacks.ZPP_CbSet.zpp_pool=l,i},remove:function(t){for(this.cbsets.remove(t);null!=t.cbpairs.head;){var n=t.cbpairs.pop_unsafe();n.a!=n.b&&(t==n.a?n.b.cbpairs.remove(n):n.a.cbpairs.remove(n));var e=n;e.a=e.b=null,e.listeners.clear(),e.next=o.callbacks.ZPP_CbSetPair.zpp_pool,o.callbacks.ZPP_CbSetPair.zpp_pool=e}t.manager=null},clear:function(){},validate:function(){if(!this.cbsets.empty()){for(var t=this.cbsets.parent;null!=t.prev;)t=t.prev;for(;null!=t;){if(t.data.validate(),null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}},pair:function(t,n){var e,i=null;e=t.cbpairs.length<n.cbpairs.length?t.cbpairs:n.cbpairs;for(var r=e.head;null!=r;){var s=r.elt;if(s.a==t&&s.b==n||s.a==n&&s.b==t){i=s;break}r=r.next}return null==i&&(i=o.callbacks.ZPP_CbSetPair.get(t,n),t.cbpairs.add(i),n!=t&&n.cbpairs.add(i)),i.zip_listeners&&(i.zip_listeners=!1,i.__validate()),i},valid_listener:function(t){return t.space==this.space},__class__:o.space.ZPP_CbSetManager},o.space.ZPP_Space=function(t,e){this.prelisteners=null,this.precb=null,this.continuous=!1,this.toiEvents=null,this.pre_dt=0,this.convexShapeList=null,this.cbsets=null,this.callbackset_list=null,this.callbacks=null,this.wrap_listeners=null,this.listeners=null,this.islands=null,this.staticsleep=null,this.wrap_livecon=null,this.live_constraints=null,this.wrap_live=null,this.live=null,this.wrap_arbiters=null,this.s_arbiters=null,this.f_arbiters=null,this.c_arbiters_false=null,this.c_arbiters_true=null,this.sortcontacts=!1,this.time=0,this.midstep=!1,this.stamp=0,this.global_ang_drag=0,this.global_lin_drag=0,this.__static=null,this.bphase=null,this.kinematics=null,this.wrap_constraints=null,this.constraints=null,this.wrap_compounds=null,this.compounds=null,this.wrap_bodies=null,this.bodies=null,this.wrap_gravity=null,this.gravityy=0,this.gravityx=0,this.userData=null,this.outer=null,this.toiEvents=new o.util.ZNPList_ZPP_ToiEvent,this.global_lin_drag=.015,this.global_ang_drag=.015,o.callbacks.ZPP_Callback.internal=!0,this.precb=new p.callbacks.PreCallback,this.precb.zpp_inner=new o.callbacks.ZPP_Callback,o.callbacks.ZPP_Callback.internal=!1,this.sortcontacts=!0,this.pre_dt=0,null==e||e==function(t){return null==o.util.ZPP_Flags.Broadphase_DYNAMIC_AABB_TREE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Broadphase_DYNAMIC_AABB_TREE=new p.space.Broadphase,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Broadphase_DYNAMIC_AABB_TREE}()?this.bphase=new o.space.ZPP_DynAABBPhase(this):e==function(t){return null==o.util.ZPP_Flags.Broadphase_SWEEP_AND_PRUNE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.Broadphase_SWEEP_AND_PRUNE=new p.space.Broadphase,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.Broadphase_SWEEP_AND_PRUNE}()&&(this.bphase=new o.space.ZPP_SweepPhase(this)),this.time=0;null!=t?(this.gravityx=t.x,this.gravityy=t.y):(this.gravityx=0,this.gravityy=0),this.bodies=new o.util.ZNPList_ZPP_Body,this.wrap_bodies=o.util.ZPP_BodyList.get(this.bodies),this.wrap_bodies.zpp_inner.adder=n(this,this.bodies_adder),this.wrap_bodies.zpp_inner.subber=n(this,this.bodies_subber),this.wrap_bodies.zpp_inner._modifiable=n(this,this.bodies_modifiable),this.compounds=new o.util.ZNPList_ZPP_Compound,this.wrap_compounds=o.util.ZPP_CompoundList.get(this.compounds),this.wrap_compounds.zpp_inner.adder=n(this,this.compounds_adder),this.wrap_compounds.zpp_inner.subber=n(this,this.compounds_subber),this.wrap_compounds.zpp_inner._modifiable=n(this,this.compounds_modifiable),this.kinematics=new o.util.ZNPList_ZPP_Body,this.c_arbiters_true=new o.util.ZNPList_ZPP_ColArbiter,this.c_arbiters_false=new o.util.ZNPList_ZPP_ColArbiter,this.f_arbiters=new o.util.ZNPList_ZPP_FluidArbiter,this.s_arbiters=new o.util.ZNPList_ZPP_SensorArbiter,this.islands=new o.space.ZPP_Island,this.live=new o.util.ZNPList_ZPP_Body,this.wrap_live=o.util.ZPP_BodyList.get(this.live,!0),this.staticsleep=new o.util.ZNPList_ZPP_Body,this.constraints=new o.util.ZNPList_ZPP_Constraint,this.wrap_constraints=o.util.ZPP_ConstraintList.get(this.constraints),this.wrap_constraints.zpp_inner.adder=n(this,this.constraints_adder),this.wrap_constraints.zpp_inner.subber=n(this,this.constraints_subber),this.wrap_constraints.zpp_inner._modifiable=n(this,this.constraints_modifiable),this.live_constraints=new o.util.ZNPList_ZPP_Constraint,this.wrap_livecon=o.util.ZPP_ConstraintList.get(this.live_constraints,!0),this.__static=o.phys.ZPP_Body.__static(),this.__static.zpp_inner.space=this,this.callbacks=new o.callbacks.ZPP_Callback,this.midstep=!1,this.listeners=new o.util.ZNPList_ZPP_Listener,this.wrap_listeners=o.util.ZPP_ListenerList.get(this.listeners),this.wrap_listeners.zpp_inner.adder=n(this,this.listeners_adder),this.wrap_listeners.zpp_inner.subber=n(this,this.listeners_subber),this.wrap_listeners.zpp_inner._modifiable=n(this,this.listeners_modifiable),this.callbackset_list=new o.space.ZPP_CallbackSet,this.mrca1=new o.util.ZNPList_ZPP_Interactor,this.mrca2=new o.util.ZNPList_ZPP_Interactor,this.prelisteners=new o.util.ZNPList_ZPP_InteractionListener,this.cbsets=new o.space.ZPP_CbSetManager(this)},o.space.ZPP_Space.__name__=!0,o.space.ZPP_Space.prototype={getgravity:function(){this.wrap_gravity=p.geom.Vec2.get(this.gravityx,this.gravityy,null),this.wrap_gravity.zpp_inner._inuse=!0,this.wrap_gravity.zpp_inner._invalidate=n(this,this.gravity_invalidate),this.wrap_gravity.zpp_inner._validate=n(this,this.gravity_validate)},gravity_invalidate:function(t){if(this.midstep)throw"Error: Space::gravity cannot be set during space step";this.gravityx=t.x,this.gravityy=t.y;for(var n=new o.util.ZNPList_ZPP_Compound,e=this.bodies.head;null!=e;){var i=e.elt,r=i;r.world||(r.component.waket=this.stamp+(this.midstep?0:1),r.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(r.kinematicDelaySleep=!0),r.component.sleeping&&this.really_wake(r,!1)),e=e.next}for(var s=this.compounds.head;null!=s;){var l=s.elt;n.add(l),s=s.next}for(;null!=n.head;){for(var a=n.pop_unsafe(),p=a.bodies.head;null!=p;){var _=p.elt,h=_;h.world||(h.component.waket=this.stamp+(this.midstep?0:1),h.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(h.kinematicDelaySleep=!0),h.component.sleeping&&this.really_wake(h,!1)),p=p.next}for(var u=a.compounds.head;null!=u;){var d=u.elt;n.add(d),u=u.next}}},gravity_validate:function(){this.wrap_gravity.zpp_inner.x=this.gravityx,this.wrap_gravity.zpp_inner.y=this.gravityy},clear:function(){for(;null!=this.listeners.head;){var t=this.listeners.pop_unsafe();this.remListener(t)}for(;null!=this.callbackset_list.next;){var n=this.callbackset_list.pop_unsafe();n.arbiters.clear();var e=n;e.int1=e.int2=null,e.id=e.di=-1,e.freed=!0,e.next=o.space.ZPP_CallbackSet.zpp_pool,o.space.ZPP_CallbackSet.zpp_pool=e}for(;null!=this.c_arbiters_true.head;){this.c_arbiters_true.pop_unsafe().retire()}for(;null!=this.c_arbiters_false.head;){this.c_arbiters_false.pop_unsafe().retire()}
for(;null!=this.s_arbiters.head;){this.s_arbiters.pop_unsafe().retire()}for(;null!=this.f_arbiters.head;){this.f_arbiters.pop_unsafe().retire()}for(this.bphase.clear();null!=this.bodies.head;){var i=this.bodies.pop_unsafe();if(null!=i.component){var r=i.component.island;if(null!=r){for(;null!=r.comps.head;){var s=r.comps.pop_unsafe();s.sleeping=!1,s.island=null,s.parent=s,s.rank=0}var l=r;l.next=o.space.ZPP_Island.zpp_pool,o.space.ZPP_Island.zpp_pool=l}}i.removedFromSpace(),i.space=null}for(;null!=this.constraints.head;){var a=this.constraints.pop_unsafe();if(null!=a.component){var p=a.component.island;if(null!=p){for(;null!=p.comps.head;){var _=p.comps.pop_unsafe();_.sleeping=!1,_.island=null,_.parent=_,_.rank=0}var h=p;h.next=o.space.ZPP_Island.zpp_pool,o.space.ZPP_Island.zpp_pool=h}}a.removedFromSpace(),a.space=null}this.kinematics.clear();for(var u=new o.util.ZNPList_ZPP_Compound;null!=this.compounds.head;){var d=this.compounds.pop_unsafe();u.add(d)}for(;null!=u.head;){var c=u.pop_unsafe();c.removedFromSpace(),c.space=null;for(var P=c.bodies.head;null!=P;){var f=P.elt;if(null!=f.component){var z=f.component.island;if(null!=z){for(;null!=z.comps.head;){var v=z.comps.pop_unsafe();v.sleeping=!1,v.island=null,v.parent=v,v.rank=0}var m=z;m.next=o.space.ZPP_Island.zpp_pool,o.space.ZPP_Island.zpp_pool=m}}f.removedFromSpace(),f.space=null,P=P.next}for(var b=c.constraints.head;null!=b;){var y=b.elt;if(null!=y.component){var g=y.component.island;if(null!=g){for(;null!=g.comps.head;){var x=g.comps.pop_unsafe();x.sleeping=!1,x.island=null,x.parent=x,x.rank=0}var Z=g;Z.next=o.space.ZPP_Island.zpp_pool,o.space.ZPP_Island.zpp_pool=Z}}y.removedFromSpace(),y.space=null,b=b.next}for(var w=c.compounds.head;null!=w;){var C=w.elt;u.add(C),w=w.next}}this.staticsleep.clear(),this.live.clear(),this.live_constraints.clear(),this.stamp=0,this.time=0,this.mrca1.clear(),this.mrca2.clear(),this.prelisteners.clear(),this.cbsets.clear()},bodies_adder:function(t){if(null!=t.zpp_inner.compound)throw"Error: Cannot set the space of a Body belonging to a Compound, only the root Compound space can be set";return t.zpp_inner.space!=this&&(null!=t.zpp_inner.space&&t.zpp_inner.space.outer.zpp_inner.wrap_bodies.remove(t),this.addBody(t.zpp_inner),!0)},bodies_subber:function(t){this.remBody(t.zpp_inner)},bodies_modifiable:function(){if(this.midstep)throw"Error: Space::bodies cannot be set during space step()"},compounds_adder:function(t){if(null!=t.zpp_inner.compound)throw"Error: Cannot set the space of an inner Compound, only the root Compound space can be set";return t.zpp_inner.space!=this&&(null!=t.zpp_inner.space&&t.zpp_inner.space.wrap_compounds.remove(t),this.addCompound(t.zpp_inner),!0)},compounds_subber:function(t){this.remCompound(t.zpp_inner)},compounds_modifiable:function(){if(this.midstep)throw"Error: Space::compounds cannot be set during space step()"},constraints_adder:function(t){if(null!=t.zpp_inner.compound)throw"Error: Cannot set the space of a Constraint belonging to a Compound, only the root Compound space can be set";return t.zpp_inner.space!=this&&(null!=t.zpp_inner.space&&t.zpp_inner.space.outer.zpp_inner.wrap_constraints.remove(t),this.addConstraint(t.zpp_inner),!0)},constraints_subber:function(t){this.remConstraint(t.zpp_inner)},constraints_modifiable:function(){if(this.midstep)throw"Error: Space::constraints cannot be set during space step()"},listeners_adder:function(t){return t.zpp_inner.space!=this&&(null!=t.zpp_inner.space&&t.zpp_inner.space.outer.zpp_inner.wrap_listeners.remove(t),this.addListener(t.zpp_inner),!0)},listeners_subber:function(t){this.remListener(t.zpp_inner)},listeners_modifiable:function(){if(this.midstep)throw"Error: Space::listeners cannot be set during space step()"},revoke_listener:function(t){},unrevoke_listener:function(t){},addListener:function(t){t.space=this,t.addedToSpace(),t.interaction},remListener:function(t){t.interaction,t.removedFromSpace(),t.space=null},add_callbackset:function(t){t.int1.cbsets.inlined_add(t),t.int2.cbsets.inlined_add(t),this.callbackset_list.inlined_add(t)},remove_callbackset:function(t){t.lazydel=!0,t.int1.cbsets.inlined_try_remove(t),t.int2.cbsets.inlined_try_remove(t)},transmitType:function(t,n){var e=t;e.world||(e.component.waket=this.stamp+(this.midstep?0:1),e.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(e.kinematicDelaySleep=!0),e.component.sleeping&&this.really_wake(e,!1)),t.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC?this.live.remove(t):t.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC?(this.kinematics.remove(t),this.staticsleep.remove(t)):t.type==o.util.ZPP_Flags.id_BodyType_STATIC&&this.staticsleep.remove(t),t.type=n,t.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&this.kinematics.add(t),t.type==o.util.ZPP_Flags.id_BodyType_STATIC&&this.static_validation(t),t.component.sleeping=!0;var i=t;i.world||(i.component.waket=this.stamp+(this.midstep?0:1),i.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(i.kinematicDelaySleep=!0),i.component.sleeping&&this.really_wake(i,!0))},added_shape:function(t,n){if(null==n&&(n=!1),!n){var e=t.body;e.world||(e.component.waket=this.stamp+(this.midstep?0:1),e.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(e.kinematicDelaySleep=!0),e.component.sleeping&&this.really_wake(e,!1))}this.bphase.insert(t),t.addedToSpace()},removed_shape:function(t,n){null==n&&(n=!1);var e=this,i=t.body;n||i.wake();for(var r=null,s=i.arbiters.head;null!=s;){var l=[s.elt];if(l[0].ws1==t||l[0].ws2==t){if(0!=l[0].present){this.MRCA_chains(l[0].ws1,l[0].ws2);for(var a=this.mrca1.head;null!=a;){for(var p=a.elt,_=this.mrca2.head;null!=_;){var h=_.elt,u=p.cbSet,d=h.cbSet;if(u.validate(),d.validate(),u.manager.pair(u,d).empty_intersection())_=_.next;else{var c=[o.phys.ZPP_Interactor.get(p,h)];c[0].remove_arb(l[0]),l[0].present--,u.manager.pair(u,d).forall(o.util.ZPP_Flags.id_CbEvent_END,function(t,n){return function(i){if(0!=(i.itype&n[0].type)&&t[0].empty_arb(i.itype)){var r=e.push_callback(i);r.event=o.util.ZPP_Flags.id_CbEvent_END,o.phys.ZPP_Interactor.int_callback(t[0],i,r),r.set=t[0]}}}(c,l)),null==c[0].arbiters.head&&this.remove_callbackset(c[0]),_=_.next}}a=a.next}}if(l[0].b1!=i&&l[0].b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var P=l[0].b1;P.world||(P.component.waket=this.stamp+(this.midstep?0:1),P.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(P.kinematicDelaySleep=!0),P.component.sleeping&&this.really_wake(P,!1))}if(l[0].b2!=i&&l[0].b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var f=l[0].b2;f.world||(f.component.waket=this.stamp+(this.midstep?0:1),f.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(f.kinematicDelaySleep=!0),f.component.sleeping&&this.really_wake(f,!1))}l[0].cleared=!0,null!=i&&l[0].b2!=i||l[0].b1.arbiters.inlined_try_remove(l[0]),null!=i&&l[0].b1!=i||l[0].b2.arbiters.inlined_try_remove(l[0]),null!=l[0].pair&&(l[0].pair.arb=null,l[0].pair=null),l[0].active=!1,this.f_arbiters.modified=!0,s=i.arbiters.erase(r)}else r=s,s=s.next}this.bphase.remove(t),t.removedFromSpace()},addConstraint:function(t){t.space=this,t.addedToSpace(),t.active&&(t.component.sleeping=!0,this.wake_constraint(t,!0))},remConstraint:function(t){t.active&&(this.wake_constraint(t,!0),this.live_constraints.remove(t)),t.removedFromSpace(),t.space=null},addCompound:function(t){t.space=this,t.addedToSpace();for(var n=t.bodies.head;null!=n;){var e=n.elt;this.addBody(e),n=n.next}for(var i=t.constraints.head;null!=i;){var r=i.elt;this.addConstraint(r),i=i.next}for(var s=t.compounds.head;null!=s;){var l=s.elt;this.addCompound(l),s=s.next}},remCompound:function(t){for(var n=t.bodies.head;null!=n;){var e=n.elt;this.remBody(e),n=n.next}for(var i=t.constraints.head;null!=i;){var r=i.elt;this.remConstraint(r),i=i.next}for(var s=t.compounds.head;null!=s;){var l=s.elt;this.remCompound(l),s=s.next}t.removedFromSpace(),t.space=null},addBody:function(t,n){null==n&&(n=-1),t.space=this,t.addedToSpace(),t.component.sleeping=!0;var e=t;e.world||(e.component.waket=this.stamp+(this.midstep?0:1),e.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(e.kinematicDelaySleep=!0),e.component.sleeping&&this.really_wake(e,!0));for(var i=t.shapes.head;null!=i;){var r=i.elt;this.added_shape(r,!0),i=i.next}t.type==o.util.ZPP_Flags.id_BodyType_STATIC?this.static_validation(t):t.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC||n!=o.util.ZPP_Flags.id_BodyType_KINEMATIC&&this.kinematics.add(t)},remBody:function(t,n){if(null==n&&(n=-1),t.type==o.util.ZPP_Flags.id_BodyType_STATIC){var e=t;e.world||(e.component.waket=this.stamp+(this.midstep?0:1),e.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(e.kinematicDelaySleep=!0),e.component.sleeping&&this.really_wake(e,!0)),this.staticsleep.remove(t)}else if(t.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var i=t;i.world||(i.component.waket=this.stamp+(this.midstep?0:1),i.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(i.kinematicDelaySleep=!0),i.component.sleeping&&this.really_wake(i,!0)),this.live.remove(t)}else{n!=o.util.ZPP_Flags.id_BodyType_KINEMATIC&&this.kinematics.remove(t);var r=t;r.world||(r.component.waket=this.stamp+(this.midstep?0:1),r.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(r.kinematicDelaySleep=!0),r.component.sleeping&&this.really_wake(r,!0)),this.staticsleep.remove(t)}for(var s=t.shapes.head;null!=s;){var l=s.elt;this.removed_shape(l,!0),s=s.next}t.removedFromSpace(),t.space=null},shapesUnderPoint:function(t,n,e,i){return this.bphase.shapesUnderPoint(t,n,e,i)},bodiesUnderPoint:function(t,n,e,i){return this.bphase.bodiesUnderPoint(t,n,e,i)},shapesInAABB:function(t,n,e,i,r){return this.bphase.shapesInAABB(t.zpp_inner,n,e,i,r)},bodiesInAABB:function(t,n,e,i,r){return this.bphase.bodiesInAABB(t.zpp_inner,n,e,i,r)},shapesInCircle:function(t,n,e,i,r){return this.bphase.shapesInCircle(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(),n,e,i,r)},bodiesInCircle:function(t,n,e,i,r){return this.bphase.bodiesInCircle(function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.x}(),function(n){if(null!=t&&t.zpp_disp)throw"Error: Vec2 has been disposed and cannot be used!";return t.zpp_inner.validate(),t.zpp_inner.y}(),n,e,i,r)},shapesInShape:function(t,n,e,i){return this.bphase.shapesInShape(t,n,e,i)},bodiesInShape:function(t,n,e,i){return this.bphase.bodiesInShape(t,n,e,i)},rayCast:function(t,n,e){return this.bphase.rayCast(t.zpp_inner,n,null==e?null:e.zpp_inner)},rayMultiCast:function(t,n,e,i){return this.bphase.rayMultiCast(t.zpp_inner,n,null==e?null:e.zpp_inner,i)},convexCast:function(t,n,e,i){var r;null==o.geom.ZPP_ToiEvent.zpp_pool?r=new o.geom.ZPP_ToiEvent:(r=o.geom.ZPP_ToiEvent.zpp_pool,o.geom.ZPP_ToiEvent.zpp_pool=r.next,r.next=null),r.failed=!1,r.s1=r.s2=null,r.arbiter=null,t.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.circle.validate_worldCOM():t.polygon.validate_gaxi();var s=t.body,l=s.posx,a=s.posy;s.sweepTime=0,s.sweep_angvel=s.angvel,s.sweepIntegrate(n);var _=s.posx,h=s.posy;t.validate_sweepRadius();var u,d=t.sweepRadius;null==o.geom.ZPP_AABB.zpp_pool?u=new o.geom.ZPP_AABB:(u=o.geom.ZPP_AABB.zpp_pool,o.geom.ZPP_AABB.zpp_pool=u.next,u.next=null),u.minx=function(t){var n=l,e=_;return n<e?n:e}()-d,u.maxx=function(t){var n=l,e=_;return n>e?n:e}()+d,u.miny=function(t){var n=a,e=h;return n<e?n:e}()-d,u.maxy=function(t){var n=a,e=h;return n>e?n:e}()+d;var c=this.convexShapeList=this.bphase.shapesInAABB(u,!1,!1,null==e?null:e.zpp_inner,this.convexShapeList),P=u;null!=P.outer&&(P.outer.zpp_inner=null,P.outer=null),P.wrap_min=P.wrap_max=null,P._invalidate=null,P._validate=null,P.next=o.geom.ZPP_AABB.zpp_pool,o.geom.ZPP_AABB.zpp_pool=P;var f=0,z=0;f=0,z=0;var v=0,m=0;v=0,m=0;var b,y=null,g=n+1;for(c.zpp_inner.valmod(),b=p.shape.ShapeIterator.get(c);b.hasNext();){var x;b.zpp_critical=!1,x=b.zpp_inner.at(b.zpp_i++),x!=t.outer&&(null!=x.zpp_inner.body?x.zpp_inner.body.outer:null)!=s.outer&&(r.s1=t,r.s2=x.zpp_inner,i?(x.zpp_inner.validate_sweepRadius(),(null!=x.zpp_inner.body?x.zpp_inner.body.outer:null).zpp_inner.sweep_angvel=(null!=x.zpp_inner.body?x.zpp_inner.body.outer:null).zpp_inner.angvel,(null!=x.zpp_inner.body?x.zpp_inner.body.outer:null).zpp_inner.sweepTime=0,o.geom.ZPP_SweepDistance.dynamicSweep(r,n,0,0,!0),(null!=x.zpp_inner.body?x.zpp_inner.body.outer:null).zpp_inner.sweepIntegrate(0),(null!=x.zpp_inner.body?x.zpp_inner.body.outer:null).zpp_inner.sweepValidate(x.zpp_inner)):o.geom.ZPP_SweepDistance.staticSweep(r,n,0,0),r.toi*=n,r.toi>0&&r.toi<g&&(g=r.toi,f=r.axis.x,z=r.axis.y,v=r.c2.x,m=r.c2.y,y=x))}c.clear();var Z=r;return Z.next=o.geom.ZPP_ToiEvent.zpp_pool,o.geom.ZPP_ToiEvent.zpp_pool=Z,s.sweepIntegrate(0),s.sweepValidate(t),g<=n?o.geom.ZPP_ConvexRayResult.getConvex(p.geom.Vec2.get(-f,-z,null),p.geom.Vec2.get(v,m,null),g,y):null},prepareCast:function(t){t.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.circle.validate_worldCOM():t.polygon.validate_gaxi()},convexMultiCast:function(t,n,e,i,r){var s;null==o.geom.ZPP_ToiEvent.zpp_pool?s=new o.geom.ZPP_ToiEvent:(s=o.geom.ZPP_ToiEvent.zpp_pool,o.geom.ZPP_ToiEvent.zpp_pool=s.next,s.next=null),s.failed=!1,s.s1=s.s2=null,s.arbiter=null,t.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.circle.validate_worldCOM():t.polygon.validate_gaxi();var l=t.body,a=l.posx,_=l.posy;l.sweepTime=0,l.sweep_angvel=l.angvel,l.sweepIntegrate(n);var h=l.posx,u=l.posy;t.validate_sweepRadius();var d,c=t.sweepRadius;null==o.geom.ZPP_AABB.zpp_pool?d=new o.geom.ZPP_AABB:(d=o.geom.ZPP_AABB.zpp_pool,o.geom.ZPP_AABB.zpp_pool=d.next,d.next=null),d.minx=function(t){var n=a,e=h;return n<e?n:e}()-c,d.maxx=function(t){var n=a,e=h;return n>e?n:e}()+c,d.miny=function(t){var n=_,e=u;return n<e?n:e}()-c,d.maxy=function(t){var n=_,e=u;return n>e?n:e}()+c;var P=this.convexShapeList=this.bphase.shapesInAABB(d,!1,!1,null==e?null:e.zpp_inner,this.convexShapeList),f=d;null!=f.outer&&(f.outer.zpp_inner=null,f.outer=null),f.wrap_min=f.wrap_max=null,f._invalidate=null,f._validate=null,f.next=o.geom.ZPP_AABB.zpp_pool,o.geom.ZPP_AABB.zpp_pool=f;var z;z=null==r?new p.geom.ConvexResultList:r;var v;for(P.zpp_inner.valmod(),v=p.shape.ShapeIterator.get(P);v.hasNext();){var m;if(v.zpp_critical=!1,(m=v.zpp_inner.at(v.zpp_i++))!=t.outer&&(null!=m.zpp_inner.body?m.zpp_inner.body.outer:null)!=l.outer&&(s.s1=t,s.s2=m.zpp_inner,i?(m.zpp_inner.validate_sweepRadius(),(null!=m.zpp_inner.body?m.zpp_inner.body.outer:null).zpp_inner.sweep_angvel=(null!=m.zpp_inner.body?m.zpp_inner.body.outer:null).zpp_inner.angvel,(null!=m.zpp_inner.body?m.zpp_inner.body.outer:null).zpp_inner.sweepTime=0,o.geom.ZPP_SweepDistance.dynamicSweep(s,n,0,0,!0),(null!=m.zpp_inner.body?m.zpp_inner.body.outer:null).zpp_inner.sweepIntegrate(0),(null!=m.zpp_inner.body?m.zpp_inner.body.outer:null).zpp_inner.sweepValidate(m.zpp_inner)):o.geom.ZPP_SweepDistance.staticSweep(s,n,0,0),s.toi*=n,s.toi>0)){for(var b=o.geom.ZPP_ConvexRayResult.getConvex(p.geom.Vec2.get(-s.axis.x,-s.axis.y,null),p.geom.Vec2.get(s.c2.x,s.c2.y,null),s.toi,m),y=null,g=z.zpp_inner.inner.head;null!=g;){var x=g.elt;if(function(t){if(null!=b.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return b.zpp_inner.toiDistance}()<function(t){if(null!=x.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";return x.zpp_inner.toiDistance}())break;y=g,g=g.next}z.zpp_inner.inner.inlined_insert(y,b)}}P.clear();var Z=s;return Z.next=o.geom.ZPP_ToiEvent.zpp_pool,o.geom.ZPP_ToiEvent.zpp_pool=Z,l.sweepIntegrate(0),l.sweepValidate(t),z},push_callback:function(t){var n;return null==o.callbacks.ZPP_Callback.zpp_pool?n=new o.callbacks.ZPP_Callback:(n=o.callbacks.ZPP_Callback.zpp_pool,o.callbacks.ZPP_Callback.zpp_pool=n.next,n.next=null),this.callbacks.push(n),n.listener=t,n},step:function(t,n,e){var i=this;if(this.midstep)throw"Error: ... REALLY?? you're going to call space.step() inside of space.step()? COME ON!!";if(this.time+=t,this.pre_dt=t,this.midstep=!0,this.stamp++,this.validation(),this.bphase.broadphase(this,!0),this.prestep(t),this.sortcontacts){var r=this.c_arbiters_false;if(null!=r.head&&null!=r.head.next){var s,l,a,p=r.head,_=null,h=null,u=null,d=null,c=1;do{for(s=0,h=p,_=p=null;null!=h;){for(s++,u=h,l=0,a=c;null!=u&&l<c;)l++,u=u.next;for(;l>0||a>0&&null!=u;)0==l?(d=u,u=u.next,a--):0==a||null==u?(d=h,h=h.next,l--):!h.elt.active||!u.elt.active||h.elt.oc1.dist<u.elt.oc1.dist?(d=h,h=h.next,l--):(d=u,u=u.next,a--),null!=_?_.next=d:p=d,_=d;h=u}_.next=null,c<<=1}while(s>1);r.head=p,r.modified=!0,r.pushmod=!0}}this.updateVel(t),this.warmStart(),this.iterateVel(n);for(var P=this.kinematics.head;null!=P;){var f=P.elt;f.pre_posx=f.posx,f.pre_posy=f.posy,f.pre_rot=f.rot,P=P.next}for(var z=this.live.head;null!=z;){var v=z.elt;v.pre_posx=v.posx,v.pre_posy=v.posy,v.pre_rot=v.rot,z=z.next}this.updatePos(t),this.continuous=!0,this.continuousCollisions(t),this.continuous=!1,this.iteratePos(e);for(var m=this.kinematics.head;null!=m;){var b=m.elt,y=!(b.posx==b.pre_posx&&b.posy==b.pre_posy),g=b.pre_rot!=b.rot;y&&b.invalidate_pos(),g&&b.invalidate_rot(),m=m.next}for(var x=this.live.head;null!=x;){var Z=x.elt,w=!(Z.posx==Z.pre_posx&&Z.posy==Z.pre_posy),C=Z.pre_rot!=Z.rot;w&&Z.invalidate_pos(),C&&Z.invalidate_rot(),x=x.next}for(var E=null,S=this.staticsleep.head;null!=S;){var N=S.elt;if(N.type!=o.util.ZPP_Flags.id_BodyType_KINEMATIC||0==N.velx&&0==N.vely&&0==N.angvel){if(N.kinematicDelaySleep){N.kinematicDelaySleep=!1,S=S.next;continue}N.component.sleeping=!0,S=this.staticsleep.inlined_erase(E)}else E=S,S=S.next}this.doForests(t),this.sleepArbiters(),this.midstep=!1;for(var k=null,M=this.callbackset_list.next;null!=M;){var I=[M];if(null!=I[0].arbiters.head){var F=[I[0].sleeping()];o.callbacks.ZPP_CbSet.find_all(I[0].int1.cbSet,I[0].int2.cbSet,o.util.ZPP_Flags.id_CbEvent_ONGOING,function(t,n){return function(e){if((!t[0]||e.allowSleepingCallbacks)&&!n[0].empty_arb(e.itype)){var r=i.push_callback(e);r.event=o.util.ZPP_Flags.id_CbEvent_ONGOING,o.phys.ZPP_Interactor.int_callback(n[0],e,r),r.set=n[0]}}}(F,I)),k=M,M=M.next}else{M=this.callbackset_list.inlined_erase(k);var A=I[0];A.int1=A.int2=null,A.id=A.di=-1,A.freed=!0,A.next=o.space.ZPP_CallbackSet.zpp_pool,o.space.ZPP_CallbackSet.zpp_pool=A}}for(;!this.callbacks.empty();){var T=this.callbacks.pop();if(T.listener.type==o.util.ZPP_Flags.id_ListenerType_BODY){T.listener.body.handler(T.wrapper_body())}else if(T.listener.type==o.util.ZPP_Flags.id_ListenerType_CONSTRAINT){var V=T.listener.constraint;V.handler(T.wrapper_con())}else if(T.listener.type==o.util.ZPP_Flags.id_ListenerType_INTERACTION){var L=T.listener.interaction;L.handleri(T.wrapper_int())}var B=T;B.int1=B.int2=null,B.body=null,B.constraint=null,B.listener=null,null!=B.wrap_arbiters&&(B.wrap_arbiters.zpp_inner.inner=null),B.set=null,B.next=o.callbacks.ZPP_Callback.zpp_pool,o.callbacks.ZPP_Callback.zpp_pool=B}},continuousCollisions:function(t){var n=2*Math.PI/t;this.bphase.broadphase(this,!1);for(var e=0;e<1&&null!=this.toiEvents.head;){for(var i=null,r=2,s=!1,l=null,a=null,_=this.toiEvents.head;null!=_;){var h=_.elt,u=h.s1.body,d=h.s2.body;if(u.sweepFrozen&&d.sweepFrozen){if(0==h.toi||!o.geom.ZPP_Collide.testCollide_safe(h.s1,h.s2)){_=this.toiEvents.erase(a);var c=h;c.next=o.geom.ZPP_ToiEvent.zpp_pool,o.geom.ZPP_ToiEvent.zpp_pool=c;continue}h.toi=0}if(h.frozen1!=u.sweepFrozen||h.frozen2!=d.sweepFrozen){if(h.kinematic){_=this.toiEvents.erase(a);var P=h;P.next=o.geom.ZPP_ToiEvent.zpp_pool,o.geom.ZPP_ToiEvent.zpp_pool=P;continue}if(h.frozen1=u.sweepFrozen,h.frozen2=d.sweepFrozen,h.frozen1){var f=h.s1;h.s1=h.s2,h.s2=f,h.frozen1=!1,h.frozen2=!0}if(o.geom.ZPP_SweepDistance.staticSweep(h,t,0,p.Config.collisionSlopCCD),h.toi<0){_=this.toiEvents.erase(a);var z=h;z.next=o.geom.ZPP_ToiEvent.zpp_pool,o.geom.ZPP_ToiEvent.zpp_pool=z;continue}}h.toi>=0&&(h.toi<r||!s&&h.kinematic)&&(i=h,r=h.toi,s=h.kinematic,l=a),a=_,_=_.next}if(null==i)break;this.toiEvents.erase(l),e=i.toi;var v=i.s1.body,m=i.s2.body;v.sweepFrozen||(v.sweepIntegrate(e*t),v.sweepValidate(i.s1)),m.sweepFrozen||(m.sweepIntegrate(e*t),m.sweepValidate(i.s2));var b=(i.arbiter,this.narrowPhase(i.s1,i.s2,!0,i.arbiter,!0));null==b?null!=i.arbiter&&null!=i.arbiter.pair&&(i.arbiter.pair.arb=null,i.arbiter.pair=null):this.presteparb(b,t,!0)||b.type==o.dynamics.ZPP_Arbiter.COL&&b.active&&0!=(b.immState&o.util.ZPP_Flags.id_ImmState_ACCEPT)&&(b.colarb.warmStart(),b.colarb.applyImpulseVel(),b.colarb.applyImpulseVel(),b.colarb.applyImpulseVel(),b.colarb.applyImpulseVel(),v.sweep_angvel=v.angvel%n,m.sweep_angvel=m.angvel%n),null!=b&&b.active&&0!=(b.immState&o.util.ZPP_Flags.id_ImmState_ACCEPT)&&b.type==o.dynamics.ZPP_Arbiter.COL&&(v.sweepFrozen||v.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC||(v.sweepFrozen=!0,i.failed?v.angvel=v.sweep_angvel=0:i.slipped?v.angvel=v.sweep_angvel*=p.Config.angularCCDSlipScale:v.angvel=v.sweep_angvel),m.sweepFrozen||m.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC||(m.sweepFrozen=!0,i.failed?m.angvel=m.sweep_angvel=0:i.slipped?m.angvel=m.sweep_angvel*=p.Config.angularCCDSlipScale:m.angvel=m.sweep_angvel));var y=i;y.next=o.geom.ZPP_ToiEvent.zpp_pool,o.geom.ZPP_ToiEvent.zpp_pool=y}for(;null!=this.toiEvents.head;){var g=this.toiEvents.pop_unsafe(),x=g;x.next=o.geom.ZPP_ToiEvent.zpp_pool,o.geom.ZPP_ToiEvent.zpp_pool=x}for(var Z=this.kinematics.head;null!=Z;){var w=Z.elt;w.sweepIntegrate(t),w.sweepTime=0,Z=Z.next}for(var C=this.live.head;null!=C;){var E=C.elt;E.sweepFrozen||E.sweepIntegrate(t),E.sweepTime=0,C=C.next}},continuousEvent:function(t,n,e,i,r){if(t.body.sweepFrozen&&n.body.sweepFrozen)return i;if(t.body.disableCCD||n.body.disableCCD)return i;if(null!=i&&null==i.colarb||this.interactionType(t,n,t.body,n.body)<=0)return i;var s=t.body,l=n.body;if(e||s.bullet||l.bullet){var a;null==o.geom.ZPP_ToiEvent.zpp_pool?a=new o.geom.ZPP_ToiEvent:(a=o.geom.ZPP_ToiEvent.zpp_pool,o.geom.ZPP_ToiEvent.zpp_pool=a.next,a.next=null),a.failed=!1,a.s1=a.s2=null,a.arbiter=null;var _=s.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC||l.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC;if(e&&!_)t.body.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC?(a.s2=t,a.s1=n):(a.s1=t,a.s2=n),a.kinematic=!1,o.geom.ZPP_SweepDistance.staticSweep(a,this.pre_dt,0,p.Config.collisionSlopCCD);else if(a.s1=t,a.s2=n,a.kinematic=_,a.s1.body.sweepFrozen||a.s2.body.sweepFrozen){if(a.s1.body.sweepFrozen){var h=a.s1;a.s1=a.s2,a.s2=h,a.frozen1=!1,a.frozen2=!0}o.geom.ZPP_SweepDistance.staticSweep(a,this.pre_dt,0,p.Config.collisionSlopCCD)}else o.geom.ZPP_SweepDistance.dynamicSweep(a,this.pre_dt,0,p.Config.collisionSlopCCD);if(e&&a.toi<0||a.failed){var u=a;u.next=o.geom.ZPP_ToiEvent.zpp_pool,o.geom.ZPP_ToiEvent.zpp_pool=u}else this.toiEvents.add(a),a.frozen1=a.s1.body.sweepFrozen,a.frozen2=a.s2.body.sweepFrozen,a.arbiter=null!=i?i.colarb:null}return i},bodyCbWake:function(t){if(t.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&null!=t.cbSet)if(this.midstep)for(var n=t.cbSet.bodylisteners.head;null!=n;){var e=n.elt;if(e.event==o.util.ZPP_Flags.id_CbEvent_WAKE){var i=this.push_callback(e);i.event=o.util.ZPP_Flags.id_CbEvent_WAKE,i.body=t,n=n.next}else n=n.next}else t.component.woken=!0},bodyCbSleep:function(t){if(t.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&null!=t.cbSet)for(var n=t.cbSet.bodylisteners.head;null!=n;){var e=n.elt;if(e.event==o.util.ZPP_Flags.id_CbEvent_SLEEP){var i=this.push_callback(e);i.event=o.util.ZPP_Flags.id_CbEvent_SLEEP,i.body=t,n=n.next}else n=n.next}},constraintCbWake:function(t){if(null!=t.cbSet)if(this.midstep)for(var n=t.cbSet.conlisteners.head;null!=n;){var e=n.elt;if(e.event==o.util.ZPP_Flags.id_CbEvent_WAKE){var i=this.push_callback(e);i.event=o.util.ZPP_Flags.id_CbEvent_WAKE,i.constraint=t,n=n.next}else n=n.next}else t.component.woken=!0},constraintCbSleep:function(t){if(null!=t.cbSet)for(var n=t.cbSet.conlisteners.head;null!=n;){var e=n.elt;if(e.event==o.util.ZPP_Flags.id_CbEvent_SLEEP){var i=this.push_callback(e);i.event=o.util.ZPP_Flags.id_CbEvent_SLEEP,i.constraint=t,n=n.next}else n=n.next}},constraintCbBreak:function(t){if(null!=t.cbSet)for(var n=t.cbSet.conlisteners.head;null!=n;){var e=n.elt;if(e.event==o.util.ZPP_Flags.id_CbEvent_BREAK){var i=this.push_callback(e);i.event=o.util.ZPP_Flags.id_CbEvent_BREAK,i.constraint=t,n=n.next}else n=n.next}},nullListenerType:function(t,n){for(var e=new o.util.ZNPList_ZPP_Interactor,i=t.interactors.head;null!=i;){var r=i.elt;e.add(r),i=i.next}if(t!=n)for(var s=n.interactors.head;null!=s;){var l=s.elt;e.add(l),s=s.next}for(;null!=e.head;){var a=e.pop_unsafe();if(null!=a.icompound){for(var p=a.icompound,_=p.bodies.head;null!=_;){var h=_.elt;e.add(h),_=_.next}for(var u=p.compounds.head;null!=u;){var d=u.elt;e.add(d),u=u.next}}else{var c;c=null!=a.ibody?a.ibody:a.ishape.body;var P;P=null!=a.ishape?a.ishape:null;for(var f=c.arbiters.head;null!=f;){var z=f.elt;if(0!=z.present)if(null==P||z.ws1==P||z.ws2==P){this.MRCA_chains(z.ws1,z.ws2);for(var v=this.mrca1.head;null!=v;){var m=v.elt;if(m.cbSet==t||m.cbSet==n){for(var b=this.mrca2.head;null!=b;){var y=b.elt;if(m.cbSet==t&&y.cbSet!=n||m.cbSet==n&&y.cbSet!=t)b=b.next;else{var g=o.phys.ZPP_Interactor.get(m,y);if(null!=g){for(;null!=g.arbiters.head;){var x=g.arbiters.pop_unsafe();x.present--}this.remove_callbackset(g)}b=b.next}}v=v.next}else v=v.next}f=f.next}else f=f.next;else f=f.next}}}},nullInteractorType:function(t,n){if(null==n&&(n=t),null!=t.icompound){for(var e=t.icompound,i=e.bodies.head;null!=i;){var r=i.elt;this.nullInteractorType(r,n),i=i.next}for(var s=e.compounds.head;null!=s;){var l=s.elt;this.nullInteractorType(l,n),s=s.next}}else{var a;a=null!=t.ibody?t.ibody:t.ishape.body;var p;p=null!=t.ishape?t.ishape:null;for(var _=a.arbiters.head;null!=_;){var h=_.elt;if(0!=h.present)if(null==p||h.ws1==p||h.ws2==p){this.MRCA_chains(h.ws1,h.ws2);for(var u=this.mrca1.head;null!=u;){for(var d=u.elt,c=this.mrca2.head;null!=c;){var P=c.elt;if(d==n||P==n){var f=o.phys.ZPP_Interactor.get(d,P);null!=f&&(h.present--,f.remove_arb(h),null==f.arbiters.head&&this.remove_callbackset(f)),c=c.next}else c=c.next}u=u.next}_=_.next}else _=_.next;else _=_.next}}},freshListenerType:function(t,n){for(var e=new o.util.ZNPList_ZPP_Interactor,i=t.interactors.head;null!=i;){var r=i.elt;e.add(r),i=i.next}if(t!=n)for(var s=n.interactors.head;null!=s;){var l=s.elt;e.add(l),s=s.next}for(;null!=e.head;){var a=e.pop_unsafe();if(null!=a.icompound){for(var p=a.icompound,_=p.bodies.head;null!=_;){var h=_.elt;e.add(h),_=_.next}for(var u=p.compounds.head;null!=u;){var d=u.elt;e.add(d),u=u.next}}else{var c;c=null!=a.ibody?a.ibody:a.ishape.body;var P;P=null!=a.ishape?a.ishape:null;for(var f=c.arbiters.head;null!=f;){var z=f.elt;if(z.presentable)if(null==P||z.ws1==P||z.ws2==P){this.MRCA_chains(z.ws1,z.ws2);for(var v=this.mrca1.head;null!=v;){var m=v.elt;if(m.cbSet==t||m.cbSet==n){for(var b=this.mrca2.head;null!=b;){var y=b.elt;if(m.cbSet==t&&y.cbSet!=n||m.cbSet==n&&y.cbSet!=t)b=b.next;else{var g=o.phys.ZPP_Interactor.get(m,y);null==g&&(g=o.space.ZPP_CallbackSet.get(m,y),this.add_callbackset(g)),!g.arbiters.inlined_has(z)&&function(t){return g.arbiters.inlined_add(z),!0}()&&z.present++,b=b.next}}v=v.next}else v=v.next}f=f.next}else f=f.next;else f=f.next}}}},freshInteractorType:function(t,n){if(null==n&&(n=t),null!=t.icompound){for(var e=t.icompound,i=e.bodies.head;null!=i;){var r=i.elt;this.freshInteractorType(r,n),i=i.next}for(var s=e.compounds.head;null!=s;){var l=s.elt;this.freshInteractorType(l,n),s=s.next}}else{var a;a=null!=t.ibody?t.ibody:t.ishape.body;var p;p=null!=t.ishape?t.ishape:null;for(var _=a.arbiters.head;null!=_;){var h=_.elt;if(h.presentable)if(null==p||h.ws1==p||h.ws2==p){this.MRCA_chains(h.ws1,h.ws2);for(var u=this.mrca1.head;null!=u;){for(var d=u.elt,c=this.mrca2.head;null!=c;){var P=c.elt;if(d==n||P==n){var f=d.cbSet,z=P.cbSet;if(f.validate(),z.validate(),!f.manager.pair(f,z).empty_intersection()){var v=o.phys.ZPP_Interactor.get(d,P);null==v&&(v=o.space.ZPP_CallbackSet.get(d,P),this.add_callbackset(v)),!v.arbiters.inlined_has(h)&&function(t){return v.arbiters.inlined_add(h),!0}()&&h.present++}c=c.next}else c=c.next}u=u.next}_=_.next}else _=_.next;else _=_.next}}},wakeCompound:function(t){for(var n=t.bodies.head;null!=n;){var e=n.elt,i=e;i.world||(i.component.waket=this.stamp+(this.midstep?0:1),i.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(i.kinematicDelaySleep=!0),i.component.sleeping&&this.really_wake(i,!1)),n=n.next}for(var r=t.constraints.head;null!=r;){var s=r.elt;this.wake_constraint(s),r=r.next}for(var l=t.compounds.head;null!=l;){var a=l.elt;this.wakeCompound(a),l=l.next}},wakeIsland:function(t){for(;null!=t.comps.head;){var n=t.comps.pop_unsafe();if(n.waket=this.stamp+(this.midstep?0:1),n.isBody){var e=n.body;this.live.add(e);for(var i=e.arbiters.head;null!=i;){var r=i.elt;if(r.sleeping)if(r.sleeping=!1,r.up_stamp+=this.stamp-r.sleep_stamp,r.type==o.dynamics.ZPP_Arbiter.COL){var s=r.colarb;s.stat?this.c_arbiters_true.inlined_add(s):this.c_arbiters_false.inlined_add(s)}else r.type==o.dynamics.ZPP_Arbiter.FLUID?this.f_arbiters.inlined_add(r.fluidarb):this.s_arbiters.inlined_add(r.sensorarb);i=i.next}if(this.bodyCbWake(e),n.sleeping=!1,n.island=null,n.parent=n,n.rank=0,e.type!=o.util.ZPP_Flags.id_BodyType_STATIC)for(var l=e.shapes.head;null!=l;){var a=l.elt;null!=a.node&&this.bphase.sync(a),l=l.next}}else{var p=n.constraint;this.live_constraints.inlined_add(p),this.constraintCbWake(p),n.sleeping=!1,n.island=null,n.parent=n,n.rank=0}}var _=t;_.next=o.space.ZPP_Island.zpp_pool,o.space.ZPP_Island.zpp_pool=_},non_inlined_wake:function(t,n){null==n&&(n=!1);var e=t;e.world||(e.component.waket=this.stamp+(this.midstep?0:1),e.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(e.kinematicDelaySleep=!0),e.component.sleeping&&this.really_wake(e,n))},really_wake:function(t,n){if(null==n&&(n=!1),null==t.component.island){t.component.sleeping=!1,t.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC||t.type==o.util.ZPP_Flags.id_BodyType_STATIC?this.staticsleep.inlined_add(t):this.live.inlined_add(t);for(var e=t.constraints.head;null!=e;){var i=e.elt;i.space==this&&this.wake_constraint(i),e=e.next}for(var r=t.arbiters.head;null!=r;){var s=r.elt;if(s.sleeping)if(s.sleeping=!1,s.up_stamp+=this.stamp+(this.midstep?0:1)-s.sleep_stamp,s.type==o.dynamics.ZPP_Arbiter.COL){var l=s.colarb;l.stat?this.c_arbiters_true.inlined_add(l):this.c_arbiters_false.inlined_add(l)}else s.type==o.dynamics.ZPP_Arbiter.FLUID?this.f_arbiters.inlined_add(s.fluidarb):this.s_arbiters.inlined_add(s.sensorarb);if(s.type!=o.dynamics.ZPP_Arbiter.SENSOR&&!s.cleared&&s.up_stamp>=this.stamp&&0!=(s.immState&o.util.ZPP_Flags.id_ImmState_ACCEPT)){if(s.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&s.b1.component.sleeping){var a=s.b1;a.world||(a.component.waket=this.stamp+(this.midstep?0:1),a.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(a.kinematicDelaySleep=!0),a.component.sleeping&&this.really_wake(a,!1))}if(s.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&s.b2.component.sleeping){var p=s.b2;p.world||(p.component.waket=this.stamp+(this.midstep?0:1),p.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(p.kinematicDelaySleep=!0),p.component.sleeping&&this.really_wake(p,!1))}}r=r.next}if(n||t.type!=o.util.ZPP_Flags.id_BodyType_DYNAMIC||this.bodyCbWake(t),!n&&!this.bphase.is_sweep&&t.type!=o.util.ZPP_Flags.id_BodyType_STATIC)for(var _=t.shapes.head;null!=_;){var h=_.elt;null!=h.node&&this.bphase.sync(h),_=_.next}}else this.wakeIsland(t.component.island)},wake_constraint:function(t,n){return null==n&&(n=!1),!!t.active&&(t.component.waket=this.stamp+(this.midstep?0:1),!!t.component.sleeping&&(null==t.component.island?(t.component.sleeping=!1,this.live_constraints.inlined_add(t),t.wake_connected(),n||this.constraintCbWake(t)):this.wakeIsland(t.component.island),!0))},doForests:function(t){for(var n=this.c_arbiters_false.head;null!=n;){var e=n.elt
;if(!e.cleared&&e.up_stamp==this.stamp&&0!=(e.immState&o.util.ZPP_Flags.id_ImmState_ACCEPT)&&e.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&e.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var i;if(e.b1.component==e.b1.component.parent)i=e.b1.component;else{for(var r=e.b1.component,s=null;r!=r.parent;){var l=r.parent;r.parent=s,s=r,r=l}for(;null!=s;){var a=s.parent;s.parent=r,s=a}i=r}var p;if(e.b2.component==e.b2.component.parent)p=e.b2.component;else{for(var _=e.b2.component,h=null;_!=_.parent;){var u=_.parent;_.parent=h,h=_,_=u}for(;null!=h;){var d=h.parent;h.parent=_,h=d}p=_}i!=p&&(i.rank<p.rank?i.parent=p:i.rank>p.rank?p.parent=i:(p.parent=i,i.rank++))}n=n.next}for(var c=this.f_arbiters.head;null!=c;){var P=c.elt;if(!P.cleared&&P.up_stamp==this.stamp&&0!=(P.immState&o.util.ZPP_Flags.id_ImmState_ACCEPT)&&P.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&P.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var f;if(P.b1.component==P.b1.component.parent)f=P.b1.component;else{for(var z=P.b1.component,v=null;z!=z.parent;){var m=z.parent;z.parent=v,v=z,z=m}for(;null!=v;){var b=v.parent;v.parent=z,v=b}f=z}var y;if(P.b2.component==P.b2.component.parent)y=P.b2.component;else{for(var g=P.b2.component,x=null;g!=g.parent;){var Z=g.parent;g.parent=x,x=g,g=Z}for(;null!=x;){var w=x.parent;x.parent=g,x=w}y=g}f!=y&&(f.rank<y.rank?f.parent=y:f.rank>y.rank?y.parent=f:(y.parent=f,f.rank++))}c=c.next}for(var C=this.live_constraints.head;null!=C;){C.elt.forest(),C=C.next}for(;null!=this.live.head;){var E,S=this.live.inlined_pop_unsafe(),N=S.component;if(N==N.parent)E=N;else{for(var k=N,M=null;k!=k.parent;){var I=k.parent;k.parent=M,M=k,k=I}for(;null!=M;){var F=M.parent;M.parent=k,M=F}E=k}null==E.island&&(null==o.space.ZPP_Island.zpp_pool?E.island=new o.space.ZPP_Island:(E.island=o.space.ZPP_Island.zpp_pool,o.space.ZPP_Island.zpp_pool=E.island.next,E.island.next=null),E.island.waket=0,this.islands.inlined_add(E.island),E.island.sleep=!0),N.island=E.island,N.island.comps.inlined_add(N);var A=S.atRest(t);N.island.sleep=N.island.sleep&&A,N.waket>N.island.waket&&(N.island.waket=N.waket)}for(;null!=this.live_constraints.head;){var T,V=this.live_constraints.inlined_pop_unsafe(),L=V.component;if(L==L.parent)T=L;else{for(var B=L,O=null;B!=B.parent;){var G=B.parent;B.parent=O,O=B,B=G}for(;null!=O;){var R=O.parent;O.parent=B,O=R}T=B}L.island=T.island,L.island.comps.inlined_add(L),L.waket>L.island.waket&&(L.island.waket=L.waket)}for(;null!=this.islands.next;){var D=this.islands.inlined_pop_unsafe();if(D.sleep)for(var j=D.comps.head;null!=j;){var q=j.elt;if(q.isBody){var Y=q.body;Y.velx=0,Y.vely=0,Y.angvel=0,q.sleeping=!0;for(var U=Y.shapes.head;null!=U;){var W=U.elt;this.bphase.sync(W),U=U.next}this.bodyCbSleep(Y)}else{var J=q.constraint;this.constraintCbSleep(J),q.sleeping=!0}j=j.next}else{for(;null!=D.comps.head;){var K=D.comps.inlined_pop_unsafe();K.waket=D.waket,K.isBody?this.live.inlined_add(K.body):this.live_constraints.inlined_add(K.constraint),K.sleeping=!1,K.island=null,K.parent=K,K.rank=0}var H=D;H.next=o.space.ZPP_Island.zpp_pool,o.space.ZPP_Island.zpp_pool=H}}},sleepArbiters:function(){var t=null,n=this.c_arbiters_true,e=n.head,i=null!=this.c_arbiters_false;for(i&&null==e&&(i=!1,e=this.c_arbiters_false.head,n=this.c_arbiters_false,t=null);null!=e;){var r=e.elt;r.b1.component.sleeping&&r.b2.component.sleeping?(r.sleep_stamp=this.stamp,r.sleeping=!0,e=n.inlined_erase(t),i&&null==e&&(i=!1,e=this.c_arbiters_false.head,n=this.c_arbiters_false,t=null)):(t=e,e=e.next,i&&null==e&&(i=!1,e=this.c_arbiters_false.head,n=this.c_arbiters_false,t=null))}var s=null,l=this.f_arbiters,a=l.head,p=!1;for(p&&null==a&&(p=!1,l=null,s=null);null!=a;){var o=a.elt;o.b1.component.sleeping&&o.b2.component.sleeping?(o.sleep_stamp=this.stamp,o.sleeping=!0,a=l.inlined_erase(s),p&&null==a&&(p=!1,l=null,s=null)):(s=a,a=a.next,p&&null==a&&(p=!1,l=null,s=null))}var _=null,h=this.s_arbiters,u=h.head,d=!1;for(d&&null==u&&(d=!1,h=null,_=null);null!=u;){var c=u.elt;c.b1.component.sleeping&&c.b2.component.sleeping?(c.sleep_stamp=this.stamp,c.sleeping=!0,u=h.inlined_erase(_),d&&null==u&&(d=!1,h=null,_=null)):(_=u,u=u.next,d&&null==u&&(d=!1,h=null,_=null))}},static_validation:function(t){if(null!=t.shapes.head&&t.validate_aabb(),t.validate_mass(),t.validate_inertia(),0!=t.velx||0!=t.vely||0!=t.angvel)throw"Error: Static body cannot have any real velocity, only kinematic or surface velocities";for(var n=t.shapes.head;null!=n;){var e=n.elt;if(e.type==o.util.ZPP_Flags.id_ShapeType_POLYGON){e.polygon.splice_collinear();var i=e.polygon.valid();if(i!=function(t){return null==o.util.ZPP_Flags.ValidationResult_VALID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_VALID=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ValidationResult_VALID}())throw"Error: Cannot simulate with an invalid Polygon : "+e.polygon.outer.toString()+" is invalid : "+i.toString();e.polygon.validate_gaxi()}n=n.next}t.sweepFrozen=!0},validation:function(){this.cbsets.validate();for(var t=this.live.head;null!=t;){var n=t.elt;n.sweepRadius=0;for(var e=n.shapes.head;null!=e;){var i=e.elt;if(i.type==o.util.ZPP_Flags.id_ShapeType_POLYGON){i.polygon.splice_collinear();var r=i.polygon.valid();if(r!=function(t){return null==o.util.ZPP_Flags.ValidationResult_VALID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_VALID=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ValidationResult_VALID}())throw"Error: Cannot simulate with an invalid Polygon : "+i.polygon.outer.toString()+" is invalid : "+r.toString();i.polygon.validate_gaxi()}i.validate_sweepRadius(),i.sweepRadius>n.sweepRadius&&(n.sweepRadius=i.sweepRadius),e=e.next}if(n.validate_mass(),n.validate_inertia(),null!=n.shapes.head&&(n.validate_aabb(),n.validate_worldCOM()),n.validate_gravMass(),n.zip_axis&&(n.zip_axis=!1,n.axisx=Math.sin(n.rot),n.axisy=Math.cos(n.rot)),!n.nomove&&n.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&0==n.mass)throw"Error: Dynamic Body cannot be simulated with 0 mass unless allowMovement is false";if(!n.norotate&&n.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&0==n.inertia)throw"Error: Dynamic Body cannot be simulated with 0 inertia unless allowRotation is false";if(n.component.woken&&null!=n.cbSet)for(var s=n.cbSet.bodylisteners.head;null!=s;){var l=s.elt;if(l.event==o.util.ZPP_Flags.id_CbEvent_WAKE){var a=this.push_callback(l);a.event=o.util.ZPP_Flags.id_CbEvent_WAKE,a.body=n,s=s.next}else s=s.next}n.component.woken=!1;for(var _=n.shapes.head;null!=_;){var h=_.elt;this.bphase.sync(h),_=_.next}t=t.next}for(var u=this.kinematics.head;null!=u;){var d=u.elt;d.sweepRadius=0;for(var c=d.shapes.head;null!=c;){var P=c.elt;if(P.type==o.util.ZPP_Flags.id_ShapeType_POLYGON){P.polygon.splice_collinear();var f=P.polygon.valid();if(f!=function(t){return null==o.util.ZPP_Flags.ValidationResult_VALID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ValidationResult_VALID=new p.shape.ValidationResult,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ValidationResult_VALID}())throw"Error: Cannot simulate with an invalid Polygon : "+P.polygon.outer.toString()+" is invalid : "+f.toString();P.polygon.validate_gaxi()}P.validate_sweepRadius(),P.sweepRadius>d.sweepRadius&&(d.sweepRadius=P.sweepRadius),c=c.next}if(d.validate_mass(),d.validate_inertia(),null!=d.shapes.head&&(d.validate_aabb(),d.validate_worldCOM()),d.validate_gravMass(),d.zip_axis&&(d.zip_axis=!1,d.axisx=Math.sin(d.rot),d.axisy=Math.cos(d.rot)),!d.nomove&&d.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&0==d.mass)throw"Error: Dynamic Body cannot be simulated with 0 mass unless allowMovement is false";if(!d.norotate&&d.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&0==d.inertia)throw"Error: Dynamic Body cannot be simulated with 0 inertia unless allowRotation is false";for(var z=d.shapes.head;null!=z;){var v=z.elt;this.bphase.sync(v),z=z.next}u=u.next}for(var m=this.live_constraints.head;null!=m;){var b=m.elt;if(b.active){if(b.validate(),b.component.woken&&null!=b.cbSet)for(var y=b.cbSet.conlisteners.head;null!=y;){var g=y.elt;if(g.event==o.util.ZPP_Flags.id_CbEvent_WAKE){var x=this.push_callback(g);x.event=o.util.ZPP_Flags.id_CbEvent_WAKE,x.constraint=b,y=y.next}else y=y.next}b.component.woken=!1}m=m.next}},updateVel:function(t){for(var n=1-t*this.global_lin_drag,e=1-t*this.global_ang_drag,i=this.live.head;null!=i;){var r=i.elt;if(0!=r.smass){var s=t*r.imass;r.velx=n*r.velx+(r.forcex+this.gravityx*r.gravMass)*s,r.vely=n*r.vely+(r.forcey+this.gravityy*r.gravMass)*s}if(0!=r.sinertia){var l=0,a=0;l=r.worldCOMx-r.posx,a=r.worldCOMy-r.posy;var p=r.torque+(this.gravityy*l-this.gravityx*a)*r.gravMass;r.angvel=e*r.angvel+p*t*r.iinertia}i,i=i.next}},updatePos:function(t){for(var n=2*Math.PI/t,e=this.live.head;null!=e;){var i=e.elt;if(i.pre_posx=i.posx,i.pre_posy=i.posy,i.pre_rot=i.rot,i.sweepTime=0,i.sweep_angvel=i.angvel%n,i.sweepIntegrate(t),i.disableCCD)i.sweepFrozen=!0,i.bullet=!1;else{var r=p.Config.staticCCDLinearThreshold*i.sweepRadius,s=p.Config.staticCCDAngularThreshold;if((i.velx*i.velx+i.vely*i.vely)*t*t>r*r||i.angvel*i.angvel*t*t>s*s||i.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC){var l=i.sweep_angvel;l<0&&(l=-l);for(var a=1/l,_=i.shapes.head;null!=_;){var h=_.elt,u=h.aabb,d=u.minx,c=u.miny,P=u.maxx,f=u.maxy,z=l*t*h.sweepCoef*.008333333333333333|0;z>8&&(z=8);var v=l*t/z;i.sweepIntegrate(t),h.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?h.circle._force_validate_aabb():h.polygon._force_validate_aabb(),d<u.minx?u.minx=d:d=u.minx,c<u.miny?u.miny=c:c=u.miny,P>u.maxx?u.maxx=P:P=u.maxx,f>u.maxy?u.maxy=f:f=u.maxy;for(var m=1;m<z;){var b=m++;i.sweepIntegrate(v*b*a),h.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?h.circle._force_validate_aabb():h.polygon._force_validate_aabb(),d<u.minx?u.minx=d:d=u.minx,c<u.miny?u.miny=c:c=u.miny,P>u.maxx?u.maxx=P:P=u.maxx,f>u.maxy?u.maxy=f:f=u.maxy}this.bphase.sync(h),_=_.next}if(i.sweepFrozen=!1,i.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&i.bulletEnabled){var y=p.Config.bulletCCDLinearThreshold*i.sweepRadius,g=p.Config.bulletCCDAngularThreshold;((i.velx*i.velx+i.vely*i.vely)*t*t>y*y||i.angvel*i.angvel*t*t>g*g)&&(i.bullet=!0)}}else i.sweepFrozen=!0,i.bullet=!1}e=e.next}for(var x=this.kinematics.head;null!=x;){var Z=x.elt;if(Z.pre_posx=Z.posx,Z.pre_posy=Z.posy,Z.pre_rot=Z.rot,Z.sweepTime=0,Z.sweep_angvel=Z.angvel%n,Z.sweepIntegrate(t),Z.disableCCD)Z.sweepFrozen=!0,Z.bullet=!1;else{var w=p.Config.staticCCDLinearThreshold*Z.sweepRadius,C=p.Config.staticCCDAngularThreshold;if((Z.velx*Z.velx+Z.vely*Z.vely)*t*t>w*w||Z.angvel*Z.angvel*t*t>C*C||Z.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC){var E=Z.sweep_angvel;E<0&&(E=-E);for(var S=1/E,N=Z.shapes.head;null!=N;){var k=N.elt,M=k.aabb,I=M.minx,F=M.miny,A=M.maxx,T=M.maxy,V=E*t*k.sweepCoef*.008333333333333333|0;V>8&&(V=8);var L=E*t/V;Z.sweepIntegrate(t),k.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?k.circle._force_validate_aabb():k.polygon._force_validate_aabb(),I<M.minx?M.minx=I:I=M.minx,F<M.miny?M.miny=F:F=M.miny,A>M.maxx?M.maxx=A:A=M.maxx,T>M.maxy?M.maxy=T:T=M.maxy;for(var B=1;B<V;){var O=B++;Z.sweepIntegrate(L*O*S),k.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?k.circle._force_validate_aabb():k.polygon._force_validate_aabb(),I<M.minx?M.minx=I:I=M.minx,F<M.miny?M.miny=F:F=M.miny,A>M.maxx?M.maxx=A:A=M.maxx,T>M.maxy?M.maxy=T:T=M.maxy}this.bphase.sync(k),N=N.next}if(Z.sweepFrozen=!1,Z.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&Z.bulletEnabled){var G=p.Config.bulletCCDLinearThreshold*Z.sweepRadius,R=p.Config.bulletCCDAngularThreshold;((Z.velx*Z.velx+Z.vely*Z.vely)*t*t>G*G||Z.angvel*Z.angvel*t*t>R*R)&&(Z.bullet=!0)}}else Z.sweepFrozen=!0,Z.bullet=!1}x=x.next}},presteparb:function(t,n,e){null==e&&(e=!1);var i=this;if(!t.cleared&&t.b1.component.sleeping&&t.b2.component.sleeping)return t.sleep_stamp=this.stamp,t.sleeping=!0,!0;if(!t.cleared||0!=t.present||t.intchange){var r=!e&&t.up_stamp==this.stamp-1&&!t.cleared&&!t.intchange,s=t.fresh&&!t.cleared&&!t.intchange;if(r&&(t.endGenerated=this.stamp),s||r||t.cleared||t.intchange){this.inlined_MRCA_chains(t.ws1,t.ws2);for(var l=this.mrca1.head;null!=l;){for(var a=l.elt,_=this.mrca2.head;null!=_;){var h=_.elt,u=a.cbSet,d=h.cbSet;if(u.manager.pair(u,d).empty_intersection())_=_.next;else{var c=[o.phys.ZPP_Interactor.get(a,h)];s||t.intchange?(null==c[0]&&(c[0]=o.space.ZPP_CallbackSet.get(a,h),this.add_callbackset(c[0])),u.manager.pair(u,d).forall(o.util.ZPP_Flags.id_CbEvent_BEGIN,function(n){return function(e){if(0!=(e.itype&t.type)&&n[0].empty_arb(e.itype)){var r=i.push_callback(e);r.event=o.util.ZPP_Flags.id_CbEvent_BEGIN,o.phys.ZPP_Interactor.int_callback(n[0],e,r),r.set=n[0]}}}(c)),!c[0].arbiters.inlined_has(t)&&function(n){return c[0].arbiters.inlined_add(t),!0}()&&t.present++):(t.present--,c[0].remove_arb(t),u.manager.pair(u,d).forall(o.util.ZPP_Flags.id_CbEvent_END,function(n){return function(e){if(0!=(e.itype&t.type)&&n[0].empty_arb(e.itype)){var r=i.push_callback(e);r.event=o.util.ZPP_Flags.id_CbEvent_END,o.phys.ZPP_Interactor.int_callback(n[0],e,r),r.set=n[0]}}}(c)),null==c[0].arbiters.head&&this.remove_callbackset(c[0])),_=_.next}}l=l.next}}t.fresh=!1,t.intchange=!1}if(t.cleared||t.up_stamp+(t.type==o.dynamics.ZPP_Arbiter.COL?p.Config.arbiterExpirationDelay:0)<this.stamp)return t.type==o.dynamics.ZPP_Arbiter.SENSOR?t.sensorarb.retire():t.type==o.dynamics.ZPP_Arbiter.FLUID?t.fluidarb.retire():t.colarb.retire(),!0;var P=t.active;return t.active=t.presentable=t.up_stamp==this.stamp,0!=(t.immState&o.util.ZPP_Flags.id_ImmState_ACCEPT)?t.active&&t.type!=o.dynamics.ZPP_Arbiter.SENSOR&&(null!=t.colarb?t.colarb.preStep(n)&&(t.active=!1):t.fluidarb.preStep(this,n)):null!=t.colarb&&t.colarb.cleanupContacts()&&(t.active=!1),P!=t.active&&(t.b1.arbiters.modified=!0,t.b2.arbiters.modified=!0,this.c_arbiters_true.modified=this.c_arbiters_false.modified=!0,this.s_arbiters.modified=this.f_arbiters.modified=!0),!1},prestep:function(t){for(var n=null,e=this.live_constraints.head;null!=e;){var i=e.elt;i.preStep(t)?(e=this.live_constraints.erase(n),i.broken(),this.constraintCbBreak(i),i.removeOnBreak?(i.component.sleeping=!0,this.midstep=!1,null!=i.compound?i.compound.wrap_constraints.remove(i.outer):this.wrap_constraints.remove(i.outer),this.midstep=!0):i.active=!1,i.clearcache()):(n=e,e=e.next)}var r=null,s=this.c_arbiters_true,l=s.head,a=null!=this.c_arbiters_false;for(a&&null==l&&(a=!1,l=this.c_arbiters_false.head,s=this.c_arbiters_false,r=null);null!=l;){var p=l.elt;this.presteparb(p,t)?(l=s.inlined_erase(r),a&&null==l&&(a=!1,l=this.c_arbiters_false.head,s=this.c_arbiters_false,r=null)):(r=l,l=l.next,a&&null==l&&(a=!1,l=this.c_arbiters_false.head,s=this.c_arbiters_false,r=null))}var o=null,_=this.f_arbiters,h=_.head,u=!1;for(u&&null==h&&(u=!1,_=null,o=null);null!=h;){var d=h.elt;this.presteparb(d,t)?(h=_.inlined_erase(o),u&&null==h&&(u=!1,_=null,o=null)):(o=h,h=h.next,u&&null==h&&(u=!1,_=null,o=null))}var c=null,P=this.s_arbiters,f=P.head,z=!1;for(z&&null==f&&(z=!1,P=null,c=null);null!=f;){var v=f.elt;this.presteparb(v,t)?(f=P.inlined_erase(c),z&&null==f&&(z=!1,P=null,c=null)):(c=f,f=f.next,z&&null==f&&(z=!1,P=null,c=null))}},warmStart:function(){for(var t=this.f_arbiters.head;null!=t;){var n=t.elt;n.active&&0!=(n.immState&o.util.ZPP_Flags.id_ImmState_ACCEPT)&&n.warmStart(),t=t.next}var e=this.c_arbiters_false.head,i=!0;for(null==e&&(e=this.c_arbiters_true.head,i=!1);null!=e;){var r=e.elt;r.active&&0!=(r.immState&o.util.ZPP_Flags.id_ImmState_ACCEPT)&&r.warmStart(),e=e.next,i&&null==e&&(e=this.c_arbiters_true.head,i=!1)}for(var s=this.live_constraints.head;null!=s;){s.elt.warmStart(),s=s.next}},iterateVel:function(t){for(var n=0;n<t;){for(var e=(n++,this.f_arbiters.head);null!=e;){var i=e.elt;i.active&&0!=(i.immState&o.util.ZPP_Flags.id_ImmState_ACCEPT)&&i.applyImpulseVel(),e=e.next}for(var r=null,s=this.live_constraints.head;null!=s;){var l=s.elt;l.applyImpulseVel()?(s=this.live_constraints.erase(r),l.broken(),this.constraintCbBreak(l),l.removeOnBreak?(l.component.sleeping=!0,this.midstep=!1,null!=l.compound?l.compound.wrap_constraints.remove(l.outer):this.wrap_constraints.remove(l.outer),this.midstep=!0):l.active=!1,l.clearcache()):(r=s,s=s.next)}var a=this.c_arbiters_false.head,p=!0;for(null==a&&(a=this.c_arbiters_true.head,p=!1);null!=a;){var _=a.elt;_.active&&0!=(_.immState&o.util.ZPP_Flags.id_ImmState_ACCEPT)&&_.applyImpulseVel(),a=a.next,p&&null==a&&(a=this.c_arbiters_true.head,p=!1)}}},iteratePos:function(t){for(var n=0;n<t;){for(var e=(n++,null),i=this.live_constraints.head;null!=i;){var r=i.elt;!r.__velocity&&r.stiff&&r.applyImpulsePos()?(i=this.live_constraints.erase(e),r.broken(),this.constraintCbBreak(r),r.removeOnBreak?(r.component.sleeping=!0,this.midstep=!1,null!=r.compound?r.compound.wrap_constraints.remove(r.outer):this.wrap_constraints.remove(r.outer),this.midstep=!0):r.active=!1,r.clearcache()):(e=i,i=i.next)}var s=this.c_arbiters_false.head,l=!0;for(null==s&&(s=this.c_arbiters_true.head,l=!1);null!=s;){var a=s.elt;a.active&&0!=(a.immState&o.util.ZPP_Flags.id_ImmState_ACCEPT)&&a.applyImpulsePos(),s=s.next,l&&null==s&&(s=this.c_arbiters_true.head,l=!1)}}},group_ignore:function(t,n){var e=t.lookup_group();if(null==e)return!1;var i=n.lookup_group();if(null==i)return!1;for(var r=!1;null!=e&&null!=i;){if(e==i){r=e.ignore;break}e.depth<i.depth?i=i.group:e=e.group}return r},interactionType:function(t,n,e,i){var r;r=!1;for(var s=e.constraints.head;null!=s;){var l=s.elt;if(l.ignore&&l.pair_exists(e.id,i.id)){r=!0;break}s=s.next}return r||this.group_ignore(t,n)?-1:(t.sensorEnabled||n.sensorEnabled)&&t.filter.shouldSense(n.filter)?2:!t.fluidEnabled&&!n.fluidEnabled||!t.filter.shouldFlow(n.filter)||0==e.imass&&0==i.imass&&0==e.iinertia&&0==i.iinertia?!t.filter.shouldCollide(n.filter)||0==e.imass&&0==i.imass&&0==e.iinertia&&0==i.iinertia?-1:1:0},narrowPhase:function(t,n,e,i,r){var s=this,l=null,a=t.body,_=n.body,h=this.interactionType(t,n,a,_);if(-1!=h){var u,d;t.type>n.type?(u=n,d=t):t.type==n.type?t.id<n.id?(u=t,d=n):(d=t,u=n):(u=t,d=n);var c=u==n;if(0==h){var P;if(null==i){var f,z=null;f=a.arbiters.length<_.arbiters.length?a:_;for(var v=f.arbiters.head;null!=v;){var m=v.elt;if(m.id==u.id&&m.di==d.id){z=m;break}v=v.next}P=z}else P=i;var b,y=null==P,g=!1;y?null==o.dynamics.ZPP_FluidArbiter.zpp_pool?b=new o.dynamics.ZPP_FluidArbiter:(b=o.dynamics.ZPP_FluidArbiter.zpp_pool,o.dynamics.ZPP_FluidArbiter.zpp_pool=b.next,b.next=null):null==P.fluidarb?(P.cleared=!0,P.b1.arbiters.inlined_try_remove(P),P.b2.arbiters.inlined_try_remove(P),null!=P.pair&&(P.pair.arb=null,P.pair=null),P.active=!1,this.f_arbiters.modified=!0,null==o.dynamics.ZPP_FluidArbiter.zpp_pool?b=new o.dynamics.ZPP_FluidArbiter:(b=o.dynamics.ZPP_FluidArbiter.zpp_pool,o.dynamics.ZPP_FluidArbiter.zpp_pool=b.next,b.next=null),b.intchange=!0,y=!0,g=!0):b=P.fluidarb;var x=o.util.ZPP_Flags.id_InteractionType_FLUID;if(y||b.stamp!=this.stamp||r)if(b.stamp=this.stamp,o.geom.ZPP_Collide.flowCollide(u,d,b)){if(y?(b.b1=t.body,b.ws1=t,b.b2=n.body,b.ws2=n,b.id=u.id,b.di=d.id,b.b1.arbiters.inlined_add(b),b.b2.arbiters.inlined_add(b),b.active=!0,b.present=0,b.cleared=!1,b.sleeping=!1,b.fresh=!1,b.presentable=!1,b.nx=0,b.ny=1,b.dampx=0,b.dampy=0,b.adamp=0,this.f_arbiters.inlined_add(b),b.fresh=!g):b.fresh=b.up_stamp<this.stamp-1||b.endGenerated==this.stamp&&r,b.up_stamp=b.stamp,b.fresh||0==(b.immState&o.util.ZPP_Flags.id_ImmState_ALWAYS)){b.immState=o.util.ZPP_Flags.id_ImmState_ACCEPT;var Z,w=!1;Z=b.ws1.id>b.ws2.id?b.ws2:b.ws1;var C;C=b.ws1.id>b.ws2.id?b.ws1:b.ws2,this.inlined_MRCA_chains(Z,C);for(var E=this.mrca1.head;null!=E;){for(var S=E.elt,N=this.mrca2.head;null!=N;){var k=N.elt,M=S.cbSet,I=k.cbSet;if(M.manager.pair(M,I).empty_intersection())N=N.next;else{var F=null,A=null;this.prelisteners.inlined_clear();var T=[null];if(M.manager.pair(M,I).forall(o.util.ZPP_Flags.id_CbEvent_PRE,function(t){return function(n){0!=(n.itype&x)&&(t[0]=s.prelisteners.inlined_insert(t[0],n),w=w||!n.pure)}}(T)),null!=this.prelisteners.head){if(F=o.phys.ZPP_Interactor.get(S,k),null==F&&(A=o.space.ZPP_CallbackSet.get(S,k),this.add_callbackset(A)),null==F||(F.FLUIDstamp!=this.stamp||r)&&0==(F.FLUIDstate&o.util.ZPP_Flags.id_ImmState_ALWAYS)){if(null!=A&&(F=A),null!=F)for(var V=this.prelisteners.head;null!=V;){var L=V.elt;L.itype==o.util.ZPP_Flags.id_InteractionType_ANY?(F.COLLISIONstamp=this.stamp,F.SENSORstamp=this.stamp,F.FLUIDstamp=this.stamp):F.FLUIDstamp=this.stamp,V=V.next}b.mutable=!0,null!=b.wrap_position&&(b.wrap_position.zpp_inner._immutable=!1);var B=b.active;b.active=!0;this.precb.zpp_inner.pre_arbiter=b,this.precb.zpp_inner.set=F;for(var O=this.prelisteners.head;null!=O;){var G=O.elt;this.precb.zpp_inner.listener=G,o.phys.ZPP_Interactor.int_callback(F,G,this.precb.zpp_inner),this.precb.zpp_inner.pre_swapped=S!=this.precb.zpp_inner.int1;var R=G.handlerp(this.precb);null!=R&&(R==function(t){return null==o.util.ZPP_Flags.PreFlag_ACCEPT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_ACCEPT=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_ACCEPT}()?b.immState=o.util.ZPP_Flags.id_ImmState_ACCEPT|o.util.ZPP_Flags.id_ImmState_ALWAYS:R==function(t){return null==o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE}()?b.immState=o.util.ZPP_Flags.id_ImmState_ACCEPT:R==function(t){return null==o.util.ZPP_Flags.PreFlag_IGNORE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_IGNORE=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_IGNORE}()?b.immState=o.util.ZPP_Flags.id_ImmState_IGNORE|o.util.ZPP_Flags.id_ImmState_ALWAYS:b.immState=o.util.ZPP_Flags.id_ImmState_IGNORE),O=O.next}if(b.mutable=!1,null!=b.wrap_position&&(b.wrap_position.zpp_inner._immutable=!0),b.active=B,null!=F)for(var D=this.prelisteners.head;null!=D;){var j=D.elt;j.itype==o.util.ZPP_Flags.id_InteractionType_ANY?(F.COLLISIONstate=b.immState,F.SENSORstate=b.immState,F.FLUIDstate=b.immState):F.FLUIDstate=b.immState,D=D.next}}else null==F?0==(b.immState&o.util.ZPP_Flags.id_ImmState_ALWAYS)&&(b.immState=o.util.ZPP_Flags.id_ImmState_ACCEPT):b.immState=F.FLUIDstate;N=N.next}else N=N.next}}E=E.next}if(w&&0==(b.immState&o.util.ZPP_Flags.id_ImmState_ALWAYS)){if(b.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var q=b.b1;q.world||(q.component.waket=this.stamp+(this.midstep?0:1),q.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(q.kinematicDelaySleep=!0),q.component.sleeping&&this.really_wake(q,!1))}if(b.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var Y=b.b2;Y.world||(Y.component.waket=this.stamp+(this.midstep?0:1),Y.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(Y.kinematicDelaySleep=!0),Y.component.sleeping&&this.really_wake(Y,!1))}}}if(0!=(b.immState&o.util.ZPP_Flags.id_ImmState_ACCEPT)){if(b.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&b.b1.component.sleeping){var U=b.b1;U.world||(U.component.waket=this.stamp+(this.midstep?0:1),U.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(U.kinematicDelaySleep=!0),U.component.sleeping&&this.really_wake(U,!1))}if(b.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&b.b2.component.sleeping){var W=b.b2;W.world||(W.component.waket=this.stamp+(this.midstep?0:1),W.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(W.kinematicDelaySleep=!0),W.component.sleeping&&this.really_wake(W,!1))}}b.sleeping&&(b.sleeping=!1,this.f_arbiters.inlined_add(b)),l=b}else if(y){var J=b;J.next=o.dynamics.ZPP_FluidArbiter.zpp_pool,o.dynamics.ZPP_FluidArbiter.zpp_pool=J,l=null}else l=b;else l=b}else if(1==h){var K;K=e?this.c_arbiters_true:this.c_arbiters_false;var H;if(null==i){var X,Q=null;X=a.arbiters.length<_.arbiters.length?a:_;for(var $=X.arbiters.head;null!=$;){var tt=$.elt;if(tt.id==u.id&&tt.di==d.id){Q=tt;break}$=$.next}H=Q}else H=i;var nt,et=null==H,it=!1;et?(null==o.dynamics.ZPP_ColArbiter.zpp_pool?nt=new o.dynamics.ZPP_ColArbiter:(nt=o.dynamics.ZPP_ColArbiter.zpp_pool,o.dynamics.ZPP_ColArbiter.zpp_pool=nt.next,nt.next=null),nt.stat=e):null==H.colarb?(H.cleared=!0,H.b1.arbiters.inlined_try_remove(H),H.b2.arbiters.inlined_try_remove(H),null!=H.pair&&(H.pair.arb=null,H.pair=null),H.active=!1,this.f_arbiters.modified=!0,null==o.dynamics.ZPP_ColArbiter.zpp_pool?nt=new o.dynamics.ZPP_ColArbiter:(nt=o.dynamics.ZPP_ColArbiter.zpp_pool,o.dynamics.ZPP_ColArbiter.zpp_pool=nt.next,nt.next=null),nt.intchange=!0,nt.stat=e,et=!0,it=!0):(nt=H.colarb,c=u!=nt.s1,nt.stat!=e&&(nt.stat=e,nt.sleeping||((e?this.c_arbiters_false:this.c_arbiters_true).remove(nt),K.add(nt))));var rt=o.util.ZPP_Flags.id_InteractionType_COLLISION;if(et||nt.stamp!=this.stamp||r)if(nt.stamp=this.stamp,o.geom.ZPP_Collide.contactCollide(u,d,nt,c)){if(et?(nt.b1=t.body,nt.ws1=t,nt.b2=n.body,nt.ws2=n,nt.id=u.id,nt.di=d.id,nt.b1.arbiters.inlined_add(nt),nt.b2.arbiters.inlined_add(nt),nt.active=!0,nt.present=0,nt.cleared=!1,nt.sleeping=!1,nt.fresh=!1,nt.presentable=!1,nt.s1=t,nt.s2=n,nt.userdef_restitution||(nt.s1.material.elasticity<=Math.NEGATIVE_INFINITY||nt.s2.material.elasticity<=Math.NEGATIVE_INFINITY?nt.restitution=0:nt.s1.material.elasticity>=Math.POSITIVE_INFINITY||nt.s2.material.elasticity>=Math.POSITIVE_INFINITY?nt.restitution=1:nt.restitution=(nt.s1.material.elasticity+nt.s2.material.elasticity)/2,nt.restitution<0&&(nt.restitution=0),nt.restitution>1&&(nt.restitution=1)),nt.userdef_dyn_fric||(nt.dyn_fric=Math.sqrt(nt.s1.material.dynamicFriction*nt.s2.material.dynamicFriction)),nt.userdef_stat_fric||(nt.stat_fric=Math.sqrt(nt.s1.material.staticFriction*nt.s2.material.staticFriction)),nt.userdef_rfric||(nt.rfric=Math.sqrt(nt.s1.material.rollingFriction*nt.s2.material.rollingFriction)),K.inlined_add(nt),nt.fresh=!it):nt.fresh=nt.up_stamp<this.stamp-1||nt.endGenerated==this.stamp&&r,nt.up_stamp=nt.stamp,nt.fresh||0==(nt.immState&o.util.ZPP_Flags.id_ImmState_ALWAYS)){nt.immState=o.util.ZPP_Flags.id_ImmState_ACCEPT;var st,lt=!1;st=nt.ws1.id>nt.ws2.id?nt.ws2:nt.ws1;var at;at=nt.ws1.id>nt.ws2.id?nt.ws1:nt.ws2,this.inlined_MRCA_chains(st,at);for(var pt=this.mrca1.head;null!=pt;){for(var ot=pt.elt,_t=this.mrca2.head;null!=_t;){var ht=_t.elt,ut=ot.cbSet,dt=ht.cbSet;if(ut.manager.pair(ut,dt).empty_intersection())_t=_t.next;else{var ct=null,Pt=null;this.prelisteners.inlined_clear();var ft=[null];if(ut.manager.pair(ut,dt).forall(o.util.ZPP_Flags.id_CbEvent_PRE,function(t){return function(n){0!=(n.itype&rt)&&(t[0]=s.prelisteners.inlined_insert(t[0],n),lt=lt||!n.pure)}}(ft)),null!=this.prelisteners.head){if(ct=o.phys.ZPP_Interactor.get(ot,ht),null==ct&&(Pt=o.space.ZPP_CallbackSet.get(ot,ht),this.add_callbackset(Pt)),null==ct||(ct.COLLISIONstamp!=this.stamp||r)&&0==(ct.COLLISIONstate&o.util.ZPP_Flags.id_ImmState_ALWAYS)){if(null!=Pt&&(ct=Pt),null!=ct)for(var zt=this.prelisteners.head;null!=zt;){var vt=zt.elt;vt.itype==o.util.ZPP_Flags.id_InteractionType_ANY?(ct.COLLISIONstamp=this.stamp,ct.SENSORstamp=this.stamp,ct.FLUIDstamp=this.stamp):ct.COLLISIONstamp=this.stamp,zt=zt.next}nt.mutable=!0,null!=nt.wrap_normal&&(nt.wrap_normal.zpp_inner._immutable=!1),null!=nt.wrap_contacts&&(nt.wrap_contacts.zpp_inner.immutable=!1);var mt=nt.active;nt.active=!0;nt.cleanupContacts(),this.precb.zpp_inner.pre_arbiter=nt,this.precb.zpp_inner.set=ct;for(var bt=this.prelisteners.head;null!=bt;){var yt=bt.elt;this.precb.zpp_inner.listener=yt,o.phys.ZPP_Interactor.int_callback(ct,yt,this.precb.zpp_inner),this.precb.zpp_inner.pre_swapped=ot!=this.precb.zpp_inner.int1;var gt=yt.handlerp(this.precb);null!=gt&&(gt==function(t){return null==o.util.ZPP_Flags.PreFlag_ACCEPT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_ACCEPT=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_ACCEPT}()?nt.immState=o.util.ZPP_Flags.id_ImmState_ACCEPT|o.util.ZPP_Flags.id_ImmState_ALWAYS:gt==function(t){return null==o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE}()?nt.immState=o.util.ZPP_Flags.id_ImmState_ACCEPT:gt==function(t){return null==o.util.ZPP_Flags.PreFlag_IGNORE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_IGNORE=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_IGNORE}()?nt.immState=o.util.ZPP_Flags.id_ImmState_IGNORE|o.util.ZPP_Flags.id_ImmState_ALWAYS:nt.immState=o.util.ZPP_Flags.id_ImmState_IGNORE),bt=bt.next}if(nt.mutable=!1,null!=nt.wrap_normal&&(nt.wrap_normal.zpp_inner._immutable=!0),null!=nt.wrap_contacts&&(nt.wrap_contacts.zpp_inner.immutable=!0),nt.active=mt,null!=ct)for(var xt=this.prelisteners.head;null!=xt;){var Zt=xt.elt;Zt.itype==o.util.ZPP_Flags.id_InteractionType_ANY?(ct.COLLISIONstate=nt.immState,ct.SENSORstate=nt.immState,ct.FLUIDstate=nt.immState):ct.COLLISIONstate=nt.immState,xt=xt.next}}else null==ct?0==(nt.immState&o.util.ZPP_Flags.id_ImmState_ALWAYS)&&(nt.immState=o.util.ZPP_Flags.id_ImmState_ACCEPT):nt.immState=ct.COLLISIONstate;_t=_t.next}else _t=_t.next}}pt=pt.next}if(lt&&0==(nt.immState&o.util.ZPP_Flags.id_ImmState_ALWAYS)){if(nt.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var wt=nt.b1;wt.world||(wt.component.waket=this.stamp+(this.midstep?0:1),wt.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(wt.kinematicDelaySleep=!0),wt.component.sleeping&&this.really_wake(wt,!1))}if(nt.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC){var Ct=nt.b2;Ct.world||(Ct.component.waket=this.stamp+(this.midstep?0:1),Ct.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(Ct.kinematicDelaySleep=!0),Ct.component.sleeping&&this.really_wake(Ct,!1))}}}if(0!=(nt.immState&o.util.ZPP_Flags.id_ImmState_ACCEPT)){if(nt.b1.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&nt.b1.component.sleeping){var Et=nt.b1;Et.world||(Et.component.waket=this.stamp+(this.midstep?0:1),Et.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(Et.kinematicDelaySleep=!0),Et.component.sleeping&&this.really_wake(Et,!1))}if(nt.b2.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&nt.b2.component.sleeping){var St=nt.b2;St.world||(St.component.waket=this.stamp+(this.midstep?0:1),St.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(St.kinematicDelaySleep=!0),St.component.sleeping&&this.really_wake(St,!1))}}nt.sleeping&&(nt.sleeping=!1,K.inlined_add(nt)),l=nt}else if(et){var Nt=nt;Nt.userdef_dyn_fric=!1,Nt.userdef_stat_fric=!1,Nt.userdef_restitution=!1,Nt.userdef_rfric=!1,Nt.__ref_edge1=Nt.__ref_edge2=null,Nt.next=o.dynamics.ZPP_ColArbiter.zpp_pool,o.dynamics.ZPP_ColArbiter.zpp_pool=Nt,l=null}else l=nt;else l=nt}else{var kt;if(null==i){var Mt,It=null;Mt=a.arbiters.length<_.arbiters.length?a:_;for(var Ft=Mt.arbiters.head;null!=Ft;){var At=Ft.elt;if(At.id==u.id&&At.di==d.id){It=At;break}Ft=Ft.next}kt=It}else kt=i;var Tt,Vt=null==kt,Lt=!1;Vt?null==o.dynamics.ZPP_SensorArbiter.zpp_pool?Tt=new o.dynamics.ZPP_SensorArbiter:(Tt=o.dynamics.ZPP_SensorArbiter.zpp_pool,o.dynamics.ZPP_SensorArbiter.zpp_pool=Tt.next,Tt.next=null):null==kt.sensorarb?(kt.cleared=!0,kt.b1.arbiters.inlined_try_remove(kt),kt.b2.arbiters.inlined_try_remove(kt),null!=kt.pair&&(kt.pair.arb=null,kt.pair=null),kt.active=!1,this.f_arbiters.modified=!0,null==o.dynamics.ZPP_SensorArbiter.zpp_pool?Tt=new o.dynamics.ZPP_SensorArbiter:(Tt=o.dynamics.ZPP_SensorArbiter.zpp_pool,o.dynamics.ZPP_SensorArbiter.zpp_pool=Tt.next,Tt.next=null),Tt.intchange=!0,Vt=!0,Lt=!0):Tt=kt.sensorarb;var Bt=o.util.ZPP_Flags.id_InteractionType_SENSOR;if(Vt||Tt.stamp!=this.stamp||r)if(Tt.stamp=this.stamp,o.geom.ZPP_Collide.testCollide(u,d)){if(Vt?(Tt.b1=t.body,Tt.ws1=t,Tt.b2=n.body,Tt.ws2=n,Tt.id=u.id,Tt.di=d.id,Tt.b1.arbiters.inlined_add(Tt),Tt.b2.arbiters.inlined_add(Tt),Tt.active=!0,Tt.present=0,Tt.cleared=!1,Tt.sleeping=!1,Tt.fresh=!1,Tt.presentable=!1,this.s_arbiters.inlined_add(Tt),Tt.fresh=!Lt):Tt.fresh=Tt.up_stamp<this.stamp-1||Tt.endGenerated==this.stamp&&r,Tt.up_stamp=Tt.stamp,Tt.fresh||0==(Tt.immState&o.util.ZPP_Flags.id_ImmState_ALWAYS)){Tt.immState=o.util.ZPP_Flags.id_ImmState_ACCEPT;var Ot,Gt=!1;Ot=Tt.ws1.id>Tt.ws2.id?Tt.ws2:Tt.ws1;var Rt;Rt=Tt.ws1.id>Tt.ws2.id?Tt.ws1:Tt.ws2,
this.inlined_MRCA_chains(Ot,Rt);for(var Dt=this.mrca1.head;null!=Dt;){for(var jt=Dt.elt,qt=this.mrca2.head;null!=qt;){var Yt=qt.elt,Ut=jt.cbSet,Wt=Yt.cbSet;if(Ut.manager.pair(Ut,Wt).empty_intersection())qt=qt.next;else{var Jt=null,Kt=null;this.prelisteners.inlined_clear();var Ht=[null];if(Ut.manager.pair(Ut,Wt).forall(o.util.ZPP_Flags.id_CbEvent_PRE,function(t){return function(n){0!=(n.itype&Bt)&&(t[0]=s.prelisteners.inlined_insert(t[0],n),Gt=Gt||!n.pure)}}(Ht)),null!=this.prelisteners.head){if(Jt=o.phys.ZPP_Interactor.get(jt,Yt),null==Jt&&(Kt=o.space.ZPP_CallbackSet.get(jt,Yt),this.add_callbackset(Kt)),null==Jt||(Jt.SENSORstamp!=this.stamp||r)&&0==(Jt.SENSORstate&o.util.ZPP_Flags.id_ImmState_ALWAYS)){if(null!=Kt&&(Jt=Kt),null!=Jt)for(var Xt=this.prelisteners.head;null!=Xt;){var Qt=Xt.elt;Qt.itype==o.util.ZPP_Flags.id_InteractionType_ANY?(Jt.COLLISIONstamp=this.stamp,Jt.SENSORstamp=this.stamp,Jt.FLUIDstamp=this.stamp):Jt.SENSORstamp=this.stamp,Xt=Xt.next}var $t=Tt.active;Tt.active=!0;this.precb.zpp_inner.pre_arbiter=Tt,this.precb.zpp_inner.set=Jt;for(var tn=this.prelisteners.head;null!=tn;){var nn=tn.elt;this.precb.zpp_inner.listener=nn,o.phys.ZPP_Interactor.int_callback(Jt,nn,this.precb.zpp_inner),this.precb.zpp_inner.pre_swapped=jt!=this.precb.zpp_inner.int1;var en=nn.handlerp(this.precb);null!=en&&(en==function(t){return null==o.util.ZPP_Flags.PreFlag_ACCEPT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_ACCEPT=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_ACCEPT}()?Tt.immState=o.util.ZPP_Flags.id_ImmState_ACCEPT|o.util.ZPP_Flags.id_ImmState_ALWAYS:en==function(t){return null==o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_ACCEPT_ONCE}()?Tt.immState=o.util.ZPP_Flags.id_ImmState_ACCEPT:en==function(t){return null==o.util.ZPP_Flags.PreFlag_IGNORE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.PreFlag_IGNORE=new p.callbacks.PreFlag,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.PreFlag_IGNORE}()?Tt.immState=o.util.ZPP_Flags.id_ImmState_IGNORE|o.util.ZPP_Flags.id_ImmState_ALWAYS:Tt.immState=o.util.ZPP_Flags.id_ImmState_IGNORE),tn=tn.next}if(Tt.active=$t,null!=Jt)for(var rn=this.prelisteners.head;null!=rn;){var sn=rn.elt;sn.itype==o.util.ZPP_Flags.id_InteractionType_ANY?(Jt.COLLISIONstate=Tt.immState,Jt.SENSORstate=Tt.immState,Jt.FLUIDstate=Tt.immState):Jt.SENSORstate=Tt.immState,rn=rn.next}}else null==Jt?0==(Tt.immState&o.util.ZPP_Flags.id_ImmState_ALWAYS)&&(Tt.immState=o.util.ZPP_Flags.id_ImmState_ACCEPT):Tt.immState=Jt.SENSORstate;qt=qt.next}else qt=qt.next}}Dt=Dt.next}if(Gt&&0==(Tt.immState&o.util.ZPP_Flags.id_ImmState_ALWAYS)){if(Tt.b1.type!=o.util.ZPP_Flags.id_BodyType_STATIC){var ln=Tt.b1;ln.world||(ln.component.waket=this.stamp+(this.midstep?0:1),ln.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(ln.kinematicDelaySleep=!0),ln.component.sleeping&&this.really_wake(ln,!1))}if(Tt.b2.type!=o.util.ZPP_Flags.id_BodyType_STATIC){var an=Tt.b2;an.world||(an.component.waket=this.stamp+(this.midstep?0:1),an.type==o.util.ZPP_Flags.id_BodyType_KINEMATIC&&(an.kinematicDelaySleep=!0),an.component.sleeping&&this.really_wake(an,!1))}}}Tt.sleeping&&(Tt.sleeping=!1,this.s_arbiters.inlined_add(Tt)),l=Tt}else if(Vt){var pn=Tt;pn.next=o.dynamics.ZPP_SensorArbiter.zpp_pool,o.dynamics.ZPP_SensorArbiter.zpp_pool=pn,l=null}else l=Tt;else l=Tt}}return l},MRCA_chains:function(t,n){this.inlined_MRCA_chains(t,n)},inlined_MRCA_chains:function(t,n){this.mrca1.inlined_clear(),this.mrca2.inlined_clear(),null!=t.cbSet&&this.mrca1.inlined_add(t),null!=t.body.cbSet&&this.mrca1.inlined_add(t.body),null!=n.cbSet&&this.mrca2.inlined_add(n),null!=n.body.cbSet&&this.mrca2.inlined_add(n.body);for(var e=t.body.compound,i=n.body.compound;e!=i;){var r;r=null==e?0:e.depth;var s;s=null==i?0:i.depth,r<s?(null!=i.cbSet&&this.mrca2.inlined_add(i),i=i.compound):(null!=e.cbSet&&this.mrca1.inlined_add(e),e=e.compound)}},__class__:o.space.ZPP_Space},o.space.ZPP_SweepData=function(){this.aabb=null,this.shape=null,this.prev=null,this.next=null},o.space.ZPP_SweepData.__name__=!0,o.space.ZPP_SweepData.prototype={free:function(){this.prev=null,this.shape=null,this.aabb=null},alloc:function(){},gt:function(t){return this.aabb.minx>t.aabb.minx},__class__:o.space.ZPP_SweepData},o.space.ZPP_SweepPhase=function(t){this.failed=null,this.list=null,this.space=t,this.is_sweep=!0,this.sweep=this};o.space.ZPP_SweepPhase.__name__=!0,o.space.ZPP_SweepPhase.__super__=o.space.ZPP_Broadphase,o.space.ZPP_SweepPhase.prototype=t(o.space.ZPP_Broadphase.prototype,{__insert:function(t){var n;null==o.space.ZPP_SweepData.zpp_pool?n=new o.space.ZPP_SweepData:(n=o.space.ZPP_SweepData.zpp_pool,o.space.ZPP_SweepData.zpp_pool=n.next,n.next=null),t.sweep=n,n.shape=t,n.aabb=t.aabb,n.next=this.list,null!=this.list&&(this.list.prev=n),this.list=n},__remove:function(t){var n=t.sweep;null==n.prev?this.list=n.next:n.prev.next=n.next,null!=n.next&&(n.next.prev=n.prev),t.sweep=null;var e=n;e.prev=null,e.shape=null,e.aabb=null,e.next=o.space.ZPP_SweepData.zpp_pool,o.space.ZPP_SweepData.zpp_pool=e},__sync:function(t){this.space.continuous||t.zip_aabb&&null!=t.body&&(t.zip_aabb=!1,t.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.circle.__validate_aabb():t.polygon.__validate_aabb())},sync_broadphase:function(){this.space.validation(),null!=this.list&&this.sync_broadphase_fast()},sync_broadphase_fast:function(){for(var t=this.list.next;null!=t;){var n=t.next,e=t.prev;if(t.aabb.minx>e.aabb.minx)t=n;else{for(;null!=e.prev&&e.prev.aabb.minx>t.aabb.minx;)e=e.prev;var i=t.prev;i.next=t.next,null!=t.next&&(t.next.prev=i),null==e.prev?(t.prev=null,this.list=t,t.next=e,e.prev=t):(t.prev=e.prev,e.prev=t,t.prev.next=t,t.next=e),t=n}}},broadphase:function(t,n){if(null!=this.list){this.sync_broadphase_fast();for(var e=this.list;null!=e;){for(var i=e.next,r=e.shape,s=r.body,l=e.aabb.maxx;null!=i&&!(i.aabb.minx>l);){var a=i.shape,p=a.body;p!=s&&(s.type!=o.util.ZPP_Flags.id_BodyType_STATIC||p.type!=o.util.ZPP_Flags.id_BodyType_STATIC)?s.component.sleeping&&p.component.sleeping?i=i.next:(r.aabb.intersectY(a.aabb)&&(n?t.narrowPhase(r,a,!(s.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&p.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC),null,!1):t.continuousEvent(r,a,!(s.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC&&p.type==o.util.ZPP_Flags.id_BodyType_DYNAMIC),null,!1)),i=i.next):i=i.next}e=e.next}}},clear:function(){for(;null!=this.list;)this.list.shape.removedFromSpace(),this.__remove(this.list.shape)},shapesUnderPoint:function(t,n,e,i){this.sync_broadphase();var r,s=o.geom.ZPP_Vec2.get(t,n,null);r=null==i?new p.shape.ShapeList:i;for(var l=this.list;null!=l&&l.aabb.minx>t;)l=l.next;for(;null!=l&&l.aabb.minx<=t;){if(l.aabb.maxx>=t&&l.aabb.miny<=n&&l.aabb.maxy>=n){var a=l.shape;(null==e||a.filter.shouldCollide(e))&&(a.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?o.geom.ZPP_Collide.circleContains(a.circle,s)&&r.push(a.outer):o.geom.ZPP_Collide.polyContains(a.polygon,s)&&r.push(a.outer))}l=l.next}var _=s;return null!=_.outer&&(_.outer.zpp_inner=null,_.outer=null),_._isimmutable=null,_._validate=null,_._invalidate=null,_.next=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=_,r},bodiesUnderPoint:function(t,n,e,i){this.sync_broadphase();var r,s=o.geom.ZPP_Vec2.get(t,n,null);r=null==i?new p.phys.BodyList:i;for(var l=this.list;null!=l&&l.aabb.minx>t;)l=l.next;for(;null!=l&&l.aabb.minx<=t;){if(l.aabb.maxx>=t&&l.aabb.miny<=n&&l.aabb.maxy>=n){var a=l.shape,_=a.body.outer;r.has(_)||(null==e||a.filter.shouldCollide(e))&&(a.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?o.geom.ZPP_Collide.circleContains(a.circle,s)&&r.push(_):o.geom.ZPP_Collide.polyContains(a.polygon,s)&&r.push(_))}l=l.next}var h=s;return null!=h.outer&&(h.outer.zpp_inner=null,h.outer=null),h._isimmutable=null,h._validate=null,h._invalidate=null,h.next=o.geom.ZPP_Vec2.zpp_pool,o.geom.ZPP_Vec2.zpp_pool=h,r},shapesInAABB:function(t,n,e,i,r){this.sync_broadphase(),this.updateAABBShape(t);var s,l=this.aabbShape.zpp_inner.aabb;s=null==r?new p.shape.ShapeList:r;for(var a=this.list;null!=a&&a.aabb.maxx<l.minx;)a=a.next;for(;null!=a&&a.aabb.minx<=l.maxx;){var _=a.shape;(null==i||_.filter.shouldCollide(i))&&(n?e?o.geom.ZPP_Collide.containTest(this.aabbShape.zpp_inner,_)&&s.push(_.outer):l.contains(a.aabb)?s.push(_.outer):a.aabb.intersect(l)&&o.geom.ZPP_Collide.testCollide_safe(_,this.aabbShape.zpp_inner)&&s.push(_.outer):(e?l.contains(a.aabb):a.aabb.intersect(l))&&s.push(_.outer)),a=a.next}return s},bodiesInAABB:function(t,n,e,i,r){this.sync_broadphase(),this.updateAABBShape(t);var s,l=this.aabbShape.zpp_inner.aabb;s=null==r?new p.phys.BodyList:r,null==this.failed&&(this.failed=new p.phys.BodyList);for(var a=this.list;null!=a&&a.aabb.maxx<l.minx;)a=a.next;for(;null!=a&&a.aabb.minx<=l.maxx;){var _=a.shape,h=_.body.outer;if(a.aabb.intersect(l)&&(null==i||_.filter.shouldCollide(i)))if(n)if(e){if(!this.failed.has(h)){var u=o.geom.ZPP_Collide.containTest(this.aabbShape.zpp_inner,_);!s.has(h)&&u?s.push(h):u||(s.remove(h),this.failed.push(h))}}else!s.has(h)&&o.geom.ZPP_Collide.testCollide_safe(_,this.aabbShape.zpp_inner)&&s.push(h);else if(e){if(!this.failed.has(h)){var d=l.contains(_.aabb);!s.has(h)&&d?s.push(h):d||(s.remove(h),this.failed.push(h))}}else!s.has(h)&&l.contains(_.aabb)&&s.push(h);a=a.next}return this.failed.clear(),s},shapesInCircle:function(t,n,e,i,r,s){this.sync_broadphase(),this.updateCircShape(t,n,e);var l,a=this.circShape.zpp_inner.aabb;l=null==s?new p.shape.ShapeList:s;for(var _=this.list;null!=_&&_.aabb.maxx<a.minx;)_=_.next;for(;null!=_&&_.aabb.minx<=a.maxx;){if(_.aabb.intersect(a)){var h=_.shape;(null==r||h.filter.shouldCollide(r))&&(i?o.geom.ZPP_Collide.containTest(this.circShape.zpp_inner,h)&&l.push(h.outer):o.geom.ZPP_Collide.testCollide_safe(h,this.circShape.zpp_inner)&&l.push(h.outer))}_=_.next}return l},bodiesInCircle:function(t,n,e,i,r,s){this.sync_broadphase(),this.updateCircShape(t,n,e);var l,a=this.circShape.zpp_inner.aabb;l=null==s?new p.phys.BodyList:s,null==this.failed&&(this.failed=new p.phys.BodyList);for(var _=this.list;null!=_&&_.aabb.maxx<a.minx;)_=_.next;for(;null!=_&&_.aabb.minx<=a.maxx;){if(_.aabb.intersect(a)){var h=_.shape,u=h.body.outer;if(null==r||h.filter.shouldCollide(r))if(i){if(!this.failed.has(u)){var d=o.geom.ZPP_Collide.containTest(this.circShape.zpp_inner,h);!l.has(u)&&d?l.push(u):d||(l.remove(u),this.failed.push(u))}}else!l.has(u)&&o.geom.ZPP_Collide.testCollide_safe(h,this.circShape.zpp_inner)&&l.push(u)}_=_.next}return this.failed.clear(),l},shapesInShape:function(t,n,e,i){this.sync_broadphase(),this.validateShape(t);var r,s=t.aabb;r=null==i?new p.shape.ShapeList:i;for(var l=this.list;null!=l&&l.aabb.maxx<s.minx;)l=l.next;for(;null!=l&&l.aabb.minx<=s.maxx;){if(l.aabb.intersect(s)){var a=l.shape;(null==e||a.filter.shouldCollide(e))&&(n?o.geom.ZPP_Collide.containTest(t,a)&&r.push(a.outer):o.geom.ZPP_Collide.testCollide_safe(a,t)&&r.push(a.outer))}l=l.next}return r},bodiesInShape:function(t,n,e,i){this.sync_broadphase(),this.validateShape(t);var r,s=t.aabb;r=null==i?new p.phys.BodyList:i,null==this.failed&&(this.failed=new p.phys.BodyList);for(var l=this.list;null!=l&&l.aabb.maxx<s.minx;)l=l.next;for(;null!=l&&l.aabb.minx<=s.maxx;){if(l.aabb.intersect(s)){var a=l.shape,_=a.body.outer;if(null==e||a.filter.shouldCollide(e))if(n){if(!this.failed.has(_)){var h=o.geom.ZPP_Collide.containTest(t,a);!r.has(_)&&h?r.push(_):h||(r.remove(_),this.failed.push(_))}}else!r.has(_)&&o.geom.ZPP_Collide.testCollide_safe(t,a)&&r.push(_)}l=l.next}return this.failed.clear(),r},rayCast:function(t,n,e){this.sync_broadphase(),t.validate_dir();var i=t.rayAABB(),r=t.maxdist,s=null;if(0==t.dirx)for(var l=this.list;null!=l&&l.aabb.minx<=i.minx;){if(l.aabb.intersect(i)&&(null==e||l.shape.filter.shouldCollide(e))){var a=t.aabbsect(l.aabb);if(a>=0&&a<r){var p;if(null!=(p=l.shape.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.circlesect(l.shape.circle,n,r):t.polysect(l.shape.polygon,n,r))){if(null!=p.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";if(r=p.zpp_inner.toiDistance,null!=s){if(null!=s.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";s.zpp_inner.free()}s=p}}}l=l.next}else if(t.dirx<0){for(var _=this.list,h=null;null!=_&&_.aabb.minx<=i.maxx;)h=_,_=_.next;for(_=h;null!=_;){if(_.aabb.intersect(i)&&(null==e||_.shape.filter.shouldCollide(e))){var u=t.aabbsect(_.aabb);if(u>=0&&u<r){var d;if(null!=(d=_.shape.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.circlesect(_.shape.circle,n,r):t.polysect(_.shape.polygon,n,r))){if(null!=d.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";if(r=d.zpp_inner.toiDistance,null!=s){if(null!=s.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";s.zpp_inner.free()}s=d}}}_=_.prev}}else for(var c=this.list;null!=c&&c.aabb.minx<=i.maxx&&c.aabb.minx<t.originx+t.dirx*r;){if(c.aabb.intersect(i)&&(null==e||c.shape.filter.shouldCollide(e))){var P=t.aabbsect(c.aabb);if(P>=0&&P<r){var f;if(null!=(f=c.shape.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.circlesect(c.shape.circle,n,r):t.polysect(c.shape.polygon,n,r))){if(null!=f.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";if(r=f.zpp_inner.toiDistance,null!=s){if(null!=s.zpp_inner.next)throw"Error: This object has been disposed of and cannot be used";s.zpp_inner.free()}s=f}}}c=c.next}var z=i;return null!=z.outer&&(z.outer.zpp_inner=null,z.outer=null),z.wrap_min=z.wrap_max=null,z._invalidate=null,z._validate=null,z.next=o.geom.ZPP_AABB.zpp_pool,o.geom.ZPP_AABB.zpp_pool=z,s},rayMultiCast:function(t,n,e,i){this.sync_broadphase(),t.validate_dir();var r,s=t.rayAABB();if(r=null==i?new p.geom.RayResultList:i,0==t.dirx)for(var l=this.list;null!=l&&l.aabb.minx<=s.minx;){if(l.aabb.intersect(s)&&(null==e||l.shape.filter.shouldCollide(e))){var a=t.aabbsect(l.aabb);a>=0&&(l.shape.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.circlesect2(l.shape.circle,n,r):t.polysect2(l.shape.polygon,n,r))}l=l.next}else if(t.dirx<0){for(var _=this.list,h=null;null!=_&&_.aabb.minx<=s.maxx;)h=_,_=_.next;for(_=h;null!=_;){if(_.aabb.intersect(s)&&(null==e||_.shape.filter.shouldCollide(e))){var u=t.aabbsect(_.aabb);u>=0&&(_.shape.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.circlesect2(_.shape.circle,n,r):t.polysect2(_.shape.polygon,n,r))}_=_.prev}}else for(var d=this.list;null!=d&&d.aabb.minx<=s.maxx;){if(d.aabb.intersect(s)&&(null==e||d.shape.filter.shouldCollide(e))){var c=t.aabbsect(d.aabb);c>=0&&(d.shape.type==o.util.ZPP_Flags.id_ShapeType_CIRCLE?t.circlesect2(d.shape.circle,n,r):t.polysect2(d.shape.polygon,n,r))}d=d.next}var P=s;return null!=P.outer&&(P.outer.zpp_inner=null,P.outer=null),P.wrap_min=P.wrap_max=null,P._invalidate=null,P._validate=null,P.next=o.geom.ZPP_AABB.zpp_pool,o.geom.ZPP_AABB.zpp_pool=P,r},__class__:o.space.ZPP_SweepPhase}),o.util.ZNPArray2_Float=function(t,n){this.width=0,this.list=null,this.width=t,this.list=new Array},o.util.ZNPArray2_Float.__name__=!0,o.util.ZNPArray2_Float.prototype={resize:function(t,n,e){this.width=t;for(var i=0,r=t*n;i<r;){var s=i++;this.list[s]=e}},get:function(t,n){return this.list[n*this.width+t]},set:function(t,n,e){return this.list[n*this.width+t]=e},__class__:o.util.ZNPArray2_Float},o.util.ZNPArray2_ZPP_GeomVert=function(t,n){this.width=0,this.list=null,this.width=t,this.list=new Array},o.util.ZNPArray2_ZPP_GeomVert.__name__=!0,o.util.ZNPArray2_ZPP_GeomVert.prototype={resize:function(t,n,e){this.width=t;for(var i=0,r=t*n;i<r;){var s=i++;this.list[s]=e}},get:function(t,n){return this.list[n*this.width+t]},set:function(t,n,e){return this.list[n*this.width+t]=e},__class__:o.util.ZNPArray2_ZPP_GeomVert},o.util.ZNPArray2_ZPP_MarchPair=function(t,n){this.width=0,this.list=null,this.width=t,this.list=new Array},o.util.ZNPArray2_ZPP_MarchPair.__name__=!0,o.util.ZNPArray2_ZPP_MarchPair.prototype={resize:function(t,n,e){this.width=t;for(var i=0,r=t*n;i<r;){var s=i++;this.list[s]=e}},get:function(t,n){return this.list[n*this.width+t]},set:function(t,n,e){return this.list[n*this.width+t]=e},__class__:o.util.ZNPArray2_ZPP_MarchPair},o.util.Hashable2_Boolfalse=function(){this.di=0,this.id=0,this.hnext=null,this.next=null,this.value=!1},o.util.Hashable2_Boolfalse.__name__=!0,o.util.Hashable2_Boolfalse.get=function(t,n,e){var i=o.util.Hashable2_Boolfalse.getpersist(t,n);return i.value=e,i},o.util.Hashable2_Boolfalse.getpersist=function(t,n){var e;return null==o.util.Hashable2_Boolfalse.zpp_pool?e=new o.util.Hashable2_Boolfalse:(e=o.util.Hashable2_Boolfalse.zpp_pool,o.util.Hashable2_Boolfalse.zpp_pool=e.next,e.next=null),e.id=t,e.di=n,e},o.util.Hashable2_Boolfalse.ordered_get=function(t,n,e){return t<=n?o.util.Hashable2_Boolfalse.get(t,n,e):o.util.Hashable2_Boolfalse.get(n,t,e)},o.util.Hashable2_Boolfalse.ordered_get_persist=function(t,n){return t<=n?o.util.Hashable2_Boolfalse.getpersist(t,n):o.util.Hashable2_Boolfalse.getpersist(n,t)},o.util.Hashable2_Boolfalse.prototype={free:function(){},alloc:function(){},__class__:o.util.Hashable2_Boolfalse},o.util.FastHash2_Hashable2_Boolfalse=function(){this.cnt=0,this.table=null,this.cnt=0,this.table=new Array;for(var t=0;t<1048576;){t++;this.table.push(null)}},o.util.FastHash2_Hashable2_Boolfalse.__name__=!0,o.util.FastHash2_Hashable2_Boolfalse.prototype={empty:function(){return 0==this.cnt},clear:function(){for(var t=0,n=this.table.length;t<n;){var e=t++,i=this.table[e];if(null!=i){for(;null!=i;){var r=i.hnext;i.hnext=null,i=r}this.table[e]=null}}},get:function(t,n){var e=this.table[106039*t+n&1048575];if(null==e)return null;if(e.id==t&&e.di==n)return e;do{e=e.hnext}while(null!=e&&(e.id!=t||e.di!=n));return e},ordered_get:function(t,n){if(t>n){var e=t;t=n,n=e}return this.get(t,n)},has:function(t,n){var e=this.table[106039*t+n&1048575];if(null==e)return!1;if(e.id==t&&e.di==n)return!0;do{e=e.hnext}while(null!=e&&(e.id!=t||e.di!=n));return null!=e},maybeAdd:function(t){var n=106039*t.id+t.di&1048575,e=this.table[n];null==e?(this.table[n]=t,t.hnext=null):(t.hnext=e.hnext,e.hnext=t),this.cnt++},add:function(t){var n=106039*t.id+t.di&1048575,e=this.table[n];null==e?(this.table[n]=t,t.hnext=null):(t.hnext=e.hnext,e.hnext=t),this.cnt++},remove:function(t){var n=106039*t.id+t.di&1048575,e=this.table[n];if(e==t)this.table[n]=e.hnext;else if(null!=e){var i;do{i=e,e=e.hnext}while(null!=e&&e!=t);i.hnext=e.hnext}t.hnext=null,this.cnt--},hash:function(t,n){return 106039*t+n&1048575},__class__:o.util.FastHash2_Hashable2_Boolfalse},o.util.ZNPList_ZPP_CallbackSet=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_CallbackSet.__name__=!0,o.util.ZNPList_ZPP_CallbackSet.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_CallbackSet.zpp_pool?e=new o.util.ZNPNode_ZPP_CallbackSet:(e=o.util.ZNPNode_ZPP_CallbackSet.zpp_pool,o.util.ZNPNode_ZPP_CallbackSet.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_CallbackSet.zpp_pool?i=new o.util.ZNPNode_ZPP_CallbackSet:(i=o.util.ZNPNode_ZPP_CallbackSet.zpp_pool,o.util.ZNPNode_ZPP_CallbackSet.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_CallbackSet.zpp_pool,o.util.ZNPNode_ZPP_CallbackSet.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_CallbackSet.zpp_pool,o.util.ZNPNode_ZPP_CallbackSet.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_CallbackSet},o.util.ZNPList_ZPP_Shape=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_Shape.__name__=!0,o.util.ZNPList_ZPP_Shape.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_Shape.zpp_pool?e=new o.util.ZNPNode_ZPP_Shape:(e=o.util.ZNPNode_ZPP_Shape.zpp_pool,o.util.ZNPNode_ZPP_Shape.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_Shape.zpp_pool?i=new o.util.ZNPNode_ZPP_Shape:(i=o.util.ZNPNode_ZPP_Shape.zpp_pool,o.util.ZNPNode_ZPP_Shape.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_Shape.zpp_pool,o.util.ZNPNode_ZPP_Shape.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_Shape.zpp_pool,o.util.ZNPNode_ZPP_Shape.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_Shape},o.util.ZNPList_ZPP_Body=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_Body.__name__=!0,o.util.ZNPList_ZPP_Body.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_Body.zpp_pool?e=new o.util.ZNPNode_ZPP_Body:(e=o.util.ZNPNode_ZPP_Body.zpp_pool,o.util.ZNPNode_ZPP_Body.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_Body.zpp_pool?i=new o.util.ZNPNode_ZPP_Body:(i=o.util.ZNPNode_ZPP_Body.zpp_pool,o.util.ZNPNode_ZPP_Body.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_Body.zpp_pool,o.util.ZNPNode_ZPP_Body.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_Body.zpp_pool,o.util.ZNPNode_ZPP_Body.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_Body},o.util.ZNPList_ZPP_Compound=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_Compound.__name__=!0,o.util.ZNPList_ZPP_Compound.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_Compound.zpp_pool?e=new o.util.ZNPNode_ZPP_Compound:(e=o.util.ZNPNode_ZPP_Compound.zpp_pool,o.util.ZNPNode_ZPP_Compound.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_Compound.zpp_pool?i=new o.util.ZNPNode_ZPP_Compound:(i=o.util.ZNPNode_ZPP_Compound.zpp_pool,o.util.ZNPNode_ZPP_Compound.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_Compound.zpp_pool,o.util.ZNPNode_ZPP_Compound.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_Compound.zpp_pool,o.util.ZNPNode_ZPP_Compound.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_Compound},o.util.ZNPList_ZPP_Arbiter=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_Arbiter.__name__=!0,o.util.ZNPList_ZPP_Arbiter.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_Arbiter.zpp_pool?e=new o.util.ZNPNode_ZPP_Arbiter:(e=o.util.ZNPNode_ZPP_Arbiter.zpp_pool,o.util.ZNPNode_ZPP_Arbiter.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_Arbiter.zpp_pool?i=new o.util.ZNPNode_ZPP_Arbiter:(i=o.util.ZNPNode_ZPP_Arbiter.zpp_pool,o.util.ZNPNode_ZPP_Arbiter.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,
t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_Arbiter.zpp_pool,o.util.ZNPNode_ZPP_Arbiter.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_Arbiter.zpp_pool,o.util.ZNPNode_ZPP_Arbiter.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_Arbiter},o.util.ZNPList_ZPP_CbSetPair=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_CbSetPair.__name__=!0,o.util.ZNPList_ZPP_CbSetPair.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_CbSetPair.zpp_pool?e=new o.util.ZNPNode_ZPP_CbSetPair:(e=o.util.ZNPNode_ZPP_CbSetPair.zpp_pool,o.util.ZNPNode_ZPP_CbSetPair.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_CbSetPair.zpp_pool?i=new o.util.ZNPNode_ZPP_CbSetPair:(i=o.util.ZNPNode_ZPP_CbSetPair.zpp_pool,o.util.ZNPNode_ZPP_CbSetPair.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_CbSetPair.zpp_pool,o.util.ZNPNode_ZPP_CbSetPair.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_CbSetPair.zpp_pool,o.util.ZNPNode_ZPP_CbSetPair.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_CbSetPair},o.util.ZNPList_ZPP_CutInt=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_CutInt.__name__=!0,o.util.ZNPList_ZPP_CutInt.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_CutInt.zpp_pool?e=new o.util.ZNPNode_ZPP_CutInt:(e=o.util.ZNPNode_ZPP_CutInt.zpp_pool,o.util.ZNPNode_ZPP_CutInt.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_CutInt.zpp_pool?i=new o.util.ZNPNode_ZPP_CutInt:(i=o.util.ZNPNode_ZPP_CutInt.zpp_pool,o.util.ZNPNode_ZPP_CutInt.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_CutInt.zpp_pool,o.util.ZNPNode_ZPP_CutInt.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_CutInt.zpp_pool,o.util.ZNPNode_ZPP_CutInt.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_CutInt},o.util.ZNPList_ZPP_CutVert=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_CutVert.__name__=!0,o.util.ZNPList_ZPP_CutVert.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_CutVert.zpp_pool?e=new o.util.ZNPNode_ZPP_CutVert:(e=o.util.ZNPNode_ZPP_CutVert.zpp_pool,o.util.ZNPNode_ZPP_CutVert.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_CutVert.zpp_pool?i=new o.util.ZNPNode_ZPP_CutVert:(i=o.util.ZNPNode_ZPP_CutVert.zpp_pool,o.util.ZNPNode_ZPP_CutVert.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_CutVert.zpp_pool,o.util.ZNPNode_ZPP_CutVert.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_CutVert.zpp_pool,o.util.ZNPNode_ZPP_CutVert.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_CutVert},o.util.ZNPList_ZPP_PartitionVertex=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_PartitionVertex.__name__=!0,o.util.ZNPList_ZPP_PartitionVertex.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_PartitionVertex.zpp_pool?e=new o.util.ZNPNode_ZPP_PartitionVertex:(e=o.util.ZNPNode_ZPP_PartitionVertex.zpp_pool,o.util.ZNPNode_ZPP_PartitionVertex.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_PartitionVertex.zpp_pool?i=new o.util.ZNPNode_ZPP_PartitionVertex:(i=o.util.ZNPNode_ZPP_PartitionVertex.zpp_pool,o.util.ZNPNode_ZPP_PartitionVertex.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_PartitionVertex.zpp_pool,o.util.ZNPNode_ZPP_PartitionVertex.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_PartitionVertex.zpp_pool,o.util.ZNPNode_ZPP_PartitionVertex.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_PartitionVertex},o.util.ZNPList_ZPP_PartitionedPoly=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_PartitionedPoly.__name__=!0,o.util.ZNPList_ZPP_PartitionedPoly.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_PartitionedPoly.zpp_pool?e=new o.util.ZNPNode_ZPP_PartitionedPoly:(e=o.util.ZNPNode_ZPP_PartitionedPoly.zpp_pool,o.util.ZNPNode_ZPP_PartitionedPoly.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_PartitionedPoly.zpp_pool?i=new o.util.ZNPNode_ZPP_PartitionedPoly:(i=o.util.ZNPNode_ZPP_PartitionedPoly.zpp_pool,o.util.ZNPNode_ZPP_PartitionedPoly.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_PartitionedPoly.zpp_pool,o.util.ZNPNode_ZPP_PartitionedPoly.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_PartitionedPoly.zpp_pool,o.util.ZNPNode_ZPP_PartitionedPoly.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_PartitionedPoly},o.util.ZNPList_ZPP_GeomVert=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_GeomVert.__name__=!0,o.util.ZNPList_ZPP_GeomVert.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_GeomVert.zpp_pool?e=new o.util.ZNPNode_ZPP_GeomVert:(e=o.util.ZNPNode_ZPP_GeomVert.zpp_pool,o.util.ZNPNode_ZPP_GeomVert.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_GeomVert.zpp_pool?i=new o.util.ZNPNode_ZPP_GeomVert:(i=o.util.ZNPNode_ZPP_GeomVert.zpp_pool,o.util.ZNPNode_ZPP_GeomVert.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_GeomVert.zpp_pool,o.util.ZNPNode_ZPP_GeomVert.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_GeomVert.zpp_pool,o.util.ZNPNode_ZPP_GeomVert.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_GeomVert},o.util.ZNPList_ZPP_SimplifyP=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_SimplifyP.__name__=!0,o.util.ZNPList_ZPP_SimplifyP.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_SimplifyP.zpp_pool?e=new o.util.ZNPNode_ZPP_SimplifyP:(e=o.util.ZNPNode_ZPP_SimplifyP.zpp_pool,o.util.ZNPNode_ZPP_SimplifyP.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_SimplifyP.zpp_pool?i=new o.util.ZNPNode_ZPP_SimplifyP:(i=o.util.ZNPNode_ZPP_SimplifyP.zpp_pool,o.util.ZNPNode_ZPP_SimplifyP.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_SimplifyP.zpp_pool,o.util.ZNPNode_ZPP_SimplifyP.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_SimplifyP.zpp_pool,o.util.ZNPNode_ZPP_SimplifyP.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_SimplifyP},o.util.ZNPList_ZPP_SimpleVert=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_SimpleVert.__name__=!0,o.util.ZNPList_ZPP_SimpleVert.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_SimpleVert.zpp_pool?e=new o.util.ZNPNode_ZPP_SimpleVert:(e=o.util.ZNPNode_ZPP_SimpleVert.zpp_pool,o.util.ZNPNode_ZPP_SimpleVert.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_SimpleVert.zpp_pool?i=new o.util.ZNPNode_ZPP_SimpleVert:(i=o.util.ZNPNode_ZPP_SimpleVert.zpp_pool,o.util.ZNPNode_ZPP_SimpleVert.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_SimpleVert.zpp_pool,o.util.ZNPNode_ZPP_SimpleVert.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_SimpleVert.zpp_pool,o.util.ZNPNode_ZPP_SimpleVert.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_SimpleVert},o.util.ZNPList_ZPP_SimpleEvent=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_SimpleEvent.__name__=!0,o.util.ZNPList_ZPP_SimpleEvent.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_SimpleEvent.zpp_pool?e=new o.util.ZNPNode_ZPP_SimpleEvent:(e=o.util.ZNPNode_ZPP_SimpleEvent.zpp_pool,o.util.ZNPNode_ZPP_SimpleEvent.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_SimpleEvent.zpp_pool?i=new o.util.ZNPNode_ZPP_SimpleEvent:(i=o.util.ZNPNode_ZPP_SimpleEvent.zpp_pool,o.util.ZNPNode_ZPP_SimpleEvent.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_SimpleEvent.zpp_pool,o.util.ZNPNode_ZPP_SimpleEvent.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_SimpleEvent.zpp_pool,o.util.ZNPNode_ZPP_SimpleEvent.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_SimpleEvent},o.util.ZNPList_ZPP_AABBPair=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_AABBPair.__name__=!0,o.util.ZNPList_ZPP_AABBPair.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_AABBPair.zpp_pool?e=new o.util.ZNPNode_ZPP_AABBPair:(e=o.util.ZNPNode_ZPP_AABBPair.zpp_pool,o.util.ZNPNode_ZPP_AABBPair.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_AABBPair.zpp_pool?i=new o.util.ZNPNode_ZPP_AABBPair:(i=o.util.ZNPNode_ZPP_AABBPair.zpp_pool,o.util.ZNPNode_ZPP_AABBPair.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_AABBPair.zpp_pool,o.util.ZNPNode_ZPP_AABBPair.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},
try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_AABBPair.zpp_pool,o.util.ZNPNode_ZPP_AABBPair.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_AABBPair},o.util.ZNPList_ZPP_Edge=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_Edge.__name__=!0,o.util.ZNPList_ZPP_Edge.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_Edge.zpp_pool?e=new o.util.ZNPNode_ZPP_Edge:(e=o.util.ZNPNode_ZPP_Edge.zpp_pool,o.util.ZNPNode_ZPP_Edge.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_Edge.zpp_pool?i=new o.util.ZNPNode_ZPP_Edge:(i=o.util.ZNPNode_ZPP_Edge.zpp_pool,o.util.ZNPNode_ZPP_Edge.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_Edge.zpp_pool,o.util.ZNPNode_ZPP_Edge.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_Edge.zpp_pool,o.util.ZNPNode_ZPP_Edge.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_Edge},o.util.ZNPList_ZPP_Component=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_Component.__name__=!0,o.util.ZNPList_ZPP_Component.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_Component.zpp_pool?e=new o.util.ZNPNode_ZPP_Component:(e=o.util.ZNPNode_ZPP_Component.zpp_pool,o.util.ZNPNode_ZPP_Component.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_Component.zpp_pool?i=new o.util.ZNPNode_ZPP_Component:(i=o.util.ZNPNode_ZPP_Component.zpp_pool,o.util.ZNPNode_ZPP_Component.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_Component.zpp_pool,o.util.ZNPNode_ZPP_Component.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_Component.zpp_pool,o.util.ZNPNode_ZPP_Component.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_Component},o.util.ZNPList_ZPP_AABBNode=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_AABBNode.__name__=!0,o.util.ZNPList_ZPP_AABBNode.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_AABBNode.zpp_pool?e=new o.util.ZNPNode_ZPP_AABBNode:(e=o.util.ZNPNode_ZPP_AABBNode.zpp_pool,o.util.ZNPNode_ZPP_AABBNode.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_AABBNode.zpp_pool?i=new o.util.ZNPNode_ZPP_AABBNode:(i=o.util.ZNPNode_ZPP_AABBNode.zpp_pool,o.util.ZNPNode_ZPP_AABBNode.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_AABBNode.zpp_pool,o.util.ZNPNode_ZPP_AABBNode.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_AABBNode.zpp_pool,o.util.ZNPNode_ZPP_AABBNode.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_AABBNode},o.util.ZNPList_ZPP_InteractionGroup=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_InteractionGroup.__name__=!0,o.util.ZNPList_ZPP_InteractionGroup.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_InteractionGroup.zpp_pool?e=new o.util.ZNPNode_ZPP_InteractionGroup:(e=o.util.ZNPNode_ZPP_InteractionGroup.zpp_pool,o.util.ZNPNode_ZPP_InteractionGroup.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_InteractionGroup.zpp_pool?i=new o.util.ZNPNode_ZPP_InteractionGroup:(i=o.util.ZNPNode_ZPP_InteractionGroup.zpp_pool,o.util.ZNPNode_ZPP_InteractionGroup.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_InteractionGroup.zpp_pool,o.util.ZNPNode_ZPP_InteractionGroup.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_InteractionGroup.zpp_pool,o.util.ZNPNode_ZPP_InteractionGroup.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_InteractionGroup},o.util.ZNPList_ZPP_FluidArbiter=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_FluidArbiter.__name__=!0,o.util.ZNPList_ZPP_FluidArbiter.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_FluidArbiter.zpp_pool?e=new o.util.ZNPNode_ZPP_FluidArbiter:(e=o.util.ZNPNode_ZPP_FluidArbiter.zpp_pool,o.util.ZNPNode_ZPP_FluidArbiter.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_FluidArbiter.zpp_pool?i=new o.util.ZNPNode_ZPP_FluidArbiter:(i=o.util.ZNPNode_ZPP_FluidArbiter.zpp_pool,o.util.ZNPNode_ZPP_FluidArbiter.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_FluidArbiter.zpp_pool,o.util.ZNPNode_ZPP_FluidArbiter.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_FluidArbiter.zpp_pool,o.util.ZNPNode_ZPP_FluidArbiter.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_FluidArbiter},o.util.ZNPList_ZPP_SensorArbiter=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_SensorArbiter.__name__=!0,o.util.ZNPList_ZPP_SensorArbiter.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_SensorArbiter.zpp_pool?e=new o.util.ZNPNode_ZPP_SensorArbiter:(e=o.util.ZNPNode_ZPP_SensorArbiter.zpp_pool,o.util.ZNPNode_ZPP_SensorArbiter.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_SensorArbiter.zpp_pool?i=new o.util.ZNPNode_ZPP_SensorArbiter:(i=o.util.ZNPNode_ZPP_SensorArbiter.zpp_pool,o.util.ZNPNode_ZPP_SensorArbiter.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_SensorArbiter.zpp_pool,o.util.ZNPNode_ZPP_SensorArbiter.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_SensorArbiter.zpp_pool,o.util.ZNPNode_ZPP_SensorArbiter.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_SensorArbiter},o.util.ZNPList_ZPP_ColArbiter=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_ColArbiter.__name__=!0,o.util.ZNPList_ZPP_ColArbiter.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_ColArbiter.zpp_pool?e=new o.util.ZNPNode_ZPP_ColArbiter:(e=o.util.ZNPNode_ZPP_ColArbiter.zpp_pool,o.util.ZNPNode_ZPP_ColArbiter.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_ColArbiter.zpp_pool?i=new o.util.ZNPNode_ZPP_ColArbiter:(i=o.util.ZNPNode_ZPP_ColArbiter.zpp_pool,o.util.ZNPNode_ZPP_ColArbiter.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_ColArbiter.zpp_pool,o.util.ZNPNode_ZPP_ColArbiter.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_ColArbiter.zpp_pool,o.util.ZNPNode_ZPP_ColArbiter.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_ColArbiter},o.util.ZNPList_ZPP_Listener=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_Listener.__name__=!0,o.util.ZNPList_ZPP_Listener.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_Listener.zpp_pool?e=new o.util.ZNPNode_ZPP_Listener:(e=o.util.ZNPNode_ZPP_Listener.zpp_pool,o.util.ZNPNode_ZPP_Listener.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_Listener.zpp_pool?i=new o.util.ZNPNode_ZPP_Listener:(i=o.util.ZNPNode_ZPP_Listener.zpp_pool,o.util.ZNPNode_ZPP_Listener.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_Listener.zpp_pool,o.util.ZNPNode_ZPP_Listener.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_Listener.zpp_pool,o.util.ZNPNode_ZPP_Listener.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_Listener},o.util.ZNPList_ZPP_ToiEvent=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_ToiEvent.__name__=!0,o.util.ZNPList_ZPP_ToiEvent.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_ToiEvent.zpp_pool?e=new o.util.ZNPNode_ZPP_ToiEvent:(e=o.util.ZNPNode_ZPP_ToiEvent.zpp_pool,o.util.ZNPNode_ZPP_ToiEvent.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_ToiEvent.zpp_pool?i=new o.util.ZNPNode_ZPP_ToiEvent:(i=o.util.ZNPNode_ZPP_ToiEvent.zpp_pool,o.util.ZNPNode_ZPP_ToiEvent.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_ToiEvent.zpp_pool,o.util.ZNPNode_ZPP_ToiEvent.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_ToiEvent.zpp_pool,o.util.ZNPNode_ZPP_ToiEvent.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_ToiEvent},o.util.ZNPList_ConvexResult=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ConvexResult.__name__=!0,o.util.ZNPList_ConvexResult.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ConvexResult.zpp_pool?e=new o.util.ZNPNode_ConvexResult:(e=o.util.ZNPNode_ConvexResult.zpp_pool,o.util.ZNPNode_ConvexResult.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ConvexResult.zpp_pool?i=new o.util.ZNPNode_ConvexResult:(i=o.util.ZNPNode_ConvexResult.zpp_pool,o.util.ZNPNode_ConvexResult.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ConvexResult.zpp_pool,o.util.ZNPNode_ConvexResult.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,
null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ConvexResult.zpp_pool,o.util.ZNPNode_ConvexResult.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ConvexResult},o.util.ZNPList_ZPP_GeomPoly=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_ZPP_GeomPoly.__name__=!0,o.util.ZNPList_ZPP_GeomPoly.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_ZPP_GeomPoly.zpp_pool?e=new o.util.ZNPNode_ZPP_GeomPoly:(e=o.util.ZNPNode_ZPP_GeomPoly.zpp_pool,o.util.ZNPNode_ZPP_GeomPoly.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_ZPP_GeomPoly.zpp_pool?i=new o.util.ZNPNode_ZPP_GeomPoly:(i=o.util.ZNPNode_ZPP_GeomPoly.zpp_pool,o.util.ZNPNode_ZPP_GeomPoly.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_ZPP_GeomPoly.zpp_pool,o.util.ZNPNode_ZPP_GeomPoly.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_ZPP_GeomPoly.zpp_pool,o.util.ZNPNode_ZPP_GeomPoly.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_ZPP_GeomPoly},o.util.ZNPList_RayResult=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null},o.util.ZNPList_RayResult.__name__=!0,o.util.ZNPList_RayResult.prototype={begin:function(){return this.head},setbegin:function(t){this.head=t,this.modified=!0,this.pushmod=!0},add:function(t){return this.inlined_add(t)},inlined_add:function(t){var n,e;return null==o.util.ZNPNode_RayResult.zpp_pool?e=new o.util.ZNPNode_RayResult:(e=o.util.ZNPNode_RayResult.zpp_pool,o.util.ZNPNode_RayResult.zpp_pool=e.next,e.next=null),e.elt=t,n=e,n.next=this.head,this.head=n,this.modified=!0,this.length++,t},addAll:function(t){for(var n=t.head;null!=n;){var e=n.elt;this.add(e),n=n.next}},insert:function(t,n){return this.inlined_insert(t,n)},inlined_insert:function(t,n){var e,i;return null==o.util.ZNPNode_RayResult.zpp_pool?i=new o.util.ZNPNode_RayResult:(i=o.util.ZNPNode_RayResult.zpp_pool,o.util.ZNPNode_RayResult.zpp_pool=i.next,i.next=null),i.elt=n,e=i,null==t?(e.next=this.head,this.head=e):(e.next=t.next,t.next=e),this.pushmod=this.modified=!0,this.length++,e},pop:function(){this.inlined_pop()},inlined_pop:function(){var t=this.head;this.head=t.next;var n=t;n.elt=null,n.next=o.util.ZNPNode_RayResult.zpp_pool,o.util.ZNPNode_RayResult.zpp_pool=n,null==this.head&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var t=this.head.elt;return this.pop(),t},remove:function(t){this.inlined_try_remove(t)},try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.erase(n),i=!0;break}n=e,e=e.next}return i},inlined_remove:function(t){this.inlined_try_remove(t)},inlined_try_remove:function(t){for(var n=null,e=this.head,i=!1;null!=e;){if(e.elt==t){this.inlined_erase(n),i=!0;break}n=e,e=e.next}return i},erase:function(t){return this.inlined_erase(t)},inlined_erase:function(t){var n,e;null==t?(n=this.head,e=n.next,this.head=e,null==this.head&&(this.pushmod=!0)):(n=t.next,e=n.next,t.next=e,null==e&&(this.pushmod=!0));var i=n;return i.elt=null,i.next=o.util.ZNPNode_RayResult.zpp_pool,o.util.ZNPNode_RayResult.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,e},splice:function(t,n){for(;n-- >0&&null!=t.next;)this.erase(t);return t.next},clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},inlined_clear:function(){for(;null!=this.head;)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var t=this.head,n=null;null!=t;){var e=t.next;t.next=n,this.head=t,n=t,t=e}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.head},size:function(){return this.length},has:function(t){return this.inlined_has(t)},inlined_has:function(t){var n;n=!1;for(var e=this.head;null!=e;){if(e.elt==t){n=!0;break}e=e.next}return n},front:function(){return this.head.elt},back:function(){for(var t=this.head,n=t;null!=n;)t=n,n=n.next;return t.elt},iterator_at:function(t){for(var n=this.head;t-- >0&&null!=n;)n=n.next;return n},at:function(t){var n=this.iterator_at(t);return null!=n?n.elt:null},__class__:o.util.ZNPList_RayResult},o.util.ZNPNode_ZPP_CbType=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_CbType.__name__=!0,o.util.ZNPNode_ZPP_CbType.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_CbType},o.util.ZNPNode_ZPP_CallbackSet=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_CallbackSet.__name__=!0,o.util.ZNPNode_ZPP_CallbackSet.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_CallbackSet},o.util.ZNPNode_ZPP_Shape=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_Shape.__name__=!0,o.util.ZNPNode_ZPP_Shape.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_Shape},o.util.ZNPNode_ZPP_Body=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_Body.__name__=!0,o.util.ZNPNode_ZPP_Body.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_Body},o.util.ZNPNode_ZPP_Constraint=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_Constraint.__name__=!0,o.util.ZNPNode_ZPP_Constraint.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_Constraint},o.util.ZNPNode_ZPP_Compound=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_Compound.__name__=!0,o.util.ZNPNode_ZPP_Compound.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_Compound},o.util.ZNPNode_ZPP_InteractionListener=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_InteractionListener.__name__=!0,o.util.ZNPNode_ZPP_InteractionListener.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_InteractionListener},o.util.ZNPNode_ZPP_CbSet=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_CbSet.__name__=!0,o.util.ZNPNode_ZPP_CbSet.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_CbSet},o.util.ZNPNode_ZPP_Interactor=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_Interactor.__name__=!0,o.util.ZNPNode_ZPP_Interactor.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_Interactor},o.util.ZNPNode_ZPP_BodyListener=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_BodyListener.__name__=!0,o.util.ZNPNode_ZPP_BodyListener.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_BodyListener},o.util.ZNPNode_ZPP_Arbiter=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_Arbiter.__name__=!0,o.util.ZNPNode_ZPP_Arbiter.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_Arbiter},o.util.ZNPNode_ZPP_ConstraintListener=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_ConstraintListener.__name__=!0,o.util.ZNPNode_ZPP_ConstraintListener.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_ConstraintListener},o.util.ZNPNode_ZPP_CbSetPair=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_CbSetPair.__name__=!0,o.util.ZNPNode_ZPP_CbSetPair.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_CbSetPair},o.util.ZNPNode_ZPP_CutInt=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_CutInt.__name__=!0,o.util.ZNPNode_ZPP_CutInt.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_CutInt},o.util.ZNPNode_ZPP_CutVert=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_CutVert.__name__=!0,o.util.ZNPNode_ZPP_CutVert.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_CutVert},o.util.ZNPNode_ZPP_PartitionVertex=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_PartitionVertex.__name__=!0,o.util.ZNPNode_ZPP_PartitionVertex.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_PartitionVertex},o.util.ZNPNode_ZPP_PartitionedPoly=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_PartitionedPoly.__name__=!0,o.util.ZNPNode_ZPP_PartitionedPoly.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_PartitionedPoly},o.util.ZNPNode_ZPP_GeomVert=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_GeomVert.__name__=!0,o.util.ZNPNode_ZPP_GeomVert.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_GeomVert},o.util.ZNPNode_ZPP_SimplifyP=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_SimplifyP.__name__=!0,o.util.ZNPNode_ZPP_SimplifyP.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_SimplifyP},o.util.ZNPNode_ZPP_SimpleVert=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_SimpleVert.__name__=!0,o.util.ZNPNode_ZPP_SimpleVert.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_SimpleVert},o.util.ZNPNode_ZPP_SimpleEvent=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_SimpleEvent.__name__=!0,o.util.ZNPNode_ZPP_SimpleEvent.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_SimpleEvent},o.util.ZNPNode_ZPP_AABBPair=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_AABBPair.__name__=!0,o.util.ZNPNode_ZPP_AABBPair.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_AABBPair},o.util.ZNPNode_ZPP_Edge=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_Edge.__name__=!0,o.util.ZNPNode_ZPP_Edge.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_Edge},o.util.ZNPNode_ZPP_Vec2=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_Vec2.__name__=!0,o.util.ZNPNode_ZPP_Vec2.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_Vec2},o.util.ZNPNode_ZPP_Component=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_Component.__name__=!0,o.util.ZNPNode_ZPP_Component.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_Component},o.util.ZNPNode_ZPP_AABBNode=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_AABBNode.__name__=!0,o.util.ZNPNode_ZPP_AABBNode.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_AABBNode},o.util.ZNPNode_ZPP_InteractionGroup=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_InteractionGroup.__name__=!0,o.util.ZNPNode_ZPP_InteractionGroup.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_InteractionGroup},o.util.ZNPNode_ZPP_FluidArbiter=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_FluidArbiter.__name__=!0,o.util.ZNPNode_ZPP_FluidArbiter.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_FluidArbiter},o.util.ZNPNode_ZPP_SensorArbiter=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_SensorArbiter.__name__=!0,o.util.ZNPNode_ZPP_SensorArbiter.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_SensorArbiter},o.util.ZNPNode_ZPP_ColArbiter=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_ColArbiter.__name__=!0,o.util.ZNPNode_ZPP_ColArbiter.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_ColArbiter},o.util.ZNPNode_ZPP_Listener=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_Listener.__name__=!0,o.util.ZNPNode_ZPP_Listener.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_Listener},o.util.ZNPNode_ZPP_ToiEvent=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_ToiEvent.__name__=!0,o.util.ZNPNode_ZPP_ToiEvent.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_ToiEvent},o.util.ZNPNode_ConvexResult=function(){this.elt=null,this.next=null};o.util.ZNPNode_ConvexResult.__name__=!0,o.util.ZNPNode_ConvexResult.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ConvexResult},o.util.ZNPNode_ZPP_GeomPoly=function(){this.elt=null,this.next=null},o.util.ZNPNode_ZPP_GeomPoly.__name__=!0,o.util.ZNPNode_ZPP_GeomPoly.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_ZPP_GeomPoly},o.util.ZNPNode_RayResult=function(){this.elt=null,this.next=null},o.util.ZNPNode_RayResult.__name__=!0,o.util.ZNPNode_RayResult.prototype={alloc:function(){},free:function(){this.elt=null},elem:function(){return this.elt},__class__:o.util.ZNPNode_RayResult},o.util.ZPP_MixVec2List=function(){this.at_index=0,this.at_ite=null,this.zip_length=!1,this._length=0,this.inner=null,p.geom.Vec2List.call(this),this.at_ite=null,this.at_index=0,this.zip_length=!0,this._length=0},o.util.ZPP_MixVec2List.__name__=!0,o.util.ZPP_MixVec2List.get=function(t,n){null==n&&(n=!1);var e=new o.util.ZPP_MixVec2List;return e.inner=t,e.zpp_inner.immutable=n,e},o.util.ZPP_MixVec2List.__super__=p.geom.Vec2List,o.util.ZPP_MixVec2List.prototype=t(p.geom.Vec2List.prototype,{zpp_gl:function(){if(this.zpp_vm(),this.zip_length){this._length=0;for(var t=this.inner.next;null!=t;){this._length++,t=t.next}this.zip_length=!1}return this._length},zpp_vm:function(){this.zpp_inner.validate(),this.inner.modified&&(this.zip_length=!0,this._length=0,this.at_ite=null)},at:function(t){if(this.zpp_vm(),t<0||t>=this.zpp_gl())throw"Error: Index out of bounds 16";if(this.zpp_inner.reverse_flag&&(t=this.zpp_gl()-1-t),t<this.at_index||null==this.at_ite)for(this.at_index=0,this.at_ite=this.inner.next;;){this.at_ite;break}for(;this.at_index!=t;)for(this.at_index++,this.at_ite=this.at_ite.next;;){this.at_ite;break}return this.at_ite.wrapper()},push:function(t){if(this.zpp_inner.immutable)throw"Error: Vec2List is immutable";if(this.zpp_inner.modify_test(),this.zpp_vm(),t.zpp_inner._inuse)throw"Error: Vec2 is already in use";var n;if(n=null==this.zpp_inner.adder||this.zpp_inner.adder(t)){if(this.zpp_inner.reverse_flag)this.inner.add(t.zpp_inner);else{var e=this.inner.iterator_at(this.zpp_gl()-1);this.inner.insert(e,t.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)}return n},unshift:function(t){if(this.zpp_inner.immutable)throw"Error: Vec2List is immutable";if(this.zpp_inner.modify_test(),this.zpp_vm(),t.zpp_inner._inuse)throw"Error: Vec2 is already in use";var n;if(n=null==this.zpp_inner.adder||this.zpp_inner.adder(t)){if(this.zpp_inner.reverse_flag){var e=this.inner.iterator_at(this.zpp_gl()-1);this.inner.insert(e,t.zpp_inner)}else this.inner.add(t.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(t)}return n},pop:function(){if(this.zpp_inner.immutable)throw"Error: Vec2List is immutable";if(this.zpp_inner.modify_test(),this.empty())throw"Error: Cannot remove from empty list";this.zpp_vm();var t=null;if(this.zpp_inner.reverse_flag){t=this.inner.next;var n=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.inner.pop()}else{null!=this.at_ite&&null==this.at_ite.next&&(this.at_ite=null);var e;e=1==this.zpp_gl()?null:this.inner.iterator_at(this.zpp_gl()-2),t=null==e?this.inner.next:e.next;var i=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.inner.erase(e)}return this.zpp_inner.invalidate(),t.wrapper()},shift:function(){if(this.zpp_inner.immutable)throw"Error: Vec2List is immutable";if(this.zpp_inner.modify_test(),this.empty())throw"Error: Cannot remove from empty list";this.zpp_vm();var t=null;if(this.zpp_inner.reverse_flag){null!=this.at_ite&&null==this.at_ite.next&&(this.at_ite=null);var n;n=1==this.zpp_gl()?null:this.inner.iterator_at(this.zpp_gl()-2),t=null==n?this.inner.next:n.next;var e=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.inner.erase(n)}else{t=this.inner.next;var i=t.wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.inner.pop()}return this.zpp_inner.invalidate(),t.wrapper()},remove:function(t){if(this.zpp_inner.immutable)throw"Error: Vec2List is immutable";this.zpp_inner.modify_test(),this.zpp_vm();var n;n=!1;for(var e=this.inner.next;null!=e;){var i=e;if(t.zpp_inner==i){n=!0;break}e=e.next}return n&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.inner.remove(t.zpp_inner),this.zpp_inner.invalidate()),n},clear:function(){if(this.zpp_inner.immutable)throw"Error: Vec2List is immutable";if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},__class__:o.util.ZPP_MixVec2List}),o.util.ZPP_ConstraintList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new o.util.ZNPList_ZPP_Constraint,this._invalidated=!0},o.util.ZPP_ConstraintList.__name__=!0,o.util.ZPP_ConstraintList.get=function(t,n){null==n&&(n=!1);var e=new p.constraint.ConstraintList;return e.zpp_inner.inner=t,n&&(e.zpp_inner.immutable=!0),e.zpp_inner.zip_length=!0,e},o.util.ZPP_ConstraintList.prototype={valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},__class__:o.util.ZPP_ConstraintList},o.util.ZPP_BodyList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new o.util.ZNPList_ZPP_Body,this._invalidated=!0},o.util.ZPP_BodyList.__name__=!0,o.util.ZPP_BodyList.get=function(t,n){null==n&&(n=!1);var e=new p.phys.BodyList;return e.zpp_inner.inner=t,n&&(e.zpp_inner.immutable=!0),e.zpp_inner.zip_length=!0,e},o.util.ZPP_BodyList.prototype={valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},__class__:o.util.ZPP_BodyList},o.util.ZPP_InteractorList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new o.util.ZNPList_ZPP_Interactor,this._invalidated=!0},o.util.ZPP_InteractorList.__name__=!0,o.util.ZPP_InteractorList.get=function(t,n){null==n&&(n=!1);var e=new p.phys.InteractorList;return e.zpp_inner.inner=t,n&&(e.zpp_inner.immutable=!0),e.zpp_inner.zip_length=!0,e},o.util.ZPP_InteractorList.prototype={valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},__class__:o.util.ZPP_InteractorList},o.util.ZPP_CompoundList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new o.util.ZNPList_ZPP_Compound,this._invalidated=!0},o.util.ZPP_CompoundList.__name__=!0,o.util.ZPP_CompoundList.get=function(t,n){null==n&&(n=!1);var e=new p.phys.CompoundList;return e.zpp_inner.inner=t,n&&(e.zpp_inner.immutable=!0),e.zpp_inner.zip_length=!0,e},o.util.ZPP_CompoundList.prototype={valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},__class__:o.util.ZPP_CompoundList},o.util.ZPP_ListenerList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new o.util.ZNPList_ZPP_Listener,this._invalidated=!0},o.util.ZPP_ListenerList.__name__=!0,o.util.ZPP_ListenerList.get=function(t,n){null==n&&(n=!1);var e=new p.callbacks.ListenerList;return e.zpp_inner.inner=t,n&&(e.zpp_inner.immutable=!0),e.zpp_inner.zip_length=!0,e},o.util.ZPP_ListenerList.prototype={valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},__class__:o.util.ZPP_ListenerList},o.util.ZPP_CbTypeList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new o.util.ZNPList_ZPP_CbType,this._invalidated=!0},o.util.ZPP_CbTypeList.__name__=!0,o.util.ZPP_CbTypeList.get=function(t,n){null==n&&(n=!1);var e=new p.callbacks.CbTypeList;return e.zpp_inner.inner=t,n&&(e.zpp_inner.immutable=!0),e.zpp_inner.zip_length=!0,e},o.util.ZPP_CbTypeList.prototype={valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},__class__:o.util.ZPP_CbTypeList},o.util.ZPP_Vec2List=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new o.util.ZNPList_ZPP_Vec2,this._invalidated=!0},o.util.ZPP_Vec2List.__name__=!0,o.util.ZPP_Vec2List.get=function(t,n){null==n&&(n=!1);var e=new p.geom.Vec2List;return e.zpp_inner.inner=t,n&&(e.zpp_inner.immutable=!0),e.zpp_inner.zip_length=!0,e},o.util.ZPP_Vec2List.prototype={valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},__class__:o.util.ZPP_Vec2List},o.util.ZPP_GeomPolyList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new o.util.ZNPList_ZPP_GeomPoly,this._invalidated=!0},o.util.ZPP_GeomPolyList.__name__=!0,o.util.ZPP_GeomPolyList.get=function(t,n){null==n&&(n=!1);var e=new p.geom.GeomPolyList;return e.zpp_inner.inner=t,n&&(e.zpp_inner.immutable=!0),e.zpp_inner.zip_length=!0,e},o.util.ZPP_GeomPolyList.prototype={valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},__class__:o.util.ZPP_GeomPolyList},o.util.ZPP_RayResultList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new o.util.ZNPList_RayResult,this._invalidated=!0},o.util.ZPP_RayResultList.__name__=!0,o.util.ZPP_RayResultList.get=function(t,n){null==n&&(n=!1);var e=new p.geom.RayResultList;return e.zpp_inner.inner=t,n&&(e.zpp_inner.immutable=!0),e.zpp_inner.zip_length=!0,e},o.util.ZPP_RayResultList.prototype={valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},__class__:o.util.ZPP_RayResultList},o.util.ZPP_ConvexResultList=function(){
this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new o.util.ZNPList_ConvexResult,this._invalidated=!0},o.util.ZPP_ConvexResultList.__name__=!0,o.util.ZPP_ConvexResultList.get=function(t,n){null==n&&(n=!1);var e=new p.geom.ConvexResultList;return e.zpp_inner.inner=t,n&&(e.zpp_inner.immutable=!0),e.zpp_inner.zip_length=!0,e},o.util.ZPP_ConvexResultList.prototype={valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},__class__:o.util.ZPP_ConvexResultList},o.util.ZPP_EdgeList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new o.util.ZNPList_ZPP_Edge,this._invalidated=!0},o.util.ZPP_EdgeList.__name__=!0,o.util.ZPP_EdgeList.get=function(t,n){null==n&&(n=!1);var e=new p.shape.EdgeList;return e.zpp_inner.inner=t,n&&(e.zpp_inner.immutable=!0),e.zpp_inner.zip_length=!0,e},o.util.ZPP_EdgeList.prototype={valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},__class__:o.util.ZPP_EdgeList},o.util.ZPP_ShapeList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new o.util.ZNPList_ZPP_Shape,this._invalidated=!0},o.util.ZPP_ShapeList.__name__=!0,o.util.ZPP_ShapeList.get=function(t,n){null==n&&(n=!1);var e=new p.shape.ShapeList;return e.zpp_inner.inner=t,n&&(e.zpp_inner.immutable=!0),e.zpp_inner.zip_length=!0,e},o.util.ZPP_ShapeList.prototype={valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},__class__:o.util.ZPP_ShapeList},o.util.ZPP_InteractionGroupList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new o.util.ZNPList_ZPP_InteractionGroup,this._invalidated=!0},o.util.ZPP_InteractionGroupList.__name__=!0,o.util.ZPP_InteractionGroupList.get=function(t,n){null==n&&(n=!1);var e=new p.dynamics.InteractionGroupList;return e.zpp_inner.inner=t,n&&(e.zpp_inner.immutable=!0),e.zpp_inner.zip_length=!0,e},o.util.ZPP_InteractionGroupList.prototype={valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},__class__:o.util.ZPP_InteractionGroupList},o.util.ZPP_ArbiterList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new o.util.ZNPList_ZPP_Arbiter,this._invalidated=!0},o.util.ZPP_ArbiterList.__name__=!0,o.util.ZPP_ArbiterList.get=function(t,n){null==n&&(n=!1);var e=new p.dynamics.ArbiterList;return e.zpp_inner.inner=t,n&&(e.zpp_inner.immutable=!0),e.zpp_inner.zip_length=!0,e},o.util.ZPP_ArbiterList.prototype={valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},__class__:o.util.ZPP_ArbiterList},o.util.ZPP_ContactList=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new o.dynamics.ZPP_Contact,this._invalidated=!0},o.util.ZPP_ContactList.__name__=!0,o.util.ZPP_ContactList.get=function(t,n){null==n&&(n=!1);var e=new p.dynamics.ContactList;return e.zpp_inner.inner=t,n&&(e.zpp_inner.immutable=!0),e.zpp_inner.zip_length=!0,e},o.util.ZPP_ContactList.prototype={valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){null!=this._modifiable&&this._modifiable()},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},__class__:o.util.ZPP_ContactList},o.util.ZPP_Math=function(){},o.util.ZPP_Math.__name__=!0,o.util.ZPP_Math.sqrt=function(t){return Math.sqrt(t)},o.util.ZPP_Math.invsqrt=function(t){return 1/Math.sqrt(t)},o.util.ZPP_Math.sqr=function(t){return t*t},o.util.ZPP_Math.clamp2=function(t,n){return o.util.ZPP_Math.clamp(t,-n,n)},o.util.ZPP_Math.clamp=function(t,n,e){return t<n?n:t>e?e:t},o.util.ZPP_PubPool=function(){},o.util.ZPP_PubPool.__name__=!0,o.util.ZPP_Set_ZPP_Body=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null},o.util.ZPP_Set_ZPP_Body.__name__=!0,o.util.ZPP_Set_ZPP_Body.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},verify:function(){if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;){var n=t.data,e=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(e){if(n==r)e=!1;else if(!this.lt(r,n)&&this.lt(n,r))return!1}else if(!this.lt(n,r)&&this.lt(r,n))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var t=0;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){n.data;if(t++,null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},has:function(t){return null!=this.find(t)},find:function(t){for(var n=this.parent;null!=n&&n.data!=t;)n=this.lt(t,n.data)?n.prev:n.next;return n},has_weak:function(t){return null!=this.find_weak(t)},find_weak:function(t){for(var n=this.parent;null!=n;)if(this.lt(t,n.data))n=n.prev;else{if(!this.lt(n.data,t))break;n=n.next}return n},lower_bound:function(t){var n=null;if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var i=e.data;if(!this.lt(i,t)){n=i;break}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return n},first:function(){for(var t=this.parent;null!=t.prev;)t=t.prev;return t.data},pop_front:function(){for(var t=this.parent;null!=t.prev;)t=t.prev;var n=t.data;return this.remove_node(t),n},remove:function(t){var n=this.find(t);this.remove_node(n)},successor_node:function(t){if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{var n=t;for(t=t.parent;null!=t&&t.prev!=n;)n=t,t=t.parent}return t},predecessor_node:function(t){if(null!=t.prev)for(t=t.prev;null!=t.next;)t=t.next;else{var n=t;for(t=t.parent;null!=t&&t.next!=n;)n=t,t=t.parent}return t},successor:function(t){var n=this.successor_node(this.find(t));return null==n?null:n.data},predecessor:function(t){var n=this.predecessor_node(this.find(t));return null==n?null:n.data},remove_node:function(t){if(null!=t.next&&null!=t.prev){for(var n=t.next;null!=n.prev;)n=n.prev;var e=t.data;t.data=n.data,n.data=e,null!=this.swapped&&this.swapped(t.data,n.data),t=n}var i;if(i=null==t.prev?t.next:t.prev,1==t.colour)if(null!=t.prev||null!=t.next)i.colour=1;else if(null!=t.parent)for(var r=t.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var s=r.prev;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}var l=r.next;if(-1==l.colour){this.__fix_neg_red(l);break}if(0==l.colour){if(null!=l.prev&&0==l.prev.colour){this.__fix_dbl_red(l.prev);break}if(null!=l.next&&0==l.next.colour){this.__fix_dbl_red(l.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var a=t.parent;null==a?this.parent=i:a.prev==t?a.prev=i:a.next=i,null!=i&&(i.parent=a),t.parent=t.prev=t.next=null;var p=t;p.data=null,p.lt=null,p.swapped=null,p.next=o.util.ZPP_Set_ZPP_Body.zpp_pool,o.util.ZPP_Set_ZPP_Body.zpp_pool=p},clear:function(){this.clear_with(function(t){})},clear_with:function(t){if(null!=this.parent){for(var n=this.parent;null!=n;)n=null!=n.prev?n.prev:null!=n.next?n.next:this.clear_node(n,t);this.parent=null}},clear_node:function(t,n){n(t.data);var e=t.parent;null!=e&&(t==e.prev?e.prev=null:e.next=null,t.parent=null);var i=t;return i.data=null,i.lt=null,i.swapped=null,i.next=o.util.ZPP_Set_ZPP_Body.zpp_pool,o.util.ZPP_Set_ZPP_Body.zpp_pool=i,e},__fix_neg_red:function(t){var n,e=t.parent;if(e.prev==t){var i=t.prev,r=t.next,s=r.prev,l=r.next;i.colour=0,t.colour=e.colour=1,t.next=s,null!=s&&(s.parent=t);var a=e.data;e.data=r.data,r.data=a,null!=this.swapped&&this.swapped(e.data,r.data),r.prev=l,null!=l&&(l.parent=r),r.next=e.next,null!=e.next&&(e.next.parent=r),e.next=r,null!=r&&(r.parent=e),n=i}else{var p=t.next,o=t.prev,_=o.next,h=o.prev;p.colour=0,t.colour=e.colour=1,t.prev=_,null!=_&&(_.parent=t);var u=e.data;e.data=o.data,o.data=u,null!=this.swapped&&this.swapped(e.data,o.data),o.next=h,null!=h&&(h.parent=o),o.prev=e.prev,null!=e.prev&&(e.prev.parent=o),e.prev=o,null!=o&&(o.parent=e),n=p}null!=n.prev&&0==n.prev.colour?this.__fix_dbl_red(n.prev):null!=n.next&&0==n.next.colour&&this.__fix_dbl_red(n.next)},__fix_dbl_red:function(t){for(;;){var n=t.parent,e=n.parent;if(null==e){n.colour=1;break}var i,r,s,l,a,p,o;n==e.prev?(s=e,o=e.next,t==n.prev?(i=t,r=n,l=t.prev,a=t.next,p=n.next):(i=n,r=t,l=n.prev,a=t.prev,p=t.next)):(i=e,l=e.prev,t==n.prev?(r=t,s=n,a=t.prev,p=t.next,o=n.next):(r=n,s=t,a=n.prev,p=t.prev,o=t.next));var _=e.parent;if(null==_?this.parent=r:_.prev==e?_.prev=r:_.next=r,null!=r&&(r.parent=_),i.prev=l,null!=l&&(l.parent=i),i.next=a,null!=a&&(a.parent=i),r.prev=i,null!=i&&(i.parent=r),r.next=s,null!=s&&(s.parent=r),s.prev=p,null!=p&&(p.parent=s),s.next=o,null!=o&&(o.parent=s),r.colour=e.colour-1,i.colour=1,s.colour=1,r==this.parent)this.parent.colour=1;else if(0==r.colour&&0==r.parent.colour){t=r;continue}break}},try_insert_bool:function(t){var n=null,e=null;if(null==this.parent)null==o.util.ZPP_Set_ZPP_Body.zpp_pool?n=new o.util.ZPP_Set_ZPP_Body:(n=o.util.ZPP_Set_ZPP_Body.zpp_pool,o.util.ZPP_Set_ZPP_Body.zpp_pool=n.next,n.next=null),n.data=t,this.parent=n;else for(e=this.parent;;)if(this.lt(t,e.data)){if(null==e.prev){null==o.util.ZPP_Set_ZPP_Body.zpp_pool?n=new o.util.ZPP_Set_ZPP_Body:(n=o.util.ZPP_Set_ZPP_Body.zpp_pool,o.util.ZPP_Set_ZPP_Body.zpp_pool=n.next,n.next=null),n.data=t,e.prev=n,n.parent=e;break}e=e.prev}else{if(!this.lt(e.data,t))break;if(null==e.next){null==o.util.ZPP_Set_ZPP_Body.zpp_pool?n=new o.util.ZPP_Set_ZPP_Body:(n=o.util.ZPP_Set_ZPP_Body.zpp_pool,o.util.ZPP_Set_ZPP_Body.zpp_pool=n.next,n.next=null),n.data=t,e.next=n,n.parent=e;break}e=e.next}return null!=n&&(null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),!0)},try_insert:function(t){var n=null,e=null;if(null==this.parent)null==o.util.ZPP_Set_ZPP_Body.zpp_pool?n=new o.util.ZPP_Set_ZPP_Body:(n=o.util.ZPP_Set_ZPP_Body.zpp_pool,o.util.ZPP_Set_ZPP_Body.zpp_pool=n.next,n.next=null),n.data=t,this.parent=n;else for(e=this.parent;;)if(this.lt(t,e.data)){if(null==e.prev){null==o.util.ZPP_Set_ZPP_Body.zpp_pool?n=new o.util.ZPP_Set_ZPP_Body:(n=o.util.ZPP_Set_ZPP_Body.zpp_pool,o.util.ZPP_Set_ZPP_Body.zpp_pool=n.next,n.next=null),n.data=t,e.prev=n,n.parent=e;break}e=e.prev}else{if(!this.lt(e.data,t))break;if(null==e.next){null==o.util.ZPP_Set_ZPP_Body.zpp_pool?n=new o.util.ZPP_Set_ZPP_Body:(n=o.util.ZPP_Set_ZPP_Body.zpp_pool,o.util.ZPP_Set_ZPP_Body.zpp_pool=n.next,n.next=null),n.data=t,e.next=n,n.parent=e;break}e=e.next}return null==n?e:(null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),n)},insert:function(t){var n;if(null==o.util.ZPP_Set_ZPP_Body.zpp_pool?n=new o.util.ZPP_Set_ZPP_Body:(n=o.util.ZPP_Set_ZPP_Body.zpp_pool,o.util.ZPP_Set_ZPP_Body.zpp_pool=n.next,n.next=null),n.data=t,null==this.parent)this.parent=n;else for(var e=this.parent;;)if(this.lt(n.data,e.data)){if(null==e.prev){e.prev=n,n.parent=e;break}e=e.prev}else{if(null==e.next){e.next=n,n.parent=e;break}e=e.next}return null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),n},__class__:o.util.ZPP_Set_ZPP_Body},o.util.ZPP_Set_ZPP_CbSetPair=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null},o.util.ZPP_Set_ZPP_CbSetPair.__name__=!0,o.util.ZPP_Set_ZPP_CbSetPair.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},verify:function(){if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;){var n=t.data,e=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(e){if(n==r)e=!1;else if(!this.lt(r,n)&&this.lt(n,r))return!1}else if(!this.lt(n,r)&&this.lt(r,n))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var t=0;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){n.data;if(t++,null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},has:function(t){return null!=this.find(t)},find:function(t){for(var n=this.parent;null!=n&&n.data!=t;)n=this.lt(t,n.data)?n.prev:n.next;return n},has_weak:function(t){return null!=this.find_weak(t)},find_weak:function(t){for(var n=this.parent;null!=n;)if(this.lt(t,n.data))n=n.prev;else{if(!this.lt(n.data,t))break;n=n.next}return n},lower_bound:function(t){var n=null;if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var i=e.data;if(!this.lt(i,t)){n=i;break}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return n},first:function(){for(var t=this.parent;null!=t.prev;)t=t.prev;return t.data},pop_front:function(){for(var t=this.parent;null!=t.prev;)t=t.prev;var n=t.data;return this.remove_node(t),n},remove:function(t){var n=this.find(t);this.remove_node(n)},successor_node:function(t){if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{var n=t;for(t=t.parent;null!=t&&t.prev!=n;)n=t,t=t.parent}return t},predecessor_node:function(t){if(null!=t.prev)for(t=t.prev;null!=t.next;)t=t.next;else{var n=t;for(t=t.parent;null!=t&&t.next!=n;)n=t,t=t.parent}return t},successor:function(t){var n=this.successor_node(this.find(t));return null==n?null:n.data},predecessor:function(t){var n=this.predecessor_node(this.find(t));return null==n?null:n.data},remove_node:function(t){if(null!=t.next&&null!=t.prev){for(var n=t.next;null!=n.prev;)n=n.prev;var e=t.data;t.data=n.data,n.data=e,null!=this.swapped&&this.swapped(t.data,n.data),t=n}var i;if(i=null==t.prev?t.next:t.prev,1==t.colour)if(null!=t.prev||null!=t.next)i.colour=1;else if(null!=t.parent)for(var r=t.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var s=r.prev;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}var l=r.next;if(-1==l.colour){this.__fix_neg_red(l);break}if(0==l.colour){if(null!=l.prev&&0==l.prev.colour){this.__fix_dbl_red(l.prev);break}if(null!=l.next&&0==l.next.colour){this.__fix_dbl_red(l.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var a=t.parent;null==a?this.parent=i:a.prev==t?a.prev=i:a.next=i,null!=i&&(i.parent=a),t.parent=t.prev=t.next=null;var p=t;p.data=null,p.lt=null,p.swapped=null,p.next=o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool,o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool=p},clear:function(){this.clear_with(function(t){})},clear_with:function(t){if(null!=this.parent){for(var n=this.parent;null!=n;)n=null!=n.prev?n.prev:null!=n.next?n.next:this.clear_node(n,t);this.parent=null}},clear_node:function(t,n){n(t.data);var e=t.parent;null!=e&&(t==e.prev?e.prev=null:e.next=null,t.parent=null);var i=t;return i.data=null,i.lt=null,i.swapped=null,i.next=o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool,o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool=i,e},__fix_neg_red:function(t){var n,e=t.parent;if(e.prev==t){var i=t.prev,r=t.next,s=r.prev,l=r.next;i.colour=0,t.colour=e.colour=1,t.next=s,null!=s&&(s.parent=t);var a=e.data;e.data=r.data,r.data=a,null!=this.swapped&&this.swapped(e.data,r.data),r.prev=l,null!=l&&(l.parent=r),r.next=e.next,null!=e.next&&(e.next.parent=r),e.next=r,null!=r&&(r.parent=e),n=i}else{var p=t.next,o=t.prev,_=o.next,h=o.prev;p.colour=0,t.colour=e.colour=1,t.prev=_,null!=_&&(_.parent=t);var u=e.data;e.data=o.data,o.data=u,null!=this.swapped&&this.swapped(e.data,o.data),o.next=h,null!=h&&(h.parent=o),o.prev=e.prev,null!=e.prev&&(e.prev.parent=o),e.prev=o,null!=o&&(o.parent=e),n=p}null!=n.prev&&0==n.prev.colour?this.__fix_dbl_red(n.prev):null!=n.next&&0==n.next.colour&&this.__fix_dbl_red(n.next)},__fix_dbl_red:function(t){for(;;){var n=t.parent,e=n.parent;if(null==e){n.colour=1;break}var i,r,s,l,a,p,o;n==e.prev?(s=e,o=e.next,t==n.prev?(i=t,r=n,l=t.prev,a=t.next,p=n.next):(i=n,r=t,l=n.prev,a=t.prev,p=t.next)):(i=e,l=e.prev,t==n.prev?(r=t,s=n,a=t.prev,p=t.next,o=n.next):(r=n,s=t,a=n.prev,p=t.prev,o=t.next));var _=e.parent;if(null==_?this.parent=r:_.prev==e?_.prev=r:_.next=r,null!=r&&(r.parent=_),i.prev=l,null!=l&&(l.parent=i),i.next=a,null!=a&&(a.parent=i),r.prev=i,null!=i&&(i.parent=r),r.next=s,null!=s&&(s.parent=r),s.prev=p,null!=p&&(p.parent=s),s.next=o,null!=o&&(o.parent=s),r.colour=e.colour-1,i.colour=1,s.colour=1,r==this.parent)this.parent.colour=1;else if(0==r.colour&&0==r.parent.colour){t=r;continue}break}},try_insert_bool:function(t){var n=null,e=null;if(null==this.parent)null==o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool?n=new o.util.ZPP_Set_ZPP_CbSetPair:(n=o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool,o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool=n.next,n.next=null),n.data=t,this.parent=n;else for(e=this.parent;;)if(this.lt(t,e.data)){if(null==e.prev){null==o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool?n=new o.util.ZPP_Set_ZPP_CbSetPair:(n=o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool,o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool=n.next,n.next=null),n.data=t,e.prev=n,n.parent=e;break}e=e.prev}else{if(!this.lt(e.data,t))break;if(null==e.next){null==o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool?n=new o.util.ZPP_Set_ZPP_CbSetPair:(n=o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool,o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool=n.next,n.next=null),n.data=t,e.next=n,n.parent=e;break}e=e.next}return null!=n&&(null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),!0)},try_insert:function(t){var n=null,e=null;if(null==this.parent)null==o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool?n=new o.util.ZPP_Set_ZPP_CbSetPair:(n=o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool,o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool=n.next,n.next=null),n.data=t,this.parent=n;else for(e=this.parent;;)if(this.lt(t,e.data)){if(null==e.prev){null==o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool?n=new o.util.ZPP_Set_ZPP_CbSetPair:(n=o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool,o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool=n.next,n.next=null),n.data=t,e.prev=n,n.parent=e;break}e=e.prev}else{if(!this.lt(e.data,t))break;if(null==e.next){null==o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool?n=new o.util.ZPP_Set_ZPP_CbSetPair:(n=o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool,o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool=n.next,n.next=null),n.data=t,e.next=n,n.parent=e;break}e=e.next}return null==n?e:(null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),n)},insert:function(t){var n;if(null==o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool?n=new o.util.ZPP_Set_ZPP_CbSetPair:(n=o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool,o.util.ZPP_Set_ZPP_CbSetPair.zpp_pool=n.next,n.next=null),n.data=t,null==this.parent)this.parent=n;else for(var e=this.parent;;)if(this.lt(n.data,e.data)){if(null==e.prev){e.prev=n,n.parent=e;break}e=e.prev}else{if(null==e.next){e.next=n,n.parent=e;break}e=e.next}return null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),n},__class__:o.util.ZPP_Set_ZPP_CbSetPair},o.util.ZPP_Set_ZPP_PartitionVertex=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null},o.util.ZPP_Set_ZPP_PartitionVertex.__name__=!0,o.util.ZPP_Set_ZPP_PartitionVertex.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},verify:function(){if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;){var n=t.data,e=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(e){if(n==r)e=!1;else if(!this.lt(r,n)&&this.lt(n,r))return!1}else if(!this.lt(n,r)&&this.lt(r,n))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var t=0;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){n.data;if(t++,null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},has:function(t){return null!=this.find(t)},find:function(t){for(var n=this.parent;null!=n&&n.data!=t;)n=this.lt(t,n.data)?n.prev:n.next;return n},has_weak:function(t){return null!=this.find_weak(t)},find_weak:function(t){for(var n=this.parent;null!=n;)if(this.lt(t,n.data))n=n.prev;else{if(!this.lt(n.data,t))break;n=n.next}return n},lower_bound:function(t){var n=null;if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var i=e.data;if(!this.lt(i,t)){n=i;break}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return n},first:function(){for(var t=this.parent;null!=t.prev;)t=t.prev;return t.data},pop_front:function(){for(var t=this.parent;null!=t.prev;)t=t.prev;var n=t.data;return this.remove_node(t),n},remove:function(t){var n=this.find(t);this.remove_node(n)},successor_node:function(t){if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{var n=t;for(t=t.parent;null!=t&&t.prev!=n;)n=t,t=t.parent}return t},predecessor_node:function(t){if(null!=t.prev)for(t=t.prev;null!=t.next;)t=t.next;else{var n=t;for(t=t.parent;null!=t&&t.next!=n;)n=t,t=t.parent}return t},successor:function(t){var n=this.successor_node(this.find(t));return null==n?null:n.data},predecessor:function(t){var n=this.predecessor_node(this.find(t));return null==n?null:n.data},remove_node:function(t){if(null!=t.next&&null!=t.prev){for(var n=t.next;null!=n.prev;)n=n.prev;var e=t.data;t.data=n.data,n.data=e,null!=this.swapped&&this.swapped(t.data,n.data),t=n}var i;if(i=null==t.prev?t.next:t.prev,1==t.colour)if(null!=t.prev||null!=t.next)i.colour=1;else if(null!=t.parent)for(var r=t.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var s=r.prev;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}var l=r.next;if(-1==l.colour){this.__fix_neg_red(l);break}if(0==l.colour){if(null!=l.prev&&0==l.prev.colour){this.__fix_dbl_red(l.prev);break}if(null!=l.next&&0==l.next.colour){this.__fix_dbl_red(l.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var a=t.parent;null==a?this.parent=i:a.prev==t?a.prev=i:a.next=i,null!=i&&(i.parent=a),t.parent=t.prev=t.next=null;var p=t;p.data=null,p.lt=null,p.swapped=null,p.next=o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool,o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool=p},clear:function(){this.clear_with(function(t){})},clear_with:function(t){if(null!=this.parent){for(var n=this.parent;null!=n;)n=null!=n.prev?n.prev:null!=n.next?n.next:this.clear_node(n,t);this.parent=null}},clear_node:function(t,n){n(t.data);var e=t.parent;null!=e&&(t==e.prev?e.prev=null:e.next=null,t.parent=null);var i=t;return i.data=null,i.lt=null,i.swapped=null,i.next=o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool,o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool=i,e},__fix_neg_red:function(t){var n,e=t.parent;if(e.prev==t){var i=t.prev,r=t.next,s=r.prev,l=r.next;i.colour=0,t.colour=e.colour=1,t.next=s,null!=s&&(s.parent=t);var a=e.data;e.data=r.data,r.data=a,null!=this.swapped&&this.swapped(e.data,r.data),r.prev=l,null!=l&&(l.parent=r),r.next=e.next,null!=e.next&&(e.next.parent=r),e.next=r,null!=r&&(r.parent=e),n=i}else{var p=t.next,o=t.prev,_=o.next,h=o.prev;p.colour=0,t.colour=e.colour=1,t.prev=_,null!=_&&(_.parent=t);var u=e.data;e.data=o.data,o.data=u,null!=this.swapped&&this.swapped(e.data,o.data),o.next=h,null!=h&&(h.parent=o),o.prev=e.prev,null!=e.prev&&(e.prev.parent=o),e.prev=o,null!=o&&(o.parent=e),n=p}null!=n.prev&&0==n.prev.colour?this.__fix_dbl_red(n.prev):null!=n.next&&0==n.next.colour&&this.__fix_dbl_red(n.next)},__fix_dbl_red:function(t){for(;;){var n=t.parent,e=n.parent;if(null==e){n.colour=1;break}var i,r,s,l,a,p,o;n==e.prev?(s=e,o=e.next,t==n.prev?(i=t,r=n,l=t.prev,a=t.next,p=n.next):(i=n,r=t,l=n.prev,a=t.prev,p=t.next)):(i=e,l=e.prev,t==n.prev?(r=t,s=n,a=t.prev,p=t.next,o=n.next):(r=n,s=t,a=n.prev,p=t.prev,o=t.next));var _=e.parent;if(null==_?this.parent=r:_.prev==e?_.prev=r:_.next=r,null!=r&&(r.parent=_),i.prev=l,null!=l&&(l.parent=i),i.next=a,null!=a&&(a.parent=i),r.prev=i,null!=i&&(i.parent=r),r.next=s,null!=s&&(s.parent=r),s.prev=p,null!=p&&(p.parent=s),s.next=o,null!=o&&(o.parent=s),r.colour=e.colour-1,i.colour=1,s.colour=1,r==this.parent)this.parent.colour=1;else if(0==r.colour&&0==r.parent.colour){t=r;continue}break}},try_insert_bool:function(t){var n=null,e=null;if(null==this.parent)null==o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool?n=new o.util.ZPP_Set_ZPP_PartitionVertex:(n=o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool,o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool=n.next,n.next=null),n.data=t,this.parent=n;else for(e=this.parent;;)if(this.lt(t,e.data)){if(null==e.prev){null==o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool?n=new o.util.ZPP_Set_ZPP_PartitionVertex:(n=o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool,o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool=n.next,n.next=null),n.data=t,e.prev=n,n.parent=e;break}e=e.prev}else{if(!this.lt(e.data,t))break;if(null==e.next){null==o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool?n=new o.util.ZPP_Set_ZPP_PartitionVertex:(n=o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool,o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool=n.next,n.next=null),n.data=t,e.next=n,n.parent=e;break}e=e.next}return null!=n&&(null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),!0)},try_insert:function(t){var n=null,e=null;if(null==this.parent)null==o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool?n=new o.util.ZPP_Set_ZPP_PartitionVertex:(n=o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool,o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool=n.next,n.next=null),n.data=t,this.parent=n;else for(e=this.parent;;)if(this.lt(t,e.data)){if(null==e.prev){null==o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool?n=new o.util.ZPP_Set_ZPP_PartitionVertex:(n=o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool,o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool=n.next,n.next=null),n.data=t,e.prev=n,n.parent=e;break}e=e.prev}else{if(!this.lt(e.data,t))break;if(null==e.next){null==o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool?n=new o.util.ZPP_Set_ZPP_PartitionVertex:(n=o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool,o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool=n.next,n.next=null),n.data=t,e.next=n,n.parent=e;break}e=e.next}return null==n?e:(null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),n)},insert:function(t){var n;if(null==o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool?n=new o.util.ZPP_Set_ZPP_PartitionVertex:(n=o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool,o.util.ZPP_Set_ZPP_PartitionVertex.zpp_pool=n.next,n.next=null),n.data=t,null==this.parent)this.parent=n;else for(var e=this.parent;;)if(this.lt(n.data,e.data)){if(null==e.prev){e.prev=n,n.parent=e;break}e=e.prev}else{if(null==e.next){e.next=n,n.parent=e;break}e=e.next}return null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),n},__class__:o.util.ZPP_Set_ZPP_PartitionVertex},o.util.ZPP_Set_ZPP_PartitionPair=function(){this.colour=0,
this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null},o.util.ZPP_Set_ZPP_PartitionPair.__name__=!0,o.util.ZPP_Set_ZPP_PartitionPair.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},verify:function(){if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;){var n=t.data,e=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(e){if(n==r)e=!1;else if(!this.lt(r,n)&&this.lt(n,r))return!1}else if(!this.lt(n,r)&&this.lt(r,n))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var t=0;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){n.data;if(t++,null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},has:function(t){return null!=this.find(t)},find:function(t){for(var n=this.parent;null!=n&&n.data!=t;)n=this.lt(t,n.data)?n.prev:n.next;return n},has_weak:function(t){return null!=this.find_weak(t)},find_weak:function(t){for(var n=this.parent;null!=n;)if(this.lt(t,n.data))n=n.prev;else{if(!this.lt(n.data,t))break;n=n.next}return n},lower_bound:function(t){var n=null;if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var i=e.data;if(!this.lt(i,t)){n=i;break}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return n},first:function(){for(var t=this.parent;null!=t.prev;)t=t.prev;return t.data},pop_front:function(){for(var t=this.parent;null!=t.prev;)t=t.prev;var n=t.data;return this.remove_node(t),n},remove:function(t){var n=this.find(t);this.remove_node(n)},successor_node:function(t){if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{var n=t;for(t=t.parent;null!=t&&t.prev!=n;)n=t,t=t.parent}return t},predecessor_node:function(t){if(null!=t.prev)for(t=t.prev;null!=t.next;)t=t.next;else{var n=t;for(t=t.parent;null!=t&&t.next!=n;)n=t,t=t.parent}return t},successor:function(t){var n=this.successor_node(this.find(t));return null==n?null:n.data},predecessor:function(t){var n=this.predecessor_node(this.find(t));return null==n?null:n.data},remove_node:function(t){if(null!=t.next&&null!=t.prev){for(var n=t.next;null!=n.prev;)n=n.prev;var e=t.data;t.data=n.data,n.data=e,null!=this.swapped&&this.swapped(t.data,n.data),t=n}var i;if(i=null==t.prev?t.next:t.prev,1==t.colour)if(null!=t.prev||null!=t.next)i.colour=1;else if(null!=t.parent)for(var r=t.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var s=r.prev;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}var l=r.next;if(-1==l.colour){this.__fix_neg_red(l);break}if(0==l.colour){if(null!=l.prev&&0==l.prev.colour){this.__fix_dbl_red(l.prev);break}if(null!=l.next&&0==l.next.colour){this.__fix_dbl_red(l.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var a=t.parent;null==a?this.parent=i:a.prev==t?a.prev=i:a.next=i,null!=i&&(i.parent=a),t.parent=t.prev=t.next=null;var p=t;p.data=null,p.lt=null,p.swapped=null,p.next=o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool,o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool=p},clear:function(){this.clear_with(function(t){})},clear_with:function(t){if(null!=this.parent){for(var n=this.parent;null!=n;)n=null!=n.prev?n.prev:null!=n.next?n.next:this.clear_node(n,t);this.parent=null}},clear_node:function(t,n){n(t.data);var e=t.parent;null!=e&&(t==e.prev?e.prev=null:e.next=null,t.parent=null);var i=t;return i.data=null,i.lt=null,i.swapped=null,i.next=o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool,o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool=i,e},__fix_neg_red:function(t){var n,e=t.parent;if(e.prev==t){var i=t.prev,r=t.next,s=r.prev,l=r.next;i.colour=0,t.colour=e.colour=1,t.next=s,null!=s&&(s.parent=t);var a=e.data;e.data=r.data,r.data=a,null!=this.swapped&&this.swapped(e.data,r.data),r.prev=l,null!=l&&(l.parent=r),r.next=e.next,null!=e.next&&(e.next.parent=r),e.next=r,null!=r&&(r.parent=e),n=i}else{var p=t.next,o=t.prev,_=o.next,h=o.prev;p.colour=0,t.colour=e.colour=1,t.prev=_,null!=_&&(_.parent=t);var u=e.data;e.data=o.data,o.data=u,null!=this.swapped&&this.swapped(e.data,o.data),o.next=h,null!=h&&(h.parent=o),o.prev=e.prev,null!=e.prev&&(e.prev.parent=o),e.prev=o,null!=o&&(o.parent=e),n=p}null!=n.prev&&0==n.prev.colour?this.__fix_dbl_red(n.prev):null!=n.next&&0==n.next.colour&&this.__fix_dbl_red(n.next)},__fix_dbl_red:function(t){for(;;){var n=t.parent,e=n.parent;if(null==e){n.colour=1;break}var i,r,s,l,a,p,o;n==e.prev?(s=e,o=e.next,t==n.prev?(i=t,r=n,l=t.prev,a=t.next,p=n.next):(i=n,r=t,l=n.prev,a=t.prev,p=t.next)):(i=e,l=e.prev,t==n.prev?(r=t,s=n,a=t.prev,p=t.next,o=n.next):(r=n,s=t,a=n.prev,p=t.prev,o=t.next));var _=e.parent;if(null==_?this.parent=r:_.prev==e?_.prev=r:_.next=r,null!=r&&(r.parent=_),i.prev=l,null!=l&&(l.parent=i),i.next=a,null!=a&&(a.parent=i),r.prev=i,null!=i&&(i.parent=r),r.next=s,null!=s&&(s.parent=r),s.prev=p,null!=p&&(p.parent=s),s.next=o,null!=o&&(o.parent=s),r.colour=e.colour-1,i.colour=1,s.colour=1,r==this.parent)this.parent.colour=1;else if(0==r.colour&&0==r.parent.colour){t=r;continue}break}},try_insert_bool:function(t){var n=null,e=null;if(null==this.parent)null==o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool?n=new o.util.ZPP_Set_ZPP_PartitionPair:(n=o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool,o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool=n.next,n.next=null),n.data=t,this.parent=n;else for(e=this.parent;;)if(this.lt(t,e.data)){if(null==e.prev){null==o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool?n=new o.util.ZPP_Set_ZPP_PartitionPair:(n=o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool,o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool=n.next,n.next=null),n.data=t,e.prev=n,n.parent=e;break}e=e.prev}else{if(!this.lt(e.data,t))break;if(null==e.next){null==o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool?n=new o.util.ZPP_Set_ZPP_PartitionPair:(n=o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool,o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool=n.next,n.next=null),n.data=t,e.next=n,n.parent=e;break}e=e.next}return null!=n&&(null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),!0)},try_insert:function(t){var n=null,e=null;if(null==this.parent)null==o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool?n=new o.util.ZPP_Set_ZPP_PartitionPair:(n=o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool,o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool=n.next,n.next=null),n.data=t,this.parent=n;else for(e=this.parent;;)if(this.lt(t,e.data)){if(null==e.prev){null==o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool?n=new o.util.ZPP_Set_ZPP_PartitionPair:(n=o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool,o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool=n.next,n.next=null),n.data=t,e.prev=n,n.parent=e;break}e=e.prev}else{if(!this.lt(e.data,t))break;if(null==e.next){null==o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool?n=new o.util.ZPP_Set_ZPP_PartitionPair:(n=o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool,o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool=n.next,n.next=null),n.data=t,e.next=n,n.parent=e;break}e=e.next}return null==n?e:(null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),n)},insert:function(t){var n;if(null==o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool?n=new o.util.ZPP_Set_ZPP_PartitionPair:(n=o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool,o.util.ZPP_Set_ZPP_PartitionPair.zpp_pool=n.next,n.next=null),n.data=t,null==this.parent)this.parent=n;else for(var e=this.parent;;)if(this.lt(n.data,e.data)){if(null==e.prev){e.prev=n,n.parent=e;break}e=e.prev}else{if(null==e.next){e.next=n,n.parent=e;break}e=e.next}return null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),n},__class__:o.util.ZPP_Set_ZPP_PartitionPair},o.util.ZPP_Set_ZPP_SimpleVert=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null},o.util.ZPP_Set_ZPP_SimpleVert.__name__=!0,o.util.ZPP_Set_ZPP_SimpleVert.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},verify:function(){if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;){var n=t.data,e=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(e){if(n==r)e=!1;else if(!this.lt(r,n)&&this.lt(n,r))return!1}else if(!this.lt(n,r)&&this.lt(r,n))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var t=0;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){n.data;if(t++,null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},has:function(t){return null!=this.find(t)},find:function(t){for(var n=this.parent;null!=n&&n.data!=t;)n=this.lt(t,n.data)?n.prev:n.next;return n},has_weak:function(t){return null!=this.find_weak(t)},find_weak:function(t){for(var n=this.parent;null!=n;)if(this.lt(t,n.data))n=n.prev;else{if(!this.lt(n.data,t))break;n=n.next}return n},lower_bound:function(t){var n=null;if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var i=e.data;if(!this.lt(i,t)){n=i;break}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return n},first:function(){for(var t=this.parent;null!=t.prev;)t=t.prev;return t.data},pop_front:function(){for(var t=this.parent;null!=t.prev;)t=t.prev;var n=t.data;return this.remove_node(t),n},remove:function(t){var n=this.find(t);this.remove_node(n)},successor_node:function(t){if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{var n=t;for(t=t.parent;null!=t&&t.prev!=n;)n=t,t=t.parent}return t},predecessor_node:function(t){if(null!=t.prev)for(t=t.prev;null!=t.next;)t=t.next;else{var n=t;for(t=t.parent;null!=t&&t.next!=n;)n=t,t=t.parent}return t},successor:function(t){var n=this.successor_node(this.find(t));return null==n?null:n.data},predecessor:function(t){var n=this.predecessor_node(this.find(t));return null==n?null:n.data},remove_node:function(t){if(null!=t.next&&null!=t.prev){for(var n=t.next;null!=n.prev;)n=n.prev;var e=t.data;t.data=n.data,n.data=e,null!=this.swapped&&this.swapped(t.data,n.data),t=n}var i;if(i=null==t.prev?t.next:t.prev,1==t.colour)if(null!=t.prev||null!=t.next)i.colour=1;else if(null!=t.parent)for(var r=t.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var s=r.prev;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}var l=r.next;if(-1==l.colour){this.__fix_neg_red(l);break}if(0==l.colour){if(null!=l.prev&&0==l.prev.colour){this.__fix_dbl_red(l.prev);break}if(null!=l.next&&0==l.next.colour){this.__fix_dbl_red(l.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var a=t.parent;null==a?this.parent=i:a.prev==t?a.prev=i:a.next=i,null!=i&&(i.parent=a),t.parent=t.prev=t.next=null;var p=t;p.data=null,p.lt=null,p.swapped=null,p.next=o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool,o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool=p},clear:function(){this.clear_with(function(t){})},clear_with:function(t){if(null!=this.parent){for(var n=this.parent;null!=n;)n=null!=n.prev?n.prev:null!=n.next?n.next:this.clear_node(n,t);this.parent=null}},clear_node:function(t,n){n(t.data);var e=t.parent;null!=e&&(t==e.prev?e.prev=null:e.next=null,t.parent=null);var i=t;return i.data=null,i.lt=null,i.swapped=null,i.next=o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool,o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool=i,e},__fix_neg_red:function(t){var n,e=t.parent;if(e.prev==t){var i=t.prev,r=t.next,s=r.prev,l=r.next;i.colour=0,t.colour=e.colour=1,t.next=s,null!=s&&(s.parent=t);var a=e.data;e.data=r.data,r.data=a,null!=this.swapped&&this.swapped(e.data,r.data),r.prev=l,null!=l&&(l.parent=r),r.next=e.next,null!=e.next&&(e.next.parent=r),e.next=r,null!=r&&(r.parent=e),n=i}else{var p=t.next,o=t.prev,_=o.next,h=o.prev;p.colour=0,t.colour=e.colour=1,t.prev=_,null!=_&&(_.parent=t);var u=e.data;e.data=o.data,o.data=u,null!=this.swapped&&this.swapped(e.data,o.data),o.next=h,null!=h&&(h.parent=o),o.prev=e.prev,null!=e.prev&&(e.prev.parent=o),e.prev=o,null!=o&&(o.parent=e),n=p}null!=n.prev&&0==n.prev.colour?this.__fix_dbl_red(n.prev):null!=n.next&&0==n.next.colour&&this.__fix_dbl_red(n.next)},__fix_dbl_red:function(t){for(;;){var n=t.parent,e=n.parent;if(null==e){n.colour=1;break}var i,r,s,l,a,p,o;n==e.prev?(s=e,o=e.next,t==n.prev?(i=t,r=n,l=t.prev,a=t.next,p=n.next):(i=n,r=t,l=n.prev,a=t.prev,p=t.next)):(i=e,l=e.prev,t==n.prev?(r=t,s=n,a=t.prev,p=t.next,o=n.next):(r=n,s=t,a=n.prev,p=t.prev,o=t.next));var _=e.parent;if(null==_?this.parent=r:_.prev==e?_.prev=r:_.next=r,null!=r&&(r.parent=_),i.prev=l,null!=l&&(l.parent=i),i.next=a,null!=a&&(a.parent=i),r.prev=i,null!=i&&(i.parent=r),r.next=s,null!=s&&(s.parent=r),s.prev=p,null!=p&&(p.parent=s),s.next=o,null!=o&&(o.parent=s),r.colour=e.colour-1,i.colour=1,s.colour=1,r==this.parent)this.parent.colour=1;else if(0==r.colour&&0==r.parent.colour){t=r;continue}break}},try_insert_bool:function(t){var n=null,e=null;if(null==this.parent)null==o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleVert:(n=o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool,o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool=n.next,n.next=null),n.data=t,this.parent=n;else for(e=this.parent;;)if(this.lt(t,e.data)){if(null==e.prev){null==o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleVert:(n=o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool,o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool=n.next,n.next=null),n.data=t,e.prev=n,n.parent=e;break}e=e.prev}else{if(!this.lt(e.data,t))break;if(null==e.next){null==o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleVert:(n=o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool,o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool=n.next,n.next=null),n.data=t,e.next=n,n.parent=e;break}e=e.next}return null!=n&&(null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),!0)},try_insert:function(t){var n=null,e=null;if(null==this.parent)null==o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleVert:(n=o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool,o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool=n.next,n.next=null),n.data=t,this.parent=n;else for(e=this.parent;;)if(this.lt(t,e.data)){if(null==e.prev){null==o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleVert:(n=o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool,o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool=n.next,n.next=null),n.data=t,e.prev=n,n.parent=e;break}e=e.prev}else{if(!this.lt(e.data,t))break;if(null==e.next){null==o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleVert:(n=o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool,o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool=n.next,n.next=null),n.data=t,e.next=n,n.parent=e;break}e=e.next}return null==n?e:(null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),n)},insert:function(t){var n;if(null==o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleVert:(n=o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool,o.util.ZPP_Set_ZPP_SimpleVert.zpp_pool=n.next,n.next=null),n.data=t,null==this.parent)this.parent=n;else for(var e=this.parent;;)if(this.lt(n.data,e.data)){if(null==e.prev){e.prev=n,n.parent=e;break}e=e.prev}else{if(null==e.next){e.next=n,n.parent=e;break}e=e.next}return null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),n},__class__:o.util.ZPP_Set_ZPP_SimpleVert},o.util.ZPP_Set_ZPP_SimpleSeg=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null},o.util.ZPP_Set_ZPP_SimpleSeg.__name__=!0,o.util.ZPP_Set_ZPP_SimpleSeg.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},verify:function(){if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;){var n=t.data,e=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(e){if(n==r)e=!1;else if(!this.lt(r,n)&&this.lt(n,r))return!1}else if(!this.lt(n,r)&&this.lt(r,n))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var t=0;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){n.data;if(t++,null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},has:function(t){return null!=this.find(t)},find:function(t){for(var n=this.parent;null!=n&&n.data!=t;)n=this.lt(t,n.data)?n.prev:n.next;return n},has_weak:function(t){return null!=this.find_weak(t)},find_weak:function(t){for(var n=this.parent;null!=n;)if(this.lt(t,n.data))n=n.prev;else{if(!this.lt(n.data,t))break;n=n.next}return n},lower_bound:function(t){var n=null;if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var i=e.data;if(!this.lt(i,t)){n=i;break}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return n},first:function(){for(var t=this.parent;null!=t.prev;)t=t.prev;return t.data},pop_front:function(){for(var t=this.parent;null!=t.prev;)t=t.prev;var n=t.data;return this.remove_node(t),n},remove:function(t){var n=this.find(t);this.remove_node(n)},successor_node:function(t){if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{var n=t;for(t=t.parent;null!=t&&t.prev!=n;)n=t,t=t.parent}return t},predecessor_node:function(t){if(null!=t.prev)for(t=t.prev;null!=t.next;)t=t.next;else{var n=t;for(t=t.parent;null!=t&&t.next!=n;)n=t,t=t.parent}return t},successor:function(t){var n=this.successor_node(this.find(t));return null==n?null:n.data},predecessor:function(t){var n=this.predecessor_node(this.find(t));return null==n?null:n.data},remove_node:function(t){if(null!=t.next&&null!=t.prev){for(var n=t.next;null!=n.prev;)n=n.prev;var e=t.data;t.data=n.data,n.data=e,null!=this.swapped&&this.swapped(t.data,n.data),t=n}var i;if(i=null==t.prev?t.next:t.prev,1==t.colour)if(null!=t.prev||null!=t.next)i.colour=1;else if(null!=t.parent)for(var r=t.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var s=r.prev;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}var l=r.next;if(-1==l.colour){this.__fix_neg_red(l);break}if(0==l.colour){if(null!=l.prev&&0==l.prev.colour){this.__fix_dbl_red(l.prev);break}if(null!=l.next&&0==l.next.colour){this.__fix_dbl_red(l.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var a=t.parent;null==a?this.parent=i:a.prev==t?a.prev=i:a.next=i,null!=i&&(i.parent=a),t.parent=t.prev=t.next=null;var p=t;p.data=null,p.lt=null,p.swapped=null,p.next=o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool,o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool=p},clear:function(){this.clear_with(function(t){})},clear_with:function(t){if(null!=this.parent){for(var n=this.parent;null!=n;)n=null!=n.prev?n.prev:null!=n.next?n.next:this.clear_node(n,t);this.parent=null}},clear_node:function(t,n){n(t.data);var e=t.parent;null!=e&&(t==e.prev?e.prev=null:e.next=null,t.parent=null);var i=t;return i.data=null,i.lt=null,i.swapped=null,i.next=o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool,o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool=i,e},__fix_neg_red:function(t){var n,e=t.parent;if(e.prev==t){var i=t.prev,r=t.next,s=r.prev,l=r.next;i.colour=0,t.colour=e.colour=1,t.next=s,null!=s&&(s.parent=t);var a=e.data;e.data=r.data,r.data=a,null!=this.swapped&&this.swapped(e.data,r.data),r.prev=l,null!=l&&(l.parent=r),r.next=e.next,null!=e.next&&(e.next.parent=r),e.next=r,null!=r&&(r.parent=e),n=i}else{var p=t.next,o=t.prev,_=o.next,h=o.prev;p.colour=0,t.colour=e.colour=1,t.prev=_,null!=_&&(_.parent=t);var u=e.data;e.data=o.data,o.data=u,null!=this.swapped&&this.swapped(e.data,o.data),o.next=h,null!=h&&(h.parent=o),o.prev=e.prev,null!=e.prev&&(e.prev.parent=o),e.prev=o,null!=o&&(o.parent=e),n=p}null!=n.prev&&0==n.prev.colour?this.__fix_dbl_red(n.prev):null!=n.next&&0==n.next.colour&&this.__fix_dbl_red(n.next)},__fix_dbl_red:function(t){for(;;){var n=t.parent,e=n.parent;if(null==e){n.colour=1;break}var i,r,s,l,a,p,o;n==e.prev?(s=e,o=e.next,t==n.prev?(i=t,r=n,l=t.prev,a=t.next,p=n.next):(i=n,r=t,l=n.prev,a=t.prev,p=t.next)):(i=e,l=e.prev,t==n.prev?(r=t,s=n,a=t.prev,p=t.next,o=n.next):(r=n,s=t,a=n.prev,p=t.prev,o=t.next));var _=e.parent;if(null==_?this.parent=r:_.prev==e?_.prev=r:_.next=r,null!=r&&(r.parent=_),i.prev=l,null!=l&&(l.parent=i),i.next=a,null!=a&&(a.parent=i),r.prev=i,null!=i&&(i.parent=r),r.next=s,null!=s&&(s.parent=r),s.prev=p,null!=p&&(p.parent=s),s.next=o,null!=o&&(o.parent=s),r.colour=e.colour-1,i.colour=1,s.colour=1,r==this.parent)this.parent.colour=1;else if(0==r.colour&&0==r.parent.colour){t=r;continue}break}},try_insert_bool:function(t){var n=null,e=null;if(null==this.parent)null==o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleSeg:(n=o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool,o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool=n.next,n.next=null),n.data=t,this.parent=n;else for(e=this.parent;;)if(this.lt(t,e.data)){if(null==e.prev){null==o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleSeg:(n=o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool,o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool=n.next,n.next=null),n.data=t,e.prev=n,n.parent=e;break}e=e.prev}else{if(!this.lt(e.data,t))break;if(null==e.next){null==o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleSeg:(n=o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool,o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool=n.next,n.next=null),n.data=t,e.next=n,n.parent=e;break}e=e.next}return null!=n&&(null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),!0)},try_insert:function(t){var n=null,e=null;if(null==this.parent)null==o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleSeg:(n=o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool,o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool=n.next,n.next=null),n.data=t,this.parent=n;else for(e=this.parent;;)if(this.lt(t,e.data)){if(null==e.prev){null==o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleSeg:(n=o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool,o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool=n.next,n.next=null),n.data=t,e.prev=n,n.parent=e;break}e=e.prev}else{if(!this.lt(e.data,t))break;if(null==e.next){null==o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleSeg:(n=o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool,o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool=n.next,n.next=null),n.data=t,e.next=n,n.parent=e;break}e=e.next}return null==n?e:(null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),n)},insert:function(t){var n;if(null==o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleSeg:(n=o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool,o.util.ZPP_Set_ZPP_SimpleSeg.zpp_pool=n.next,n.next=null),n.data=t,null==this.parent)this.parent=n;else for(var e=this.parent;;)if(this.lt(n.data,e.data)){if(null==e.prev){e.prev=n,n.parent=e;break}e=e.prev}else{if(null==e.next){e.next=n,n.parent=e;break}e=e.next}return null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),n},__class__:o.util.ZPP_Set_ZPP_SimpleSeg},o.util.ZPP_Set_ZPP_SimpleEvent=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null},o.util.ZPP_Set_ZPP_SimpleEvent.__name__=!0,o.util.ZPP_Set_ZPP_SimpleEvent.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},verify:function(){if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;){var n=t.data,e=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(e){if(n==r)e=!1;else if(!this.lt(r,n)&&this.lt(n,r))return!1}else if(!this.lt(n,r)&&this.lt(r,n))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var t=0;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){n.data;if(t++,null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},has:function(t){return null!=this.find(t)},find:function(t){for(var n=this.parent;null!=n&&n.data!=t;)n=this.lt(t,n.data)?n.prev:n.next;return n},has_weak:function(t){return null!=this.find_weak(t)},find_weak:function(t){for(var n=this.parent;null!=n;)if(this.lt(t,n.data))n=n.prev;else{if(!this.lt(n.data,t))break;n=n.next}return n},lower_bound:function(t){var n=null;if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var i=e.data;if(!this.lt(i,t)){n=i;break}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return n},first:function(){for(var t=this.parent;null!=t.prev;)t=t.prev;return t.data},pop_front:function(){for(var t=this.parent;null!=t.prev;)t=t.prev;var n=t.data;return this.remove_node(t),n},remove:function(t){var n=this.find(t);this.remove_node(n)},successor_node:function(t){if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{var n=t;for(t=t.parent;null!=t&&t.prev!=n;)n=t,t=t.parent}return t},predecessor_node:function(t){if(null!=t.prev)for(t=t.prev;null!=t.next;)t=t.next;else{var n=t;for(t=t.parent;null!=t&&t.next!=n;)n=t,t=t.parent}return t},successor:function(t){var n=this.successor_node(this.find(t));return null==n?null:n.data},predecessor:function(t){var n=this.predecessor_node(this.find(t));return null==n?null:n.data},remove_node:function(t){if(null!=t.next&&null!=t.prev){for(var n=t.next;null!=n.prev;)n=n.prev;var e=t.data;t.data=n.data,n.data=e,null!=this.swapped&&this.swapped(t.data,n.data),t=n}var i;if(i=null==t.prev?t.next:t.prev,1==t.colour)if(null!=t.prev||null!=t.next)i.colour=1;else if(null!=t.parent)for(var r=t.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var s=r.prev;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}var l=r.next;if(-1==l.colour){this.__fix_neg_red(l);break}if(0==l.colour){if(null!=l.prev&&0==l.prev.colour){this.__fix_dbl_red(l.prev);break}if(null!=l.next&&0==l.next.colour){this.__fix_dbl_red(l.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var a=t.parent;null==a?this.parent=i:a.prev==t?a.prev=i:a.next=i,null!=i&&(i.parent=a),t.parent=t.prev=t.next=null;var p=t;p.data=null,p.lt=null,p.swapped=null,p.next=o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool,o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool=p},clear:function(){this.clear_with(function(t){})},clear_with:function(t){if(null!=this.parent){for(var n=this.parent;null!=n;)n=null!=n.prev?n.prev:null!=n.next?n.next:this.clear_node(n,t);this.parent=null}},clear_node:function(t,n){n(t.data);var e=t.parent;null!=e&&(t==e.prev?e.prev=null:e.next=null,t.parent=null);var i=t;return i.data=null,i.lt=null,i.swapped=null,i.next=o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool,o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool=i,e},__fix_neg_red:function(t){var n,e=t.parent;if(e.prev==t){var i=t.prev,r=t.next,s=r.prev,l=r.next;i.colour=0,t.colour=e.colour=1,t.next=s,null!=s&&(s.parent=t);var a=e.data;e.data=r.data,r.data=a,null!=this.swapped&&this.swapped(e.data,r.data),r.prev=l,null!=l&&(l.parent=r),r.next=e.next,null!=e.next&&(e.next.parent=r),e.next=r,null!=r&&(r.parent=e),n=i}else{var p=t.next,o=t.prev,_=o.next,h=o.prev;p.colour=0,t.colour=e.colour=1,t.prev=_,null!=_&&(_.parent=t);var u=e.data;e.data=o.data,o.data=u,null!=this.swapped&&this.swapped(e.data,o.data),o.next=h,null!=h&&(h.parent=o),o.prev=e.prev,null!=e.prev&&(e.prev.parent=o),e.prev=o,null!=o&&(o.parent=e),n=p}null!=n.prev&&0==n.prev.colour?this.__fix_dbl_red(n.prev):null!=n.next&&0==n.next.colour&&this.__fix_dbl_red(n.next)},__fix_dbl_red:function(t){for(;;){var n=t.parent,e=n.parent;if(null==e){n.colour=1;break}var i,r,s,l,a,p,o;n==e.prev?(s=e,o=e.next,t==n.prev?(i=t,r=n,l=t.prev,a=t.next,p=n.next):(i=n,r=t,l=n.prev,a=t.prev,p=t.next)):(i=e,l=e.prev,t==n.prev?(r=t,s=n,a=t.prev,p=t.next,o=n.next):(r=n,s=t,a=n.prev,p=t.prev,o=t.next));var _=e.parent;if(null==_?this.parent=r:_.prev==e?_.prev=r:_.next=r,null!=r&&(r.parent=_),i.prev=l,null!=l&&(l.parent=i),i.next=a,null!=a&&(a.parent=i),r.prev=i,null!=i&&(i.parent=r),r.next=s,null!=s&&(s.parent=r),s.prev=p,null!=p&&(p.parent=s),s.next=o,null!=o&&(o.parent=s),r.colour=e.colour-1,i.colour=1,s.colour=1,r==this.parent)this.parent.colour=1;else if(0==r.colour&&0==r.parent.colour){t=r;continue}break}},try_insert_bool:function(t){var n=null,e=null;if(null==this.parent)null==o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleEvent:(n=o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool,o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool=n.next,n.next=null),n.data=t,this.parent=n;else for(e=this.parent;;)if(this.lt(t,e.data)){if(null==e.prev){null==o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleEvent:(n=o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool,o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool=n.next,n.next=null),n.data=t,e.prev=n,n.parent=e;break}e=e.prev}else{if(!this.lt(e.data,t))break;if(null==e.next){null==o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleEvent:(n=o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool,o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool=n.next,n.next=null),n.data=t,e.next=n,n.parent=e;break}e=e.next}return null!=n&&(null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),!0)},try_insert:function(t){var n=null,e=null;if(null==this.parent)null==o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleEvent:(n=o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool,o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool=n.next,n.next=null),n.data=t,this.parent=n;else for(e=this.parent;;)if(this.lt(t,e.data)){if(null==e.prev){null==o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleEvent:(n=o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool,o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool=n.next,n.next=null),n.data=t,e.prev=n,n.parent=e;break}e=e.prev}else{if(!this.lt(e.data,t))break;if(null==e.next){null==o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleEvent:(n=o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool,o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool=n.next,n.next=null),n.data=t,e.next=n,n.parent=e;break}e=e.next}return null==n?e:(null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),n)},insert:function(t){var n
;if(null==o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool?n=new o.util.ZPP_Set_ZPP_SimpleEvent:(n=o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool,o.util.ZPP_Set_ZPP_SimpleEvent.zpp_pool=n.next,n.next=null),n.data=t,null==this.parent)this.parent=n;else for(var e=this.parent;;)if(this.lt(n.data,e.data)){if(null==e.prev){e.prev=n,n.parent=e;break}e=e.prev}else{if(null==e.next){e.next=n,n.parent=e;break}e=e.next}return null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),n},__class__:o.util.ZPP_Set_ZPP_SimpleEvent},o.util.ZPP_Set_ZPP_CbSet=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null},o.util.ZPP_Set_ZPP_CbSet.__name__=!0,o.util.ZPP_Set_ZPP_CbSet.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},verify:function(){if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;){var n=t.data,e=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(e){if(n==r)e=!1;else if(!this.lt(r,n)&&this.lt(n,r))return!1}else if(!this.lt(n,r)&&this.lt(r,n))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var t=0;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){n.data;if(t++,null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},has:function(t){return null!=this.find(t)},find:function(t){for(var n=this.parent;null!=n&&n.data!=t;)n=this.lt(t,n.data)?n.prev:n.next;return n},has_weak:function(t){return null!=this.find_weak(t)},find_weak:function(t){for(var n=this.parent;null!=n;)if(this.lt(t,n.data))n=n.prev;else{if(!this.lt(n.data,t))break;n=n.next}return n},lower_bound:function(t){var n=null;if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var i=e.data;if(!this.lt(i,t)){n=i;break}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return n},first:function(){for(var t=this.parent;null!=t.prev;)t=t.prev;return t.data},pop_front:function(){for(var t=this.parent;null!=t.prev;)t=t.prev;var n=t.data;return this.remove_node(t),n},remove:function(t){var n=this.find(t);this.remove_node(n)},successor_node:function(t){if(null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{var n=t;for(t=t.parent;null!=t&&t.prev!=n;)n=t,t=t.parent}return t},predecessor_node:function(t){if(null!=t.prev)for(t=t.prev;null!=t.next;)t=t.next;else{var n=t;for(t=t.parent;null!=t&&t.next!=n;)n=t,t=t.parent}return t},successor:function(t){var n=this.successor_node(this.find(t));return null==n?null:n.data},predecessor:function(t){var n=this.predecessor_node(this.find(t));return null==n?null:n.data},remove_node:function(t){if(null!=t.next&&null!=t.prev){for(var n=t.next;null!=n.prev;)n=n.prev;var e=t.data;t.data=n.data,n.data=e,null!=this.swapped&&this.swapped(t.data,n.data),t=n}var i;if(i=null==t.prev?t.next:t.prev,1==t.colour)if(null!=t.prev||null!=t.next)i.colour=1;else if(null!=t.parent)for(var r=t.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var s=r.prev;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}var l=r.next;if(-1==l.colour){this.__fix_neg_red(l);break}if(0==l.colour){if(null!=l.prev&&0==l.prev.colour){this.__fix_dbl_red(l.prev);break}if(null!=l.next&&0==l.next.colour){this.__fix_dbl_red(l.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var a=t.parent;null==a?this.parent=i:a.prev==t?a.prev=i:a.next=i,null!=i&&(i.parent=a),t.parent=t.prev=t.next=null;var p=t;p.data=null,p.lt=null,p.swapped=null,p.next=o.util.ZPP_Set_ZPP_CbSet.zpp_pool,o.util.ZPP_Set_ZPP_CbSet.zpp_pool=p},clear:function(){this.clear_with(function(t){})},clear_with:function(t){if(null!=this.parent){for(var n=this.parent;null!=n;)n=null!=n.prev?n.prev:null!=n.next?n.next:this.clear_node(n,t);this.parent=null}},clear_node:function(t,n){n(t.data);var e=t.parent;null!=e&&(t==e.prev?e.prev=null:e.next=null,t.parent=null);var i=t;return i.data=null,i.lt=null,i.swapped=null,i.next=o.util.ZPP_Set_ZPP_CbSet.zpp_pool,o.util.ZPP_Set_ZPP_CbSet.zpp_pool=i,e},__fix_neg_red:function(t){var n,e=t.parent;if(e.prev==t){var i=t.prev,r=t.next,s=r.prev,l=r.next;i.colour=0,t.colour=e.colour=1,t.next=s,null!=s&&(s.parent=t);var a=e.data;e.data=r.data,r.data=a,null!=this.swapped&&this.swapped(e.data,r.data),r.prev=l,null!=l&&(l.parent=r),r.next=e.next,null!=e.next&&(e.next.parent=r),e.next=r,null!=r&&(r.parent=e),n=i}else{var p=t.next,o=t.prev,_=o.next,h=o.prev;p.colour=0,t.colour=e.colour=1,t.prev=_,null!=_&&(_.parent=t);var u=e.data;e.data=o.data,o.data=u,null!=this.swapped&&this.swapped(e.data,o.data),o.next=h,null!=h&&(h.parent=o),o.prev=e.prev,null!=e.prev&&(e.prev.parent=o),e.prev=o,null!=o&&(o.parent=e),n=p}null!=n.prev&&0==n.prev.colour?this.__fix_dbl_red(n.prev):null!=n.next&&0==n.next.colour&&this.__fix_dbl_red(n.next)},__fix_dbl_red:function(t){for(;;){var n=t.parent,e=n.parent;if(null==e){n.colour=1;break}var i,r,s,l,a,p,o;n==e.prev?(s=e,o=e.next,t==n.prev?(i=t,r=n,l=t.prev,a=t.next,p=n.next):(i=n,r=t,l=n.prev,a=t.prev,p=t.next)):(i=e,l=e.prev,t==n.prev?(r=t,s=n,a=t.prev,p=t.next,o=n.next):(r=n,s=t,a=n.prev,p=t.prev,o=t.next));var _=e.parent;if(null==_?this.parent=r:_.prev==e?_.prev=r:_.next=r,null!=r&&(r.parent=_),i.prev=l,null!=l&&(l.parent=i),i.next=a,null!=a&&(a.parent=i),r.prev=i,null!=i&&(i.parent=r),r.next=s,null!=s&&(s.parent=r),s.prev=p,null!=p&&(p.parent=s),s.next=o,null!=o&&(o.parent=s),r.colour=e.colour-1,i.colour=1,s.colour=1,r==this.parent)this.parent.colour=1;else if(0==r.colour&&0==r.parent.colour){t=r;continue}break}},try_insert_bool:function(t){var n=null,e=null;if(null==this.parent)null==o.util.ZPP_Set_ZPP_CbSet.zpp_pool?n=new o.util.ZPP_Set_ZPP_CbSet:(n=o.util.ZPP_Set_ZPP_CbSet.zpp_pool,o.util.ZPP_Set_ZPP_CbSet.zpp_pool=n.next,n.next=null),n.data=t,this.parent=n;else for(e=this.parent;;)if(this.lt(t,e.data)){if(null==e.prev){null==o.util.ZPP_Set_ZPP_CbSet.zpp_pool?n=new o.util.ZPP_Set_ZPP_CbSet:(n=o.util.ZPP_Set_ZPP_CbSet.zpp_pool,o.util.ZPP_Set_ZPP_CbSet.zpp_pool=n.next,n.next=null),n.data=t,e.prev=n,n.parent=e;break}e=e.prev}else{if(!this.lt(e.data,t))break;if(null==e.next){null==o.util.ZPP_Set_ZPP_CbSet.zpp_pool?n=new o.util.ZPP_Set_ZPP_CbSet:(n=o.util.ZPP_Set_ZPP_CbSet.zpp_pool,o.util.ZPP_Set_ZPP_CbSet.zpp_pool=n.next,n.next=null),n.data=t,e.next=n,n.parent=e;break}e=e.next}return null!=n&&(null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),!0)},try_insert:function(t){var n=null,e=null;if(null==this.parent)null==o.util.ZPP_Set_ZPP_CbSet.zpp_pool?n=new o.util.ZPP_Set_ZPP_CbSet:(n=o.util.ZPP_Set_ZPP_CbSet.zpp_pool,o.util.ZPP_Set_ZPP_CbSet.zpp_pool=n.next,n.next=null),n.data=t,this.parent=n;else for(e=this.parent;;)if(this.lt(t,e.data)){if(null==e.prev){null==o.util.ZPP_Set_ZPP_CbSet.zpp_pool?n=new o.util.ZPP_Set_ZPP_CbSet:(n=o.util.ZPP_Set_ZPP_CbSet.zpp_pool,o.util.ZPP_Set_ZPP_CbSet.zpp_pool=n.next,n.next=null),n.data=t,e.prev=n,n.parent=e;break}e=e.prev}else{if(!this.lt(e.data,t))break;if(null==e.next){null==o.util.ZPP_Set_ZPP_CbSet.zpp_pool?n=new o.util.ZPP_Set_ZPP_CbSet:(n=o.util.ZPP_Set_ZPP_CbSet.zpp_pool,o.util.ZPP_Set_ZPP_CbSet.zpp_pool=n.next,n.next=null),n.data=t,e.next=n,n.parent=e;break}e=e.next}return null==n?e:(null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),n)},insert:function(t){var n;if(null==o.util.ZPP_Set_ZPP_CbSet.zpp_pool?n=new o.util.ZPP_Set_ZPP_CbSet:(n=o.util.ZPP_Set_ZPP_CbSet.zpp_pool,o.util.ZPP_Set_ZPP_CbSet.zpp_pool=n.next,n.next=null),n.data=t,null==this.parent)this.parent=n;else for(var e=this.parent;;)if(this.lt(n.data,e.data)){if(null==e.prev){e.prev=n,n.parent=e;break}e=e.prev}else{if(null==e.next){e.next=n,n.parent=e;break}e=e.next}return null==n.parent?n.colour=1:(n.colour=0,0==n.parent.colour&&this.__fix_dbl_red(n)),n},__class__:o.util.ZPP_Set_ZPP_CbSet};var _,h=0;Math.NaN=Number.NaN,Math.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,Math.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,Math.isFinite=function(t){return isFinite(t)},Math.isNaN=function(t){return isNaN(t)},String.prototype.__class__=String,String.__name__=!0,Array.__name__=!0;var u={__name__:["Int"]},d={__name__:["Dynamic"]},c=Number;c.__name__=["Float"];var P=Boolean;P.__ename__=["Bool"];var f={__name__:["Class"]},z={};e.cellWcnt=3,e.cellHcnt=3,e.cellWidth=266.6666666666667,e.cellHeight=200,e.size=22,p.Config.epsilon=1e-8,p.Config.fluidAngularDragFriction=2.5,p.Config.fluidAngularDrag=100,p.Config.fluidVacuumDrag=.5,p.Config.fluidLinearDrag=.5,p.Config.collisionSlop=.2,p.Config.collisionSlopCCD=.5,p.Config.distanceThresholdCCD=.05,p.Config.staticCCDLinearThreshold=.05,p.Config.staticCCDAngularThreshold=.005,p.Config.bulletCCDLinearThreshold=.125,p.Config.bulletCCDAngularThreshold=.0125,p.Config.dynamicSweepLinearThreshold=17,p.Config.dynamicSweepAngularThreshold=.6,p.Config.angularCCDSlipScale=.75,p.Config.arbiterExpirationDelay=6,p.Config.staticFrictionThreshold=2,p.Config.elasticThreshold=20,p.Config.sleepDelay=60,p.Config.linearSleepThreshold=.2,p.Config.angularSleepThreshold=.4,p.Config.contactBiasCoef=.3,p.Config.contactStaticBiasCoef=.6,p.Config.contactContinuousBiasCoef=.4,p.Config.contactContinuousStaticBiasCoef=.5,p.Config.constraintLinearSlop=.1,p.Config.constraintAngularSlop=.001,p.Config.illConditionedThreshold=2e8,p.constraint.Constraint.zpp_internalAlloc=!1,p.phys.Interactor.zpp_internalAlloc=!1,p.shape.Shape.zpp_internalAlloc=!1,o.ZPP_Const.FMAX=1e100,o.ZPP_ID._Constraint=0,o.ZPP_ID._Interactor=0,o.ZPP_ID._CbType=0,o.ZPP_ID._CbSet=0,o.ZPP_ID._Listener=0,o.ZPP_ID._ZPP_SimpleVert=0,o.ZPP_ID._ZPP_SimpleSeg=0,o.ZPP_ID._Space=0,o.ZPP_ID._InteractionGroup=0,o.callbacks.ZPP_Callback.internal=!1,o.callbacks.ZPP_CbType.ANY_SHAPE=new p.callbacks.CbType,o.callbacks.ZPP_CbType.ANY_BODY=new p.callbacks.CbType,o.callbacks.ZPP_CbType.ANY_COMPOUND=new p.callbacks.CbType,o.callbacks.ZPP_CbType.ANY_CONSTRAINT=new p.callbacks.CbType,o.util.ZPP_Flags.internal=!1,o.util.ZPP_Flags.id_ImmState_ACCEPT=1,o.util.ZPP_Flags.id_ImmState_IGNORE=2,o.util.ZPP_Flags.id_ImmState_ALWAYS=4,o.util.ZPP_Flags.id_GravMassMode_DEFAULT=0,o.util.ZPP_Flags.id_GravMassMode_FIXED=1,o.util.ZPP_Flags.id_GravMassMode_SCALED=2,o.util.ZPP_Flags.id_InertiaMode_DEFAULT=0,o.util.ZPP_Flags.id_InertiaMode_FIXED=1,o.util.ZPP_Flags.id_MassMode_DEFAULT=0,o.util.ZPP_Flags.id_MassMode_FIXED=1,o.util.ZPP_Flags.id_BodyType_STATIC=1,o.util.ZPP_Flags.id_BodyType_DYNAMIC=2,o.util.ZPP_Flags.id_BodyType_KINEMATIC=3,o.util.ZPP_Flags.id_ListenerType_BODY=0,o.util.ZPP_Flags.id_ListenerType_CONSTRAINT=1,o.util.ZPP_Flags.id_PreFlag_ACCEPT=1,o.util.ZPP_Flags.id_ListenerType_INTERACTION=2,o.util.ZPP_Flags.id_PreFlag_IGNORE=2,o.util.ZPP_Flags.id_ListenerType_PRE=3,o.util.ZPP_Flags.id_PreFlag_ACCEPT_ONCE=3,o.util.ZPP_Flags.id_PreFlag_IGNORE_ONCE=4,o.util.ZPP_Flags.id_CbEvent_BEGIN=0,o.util.ZPP_Flags.id_CbEvent_ONGOING=6,o.util.ZPP_Flags.id_InteractionType_COLLISION=1,o.util.ZPP_Flags.id_CbEvent_END=1,o.util.ZPP_Flags.id_InteractionType_SENSOR=2,o.util.ZPP_Flags.id_CbEvent_WAKE=2,o.util.ZPP_Flags.id_InteractionType_FLUID=4,o.util.ZPP_Flags.id_CbEvent_SLEEP=3,o.util.ZPP_Flags.id_InteractionType_ANY=7,o.util.ZPP_Flags.id_CbEvent_BREAK=4,o.util.ZPP_Flags.id_CbEvent_PRE=5,o.util.ZPP_Flags.id_Winding_UNDEFINED=0,o.util.ZPP_Flags.id_Winding_CLOCKWISE=1,o.util.ZPP_Flags.id_Winding_ANTICLOCKWISE=2,o.util.ZPP_Flags.id_ValidationResult_VALID=0,o.util.ZPP_Flags.id_ValidationResult_DEGENERATE=1,o.util.ZPP_Flags.id_ValidationResult_CONCAVE=2,o.util.ZPP_Flags.id_ValidationResult_SELF_INTERSECTING=3,o.util.ZPP_Flags.id_ShapeType_CIRCLE=0,o.util.ZPP_Flags.id_ShapeType_POLYGON=1,o.util.ZPP_Flags.id_Broadphase_DYNAMIC_AABB_TREE=0,o.util.ZPP_Flags.id_Broadphase_SWEEP_AND_PRUNE=1,o.util.ZPP_Flags.id_ArbiterType_COLLISION=1,o.util.ZPP_Flags.id_ArbiterType_SENSOR=2,o.util.ZPP_Flags.id_ArbiterType_FLUID=4,o.callbacks.ZPP_Listener.internal=!1,o.callbacks.ZPP_Listener.types=[function(t){return null==o.util.ZPP_Flags.ListenerType_BODY&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ListenerType_BODY=new p.callbacks.ListenerType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ListenerType_BODY}(),function(t){return null==o.util.ZPP_Flags.ListenerType_CONSTRAINT&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ListenerType_CONSTRAINT=new p.callbacks.ListenerType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ListenerType_CONSTRAINT}(),function(t){return null==o.util.ZPP_Flags.ListenerType_INTERACTION&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ListenerType_INTERACTION=new p.callbacks.ListenerType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ListenerType_INTERACTION}(),function(t){return null==o.util.ZPP_Flags.ListenerType_PRE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ListenerType_PRE=new p.callbacks.ListenerType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ListenerType_PRE}()],o.callbacks.ZPP_Listener.events=[function(t){return null==o.util.ZPP_Flags.CbEvent_BEGIN&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_BEGIN=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_BEGIN}(),function(t){return null==o.util.ZPP_Flags.CbEvent_END&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_END=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_END}(),function(t){return null==o.util.ZPP_Flags.CbEvent_WAKE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_WAKE=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_WAKE}(),function(t){return null==o.util.ZPP_Flags.CbEvent_SLEEP&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_SLEEP=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_SLEEP}(),function(t){return null==o.util.ZPP_Flags.CbEvent_BREAK&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_BREAK=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_BREAK}(),function(t){return null==o.util.ZPP_Flags.CbEvent_PRE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_PRE=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_PRE}(),function(t){return null==o.util.ZPP_Flags.CbEvent_ONGOING&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.CbEvent_ONGOING=new p.callbacks.CbEvent,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.CbEvent_ONGOING}()],o.callbacks.ZPP_InteractionListener.UCbSet=new o.util.ZNPList_ZPP_CbSet,o.callbacks.ZPP_InteractionListener.VCbSet=new o.util.ZNPList_ZPP_CbSet,o.callbacks.ZPP_InteractionListener.WCbSet=new o.util.ZNPList_ZPP_CbSet,o.callbacks.ZPP_InteractionListener.UCbType=new o.util.ZNPList_ZPP_CbType,o.callbacks.ZPP_InteractionListener.VCbType=new o.util.ZNPList_ZPP_CbType,o.callbacks.ZPP_InteractionListener.WCbType=new o.util.ZNPList_ZPP_CbType,o.dynamics.ZPP_Arbiter.internal=!1,o.dynamics.ZPP_Arbiter.COL=1,o.dynamics.ZPP_Arbiter.FLUID=4,o.dynamics.ZPP_Arbiter.SENSOR=2,o.dynamics.ZPP_Arbiter.types=[null,function(t){return null==o.util.ZPP_Flags.ArbiterType_COLLISION&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ArbiterType_COLLISION=new p.dynamics.ArbiterType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ArbiterType_COLLISION}(),function(t){return null==o.util.ZPP_Flags.ArbiterType_SENSOR&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ArbiterType_SENSOR=new p.dynamics.ArbiterType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ArbiterType_SENSOR}(),null,function(t){return null==o.util.ZPP_Flags.ArbiterType_FLUID&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ArbiterType_FLUID=new p.dynamics.ArbiterType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ArbiterType_FLUID}()],o.dynamics.ZPP_ColArbiter.FACE1=0,o.dynamics.ZPP_ColArbiter.FACE2=1,o.dynamics.ZPP_ColArbiter.CIRCLE=2,o.dynamics.ZPP_Contact.internal=!1,o.dynamics.ZPP_InteractionGroup.SHAPE=1,o.dynamics.ZPP_InteractionGroup.BODY=2,o.geom.ZPP_Collide.flowpoly=new o.util.ZNPList_ZPP_Vec2,o.geom.ZPP_Collide.flowsegs=new o.util.ZNPList_ZPP_Vec2,o.geom.ZPP_ConvexRayResult.internal=!1,o.geom.ZPP_GeomVertexIterator.internal=!1,o.geom.ZPP_MarchingSquares.me=new o.geom.ZPP_MarchingSquares,o.geom.ZPP_MarchingSquares.look_march=[-1,224,56,216,14,-1,54,214,131,99,-1,91,141,109,181,85],o.geom.ZPP_PartitionVertex.nextId=0,o.geom.ZPP_Ray.internal=!1,o.phys.ZPP_Body.types=[null,function(t){return null==o.util.ZPP_Flags.BodyType_STATIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_STATIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_STATIC}(),function(t){return null==o.util.ZPP_Flags.BodyType_DYNAMIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_DYNAMIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_DYNAMIC}(),function(t){return null==o.util.ZPP_Flags.BodyType_KINEMATIC&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.BodyType_KINEMATIC=new p.phys.BodyType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.BodyType_KINEMATIC}()],o.phys.ZPP_Body.cur_graph_depth=0,o.phys.ZPP_Material.WAKE=1,o.phys.ZPP_Material.PROPS=2,o.phys.ZPP_Material.ANGDRAG=4,o.phys.ZPP_Material.ARBITERS=8,o.shape.ZPP_Shape.types=[function(t){return null==o.util.ZPP_Flags.ShapeType_CIRCLE&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ShapeType_CIRCLE=new p.shape.ShapeType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ShapeType_CIRCLE}(),function(t){return null==o.util.ZPP_Flags.ShapeType_POLYGON&&(o.util.ZPP_Flags.internal=!0,o.util.ZPP_Flags.ShapeType_POLYGON=new p.shape.ShapeType,o.util.ZPP_Flags.internal=!1),o.util.ZPP_Flags.ShapeType_POLYGON}()],o.shape.ZPP_Edge.internal=!1,o.space.ZPP_AABBTree.tmpaabb=new o.geom.ZPP_AABB,o.space.ZPP_DynAABBPhase.FATTEN=3,o.space.ZPP_DynAABBPhase.VEL_STEPS=2,o.util.ZPP_ConstraintList.internal=!1,o.util.ZPP_BodyList.internal=!1,o.util.ZPP_InteractorList.internal=!1,o.util.ZPP_CompoundList.internal=!1,o.util.ZPP_ListenerList.internal=!1,o.util.ZPP_CbTypeList.internal=!1,o.util.ZPP_Vec2List.internal=!1,o.util.ZPP_GeomPolyList.internal=!1,o.util.ZPP_RayResultList.internal=!1,o.util.ZPP_ConvexResultList.internal=!1,o.util.ZPP_EdgeList.internal=!1,o.util.ZPP_ShapeList.internal=!1,o.util.ZPP_InteractionGroupList.internal=!1,o.util.ZPP_ArbiterList.internal=!1,o.util.ZPP_ContactList.internal=!1,window.nape=p,window.zpp_nape=o}();